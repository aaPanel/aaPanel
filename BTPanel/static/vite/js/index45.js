import{cz as e,x as a,j as t,cr as s,p as l,c as n,y as i,bm as o,o as r,m as c}from"./page_layout.js?v=1763625242172";import{d as u,c as d,h as p,u as m,a as _,_ as g}from"./public.js?v=1763625242172";import{_ as f}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1763625242172";import{k as x,r as y,e as v,R as b,S as h,X as w,V as k,U as C,a3 as N,a2 as S,an as j,F as L,O as P,l as $,v as R,H as U,a4 as T,N as W,P as q,w as I,j as z,aj as B,c as H}from"./vue.js?v=1763625242172";import{c as F,e as A,f as K,h as D,s as O,i as V}from"./logs.js?v=1763625242172";import{_ as X}from"./index107.js?v=1763625242172";import{_ as E}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1763625242172";import{_ as G}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1763625242172";import{aC as J,bH as M,dS as Q}from"./naive.js?v=1763625242172";import{_ as Y}from"./index104.js?v=1763625242172";import{_ as Z}from"./index.js?v=1763625242172";import{a as ee}from"./site.js?v=1763625242172";import{_ as ae}from"./logs.vue_vue_type_script_setup_true_lang.js?v=1763625242172";import"./common.js?v=1763625242172";import"./__commonjsHelpers__.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1763625242172";const te={class:"flex flex-col w-240px"},se={class:"item flex-1 mt-10px overflow-hidden"},le=["onClick"],ne=l(x({__name:"index",setup(l){const n=e(),i=y(""),o=v({search:""}),r=y([]),{loading:c,setLoading:d}=u(),p=async()=>{try{d(!0);const{message:e}=await F(W(o));a(e)&&(n.setWebsite(e[0].name),i.value=e[0].name,r.value=e)}finally{d(!1)}};return p(),(e,a)=>{const l=f,u=t,d=s;return b(),h("div",te,[w(l,{value:k(o).search,"onUpdate:value":a[0]||(a[0]=e=>k(o).search=e),placeholder:e.$t("Logs.Panel.index_4"),onSearch:p},null,8,["value","placeholder"]),C("div",se,[w(d,{class:"h-full"},{default:N((()=>[k(c)?(b(),S(u,{key:0,height:"36px",text:"",repeat:6})):j("",!0),(b(!0),h(L,null,P(k(r),(e=>$((b(),h("div",{class:U(["list",{"list-active":k(i)==e.name}]),key:e.name,onClick:a=>{return t=e.name,n.setWebsite(t),void(i.value=t);var t}},T(e.name),11,le)),[[R,!k(c)]]))),128))])),_:1})])])}}}),[["__scopeId","data-v-5e09d3e2"]]),ie=x({__name:"index",setup(a,{expose:t}){const s=e(),{t:l}=q(),{keys:o,table:r,columns:c}=d([{key:"username",title:l("Ftp.Analysis.Index_27")},{key:"type",title:l("Logs.Panel.index_6")},{key:"log",title:l("Public.Btn.Details")},{key:"addtime",align:"right",title:l("Logs.Panel.index_7")}]),m=v({search:s.websiteName,p:1,limit:10,stype:"Site manager"}),{loading:_,setLoading:g}=u(),f=async()=>{try{g(!0);const{message:e}=await A(m);n(e)&&(r.data=e.data,r.total=i(e.page))}finally{o.value=[],g(!1)}};I((()=>s.websiteName),(e=>{e&&(m.p=1,m.search=e,f())}));const x=()=>{s.websiteName&&f()};return x(),t({getList:x}),(e,a)=>{const t=J,s=p,l=G,n=E;return b(),S(n,{feedback:!1},{toolsLeft:N((()=>[w(t,{type:"primary",onClick:x},{default:N((()=>[z(T(e.$t("Public.Btn.Refresh")),1)])),_:1})])),table:N((()=>[w(s,{"checked-row-keys":k(o),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>B(o)?o.value=e:null),"row-key":"name",loading:k(_),data:k(r).data,columns:k(c)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:N((()=>[w(l,{page:k(m).p,"onUpdate:page":a[1]||(a[1]=e=>k(m).p=e),"page-size":k(m).limit,"onUpdate:pageSize":a[2]||(a[2]=e=>k(m).limit=e),"item-count":k(r).total,onRefresh:x},null,8,["page","page-size","item-count"])])),_:1})}}}),oe={class:"flex flex-col h-full gap-8px"},re={class:"flex-1 overflow-hidden"},ce=x({__name:"index",setup(a,{expose:t}){const s=e(),{loading:l,setLoading:i}=u(),o=y("None"),r=async()=>{i(!0);try{const{message:e}=await K({siteName:s.websiteName});n(e)&&(o.value=e.result?e.result.slice(-4e4):"None")}catch(e){o.value="None"}finally{i(!1)}};I((()=>s.websiteName),(e=>{e&&r()}));const c=()=>{s.websiteName&&r()};return c(),t({getList:c}),(e,a)=>{const t=J,s=Y;return b(),h("div",oe,[w(t,{class:"self-start",type:"primary",onClick:c},{default:N((()=>[z(T(e.$t("Public.Btn.Refresh")),1)])),_:1}),C("div",re,[w(s,{loading:k(l),log:k(o)},null,8,["loading","log"])])])}}}),ue={class:"flex flex-col h-full gap-8px"},de={class:"flex-1 overflow-hidden"},pe=x({__name:"index",setup(a,{expose:t}){const s=e(),{loading:l,setLoading:i}=u(),o=y("None"),r=async()=>{i(!0);try{const{message:e}=await D({siteName:s.websiteName});n(e)&&(o.value=e.result?e.result.slice(-4e4):"None")}catch(e){o.value="None"}finally{i(!1)}};I((()=>s.websiteName),(e=>{e&&r()}));const c=()=>{s.websiteName&&r()};return c(),t({getList:c}),(e,a)=>{const t=J,s=Y;return b(),h("div",ue,[w(t,{class:"self-start",type:"primary",onClick:c},{default:N((()=>[z(T(e.$t("Public.Btn.Refresh")),1)])),_:1}),C("div",de,[w(s,{loading:k(l),log:k(o)},null,8,["loading","log"])])])}}}),me={class:"text-error"},_e={class:"w-400px p-20px"},ge={class:"mb-16px"},fe=l(x({__name:"index",setup(a,{expose:t}){const s=e(),l=o(),{t:i}=q(),f=y(!1),x=y(0),{keys:v,table:S,columns:j}=d([{key:"start_time",title:i("Logs.Panel.index_13")},{key:"time",title:i("Public.Unit.Time"),render:e=>Number(e.time).toFixed(2)+" Sec"},{key:"xss",title:i("Site.TableRow.index_4"),render:e=>e.xss>0?w(r,{onClick:()=>{R("xss")}},{default:()=>[e.xss]}):e.xss},{key:"sql",title:i("Site.TableRow.index_5"),render:e=>e.sql>0?w(r,{onClick:()=>{R("sql")}},{default:()=>[e.sql]}):e.sql},{key:"san",title:i("Site.TableRow.index_6"),render:e=>e.san>0?w(r,{class:"button-color",onClick:()=>{R("san")}},{default:()=>[e.san]}):e.san},{key:"php",title:i("Logs.Panel.index_14"),render:e=>e.php>0?w(r,{onClick:()=>{R("php")}},{default:()=>[e.php]}):e.php},{key:"ip",title:i("Logs.Website.index_5"),render:e=>e.ip>0?w(r,{onClick:()=>{R("ip")}},{default:()=>[e.ip]}):e.ip},{key:"url",title:i("Logs.Website.index_1"),render:e=>e.url>0?w(r,{onClick:()=>{R("url")}},{default:()=>[e.url]}):e.url},{key:"log",title:i("Security.Anti.Index_7"),render:e=>e.xss+e.sql+e.san+e.php+e.ip+e.url}]),P=()=>{_({title:i("Site.Config.index_104"),content:i("Logs.Website.index_3",[s.websiteName]),onConfirm:async({hide:e})=>{try{await O({siteName:U.value}),f.value=!0,$()}finally{e()}}})},$=(e=0)=>{let a=setTimeout((async()=>{const{message:e}=await ee({path:U.value});n(e)&&(x.value=e.result,x.value>=100?(c.success(i("Site.Config.index_107")),f.value=!1,x.value=0,A(),clearTimeout(a)):$(1e3))}),e)},R=e=>{m({title:"[".concat(e,"] ").concat(i("Site.Config.index_103")),data:{type:e,path:U.value},component:ae})},U=H((()=>{let e="";switch(l.webserver){case"nginx":e=".log";break;case"apache":e="-access_log";break;default:e="_ols.access_log"}return"/www/wwwlogs/".concat(s.websiteName).concat(e)})),{loading:W,setLoading:F}=u(),A=async()=>{try{F(!0);const{message:e}=await V({siteName:U.value});n(e)&&(S.data=e.is_status?[e]:[])}finally{v.value=[],F(!1)}};return I((()=>s.websiteName),(e=>{e&&A()})),A(),t({init:A}),(e,a)=>{const t=J,s=p,l=E,n=g,i=M,o=Z;return b(),h(L,null,[w(l,{feedback:!1},{toolsLeft:N((()=>[w(t,{type:"primary",onClick:P},{default:N((()=>[z(T(e.$t("Site.Config.index_104")),1)])),_:1})])),table:N((()=>[w(s,{"checked-row-keys":k(v),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>B(v)?v.value=e:null),"row-key":"name","max-height":1e3,loading:k(W),data:k(S).data,columns:k(j)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),w(n,{class:"mt-16px"},{default:N((()=>[C("li",null,[z(T(e.$t("Site.Config.index_108"))+" ",1),C("span",me,T(e.$t("Site.Config.index_109")),1)]),C("li",null,T(e.$t("Site.Config.index_110")),1),C("li",null,T(e.$t("Site.Config.index_111")),1),C("li",null,T(e.$t("Site.Config.index_112")),1),C("li",null,[w(r,{href:"https://www.aapanel.com/forum/d/3351-nginx-waf-instructions",target:"_blank"},{default:N((()=>[z(T(e.$t("Site.Config.index_113")),1)])),_:1}),z(" "+T(e.$t("Site.Config.index_114")),1)])])),_:1}),w(o,{show:k(f),"onUpdate:show":a[1]||(a[1]=e=>B(f)?f.value=e:null)},{default:N((()=>[C("div",_e,[C("div",ge,T(e.$t("Site.Config.index_115")),1),w(i,{type:"line",status:"success",height:24,percentage:k(x),"border-radius":4,"indicator-placement":"inside"},null,8,["percentage"])])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-5bc24312"]]),xe=x({__name:"index",setup(e){const{t:a}=q(),t=y("operation"),s=[{key:"operation",label:a("Security.Tabs.Index_7"),component:ie},{key:"access",label:a("Logs.Website.index_2"),component:ce},{key:"error",label:a("Logs.Website.index_4"),component:pe},{key:"security",label:a("Site.Config.index_102"),component:fe}];return(e,a)=>{const l=X;return b(),S(l,{class:"h-full",value:k(t),"onUpdate:value":a[0]||(a[0]=e=>B(t)?t.value=e:null),options:s},null,8,["value"])}}}),ye={class:"website-box"},ve=l(x({__name:"index",setup(e){const a=o();return(async()=>{await a.getPHPConfig()})(),(e,a)=>{const t=Q;return b(),S(t,{class:"p-16px"},{default:N((()=>[C("div",ye,[w(ne),w(xe)])])),_:1})}}}),[["__scopeId","data-v-0a3ec0ba"]]);export{ve as default};
