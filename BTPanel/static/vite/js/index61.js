import{b as e,c as t,f as a,e as s,K as i,h as n,_ as l,d as o,a as u,r as c}from"./public.js?v=1752142539265";import{_ as r}from"./index102.js?v=1752142539265";import{_ as d}from"./index.js?v=1752142539265";import{k as p,P as _,r as y,n as m,e as g,U as x,X as v,Q as h,a2 as w,V as k,a3 as b,W as f,ah as S,$ as I,w as A,F as j,j as O,a1 as P,l as C,O as U,H as $,v as q,c as R}from"./vue.js?v=1752142539265";import{v as z,i as M,X as T,w as L,cz as F,m as K,d as W,x as H,_ as X,e as D,u as B,p as E}from"./page_layout.js?v=1752142539265";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1752142539265";import{bX as V,cD as G,cz as J,aq as N,ay as Y,cA as Z,bA as ee,c1 as te}from"./naive.js?v=1752142539265";import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang.js?v=1752142539265";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1752142539265";import"./common.js?v=1752142539265";import"./__commonjsHelpers__.js?v=1752142539265";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1752142539265";const{t:ie}=M.global,ne={class:"p-20px"},le=p({__name:"log",props:{data:{}},setup(s,{expose:i}){const{t:n}=_(),l=s,{date:o,name:u}=l.data,c=y([]),{keys:r,table:d,columns:p}=e([{key:"log",title:n("Ftp.Analysis.Index_27"),render:()=>u},{key:"cwd",title:n("Security.Anti.Index_46")},{key:"cmd",title:n("Security.Anti.Index_47")},{key:"filename",title:n("Security.Anti.Index_48")},{key:"cwd",title:n("Config.Safe.index_152"),render:e=>T(e.timestamp)}]);m((()=>{c.value=o.map((e=>({label:e,value:e})))}));const I=g({p:1,num:999,day:o[0]}),{loading:A,setLoading:j}=t(),O=async()=>{try{j(!0);const{message:t}=await(e={...I,user:u},z.post("/plugin?action=a&name=bt_security&s=get_user_log",e));L(t)&&(d.data=t,d.total=t.length)}finally{r.value=[],j(!1)}var e};return O(),i({init:O}),(e,t)=>{const s=G,i=V,n=a,l=Q;return v(),x("div",ne,[h(i,{class:"flex-nowrap! items-center mb-10px"},{default:w((()=>[k("span",null,b(e.$t("Security.Anti.Index_45")),1),h(s,{class:"w-150px",value:f(I).day,"onUpdate:value":[t[0]||(t[0]=e=>f(I).day=e),O],options:f(c)},null,8,["value","options"])])),_:1}),h(l,null,{table:w((()=>[h(n,{"checked-row-keys":f(r),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>S(r)?r.value=e:null),loading:f(A),data:f(d).data,"max-height":350,columns:f(p)},null,8,["checked-row-keys","loading","data","columns"])])),_:1})])}}}),oe=p({__name:"index",setup(o,{expose:u}){const{t:c}=_(),r=F(),{antiForm:p}=I(r),y=s(),{keys:m,table:g,columns:O}=e([{key:"user",title:c("Ftp.Analysis.Index_27")},{key:"total",title:c("Security.Anti.Index_7")},{key:"today",title:c("Public.Search.Today")},i({key:"protection",title:c("Security.Tabs.Index_8"),minWidth:60,onClick:async(e,t)=>{var a;e?await(a={user:t.user},z.post("/plugin?action=a&name=bt_security&s=start_user_security",a,{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}})):await(e=>z.post("/plugin?action=a&name=bt_security&s=stop_user_security",e,{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}))({user:t.user})}}),i({key:"log",title:c("Security.Anti.Index_8"),minWidth:60,onClick:async(e,t)=>{var a;e?await(a={uid:t.uid},z.post("/plugin?action=a&name=bt_security&s=start_user_log",a,{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}})):await(e=>z.post("/plugin?action=a&name=bt_security&s=stop_user_log",e,{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}))({uid:t.uid})}}),{key:"remark",title:c("Site.Proxy.index_3")},n({width:130,title:c("Public.Table.Operation"),options:e=>[{label:c("Site.Proxy.index_51"),onClick:async()=>{const{message:t}=await(a={user:e.user},z.post("/plugin?action=a&name=bt_security&s=get_logs_list",a,{requestOptions:{loading:ie("Site.Api.Index_10"),successMessage:!1}}));var a;!L(t)||t.length?(y.title="[".concat(e.user,"] - ").concat(c("Site.Proxy.index_51")),y.data.date=t,y.data.name=e.user,y.show=!0):K.error(c("Security.Anti.Index_44"))}}]})]);A((()=>r.isRefresh),(e=>{e&&(r.setRefresh(!1),U())}));const{loading:P,setLoading:C}=t(),U=async()=>{try{C(!0);const{message:e}=await z.post("/plugin?action=a&name=bt_security&s=get_total_all");W(e)&&(p.value.switch=e.open,p.value.times=e.totla_times,p.value.days=e.totla_days,g.data=e.system_user.map((e=>({user:e[0],total:e[4].totla,today:e[4].day_totla,protection:e[3],log:e[5],remark:e[6],uid:e[1]}))))}finally{m.value=[],C(!1)}};return U(),u({init:U}),(e,t)=>{const s=a,i=l,n=d;return v(),x(j,null,[h(s,{"checked-row-keys":f(m),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(m)?m.value=e:null),"row-key":"user","max-height":750,loading:f(P),data:f(g).data,columns:f(O)},null,8,["checked-row-keys","loading","data","columns"]),h(i,{class:"mt-16px"},{default:w((()=>[k("li",null,b(e.$t("Security.Anti.Index_4")),1),k("li",null,b(e.$t("Security.Anti.Index_5")),1),k("li",null,b(e.$t("Security.Anti.Index_6")),1)])),_:1}),h(n,{show:f(y).show,"onUpdate:show":t[1]||(t[1]=e=>f(y).show=e),title:f(y).title,data:f(y).data,width:750,"min-height":268,footer:!1,component:le},null,8,["show","title","data"])],64)}}}),ue={class:"p-20px"},ce={class:"w-280px"},re={class:"color-#ff3333"},de=p({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=_(),s=e,{getList:i}=s.data,n=y(null),o=g({name:""}),u={name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=n.value)?void 0:t.validate()),await(a={cmd:o.name},z.post("/plugin?action=a&name=bt_security&s=add_porcess_log",a,{requestOptions:{loading:ie("Security.Api.Index_4"),successMessage:!0}})),null==i||i(),e()}}),(e,t)=>{const a=N,s=J,i=ae,c=l;return v(),x("div",ue,[h(i,{ref_key:"formRef",ref:n,model:f(o),rules:u},{default:w((()=>[h(s,{label:e.$t("Home.index_24"),path:"name"},{default:w((()=>[k("div",ce,[h(a,{type:"text",value:f(o).name,"onUpdate:value":t[0]||(t[0]=e=>f(o).name=e),placeholder:"e.g:/bin/bash"},null,8,["value"])])])),_:1},8,["label"])])),_:1},8,["model"]),h(c,{class:"mt-4px"},{default:w((()=>[k("li",re,b(e.$t("Security.Anti.Index_9")),1)])),_:1})])}}}),pe=p({__name:"index",setup(i,{expose:l}){const{t:u}=_(),{loading:c,setLoading:r}=t(),{keys:p,table:y,columns:m}=e([{key:"whitelist",title:u("Security.Anti.Index_11")},n({width:130,options:e=>[{label:u("Public.Btn.Del"),onClick:()=>{o({title:"".concat(u("Security.Anti.Index_12")," [").concat(e.whitelist,"]"),content:u("Security.Anti.Index_13"),onConfirm:async({hide:t})=>{var a;await(a={cmd:e.whitelist},z.post("/plugin?action=a&name=bt_security&s=del_porcess_log",a,{requestOptions:{loading:ie("Security.Api.Index_3"),successMessage:!0}})),g(),t()}})}}]})]),g=async()=>{try{r(!0);const{message:e}=await z.post("/plugin?action=a&name=bt_security&s=porcess_set_up_log");L(e)&&(y.data=e.map((e=>({whitelist:e}))))}finally{p.value=[],r(!1)}};g(),l({init:g});const k=()=>{I.show=!0},I=s(u("Security.Anti.Index_10"),{getList:g});return(e,t)=>{const s=Y,i=a,n=Q,l=d;return v(),x("div",null,[h(n,null,{toolsLeft:w((()=>[h(s,{type:"primary",onClick:k},{default:w((()=>[O(b(e.$t("Security.Anti.Index_10")),1)])),_:1})])),table:w((()=>[h(i,{"checked-row-keys":f(p),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(p)?p.value=e:null),"row-key":"whitelist",loading:f(c),"max-height":440,data:f(y).data,columns:f(m)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),h(l,{show:f(I).show,"onUpdate:show":t[1]||(t[1]=e=>f(I).show=e),title:f(I).title,data:f(I).data,width:480,footer:!0,component:de},null,8,["show","title","data"])])}}}),_e=p({__name:"index",setup(s,{expose:i}){const{t:n}=_(),{keys:l,table:o,columns:u}=e([{key:"log",title:n("Public.Table.Operation")},{key:"addtime",align:"right",title:n("Site.Cert.index_68")}]),c=g({p:1,limit:10}),{loading:r,setLoading:d}=t(),p=async()=>{try{d(!0);const{message:t}=await(e=c,z.post("/plugin?action=a&name=bt_security&s=get_log",e));W(t)&&(o.data=t.data,o.total=H(t.page))}finally{l.value=[],d(!1)}var e};return p(),i({init:p}),(e,t)=>{const s=a,i=se,n=Q;return v(),P(n,{feedback:!0},{table:w((()=>[h(s,{"checked-row-keys":f(l),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(l)?l.value=e:null),"row-key":"log",loading:f(r),data:f(o).data,columns:f(u)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:w((()=>[h(i,{page:f(c).p,"onUpdate:page":t[1]||(t[1]=e=>f(c).p=e),"page-size":f(c).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>f(c).limit=e),"item-count":f(o).total,"store-key":"security-anti",onRefresh:p},null,8,["page","page-size","item-count"])])),_:1})}}}),ye=p({__name:"index",setup(e){const{t:t}=_(),a=y("overview"),s=[{key:"overview",label:t("Security.Tabs.Index_5"),component:oe},{key:"whitelist",label:t("Security.Tabs.Index_6"),component:pe},{key:"operation",label:t("Security.Tabs.Index_7"),component:_e}];return(e,t)=>{const i=r;return v(),P(i,{value:f(a),"onUpdate:value":t[0]||(t[0]=e=>S(a)?a.value=e:null),options:s},null,8,["value"])}}}),me={class:"pt-40px pb-40px"},ge={class:"mb-16px"},xe={class:"ul-style"},ve={class:"text-center my-24px"},he={class:"flex justify-center"},we={class:"item"},ke=["onClick"],be=D(p({__name:"conversion",setup(e){const t=y(0),a=["Overview","Process whitelist","Operation logs"],s=()=>{u({source:105})};return(e,i)=>{const n=X,l=Y,o=ee,u=Z;return v(),P(u,null,{default:w((()=>[k("div",me,[i[3]||(i[3]=k("div",{class:"mb-24px text-center text-22px font-bold"},"Anti Intrusion prevention features",-1)),k("div",ge,[k("ul",xe,[k("li",null,[h(n,{name:"security-lixian",size:"22"}),i[0]||(i[0]=k("span",{class:"ml-4px"},"Prevents the program from hanging",-1))]),k("li",null,[h(n,{name:"security-sanfang",size:"20"}),i[1]||(i[1]=k("span",{class:"ml-4px"},"Stop the mining virus",-1))]),k("li",null,[h(n,{name:"security-webshell",size:"26"}),i[2]||(i[2]=k("span",null,"Prevent Privilege Escalation Attacks",-1))])])]),k("div",ve,[h(l,{type:"primary",class:"h-36px text-14px",onClick:s},{default:w((()=>[O(b(e.$t("WP.Transition.index_7")),1)])),_:1})]),k("div",he,[k("div",we,[k("ul",null,[(v(),x(j,null,U(a,((e,a)=>k("li",{class:$({active:f(t)==a}),key:a,onClick:e=>t.value=a},b(e),11,ke))),64))])]),C(h(o,{width:"100%",src:f("/static/vite/images/overview2.png")},null,8,["src"]),[[q,0==f(t)]]),C(h(o,{width:"100%",src:f("/static/vite/images/whitelist.png")},null,8,["src"]),[[q,1==f(t)]]),C(h(o,{width:"100%",src:f("/static/vite/images/logs.png")},null,8,["src"]),[[q,2==f(t)]])])])])),_:1})}}}),[["__scopeId","data-v-f9cef105"]]),fe={key:0},Se=p({__name:"index",setup(e){const t=B(),{isPro:a}=I(t),s=F(),{antiForm:i}=I(s),n=y(i.value.switch),l=R((()=>i.value.switch));A(l,(e=>{n.value=e}));const o=R((()=>i.value.times)),u=R((()=>i.value.days)),r=async e=>{e?await z.post("/plugin?action=a&name=bt_security&s=start_bt_security",{},{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}}):await z.post("/plugin?action=a&name=bt_security&s=stop_bt_security",{},{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await c("bt_security")})(),(e,t)=>{const s=te,i=E,l=V,c=Z;return f(a)?(v(),x("div",fe,[h(c,{class:"my-15px"},{default:w((()=>[h(l,{class:"p-15px items-center"},{default:w((()=>[k("span",null,b(e.$t("Security.Anti.Index_1")),1),h(s,{value:f(n),"onUpdate:value":[t[0]||(t[0]=e=>S(n)?n.value=e:null),r],"rubber-band":!1,size:"small"},null,8,["value"]),h(i,{vertical:""}),k("span",null,b(e.$t("Security.Anti.Index_2"))+": "+b(f(o)),1),h(i,{vertical:""}),k("span",null,b(e.$t("Security.Anti.Index_3"))+": "+b(f(u)),1)])),_:1})])),_:1}),h(c,{class:"p-15px"},{default:w((()=>[h(ye)])),_:1})])):(v(),P(be,{key:1}))}}});export{Se as default};
