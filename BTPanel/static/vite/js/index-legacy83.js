System.register(["./page_layout-legacy.js?v=1752142539265","./index-legacy127.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy11.js?v=1752142539265","./naive-legacy.js?v=1752142539265","./vue-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1752142539265","./index-legacy125.js?v=1752142539265","./public-legacy.js?v=1752142539265","./site-legacy.js?v=1752142539265","./index-legacy224.js?v=1752142539265","./Ssl.vue_vue_type_script_setup_true_lang-legacy.js?v=1752142539265","./soft-legacy2.js?v=1752142539265","./php-legacy.js?v=1752142539265","./useOperate-legacy.js?v=1752142539265","./common-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy15.js?v=1752142539265","./index-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1752142539265","./__commonjsHelpers__-legacy.js?v=1752142539265","./soft-legacy.js?v=1752142539265","./useModal-legacy2.js?v=1752142539265"],(function(e,t){"use strict";var a,l,n,i,s,o,u,r,d,c,p,m,y,f,v,_,g,h,x,w,k,b,S,P,C,H,j,B,U,$,T,W,V,N,D,M,L,R,A,O,K,F,q,I,E,z,Q,X,Y,G,J,Z,ee,te,ae,le,ne,ie,se,oe,ue,re,de,ce,pe,me,ye,fe,ve,_e,ge,he,xe,we,ke,be,Se,Pe,Ce,He,je,Be,Ue,$e,Te,We,Ve,Ne,De,Me,Le,Re,Ae,Oe,Ke,Fe,qe,Ie,Ee,ze,Qe,Xe,Ye,Ge,Je,Ze,et;return{setters:[e=>{a=e.h,l=e.s,n=e.aY,i=e.e,s=e.p,o=e.q,u=e.T,r=e.u,d=e.d,c=e.w,p=e.X,m=e.m,y=e.a,f=e.o},e=>{v=e._},e=>{_=e._},e=>{g=e._},e=>{h=e._},e=>{x=e.bS,w=e.c0,k=e.ay,b=e._,S=e.c2,P=e.cH,C=e.bV,H=e.b$,j=e.aT,B=e.c1,U=e.c5,$=e.bX,T=e.aq,W=e.b_,V=e.cz,N=e.cD,D=e.cA},e=>{M=e.k,L=e.i,R=e.r,A=e.o,O=e.w,K=e.a1,F=e.X,q=e.W,I=e.a2,E=e.Q,z=e.V,Q=e.F,X=e.U,Y=e.a3,G=e.l,J=e.v,Z=e.H,ee=e.c,te=e.j,ae=e.aj,le=e.P,ne=e.av,ie=e.ah,se=e.$,oe=e.x,ue=e.s,re=e.e,de=e.N,ce=e.af,pe=e._,me=e.an,ye=e.p},e=>{fe=e._},e=>{ve=e._},e=>{_e=e.a9,ge=e.v,he=e.f,xe=e.aa,we=e.E,ke=e.e,be=e.b,Se=e.h,Pe=e.d,Ce=e.c,He=e.ab,je=e.u,Be=e.m},e=>{Ue=e.s,$e=e.c,Te=e.d,We=e.e,Ve=e.f,Ne=e.h,De=e.i,Me=e.j,Le=e.k},e=>{Re=e.u},e=>{Ae=e.u,Oe=e._},e=>{Ke=e.u},e=>{Fe=e.a,qe=e.b,Ie=e.c},e=>{Ee=e.u},e=>{ze=e.a3,Qe=e.a4,Xe=e.a5,Ye=e.m,Ge=e.h},e=>{Je=e._},e=>{Ze=e._},e=>{et=e._},null,null,null,null],execute:function(){var tt=document.createElement("style");tt.textContent=".website-name[data-v-014727a8]{display:flex;align-items:center;gap:8px;width:100%}.website-icon[data-v-014727a8]{width:24px;flex-shrink:0;cursor:pointer}.website-info[data-v-014727a8]{flex:1;min-width:0;overflow:hidden}.website-description[data-v-014727a8]{margin-top:2px}.website-status[data-v-d9a6201b]{display:inline-flex;font-size:20px;cursor:pointer}.n-date-panel[data-v-4583ec55]{margin:0}.n-date-panel[data-v-4583ec55] .n-date-panel-calendar{padding:6px 0 12px}.n-date-panel[data-v-4583ec55] .n-date-panel--month .n-date-panel-footer{display:none}.n-date-panel[data-v-4583ec55] .n-date-panel-footer{padding:12px 0 6px}\n/*$vite$:1*/",document.head.appendChild(tt);const at=M({__name:"index",props:{disabledKeys:{type:Array,default:()=>[]},hideKeys:{type:Array,default:()=>[]},storeKey:{type:String,default:""},loading:{type:Boolean,default:!1}},setup(e){const t=L("tableRef"),i=R(!1),s=R([]),o=R([]),u=R([]),r=()=>{i.value=!0},d=()=>{i.value=!1},c=()=>{if(!t)return;const e=x(o.value.filter((e=>s.value.includes(String(e.key))))),a=e.length;if(a>0){const t=Math.floor(100/a),l=100-t*a;e.forEach(((e,a)=>{if(n(e.width)||!e.width)return;let i=t;a<l&&(i+=1),e.width=`${i}%`}))}"selection"===o.value[0].type&&e.unshift(o.value[0]),t.value.setColumns(e)},p=t=>{if(s.value.includes(t)?s.value=s.value.filter((e=>e!==t)):s.value.push(t),e.storeKey&&l(e.storeKey,s.value.join(",")),e.loading){const t=O((()=>e.loading),(e=>{e||c(),t()}))}else c()};return A((()=>{if(t){const l=t.value.getColumns();0===o.value.length&&(o.value=x(l)),(()=>{if(e.storeKey){const t=a(e.storeKey);t&&(s.value=t.split(","))}})(),(()=>{const t=o.value.filter((e=>"selection"!==e.type));0===s.value.length&&(s.value=t.filter((t=>!e.hideKeys.includes(String(t.key)))).map((e=>String(e.key)))),u.value=t.map((t=>({key:String(t.key),disabled:"operate"===t.key||e.disabledKeys.includes(String(t.key)),label:()=>E(Q,null,[E(b,{checked:s.value.includes(String(t.key))},null),E("span",{class:"ml-8px"},[String(t.title)])])})))})();const n=O((()=>e.loading),(e=>{e||c(),n()}))}})),(e,t)=>{const a=k,l=w;return F(),K(l,{placement:"bottom-end",show:q(i),"show-arrow":!0,"arrow-point-to-center":!0,options:q(u),onSelect:p,onClickoutside:d},{default:I((()=>[E(a,{onClick:r},{default:I((()=>t[0]||(t[0]=[z("i",{class:"i-famicons:settings-outline text-16px"},null,-1)]))),_:1,__:[0]})])),_:1},8,["show","options"])}}}),lt={class:"website-name"},nt={key:0,class:"flex-center w-24px h-24px bg-#F1F9F3 rounded-50%"},it={key:1,class:"flex-center w-24px h-24px rounded-50%"},st=["src"],ot={class:"flex flex-col flex-1 w-0 overflow-hidden"},ut={class:"flex items-center gap-8px"},rt={class:"min-w-0"},dt={class:"website-description"},ct=i(M({__name:"Name",props:{ico:{type:String,default:""},name:{type:String,default:"--"},description:{type:String,default:"--"}},emits:["clickName","blur"],setup(e,{emit:t}){const a=t,l=()=>{a("clickName")},n=()=>{window.open(`http://${e.name}`)},i=e=>{a("blur",e)};return(t,a)=>{const s=S,o=k,u=_e;return F(),X("div",lt,[z("div",{class:"website-icon",onClick:l},[e.ico?(F(),X("div",it,[z("img",{src:e.ico,class:"w-full h-full"},null,8,st)])):(F(),X("div",nt,a[0]||(a[0]=[z("i",{class:"i-mdi:earth text-primary text-18px"},null,-1)])))]),z("div",ot,[z("div",ut,[z("div",rt,[E(s,{class:"max-w-full",tooltip:{contentStyle:{maxWidth:"200px"}}},{default:I((()=>[z("span",{class:"text-primary cursor-pointer",onClick:l},Y(e.name),1)])),_:1})]),E(o,{type:"primary",text:"",onClick:n},{default:I((()=>a[1]||(a[1]=[z("i",{class:"i-fa-solid:external-link-alt"},null,-1)]))),_:1,__:[1]})]),z("div",dt,[E(u,{value:e.description,onBlur:i},null,8,["value"])])])])}}}),[["__scopeId","data-v-014727a8"]]),pt={class:"i-famicons:play-circle-outline"},mt={class:"i-famicons:pause-circle-outline"},yt=i(M({__name:"Status",props:{status:{type:String,default:"0"},checkedValue:{type:String,default:"1"},unCheckedValue:{type:String,default:"0"},onUpdateValue:{type:Function}},setup(e){const t=()=>{e.onUpdateValue?.(e.status===e.checkedValue?e.unCheckedValue:e.checkedValue)};return(a,l)=>(F(),X("div",{class:Z(["website-status",e.status===e.checkedValue?"text-primary":"text-warning"]),onClick:t},[G(z("i",pt,null,512),[[J,e.status===e.checkedValue]]),G(z("i",mt,null,512),[[J,e.status===e.unCheckedValue]])],2))}}),[["__scopeId","data-v-d9a6201b"]]),ft=M({__name:"Backup",props:{count:{type:Number,default:0},lastTime:{type:String,default:""}},emits:["showBackup"],setup(e,{emit:t}){const a=t,l=()=>{a("showBackup")},n=t=>ze(new Date,e.lastTime||new Date)>=t,i=ee((()=>{if(0===e.count)return"Backup now";const t=ze(new Date,e.lastTime||new Date);return 0===t?"Today":1===t?"Yesterday":`${t} days ago`})),s=ee((()=>n(30)||e.count<=0?"error":n(7)?"warning":"primary"));return(t,a)=>{const n=P,o=C;return F(),X("div",{class:"flex items-center gap-8px cursor-pointer",onClick:l},[E(n,{type:q(s),size:"small",bordered:!1},{default:I((()=>[te(Y(e.count),1)])),_:1},8,["type"]),E(o,{disabled:0===e.count},{trigger:I((()=>[z("div",{class:Z({"text-error":"error"===q(s),"text-warning":"warning"===q(s)})},Y(q(i)),3)])),default:I((()=>[te(" "+Y(e.lastTime),1)])),_:1},8,["disabled"])])}}}),vt={class:"inline-flex items-center w-full"},_t={class:"flex-1 text-right"},gt={class:"flex-1 text-left"},ht=M({__name:"Quick",props:{path:{type:String,default:""},phpVersion:{type:String,default:""}},emits:["showPhp"],setup(e,{emit:t}){const a=t,l=ae(),n=()=>{o("Path",e.path),l.push("/files")},i=()=>{a("showPhp")};return(t,a)=>{const l=k,o=C,u=s;return F(),X("div",vt,[z("div",_t,[E(o,{trigger:"hover"},{trigger:I((()=>[E(l,{text:"",onClick:n},{default:I((()=>a[0]||(a[0]=[z("i",{class:"i-fa:folder-open-o text-13px"},null,-1)]))),_:1,__:[0]})])),default:I((()=>[te(" "+Y(e.path),1)])),_:1})]),E(u,{vertical:""}),z("div",gt,[E(l,{text:"",onClick:i},{default:I((()=>[te(Y(e.phpVersion),1)])),_:1})])])}}}),xt={class:"flex justify-end"},wt=i(M({__name:"ExpiredDate",props:{value:{type:String,default:"0000-00-00"},onUpdateValue:{type:Function}},setup(e){const{t:t}=le(),a=ne("popoverRef"),l=R(null),n=ee((()=>{const t=new Date(e.value);return"0000-00-00"!==e.value&&Qe(t,Xe())})),i=ee((()=>"0000-00-00"===e.value?t("Site.PHP.index_34"):n.value?t("Site.PHP.index_28"):e.value)),s=e=>Qe(e,Ye(Xe(),1)),o=ee((()=>{const t=new Date(e.value);return"0000-00-00"!==e.value&&Qe(t,Ye(Xe(),7))})),r=async()=>{await(e.onUpdateValue?.("0000-00-00")),a.value?.setShow(!1)},d=async()=>{if(null===l.value)return;const t=Ge(l.value,"yyyy-MM-dd");await(e.onUpdateValue?.(t)),a.value?.setShow(!1)},c=()=>{l.value="0000-00-00"===e.value?null:new Date(e.value).getTime()};return(e,t)=>{const p=k,m=j,y=u,f=H;return F(),K(f,{ref_key:"popoverRef",ref:a,placement:"bottom",trigger:"click"},{trigger:I((()=>[E(p,{type:q(n)?"error":q(o)?"warning":"default",text:!0,onClick:c},{default:I((()=>[te(Y(q(i)),1)])),_:1},8,["type"])])),default:I((()=>[E(y,{value:q(l),"onUpdate:value":t[0]||(t[0]=e=>ie(l)?l.value=e:null),type:"date",panel:!0,actions:null,"is-date-disabled":s},{footer:I((()=>[z("div",xt,[E(m,{size:"small"},{default:I((()=>[E(p,{onClick:r},{default:I((()=>[te(Y(e.$t("Site.PHP.index_34")),1)])),_:1}),E(p,{disabled:null===q(l),onClick:d},{default:I((()=>[te(Y(e.$t("Public.Btn.Confirm")),1)])),_:1},8,["disabled"])])),_:1})])])),_:1},8,["value"])])),_:1},512)}}}),[["__scopeId","data-v-4583ec55"]]),kt={class:"text-left"},bt={class:"cursor-pointer"},St=M({__name:"Requests",props:{name:{type:String,default:""},total:{type:[Number,String],default:0},value:{type:Array,default:()=>[]}},setup(e){const{openMonitor:t}=Ee(),a=ee((()=>e.total.toLocaleString("en-US"))),l=ee((()=>({xAxis:{type:"category",data:e.value.map((e=>e.date))},yAxis:{type:"value",show:!1},series:[{name:"页面浏览量",data:e.value.map((e=>e.value)),type:"line",lineStyle:{color:"#20a53a",width:2},areaStyle:{color:"rgba(32, 165, 58, 0.1)"},symbol:"none"}],grid:{left:0,right:0,top:0,bottom:0}})));return(n,i)=>(F(),X("div",{class:"flex flex-col gap-3px cursor-pointer",onClick:i[0]||(i[0]=a=>q(t)(e.name))},[z("div",kt,Y(q(a)),1),z("div",bt,[E(Je,{type:"line",option:q(l),height:"15px"},null,8,["option"])])]))}}),Pt={class:"flex w-full items-center"},Ct={class:"flex-1 flex items-center justify-end"},Ht={class:"flex-1 flex justify-start"},jt=M({__name:"Waf",props:{siteName:{type:String,default:""},total:{type:Number,default:0},status:{type:Boolean,default:!1},onUpdateStatus:{type:Function}},setup(e){const{openSiteWaf:t}=Ee();return(a,l)=>{const n=k,i=s,o=B;return F(),X("div",Pt,[z("div",Ct,[E(n,{text:"",onClick:l[0]||(l[0]=a=>q(t)(e.siteName))},{default:I((()=>[te(Y(e.total),1)])),_:1})]),E(i,{vertical:""}),z("div",Ht,[E(o,{value:e.status,size:"small","onUpdate:value":e.onUpdateStatus},null,8,["value","onUpdate:value"])])])}}}),Bt={class:"inline-flex items-center"},Ut=M({__name:"OperateMenu",emits:["clickConfig","clickLog","clickOperate"],setup(e,{emit:t}){const a=t,l=[{key:"scan",label:"Security Scan",icon:()=>E("i",{class:"i-ant-design:security-scan-outlined text-18px"},null)},{key:"delete",label:"Delete WebSite",icon:()=>E("i",{class:"i-weui:delete-outlined text-18px"},null)}],n=e=>{a("clickOperate",e)};return(e,t)=>{const i=k,o=s,u=w;return F(),X("div",Bt,[E(i,{type:"primary",text:"",onClick:t[0]||(t[0]=e=>a("clickConfig"))},{default:I((()=>t[2]||(t[2]=[te("Conf")]))),_:1,__:[2]}),t[5]||(t[5]=z("i",{class:"i-mi:delete"},null,-1)),E(o,{vertical:""}),E(i,{class:"mr-8px",type:"primary",text:"",onClick:t[1]||(t[1]=e=>a("clickLog"))},{default:I((()=>t[3]||(t[3]=[te("Log")]))),_:1,__:[3]}),E(u,{trigger:"click",options:l,onSelect:n},{default:I((()=>t[4]||(t[4]=[z("i",{class:"i-famicons:ellipsis-vertical text-18px cursor-pointer"},null,-1)]))),_:1,__:[4]})])}}}),$t=M({__name:"index",emits:["fetchTable","update:sorter"],setup(e,{expose:t,emit:l}){const n=l,i=Re(),s=r(),{isFree:o}=se(s),{webserver:u,monitor:m,waf:y,isMonitorInstall:f,isWafInstall:v}=se(i),{t:_}=le(),{openBackupModal:g,openSiteConfig:h,openDeleteSiteConfig:x}=Ae(),{setSiteStatus:w}=Ee(),b=R([{type:"selection",width:40,minWidth:40,maxWidth:40},{key:"name",title:_("Site.PHP.index_17"),minWidth:160,sorter:!0,sortOrder:!1,render:e=>E(ct,{ico:e.ico,name:e.name,description:e.ps,onClickName:()=>{h(e)},onBlur:async t=>{await Ue({id:e.id,ps:t}),e.ps=t}},null)},{key:"status",title:_("Public.Table.Status"),align:"center",className:"sort-center",width:90,minWidth:90,maxWidth:90,sorter:!0,sortOrder:!1,render:e=>E(yt,{status:e.status,onUpdateValue:t=>{w(t,e)}},null)},{key:"backup_count",title:_("Site.PHP.index_19"),width:"10%",minWidth:110,render:e=>E(ft,{count:e.backup_count,lastTime:e.last_backup_time,onShowBackup:()=>{g(e)}},null)},{key:"path",title:"Quick action",align:"center",width:"8%",minWidth:100,render:e=>E(ht,{path:e.path,phpVersion:e.php_version,onShowPhp:()=>{h(e,{menu:"php"})}},null)},ge({type:"site",minWidth:70,callback:()=>{n("fetchTable")}}),{key:"edate",title:"Expiration",align:"center",width:"8%",minWidth:80,render:e=>E(wt,{value:e.edate,onUpdateValue:async t=>{await $e({id:e.id,edate:t}),e.edate=t}},null)},{key:"site_ssl",title:_("Site.PHP.index_27"),align:"center",width:100,minWidth:100,maxWidth:100,sorter:!0,sortOrder:!1,className:"sort-center",render:e=>{const t=N.value.filter((t=>t.target_id===e.id));return E(Oe,{config:e.ssl,sslApplyList:t,onClick:()=>{h(e,{menu:"ssl"})}},null)}},{key:"requests",title:"Requests",align:"center",width:"12%",minWidth:120,render:e=>{if("nginx"!==u.value&&"apache"!==u.value)return"--";if(o.value)return E(k,{type:"primary",text:!0,onClick:()=>{we({source:142})}},{default:()=>[te("Active")]});if(!f.value)return E(k,{type:"primary",text:!0,onClick:()=>{Ke("monitor",(async()=>{await i.getConfig(),n("fetchTable"),j()}))}},{default:()=>[1===m.value.is_install?_("Public.Btn.Update"):_("Public.Btn.Install")]});const t=P.value[e.name];if(!U(t)){const a=C(t),l=H(t);return E(St,{name:e.name,total:a,value:l},null)}return"--"}},{key:"waf",title:"WAF",align:"center",width:"10%",minWidth:100,render:e=>{if("nginx"!==u.value)return"--";if(o.value)return E(k,{type:"primary",text:!0,onClick:()=>{we({source:216})}},{default:()=>[te("Active")]});if(!v.value)return E(k,{type:"primary",text:!0,onClick:()=>{Ke("btwaf",(async()=>{await i.getConfig(),n("fetchTable"),T()}))}},{default:()=>[1===y.value.is_install?_("Public.Btn.Update"):_("Public.Btn.Install")]});const t=B.value.find((t=>t.siteName===e.name));if(d(t)){const a=$(t);return E(jt,{siteName:e.name,total:a,status:t.open,onUpdateStatus:async a=>{await Ie({siteName:e.name,obj:"open"}),t.open=a}},null)}return"--"}},{key:"operate",title:_("Public.Table.Operation"),align:"right",width:110,minWidth:110,maxWidth:110,render:e=>E(Ut,{onClickConfig:()=>{h(e)},onClickLog:()=>{h(e,{menu:"logs"})},onClickOperate:t=>{switch(t){case"scan":h(e,{menu:"logs",subMenu:"security"});break;case"delete":x([e])}}},null)}]),S=e=>{b.value.forEach((t=>{const a=t;a.key===e.columnKey?a.sortOrder=e.order:a.sortOrder=!1}));const t=e.order?`${e.columnKey} ${"descend"===e.order?"desc":"asc"}`:"";n("update:sorter",t)},P=oe({}),C=e=>e.total?e.total.request:0,H=e=>e.list.map((e=>({date:e.date,value:e.request}))),j=async()=>{if(o.value)return;if(!f.value)return;const{message:e}=await Fe((()=>{const e=new Date,t=Ye(e,-30);return{start_date:p(t,"yyyy-MM-dd"),end_date:p(e,"yyyy-MM-dd")}})());d(e)&&(P.value=e)},B=R([]),$=e=>e.total.reduce(((e,t)=>e+t.value),0),T=async()=>{if(o.value)return;if(!v.value)return;const{message:e}=await qe({p:1,limit:1e3,search:""});d(e)&&(B.value=c(e.data)?e.data.map((e=>({open:e.open,total:e.total,siteName:e.siteName}))):[])};let W=null;const V=R(!1),N=R([]),D=async()=>{W&&clearTimeout(W);const{message:e}=await xe();c(e)&&(N.value=e,e.length>0?(V.value=!0,W=window.setTimeout((()=>{D()}),3e3)):(V.value&&n("fetchTable"),W&&clearTimeout(W)))};return(()=>{const e=a("site-php-order","");if(e){const[t,a]=e.split(" "),l=b.value.find((e=>e.key===t));l&&(l.sortOrder="asc"===a?"ascend":"descend")}})(),t({getMonitorData:j,getNginxWafConfig:T,getSSLApplyList:D,getColumns:()=>b.value,setColumns:e=>{b.value=e}}),(e,t)=>{const a=he;return F(),K(a,ue(e.$attrs,{columns:q(b),"onUpdate:sorter":S}),null,16,["columns"])}}}),Tt={class:"p-20px"},Wt={class:"flex-1"},Vt={class:"mt-12px"},Nt={class:"px-20px pt-24px pb-8px"},Dt={class:"w-150px"},Mt=M({__name:"set",props:{data:{}},setup(e){const{t:t}=le(),a=e,{setOptions:l}=a.data,n=R(""),i=async()=>{const e=n.value.trim();""!==e?(await Ve({name:e}),n.value="",await f(),l?.(p.data)):m.error(t("Site.PHP.index_46"))},s=ke(),o=R(null),u=re({id:-1,name:""}),r={name:{required:!0,message:t("Site.PHP.index_46"),trigger:["blur","change"]}},d=async({hide:e})=>{await(o.value?.validate()),await Ne(de(u)),await f(),l?.(p.data),e()},{table:p,columns:y}=be([{key:"name",title:"Name"},Se({width:120,options:e=>[{label:t("Public.Btn.Edit"),disabled:0===e.id,onClick:()=>{(e=>{u.id=e.id,u.name=e.name,s.title=`${t("Site.PHP.index_48")} [${e.name}]`,s.show=!0})(e)}},{label:t("Public.Btn.Delete"),disabled:0===e.id,onClick:()=>{Pe({title:`${t("Site.PHP.index_49")} [${e.name}]`,content:t("Site.PHP.index_50"),onConfirm:async({hide:t})=>{await Te({id:e.id}),await f(),l?.(p.data,e.id),t()}})}}]})]),f=async()=>{const{message:e}=await We();p.data=c(e)?e:[]};return f(),(e,t)=>{const a=T,l=k,c=$,m=W,f=V,v=et,_=Ze;return F(),X("div",Tt,[E(c,null,{default:I((()=>[z("div",Wt,[E(a,{value:q(n),"onUpdate:value":t[0]||(t[0]=e=>ie(n)?n.value=e:null),placeholder:e.$t("Site.PHP.index_46")},null,8,["value","placeholder"])]),z("div",null,[E(l,{type:"primary",onClick:i},{default:I((()=>[te(Y(e.$t("Site.Cert.index_62")),1)])),_:1})])])),_:1}),z("div",Vt,[E(m,{"max-height":300,data:q(p).data,columns:q(y)},null,8,["data","columns"])]),E(_,{show:q(s).show,"onUpdate:show":t[2]||(t[2]=e=>q(s).show=e),title:q(s).title,width:350,footer:!0,onConfirm:d},{default:I((()=>[z("div",Nt,[E(v,{ref_key:"formRef",ref:o,model:q(u),rules:r},{default:I((()=>[E(f,{label:e.$t("Site.PHP.index_47"),path:"name"},{default:I((()=>[z("div",Dt,[E(a,{value:q(u).name,"onUpdate:value":t[1]||(t[1]=e=>q(u).name=e),placeholder:""},null,8,["value"])])])),_:1},8,["label"])])),_:1},8,["model"])])])),_:1},8,["show","title"])])}}}),Lt={class:"w-160px"},Rt=M({__name:"index",props:{value:{default:null}},emits:["change","update:value"],setup(e,{emit:t}){const a=t,l=ce(e,"value"),{t:n}=le(),{loading:i,setLoading:s}=Ce(),o=R([]),u=async e=>{a("change"),a("update:value",e),sessionStorage.setItem("typeValue",e)},r=ke(n("Site.PHP.index_44"),{setOptions:(e,t)=>{t===l.value&&(l.value=-1),o.value=e.map((e=>({label:e.name,value:e.id}))),p()}}),d=()=>{r.show=!0},p=()=>{o.value.unshift({label:n("Site.PHP.index_45"),value:-1})};return p(),A((()=>{(async()=>{try{s(!0);const{message:e}=await We();c(e)?o.value=e.map((e=>({label:e.name,value:e.id}))):o.value=[],p()}finally{s(!1);const e=sessionStorage.getItem("typeValue");l.value=e?Number(e):-1}})()})),(e,t)=>{const a=k,n=N,s=Ze;return F(),X("div",Lt,[E(n,{value:q(l),"onUpdate:value":t[0]||(t[0]=e=>ie(l)?l.value=e:null),loading:q(i),options:q(o),onUpdateValue:u},{action:I((()=>[E(a,{block:"",onClick:d},{default:I((()=>[te(Y(e.$t("Site.PHP.index_43")),1)])),_:1})])),_:1},8,["value","loading","options"]),E(s,{show:q(r).show,"onUpdate:show":t[1]||(t[1]=e=>q(r).show=e),width:350,title:q(r).title,data:q(r).data,component:Mt},null,8,["show","title","data"])])}}});e("default",M({__name:"index",setup(e){const n=Re(),i=r(),{web:s,webserver:o}=se(n),{t:u}=le(),{openAddSiteModal:d,openSiteAdvancedModal:c,openDeleteSiteConfig:p}=Ae(),{tableConfig:m,tableData:x,pageConfig:b,tableParams:S,fetchTable:P,resetTable:C,setLoading:H}=He({params:{p:1,limit:10,table:"sites",search:"",order:a("site-php-order",""),type:-1},immediate:!1,fetchFn:Le}),B=ne("siteTableRef");ye("tableRef",B);const U=R(!1),$=R([]),T=[{label:u("Site.PHP.index_5"),key:"default-page"},{label:u("Site.PHP.index_6"),key:"default-site"},{label:u("Site.PHP.index_7"),key:"php-version"},{label:u("Site.PHP.index_86"),key:"https"}],W=[{key:"enable",type:"confirm",label:u("Site.Batch.index_1"),confirm:{title:u("Site.Batch.index_2"),desc:u("Site.Batch.index_3"),columns:[{key:"name",title:u("Site.PHP.index_17")}],api:e=>De(!0,{id:e.id,name:e.name},!1),done:()=>{P(!1)}}},{key:"disable",type:"confirm",label:u("Site.Batch.index_4"),confirm:{title:u("Site.Batch.index_5"),desc:u("Site.Batch.index_6"),columns:[{key:"name",title:u("Site.PHP.index_17")}],api:e=>De(!1,{id:e.id,name:e.name},!1),done:()=>{P(!1)}}},{key:"backup",type:"confirm",label:u("Site.Batch.index_7"),confirm:{title:u("Site.Batch.index_8"),desc:u("Site.Batch.index_9"),columns:[{key:"name",title:u("Site.PHP.index_17")}],api:e=>Me({id:e.id},!1),done:()=>{P(!1)}}},{key:"expired",label:u("Site.PHP.index_70"),onBatch:e=>{je({title:u("Site.PHP.index_71"),width:380,minHeight:72,footer:!0,data:{rows:e},component:pe((()=>y((()=>t.import("./expired-legacy.js?v=1752142539265")),void 0)))})}},{key:"php",label:u("Site.PHP.index_66"),onBatch:e=>{je({title:u("Site.PHP.index_65"),width:500,minHeight:198,footer:!0,data:{rows:e},component:pe((()=>y((()=>t.import("./php-legacy2.js?v=1752142539265")),void 0)))})}},{key:"category",label:u("Crontab.Planned.index_19"),onBatch:e=>{je({title:u("Site.Batch.index_22"),width:350,minHeight:72,footer:!0,data:{rows:e},component:pe((()=>y((()=>t.import("./category-legacy.js?v=1752142539265")),void 0)))})}},{key:"delete",label:u("Site.Batch.index_10"),onBatch:e=>{p(e)}}],V=()=>{d()},N=e=>{S.value.order=e,l("site-php-order",e),P()},M=e=>{c(e)},L=async()=>{await C(),B.value?.getNginxWafConfig(),B.value?.getMonitorData(),B.value?.getSSLApplyList(),$.value=[]},Q=async(e=!1)=>{await P(e,!0),B.value?.getSSLApplyList(),B.value?.getNginxWafConfig(),B.value?.getMonitorData(),$.value=[]},X=async()=>{try{H(!0),await n.getConfig(),U.value=s.value.setup,s.value.setup&&await Q()}finally{H(!1)}};return O((()=>n.isRefresh),(e=>{e&&(n.setRefresh(!1),Q())})),O((()=>i.taskCount),(()=>{X()})),H(!0),A((async()=>{X()})),(e,t)=>{const a=f,l=k,n=w,i=j,u=ve,r=fe,d=at,p=h,y=g,C=_,H=v,R=D;return F(),K(R,null,{default:I((()=>[E(H,{install:q(s).setup},{desc:I((()=>[z("span",null,Y(e.$t("Site.PHP.index_1")),1),E(a,{class:"ml-4px",onClick:t[0]||(t[0]=e=>q(Be)("nginx"))},{default:I((()=>[te(Y(e.$t("Site.PHP.index_2")),1)])),_:1}),t[7]||(t[7]=z("span",{class:"mx-4px"},"|",-1)),E(a,{onClick:t[1]||(t[1]=e=>q(Be)("apache"))},{default:I((()=>[te(Y(e.$t("Site.PHP.index_3")),1)])),_:1})])),default:I((()=>[E(C,{class:"p-16px",feedback:!0},{toolsLeft:I((()=>[E(l,{type:"primary",class:"add-site-btn",onClick:V},{default:I((()=>[te(Y(e.$t("Site.PHP.index_4")),1)])),_:1}),E(i,null,{default:I((()=>[E(l,{onClick:t[2]||(t[2]=e=>q(c)())},{default:I((()=>[te(Y(e.$t("Database.Mysql.index_3")),1)])),_:1}),E(n,{trigger:"hover",options:T,onSelect:M},{default:I((()=>[E(l,null,{default:I((()=>t[8]||(t[8]=[z("i",{class:"i-fa:angle-down"},null,-1)]))),_:1,__:[8]})])),_:1})])),_:1}),q(U)?(F(),K(u,{key:0,"soft-name":q(o)},null,8,["soft-name"])):me("",!0)])),toolsRight:I((()=>[E(Rt,{value:q(S).type,"onUpdate:value":t[3]||(t[3]=e=>q(S).type=e),onChange:L},null,8,["value"]),E(r,{value:q(S).search,"onUpdate:value":t[4]||(t[4]=e=>q(S).search=e),placeholder:e.$t("Site.PHP.index_8"),onSearch:L},null,8,["value","placeholder"]),E(d,{"store-key":"site-php-columns",loading:q(m).loading,"hide-keys":["quota"],"disabled-keys":["name"]},null,8,["loading"])])),table:I((()=>[E($t,ue({ref_key:"siteTableRef",ref:B,"checked-row-keys":q($),"onUpdate:checkedRowKeys":t[5]||(t[5]=e=>ie($)?$.value=e:null)},q(m),{onFetchTable:q(P),"onUpdate:sorter":N}),null,16,["checked-row-keys","onFetchTable"])])),pageLeft:I((()=>[E(p,{"checked-row-keys":q($),"onUpdate:checkedRowKeys":t[6]||(t[6]=e=>ie($)?$.value=e:null),data:q(x),options:W},null,8,["checked-row-keys","data"])])),pageRight:I((()=>[E(y,ue(q(b),{"store-key":"site-php-page",onRefresh:Q}),null,16)])),_:1})])),_:1},8,["install"])])),_:1})}}}))}}}));
