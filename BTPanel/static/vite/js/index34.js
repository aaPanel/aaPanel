const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index175.js?v=1756367574781","js/index108.js?v=1756367574781","js/vue.js?v=1756367574781","js/__commonjsHelpers__.js?v=1756367574781","js/naive.js?v=1756367574781","js/common.js?v=1756367574781","js/page_layout.js?v=1756367574781","js/public.js?v=1756367574781","css/public.css?v=1756367574781","css/page_layout.css?v=1756367574781","css/index21.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang.js?v=1756367574781","js/index100.js?v=1756367574781","js/index101.js?v=1756367574781","js/file.js?v=1756367574781","js/theme-monokai.js?v=1756367574781","css/index16.css?v=1756367574781","js/index178.js?v=1756367574781","css/index27.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang22.js?v=1756367574781","js/index99.js?v=1756367574781","css/index14.css?v=1756367574781","js/index176.js?v=1756367574781","js/xterm-addon-canvas.js?v=1756367574781","css/xterm-addon-canvas.css?v=1756367574781","js/xterm.js?v=1756367574781","css/index78.css?v=1756367574781","js/index177.js?v=1756367574781","js/index.js?v=1756367574781","css/index107.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang5.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang6.js?v=1756367574781","css/index15.css?v=1756367574781"])))=>i.map(i=>d[i]);
import{i as e,a as t,t as a,p as s,m as l,d as o,R as n,_ as c,a7 as r,bY as i,w as u,r as d,o as p}from"./page_layout.js?v=1756367574781";import{u as m,a as _,d as v,E as k,D as f}from"./public.js?v=1756367574781";import{i as x,p as h,_ as g,k as w,r as C,aB as b,R as j,V as y,l as D,v as S,U as N,S as P,av as $,H as I,a4 as O,ai as R,ak as L,n as A,t as z,P as E,c as U,W as J,a3 as B,j as V,a2 as H,an as M,ae as T,w as q,F as K,O as F,am as G,I as W}from"./vue.js?v=1756367574781";import{_ as X,dd as Y,aC as Q,G as Z,au as ee,dS as te,aX as ae,di as se}from"./naive.js?v=1756367574781";import{_ as le}from"./index.vue_vue_type_script_setup_true_lang14.js?v=1756367574781";import{a as oe}from"./useModal.js?v=1756367574781";import{_ as ne}from"./index178.js?v=1756367574781";import ce from"./index100.js?v=1756367574781";import"./common.js?v=1756367574781";import"./__commonjsHelpers__.js?v=1756367574781";import"./index101.js?v=1756367574781";import"./file.js?v=1756367574781";import"./theme-monokai.js?v=1756367574781";const re=Symbol("docker-compose");function ie(){return x(re)}const ue=a=>{m({title:e.global.t("Docker.ComposeNew.index_38"),width:640,minHeight:300,footer:!0,data:a,component:g(()=>t(()=>import("./index175.js?v=1756367574781"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])))})},de=(a,s)=>{m({title:e.global.t("Docker.ComposeNew.index_39",[a]),width:640,height:440,data:s,component:g(()=>t(()=>import("./index176.js?v=1756367574781"),__vite__mapDeps([22,23,24,25,6,2,3,4,5,7,8,9,26])))})},pe=s(w({__name:"menu-item-remark",props:{value:{default:""},blur:{}},setup(e){const t=e,a=C(t.value),s=C(!1),l=C(null),o=C(null),{isOutside:n}=b(l),c=()=>{a.value=t.value,s.value=!0,A(()=>{var e;null==(e=o.value)||e.focus()})},r=async()=>{var e;try{await(null==(e=t.blur)?void 0:e.call(t,a.value))}finally{s.value=!1}};return(e,t)=>(y(),j("div",{ref_key:"remarkRef",ref:l,class:"text-desc"},[D(P("div",{class:I(["project-remark",{active:N(n)}]),onClick:$(c,["stop"])},O(e.value||e.$t("Docker.ComposeNew.index_12")),3),[[S,!N(s)]]),D(P("input",{ref_key:"inputRef",ref:o,"onUpdate:modelValue":t[0]||(t[0]=e=>L(a)?a.value=e:null),class:"project-input",onBlur:r},null,544),[[S,N(s)],[R,N(a)]])],512))}}),[["__scopeId","data-v-2d5d24e1"]]),me={class:"flex-1 pr-16px overflow-hidden"},_e={class:"menu-name"},ve=s(w({__name:"menu-item",props:{checked:{type:Boolean},active:{type:Boolean,default:!1},project:{}},emits:["changeChecked"],setup(t,{emit:s}){const l=s,o=z(t,"project"),{t:n}=E(),c=U(()=>{const e={text:n("Public.Status.Abnormal"),type:"warning"};switch(o.value.run_status){case"running":e.text=n("Public.Status.Running"),e.type="success";break;case"exited":e.text=n("Public.Status.Stopped"),e.type="error"}return e}),r=e=>{l("changeChecked",e,o.value.name)},i=async t=>{var s;t!==o.value.remark&&(await(s={name:o.value.name,remark:t,path:o.value.path},a.post("/mod/docker/com/edit_remark",s,{requestOptions:{loading:e.global.t("Docker.api.index_54"),successMessage:!0}})),o.value.remark=t)};return(e,t)=>{const a=X,s=Y;return y(),j("div",{class:I(["menu-item",{active:e.active}])},[J(a,{checked:e.checked,onClick:$(()=>!1,["stop"]),"onUpdate:checked":r},null,8,["checked"]),J(s,{class:"ml-16px mr-10px",size:"small",type:N(c).type},{default:B(()=>[V(O(N(c).text),1)]),_:1},8,["type"]),P("div",me,[P("div",_e,O(N(o).name),1),e.active||N(o).remark?(y(),H(pe,{key:0,value:N(o).remark,class:"mt-2px",blur:i},null,8,["value"])):M("",!0)])],2)}}}),[["__scopeId","data-v-c52e1bf4"]]),ke={class:"flex items-center p-16px"},fe=w({__name:"menu-list-batch",props:{value:{default:()=>[]},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=E(),{projectList:a,sendSocket:s}=ie(),n=T(e,"value"),c=U({get:()=>n.value.length>0&&n.value.length===a.value.length,set(e){n.value=e?a.value.map(e=>e.name):[]}}),r=U(()=>0===a.value.length),i=U(()=>n.value.length>0&&n.value.length<a.value.length),u=U(()=>0===n.value.length),d=()=>{_({title:t("Docker.ComposeNew.index_5"),content:t("Docker.ComposeNew.index_6",[n.value.length]),onConfirm:({hide:e})=>(p(e),!1)})},p=e=>{const{close:c}=l.loading(t("Docker.ComposeNew.index_7")),r=[],i=a.value.filter(e=>n.value.includes(e.name)).map(e=>({project_name:e.name,path:e.path}));s({def_name:"batch_delete",mod_name:"docker",project_list:i,sub_mod_name:"com",ws_callback:"batch_delete"},{action:"batch_delete",callback:(a,s)=>{const l=JSON.parse(s.data),{data:n}=l;o(n)&&r.push({project_name:n.project_name,batchStatus:n.status?"success":"error",reqMsg:n.status?t("Docker.ComposeNew.index_11"):t("Docker.ComposeNew.index_8")}),-1===n&&(c(),e(),m({title:t("Docker.ComposeNew.index_9"),width:440,footer:!0,component:le,data:{title:t("Docker.ComposeNew.index_5"),data:r,status:"done",columns:[{key:"project_name",title:t("Docker.ComposeNew.index_10"),ellipsis:{tooltip:{width:"trigger"}}}]}}))}})};return(e,t)=>{const a=X,s=Q;return y(),j("div",ke,[J(a,{checked:N(c),"onUpdate:checked":t[0]||(t[0]=e=>L(c)?c.value=e:null),disabled:N(r),indeterminate:N(i)},null,8,["checked","disabled","indeterminate"]),J(s,{type:"primary",class:"ml-16px",disabled:N(u),onClick:d},{default:B(()=>[V(O(e.$t("Docker.ComposeNew.index_4")),1)]),_:1},8,["disabled"])])}}}),xe={class:"project-list"},he={key:1,class:"flex-center h-280px"},ge=s(w({__name:"menu-list",setup(e){const{timestamp:t,loading:a,projectActive:s,projectList:l,refreshCompose:o}=ie(),c=C([]),r=e=>{for(const t of c.value)if(t===e)return!0;return!1},i=(e,t)=>{e?c.value.push(t):c.value=c.value.filter(e=>e!==t)};return q(()=>t.value,()=>{c.value=[]}),(e,t)=>{const u=Z,d=n;return N(l).length>0?(y(),j(K,{key:0},[P("div",xe,[(y(!0),j(K,null,F(N(l),(e,t)=>(y(),H(ve,{key:e.id,project:e,active:t===N(s),checked:r(e.name),onClick:e=>(e=>{s.value=e,o()})(t),onChangeChecked:i},null,8,["project","active","checked","onClick"]))),128))]),J(fe,{value:N(c),"onUpdate:value":t[0]||(t[0]=e=>L(c)?c.value=e:null)},null,8,["value"])],64)):(y(),j("div",he,[J(d,{show:N(a)},{default:B(()=>[J(u)]),_:1},8,["show"])]))}}}),[["__scopeId","data-v-fb57e04a"]]),we={class:"p-16px"},Ce={class:"mb-12px"},be=w({__name:"menu",setup(e){const{t:a}=E(),{projectList:s,projectListAll:l,sendSocket:o,refreshCompose:n}=ie(),r=C(""),i=()=>{ue({send:o,refresh:n})},u=()=>{m({title:a("Docker.ComposeNew.index_2"),width:1e3,minHeight:200,component:g(()=>t(()=>import("./index177.js?v=1756367574781"),__vite__mapDeps([27,6,2,3,4,5,7,8,9,28,29,30,31,32])))})},d=e=>{s.value=l.value.filter(t=>t.name.includes(e))};return(e,t)=>{const a=Q,s=c,l=ee,o=te;return y(),H(o,{class:"w-260px h-full mr-16px"},{default:B(()=>[P("div",we,[P("div",Ce,[J(a,{type:"primary",onClick:i},{default:B(()=>[V(O(e.$t("Docker.ComposeNew.index_1")),1)]),_:1}),J(a,{class:"ml-12px",onClick:u},{default:B(()=>[V(O(e.$t("Docker.ComposeNew.index_2")),1)]),_:1})]),J(l,{value:N(r),"onUpdate:value":[t[0]||(t[0]=e=>L(r)?r.value=e:null),d],placeholder:e.$t("Docker.ComposeNew.index_3")},{prefix:B(()=>[J(s,{name:"search",size:"16",color:"#999"})]),_:1},8,["value","placeholder"])]),J(ge)]),_:1})}}}),je={class:"flex items-center p-16px"},ye={class:"max-w-500px mr-40px"},De={class:"mb-12px text-18px truncate"},Se={class:"flex gap-10px text-desc"},Ne=s(w({__name:"main-status",setup(e){const{t:t}=E(),{currentProject:a,projectActive:s,setProjectStatus:n,refreshCompose:c}=ie(),i=()=>{_({title:t("Docker.ComposeNew.index_17",[a.value.name]),content:t("Docker.ComposeNew.index_18"),onConfirm:()=>{de(a.value.name,{status:"start",setProjectStatus:n})}})},u=()=>{_({title:t("Docker.ComposeNew.index_19",[a.value.name]),content:t("Docker.ComposeNew.index_20"),onConfirm:()=>{de(a.value.name,{status:"stop",setProjectStatus:n})}})},d=()=>{_({title:t("Docker.ComposeNew.index_21",[a.value.name]),content:t("Docker.ComposeNew.index_22"),onConfirm:()=>{de(a.value.name,{status:"restart",setProjectStatus:n})}})},p=()=>{_({title:t("Docker.ComposeNew.index_23",[a.value.name]),content:t("Docker.ComposeNew.index_24"),onConfirm:()=>{de(a.value.name,{status:"update",setProjectStatus:n})}})},m=()=>{_({title:t("Docker.ComposeNew.index_25",[a.value.name]),content:t("Docker.ComposeNew.index_26",[a.value.name]),onConfirm:({hide:e})=>{const{close:a}=l.loading(t("Docker.ComposeNew.index_27"));return n("delete",t=>{o(t)&&-1===t.data&&(a(),t.status?(e(),s.value=0,c(),l.success(t.msg)):l.error(t.msg))}),!1}})};return(e,t)=>{const s=Q,l=ae,o=te;return y(),H(o,null,{default:B(()=>[P("div",je,[P("div",ye,[P("div",De,O(N(a).name),1),P("div",Se,[P("span",null,O(e.$t("Docker.ComposeNew.index_14",[N(r)(N(a).time)])),1),P("span",null,O(e.$t("Docker.ComposeNew.index_15",[N(a).container_count])),1)])]),J(l,null,{default:B(()=>["exited"===N(a).run_status?(y(),H(s,{key:0,onClick:i},{default:B(()=>[V(O(e.$t("Public.Status.Start")),1)]),_:1})):M("",!0),"running"===N(a).run_status?(y(),H(s,{key:1,onClick:u},{default:B(()=>[V(O(e.$t("Public.Status.Stop")),1)]),_:1})):M("",!0),"running"===N(a).run_status?(y(),H(s,{key:2,onClick:d},{default:B(()=>[V(O(e.$t("Public.Status.Restart")),1)]),_:1})):M("",!0),J(s,{onClick:p},{default:B(()=>[V(O(e.$t("Docker.ComposeNew.index_16")),1)]),_:1}),J(s,{class:"delete-btn",onClick:m},{default:B(()=>[V(O(e.$t("Public.Btn.Delete")),1)]),_:1})]),_:1})])]),_:1})}}}),[["__scopeId","data-v-ef472476"]]),Pe=w({__name:"main-container-status",props:{item:{}},emits:["select"],setup(e,{emit:t}){const a=t,s=z(e,"item"),{t:l}=E(),o=U(()=>{const e={text:l("Public.Status.Abnormal"),type:"warning"};switch(s.value.State){case"running":e.text=l("Public.Status.Running"),e.type="primary";break;case"exited":e.text=l("Public.Status.Stopped"),e.type="error"}return e}),n=U(()=>{switch(s.value.State){case"running":return[{label:l("Public.Status.Restart"),key:"restart"},{label:l("Public.Status.Stop"),key:"stop"},{label:l("Public.Status.Kill"),key:"kill"}];case"exited":return[{label:l("Public.Status.Start"),key:"start"}];default:return[{label:l("Public.Status.Restart"),key:"restart"},{label:l("Public.Status.Kill"),key:"kill"}]}}),c=e=>{a("select",e,s.value)};return(e,t)=>{const a=Y,s=se;return y(),H(s,{options:N(n),onSelect:c},{default:B(()=>[J(a,{type:N(o).type,size:"small",class:"cursor-pointer"},{default:B(()=>[V(O(N(o).text),1)]),_:1},8,["type"])]),_:1},8,["options"])}}}),$e=w({__name:"index",props:{id:{}},setup(e){const t=z(e,"id"),s=C("");return(async()=>{const{message:e}=await(l={container_id:t.value},a.post("/mod/docker/com/get_project_container_logs",l));var l;o(e)&&(s.value=e.result)})(),(e,t)=>{const a=ne;return y(),H(a,{class:"h-480px",lang:"log","font-size":12,content:N(s)},null,8,["content"])}}}),Ie={class:"h-full overflow-auto"},Oe={key:0,class:"container-list"},Re={class:"container-info"},Le={class:"flex items-center flex-1"},Ae={class:"container-name"},ze={class:"ml-4px"},Ee={class:"ml-4px"},Ue=["title"],Je={key:0,class:"container-port"},Be={key:1,class:"flex-center h-full"},Ve=s(w({__name:"main-container",setup(e){const{t:t}=E(),{timestamp:a,currentProject:s,sendSocket:l}=ie(),o=C([]),r=async(e,t)=>{await i({id:t.ID,status:e})},{loading:d,setLoading:p}=v(),_=()=>{p(!0),l({mod_name:"docker",sub_mod_name:"com",def_name:"get_project_ps",path:s.value.path,ws_callback:"get_project_ps"},{action:"get_project_ps",callback:(e,t)=>{p(!1);const a=JSON.parse(t.data),{data:s}=a;u(s)&&(s.forEach(e=>{e.ports=e.Ports.split(",").filter(e=>""!==e)}),o.value=s)}})};return q(()=>s.value.path,()=>{o.value=[]}),q(()=>a.value,e=>{0!==e&&_()}),_(),(e,a)=>{const s=c,l=Q,i=Y,u=Z,p=n,_=te;return y(),H(_,{class:"flex-1",title:e.$t("Docker.ComposeNew.index_29"),"content-style":{overflow:"hidden"}},{default:B(()=>[P("div",Ie,[J(p,{show:N(d),class:"h-full"},{default:B(()=>[N(o).length>0?(y(),j("div",Oe,[(y(!0),j(K,null,F(N(o),a=>(y(),j("div",{key:a.ID,class:"container-item"},[P("div",Re,[P("div",Le,[P("div",Ae,O(a.Name),1),J(Pe,{item:a,onSelect:r},null,8,["item"])]),J(l,{onClick:e=>{var t;oe({id:(t=a).ID,status:t.State})}},{default:B(()=>[J(s,{name:"common-terminal",size:"13"}),P("span",ze,O(e.$t("Docker.ComposeNew.index_30")),1)]),_:2},1032,["onClick"]),J(l,{class:"ml-10px",onClick:e=>{var s;m({title:t("Docker.ComposeNew.index_32",[(s=a).Name]),width:720,data:{id:s.ID},component:$e})}},{default:B(()=>[J(s,{name:"base-record",size:"15"}),P("span",Ee,O(e.$t("Docker.ComposeNew.index_31")),1)]),_:2},1032,["onClick"])]),P("div",{class:"container-desc",title:a.ID},O(a.ID),9,Ue),a.ports&&a.ports.length>0?(y(),j("div",Je,[(y(!0),j(K,null,F(a.ports,e=>(y(),H(i,{key:e,size:"small"},{default:B(()=>[V(O(e),1)]),_:2},1024))),128))])):M("",!0)]))),128))])):(y(),j("div",Be,[J(u)]))]),_:1},8,["show"])])]),_:1},8,["title"])}}}),[["__scopeId","data-v-d4d7576a"]]),He={class:"p-16px h-full"},Me=w({__name:"main-logs",setup(e){const{timestamp:t,currentProject:a,sendSocket:s}=ie(),l=C(""),{loading:o,setLoading:n}=v(),c=()=>{n(!0),l.value="",s({mod_name:"docker",sub_mod_name:"com",def_name:"get_logs",path:a.value.path,ws_callback:"get_logs"},{action:"get_logs",callback:(e,t)=>{if(n(!1),t.data){const e=JSON.parse(t.data);l.value+=e.msg+"\n"}}})};return q(()=>t.value,e=>{0!==e&&c()}),c(),(e,t)=>{const a=ne,s=te;return y(),H(s,{class:"h-55%",title:e.$t("Docker.ComposeNew.index_28"),"content-style":{overflow:"hidden"}},{default:B(()=>[P("div",He,[J(a,{class:"h-full",lang:"log",rows:80,"font-size":12,loading:N(o),content:N(l)},null,8,["loading","content"])])]),_:1},8,["title"])}}}),Te={class:"h-full p-16px"},qe={class:"flex items-center mb-10px"},Ke=["title"],Fe={class:"mt-16px"},Ge=s(w({__name:"main-config",setup(e){const t=G(),{t:a}=E(),{timestamp:s,currentProject:n,sendSocket:c,setProjectStatus:r}=ie(),i=C(""),u=C(""),p=()=>{d("Path",n.value.path),t.push("/files")},m=()=>{c({mod_name:"docker",sub_mod_name:"com",def_name:"get_config",path:n.value.path,ws_callback:"get_config"},{action:"get_config",callback:(e,t)=>{const a=JSON.parse(t.data).data;o(a)&&(i.value=a.config,u.value=a.env)}})};q(()=>s.value,e=>{0!==e&&m()});const v=()=>{_({title:a("Docker.ComposeNew.index_35"),content:a("Docker.ComposeNew.index_36"),onConfirm:({hide:e})=>{const{close:t}=l.loading(a("Docker.ComposeNew.index_37"));return c({mod_name:"docker",sub_mod_name:"com",def_name:"save_config",config:i.value,env:u.value,path:n.value.path,ws_callback:"save_config"},{action:"save_config",callback:(a,s)=>{t();const o=JSON.parse(s.data);o.status?(e(),de(n.value.name,{status:"restart",setProjectStatus:r})):l.error(o.msg)}}),!1}})};return m(),(e,t)=>{const a=Q,s=te;return y(),H(s,{title:e.$t("Docker.ComposeNew.index_33"),class:"w-42%"},{default:B(()=>[P("div",Te,[P("div",qe,[t[2]||(t[2]=P("span",{class:"text-14px mr-12px"},"compose.yaml",-1)),P("a",{href:"javascript:;",title:N(n).path,class:"jump-link",onClick:p},O(e.$t("Docker.ComposeNew.index_34")),9,Ke)]),J(ce,{value:N(i),"onUpdate:value":t[0]||(t[0]=e=>L(i)?i.value=e:null),"show-tips":!1,lang:"yaml",style:{height:"calc(100% - 370px)"}},null,8,["value"]),t[3]||(t[3]=P("div",{class:"flex items-center mt-16px mb-10px"},[P("span",{class:"text-14px"},".env")],-1)),J(ce,{value:N(u),"onUpdate:value":t[1]||(t[1]=e=>L(u)?u.value=e:null),height:"200","show-tips":!1},null,8,["value"]),P("div",Fe,[J(a,{type:"primary",onClick:v},{default:B(()=>[V(O(e.$t("Public.Btn.Save")),1)]),_:1})])])]),_:1},8,["title"])}}}),[["__scopeId","data-v-9c7767b0"]]),We={class:"flex-1 flex flex-col gap-16px overflow-hidden"},Xe={class:"flex-1 flex gap-16px overflow-hidden"},Ye={class:"flex-1 flex flex-col gap-16px overflow-hidden"},Qe={class:"flex-center flex-col h-full"},Ze=s(w({__name:"main",setup(e){const{loading:t,projectList:a,sendSocket:s,refreshCompose:l}=ie(),o=()=>{ue({send:s,refresh:l})};return(e,s)=>{const l=Z,c=p,r=n,i=te;return y(),j("div",We,[N(a).length>0?(y(),j(K,{key:0},[J(Ne),P("div",Xe,[P("div",Ye,[J(Ve),J(Me)]),J(Ge)])],64)):(y(),H(i,{key:1,class:"h-full"},{default:B(()=>[J(r,{show:N(t),class:"h-full"},{default:B(()=>[P("div",Qe,[J(l),J(c,{class:"mt-16px",onClick:o},{default:B(()=>[V(O(e.$t("Docker.ComposeNew.index_13")),1)]),_:1})])]),_:1},8,["show"])]),_:1}))])}}}),[["__scopeId","data-v-d7995fdc"]]),et=w({__name:"index",setup(e){const t=C(null),{height:a}=k(t),{send:s,close:l,open:o}=f("/ws_modsoc"),n=C([]),c=C([]),r=C(0),i=U(()=>n.value[r.value]),d=C(!1),p=C(0);let m=!1;const _=e=>{m=e},v=()=>{d.value=!0,s({mod_name:"docker",sub_mod_name:"com",def_name:"get_project_list",ws_callback:"get_project_list"},{action:"get_project_list",callback:(e,t)=>{d.value=!1;const a=JSON.parse(t.data);u(a.data)&&(n.value=a.data,c.value=a.data,m&&(p.value=Date.now(),_(!1)))}})};return v(),h(re,{loading:d,timestamp:p,projectList:n,projectListAll:c,projectActive:r,currentProject:i,sendSocket:s,setProjectStatus:(e,t)=>{s({mod_name:"docker",sub_mod_name:"com",def_name:e,path:i.value.path,project_name:i.value.name,ws_callback:e},{action:e,callback:(e,a)=>{const s=JSON.parse(a.data);t(s)}})},refreshCompose:()=>{l(),o(),_(!0),v()}}),(e,s)=>(y(),j("div",{ref_key:"composeRef",ref:t,class:"flex",style:W({height:N(a)})},[J(be),J(Ze)],4))}});export{et as default};
