const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index285.js?v=1769066082311","js/index114.js?v=1769066082311","js/vue.js?v=1769066082311","js/__commonjsHelpers__.js?v=1769066082311","js/naive.js?v=1769066082311","js/common.js?v=1769066082311","js/page_layout.js?v=1769066082311","js/public.js?v=1769066082311","css/public.css?v=1769066082311","css/page_layout.css?v=1769066082311","css/index23.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang5.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang6.js?v=1769066082311","css/index17.css?v=1769066082311","js/index92.js?v=1769066082311","js/index140.js?v=1769066082311","css/index26.css?v=1769066082311","js/index.js?v=1769066082311","css/index123.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang7.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang9.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang8.js?v=1769066082311","js/index138.js?v=1769066082311","js/php.js?v=1769066082311","js/soft.js?v=1769066082311","js/site.js?v=1769066082311","css/index25.css?v=1769066082311","js/site3.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang14.js?v=1769066082311","js/index223.js?v=1769066082311","css/index45.css?v=1769066082311","js/index104.js?v=1769066082311","css/index16.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang11.js?v=1769066082311","js/index103.js?v=1769066082311","css/index15.css?v=1769066082311","js/index105.js?v=1769066082311","js/theme-monokai.js?v=1769066082311","js/file.js?v=1769066082311","css/index18.css?v=1769066082311","js/refersh.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang17.js?v=1769066082311","js/index109.js?v=1769066082311","css/index21.css?v=1769066082311","js/ssl.js?v=1769066082311","js/cert.js?v=1769066082311","js/ssl-lets-progress.js?v=1769066082311","css/ssl-lets-progress.css?v=1769066082311","js/utils3.js?v=1769066082311","js/index230.js?v=1769066082311","js/paypal-js.js?v=1769066082311","css/index58.css?v=1769066082311","js/upload.js?v=1769066082311","css/index69.css?v=1769066082311","js/index286.js?v=1769066082311"])))=>i.map(i=>d[i]);
import{aE as e,i as t,d as a,aI as l,p as s,m as i,x as n,bw as o,_ as u,a as r}from"./page_layout.js?v=1769066082311";import{_ as d}from"./index.js?v=1769066082311";import{u as p}from"./useModal2.js?v=1769066082311";import{d as c,c as _,h as m,f as h,a as f,_ as v,v as w,e as x,F as g,q as y}from"./public.js?v=1769066082311";import{Y as b,aG as k}from"./site.js?v=1769066082311";import{i as j,j as P,k as C,u as O,l as R,s as W,n as D,p as z}from"./index92.js?v=1769066082311";import{_ as q}from"./index114.js?v=1769066082311";import{i as M,p as U,k as F,W as $,R as A,V as B,S as L,U as E,a2 as T,a3 as H,q as I,P as S,r as V,aj as K,ak as N,j as G,a4 as Y,t as J,an as Q,e as X,_ as Z}from"./vue.js?v=1769066082311";import{dk as ee,dn as te,de as ae,au as le,aC as se,dl as ie,bL as ne}from"./naive.js?v=1769066082311";import{_ as oe}from"./form.vue_vue_type_script_setup_true_lang2.js?v=1769066082311";import"./common.js?v=1769066082311";import"./__commonjsHelpers__.js?v=1769066082311";import"./index140.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang9.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1769066082311";import"./index138.js?v=1769066082311";import"./php.js?v=1769066082311";import"./soft.js?v=1769066082311";import"./site3.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang14.js?v=1769066082311";import"./index223.js?v=1769066082311";import"./index104.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang11.js?v=1769066082311";import"./index103.js?v=1769066082311";import"./index105.js?v=1769066082311";import"./theme-monokai.js?v=1769066082311";import"./file.js?v=1769066082311";import"./refersh.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang17.js?v=1769066082311";import"./index109.js?v=1769066082311";import"./ssl.js?v=1769066082311";import"./cert.js?v=1769066082311";import"./ssl-lets-progress.js?v=1769066082311";import"./utils3.js?v=1769066082311";import"./index230.js?v=1769066082311";import"./paypal-js.js?v=1769066082311";import"./upload.js?v=1769066082311";const ue=Symbol("server-list");function re(){return M(ue)}const de=a=>e.post("/tamper_core/add_black_exts.json",a,{requestOptions:{loading:t.global.t("WP.api.tamper_2"),isOriginalResult:!0,prefix:""}}),pe=a=>e.post("/tamper_core/remove_black_exts.json",a,{requestOptions:{loading:t.global.t("WP.api.tamper_3"),isOriginalResult:!0,prefix:""}}),ce=F({__name:"index",setup(s,{expose:i}){const{site:n,setPid:o}=re(),{loading:u,setLoading:r}=c(),{table:d,columns:p}=_([{key:"name",title:"Name"},{key:"status",title:"Status",align:"right",render:l=>$(ee,{value:l.status,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async s=>{const{message:i}=await(n={key:l.key,value:s,path_id:l.id},e.post("/tamper_core/modify_path_config.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_1"),isOriginalResult:!0,prefix:""}}));var n;a(i)&&i.status&&(l.status=s)}},null)}]),h=[{title:"Create file",name:"create"},{title:"Modify file",name:"modify"},{title:"Delete file",name:"unlink"},{title:"Create directory",name:"mkdir"},{title:"Delete directory",name:"rmdir"},{title:"Rename file",name:"rename"},{title:"Create soft link",name:"link"},{title:"Modify permissions",name:"chmod"},{title:"Modify owner",name:"chown"}],f=async()=>{try{r(!0);const{message:t}=await j({path:n.path});a(t)&&!te(t)?(o(t.pid),e=t,d.data=h.map(t=>{const a="is_".concat(t.name),s=e[a];return{key:a,id:e.pid,name:"Disabled ".concat(t.title),status:l(s)?s:0}})):d.data=[]}finally{r(!1)}var e};return f(),i({init:f}),(e,t)=>{const a=m;return B(),A("div",null,[$(a,{loading:E(u),"loading-num":9,"max-height":340,data:E(d).data,columns:E(p)},null,8,["loading","data","columns"]),t[0]||(t[0]=L("div",{class:"mt-16px text-#777"}," Tip: Current config intercepts the above rules by default, please set and config the rules according the current project requirements. ",-1))])}}});const _e=s({},[["render",function(e,t){const a=ae;return B(),T(a,{size:"small",bordered:!1},{default:H(()=>[I(e.$slots,"default",{},void 0,!0)]),_:3})}],["__scopeId","data-v-c6193199"]]),me={class:"flex mb-12px"},he={class:"w-240px mr-12px"},fe=F({__name:"index",setup(e,{expose:t}){const{t:l}=S(),{site:s,setPid:o}=re(),u=V("");let r=-1,d="";const p=async()=>{if(""===u.value.trim())return void i.error("Please enter suffix");const{message:e}=await de({path_id:r,path:d,exts:u.value});a(e)&&(e.status?(i.success(e.msg),u.value="",k()):i.error(e.msg))},{table:w,columns:x}=_([{key:"exts",title:"Suffix"},h({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async e=>{f({title:"Delete protected file suffix [".concat(e.exts,"]"),content:"Delete protected file suffix, the file whose file name ends with this suffix will lose protection. want to continue?",onConfirm:async()=>{const{message:t}=await pe({path_id:e.id,path:d,exts:e.exts});a(t)&&(t.status?(i.success(t.msg),k()):i.error(t.msg))}})},{loading:y,setLoading:b}=c(),k=async()=>{try{b(!0);const{message:t}=await j({path:s.path});a(t)&&(o(t.pid),r=(e=t).pid,d=e.path,n(e.black_exts)?w.data=e.black_exts.filter(e=>"/"!=e[0]&&-1==e.indexOf("./")).map(t=>({id:e.pid,exts:t})):w.data=[])}finally{b(!1)}var e};return k(),t({init:k}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return B(),A("div",null,[L("div",me,[L("div",he,[$(a,{value:E(u),"onUpdate:value":t[0]||(t[0]=e=>N(u)?u.value=e:null),placeholder:"Suffix",onKeyup:K(p,["enter"])},null,8,["value"])]),$(l,{type:"primary",onClick:p},{default:H(()=>[G(Y(e.$t("Public.Btn.Add")),1)]),_:1})]),$(s,{loading:E(y),"loading-num":6,"max-height":230,data:E(w).data,columns:E(x)},null,8,["loading","data","columns"]),$(n,{class:"mt-16px"},{default:H(()=>[t[25]||(t[25]=L("li",null," The so-called file suffix refers the string at the end of the file name, not necessarily the extension ",-1)),L("li",null,[t[5]||(t[5]=G(" As: ",-1)),$(i,null,{default:H(()=>t[1]||(t[1]=[G(".php",-1)])),_:1,__:[1]}),t[6]||(t[6]=G(", ",-1)),$(i,null,{default:H(()=>t[2]||(t[2]=[G(".html",-1)])),_:1,__:[2]}),t[7]||(t[7]=G(", ",-1)),$(i,null,{default:H(()=>t[3]||(t[3]=[G(".js?v=1769066082311",-1)])),_:1,__:[3]}),t[8]||(t[8]=G(", ",-1)),$(i,null,{default:H(()=>t[4]||(t[4]=[G("index.php",-1)])),_:1,__:[4]}),t[9]||(t[9]=G(" etc. ",-1))]),t[26]||(t[26]=L("div",null,"Example:",-1)),L("li",null,[$(i,null,{default:H(()=>t[10]||(t[10]=[G(".php",-1)])),_:1,__:[10]}),t[14]||(t[14]=G(" Match: ",-1)),$(i,null,{default:H(()=>t[11]||(t[11]=[G("./1.php",-1)])),_:1,__:[11]}),t[15]||(t[15]=G()),$(i,null,{default:H(()=>t[12]||(t[12]=[G("./test/2.php",-1)])),_:1,__:[12]}),t[16]||(t[16]=G(" Mismatch: ",-1)),$(i,null,{default:H(()=>t[13]||(t[13]=[G("./1.php/1.txt",-1)])),_:1,__:[13]})]),L("li",null,[$(i,null,{default:H(()=>t[17]||(t[17]=[G("index.php",-1)])),_:1,__:[17]}),t[22]||(t[22]=G(" Match: ",-1)),$(i,null,{default:H(()=>t[18]||(t[18]=[G("./index.php",-1)])),_:1,__:[18]}),t[23]||(t[23]=G()),$(i,null,{default:H(()=>t[19]||(t[19]=[G("./test/index.php",-1)])),_:1,__:[19]}),$(i,{class:"ml-0.5em"},{default:H(()=>t[20]||(t[20]=[G("./abc_index.php",-1)])),_:1,__:[20]}),t[24]||(t[24]=G(" Mismatch: ",-1)),$(i,null,{default:H(()=>t[21]||(t[21]=[G("./index.php.tar.gz",-1)])),_:1,__:[21]})])]),_:1,__:[25,26]})])}}}),ve={class:"flex mb-12px"},we={class:"w-240px mr-12px"},xe=F({__name:"index",setup(e,{expose:t}){const{t:l}=S(),{site:s,setPid:o}=re(),u=V("");let r=-1,d="";const p=async()=>{if(""===u.value.trim())return void i.error("Please enter the full path or relative path of the file");const{message:e}=await de({path_id:r,path:d,exts:u.value});a(e)&&(e.status?(i.success(e.msg),u.value="",k()):i.error(e.msg))},{table:w,columns:x}=_([{key:"exts",title:"Full file path"},h({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async e=>{f({title:"Delete protected files [".concat(e.exts,"]"),content:"After deleting a protected file, the file will be unprotected, should I continue the operation?",onConfirm:async()=>{const{message:t}=await pe({path_id:e.id,path:d,exts:e.exts});a(t)&&(t.status?(i.success(t.msg),k()):i.error(t.msg))}})},{loading:y,setLoading:b}=c(),k=async()=>{try{b(!0);const{message:t}=await j({path:s.path});a(t)&&(o(t.pid),r=(e=t).pid,d=e.path,n(e.black_exts)?w.data=e.black_exts.filter(e=>"/"==e[0]||"."==e[0]&&"/"==e[1]).map(t=>({id:e.pid,exts:t})):w.data=[])}finally{b(!1)}var e};return k(),t({init:k}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return B(),A("div",null,[L("div",ve,[L("div",we,[$(a,{value:E(u),"onUpdate:value":t[0]||(t[0]=e=>N(u)?u.value=e:null),placeholder:"Full path Or Relative path",onKeyup:K(p,["enter"])},null,8,["value"])]),$(l,{type:"primary",onClick:p},{default:H(()=>[G(Y(e.$t("Public.Btn.Add")),1)]),_:1})]),$(s,{loading:E(y),"loading-num":5,"max-height":200,data:E(w).data,columns:E(x)},null,8,["loading","data","columns"]),$(n,{class:"mt-16px"},{default:H(()=>[t[15]||(t[15]=L("li",{class:"font-bold text-#333"},"The following 4 methods are supported",-1)),L("li",null,[t[2]||(t[2]=G("1. Complete file path, such as: ",-1)),$(i,null,{default:H(()=>t[1]||(t[1]=[G("/www/wwwroot/test/123.log",-1)])),_:1,__:[1]})]),L("li",null,[t[5]||(t[5]=G(" 2. Relative path to the site, such as: Full path ",-1)),$(i,null,{default:H(()=>t[3]||(t[3]=[G("/www/wwwroot/test/app/123.log",-1)])),_:1,__:[3]}),t[6]||(t[6]=G(" Relative path ",-1)),$(i,null,{default:H(()=>t[4]||(t[4]=[G("./app/123.log",-1)])),_:1,__:[4]})]),L("li",null,[t[9]||(t[9]=G(" 3. All files in the specified directory, such as: ",-1)),$(i,null,{default:H(()=>t[7]||(t[7]=[G("/www/wwwroot/test/app/*",-1)])),_:1,__:[7]}),t[10]||(t[10]=G(" Relative path ",-1)),$(i,null,{default:H(()=>t[8]||(t[8]=[G("./app/*",-1)])),_:1,__:[8]})]),L("li",null,[t[13]||(t[13]=G(" 4. the specified directory under the specified file type, such as: ",-1)),$(i,null,{default:H(()=>t[11]||(t[11]=[G("/www/wwwroot/test/app/*.log",-1)])),_:1,__:[11]}),t[14]||(t[14]=G(" Relative path ",-1)),$(i,null,{default:H(()=>t[12]||(t[12]=[G("./app/*.log",-1)])),_:1,__:[12]})]),t[16]||(t[16]=L("li",{class:"text-error"}," Note: files already included in the protected file suffix do not need to be set. ",-1))]),_:1,__:[15,16]})])}}}),ge={class:"flex mb-12px"},ye={class:"w-240px mr-12px"},be=F({__name:"index",setup(l,{expose:s}){const{t:o}=S(),{site:u,setPid:r}=re(),d=V("");let p=-1,x="";const g=async()=>{if(""===d.value.trim())return void i.error("Please enter directory name");const{message:l}=await(s={path_id:p,path:x,dirnames:d.value},e.post("/tamper_core/add_white_dirs.json",s,{requestOptions:{loading:t.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;a(l)&&(l.status?(i.success(l.msg),d.value="",O()):i.error(l.msg))},{table:y,columns:b}=_([{key:"dir",title:"Directory",ellipsis:{tooltip:!0}},w({title:"Remark",onBlur:async(l,s)=>{const{message:n}=await(o={path_id:s.id,dir_name:s.dir,ps:l},e.post("/tamper_core/set_white_dir_with_ps.json",o,{requestOptions:{loading:t.global.t("WP.api.tamper_5"),isOriginalResult:!0,prefix:""}}));var o;a(n)&&(n.status?s.ps=l:i.error(n.msg))}}),h({width:80,options:e=>[{label:o("Public.Btn.Del"),onClick:()=>{k(e)}}]})]),k=async l=>{f({title:"Delete directory whitelist",content:l.tip_msg?l.tip_msg:"Delete [".concat(l.dir,"] later, All files in the directory will be protected, continue?"),onConfirm:async()=>{const{message:s}=await(n={path_id:l.id,path:x,dirname:l.dir},e.post("/tamper_core/remove_white_dirs.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var n;a(s)&&(s.status?(i.success(s.msg),O()):i.error(s.msg))}})},{loading:P,setLoading:C}=c(),O=async()=>{try{C(!0);const{message:t}=await j({path:u.path});a(t)&&(r(t.pid),p=(e=t).pid,x=e.path,n(e.white_dirs)?y.data=e.white_dirs.map(t=>({id:e.pid,ps:t.ps||"",tip_msg:t.tip_msg||"",...t})):y.data=[])}finally{C(!1)}var e};return O(),s({init:O}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return B(),A("div",null,[L("div",ge,[L("div",ye,[$(a,{value:E(d),"onUpdate:value":t[0]||(t[0]=e=>N(d)?d.value=e:null),placeholder:"Directory name",onKeyup:K(g,["enter"])},null,8,["value"])]),$(l,{type:"primary",onClick:g},{default:H(()=>[G(Y(e.$t("Public.Btn.Add")),1)]),_:1})]),$(s,{loading:E(P),"loading-num":5,"max-height":188,data:E(y).data,columns:E(b)},null,8,["loading","data","columns"]),$(n,{class:"mt-16px"},{default:H(()=>[L("li",null,[t[4]||(t[4]=G(" Full path or directory name or parts path are allowed such as: ",-1)),$(i,null,{default:H(()=>t[1]||(t[1]=[G("/www/abc/cache/test/",-1)])),_:1,__:[1]}),t[5]||(t[5]=G(", ",-1)),$(i,null,{default:H(()=>t[2]||(t[2]=[G("test",-1)])),_:1,__:[2]}),t[6]||(t[6]=G(", ",-1)),$(i,null,{default:H(()=>t[3]||(t[3]=[G("cache/test/",-1)])),_:1,__:[3]})]),L("li",null,[t[10]||(t[10]=G(" The first character of the Full path must be ",-1)),$(i,null,{default:H(()=>t[7]||(t[7]=[G("/",-1)])),_:1,__:[7]}),t[11]||(t[11]=G(", as: ",-1)),$(i,null,{default:H(()=>t[8]||(t[8]=[G("cache/test/",-1)])),_:1,__:[8]}),t[12]||(t[12]=G(" or ",-1)),$(i,null,{default:H(()=>t[9]||(t[9]=[G("test",-1)])),_:1,__:[9]})]),L("li",null,[t[15]||(t[15]=G(" art of directory name or path cannot begin with ",-1)),$(i,null,{default:H(()=>t[13]||(t[13]=[G("/",-1)])),_:1,__:[13]}),t[16]||(t[16]=G(", as: ",-1)),$(i,null,{default:H(()=>t[14]||(t[14]=[G("/www/abc/cache/test/",-1)])),_:1,__:[14]})]),t[39]||(t[39]=L("div",null,"Example:",-1)),L("li",null,[$(i,null,{default:H(()=>t[17]||(t[17]=[G("/www/abc/",-1)])),_:1,__:[17]}),t[21]||(t[21]=G(" Match: ",-1)),$(i,null,{default:H(()=>t[18]||(t[18]=[G("/www/abc/*",-1)])),_:1,__:[18]}),t[22]||(t[22]=G(" Mismatch: ",-1)),$(i,null,{default:H(()=>t[19]||(t[19]=[G("/www/abc",-1)])),_:1,__:[19]}),$(i,{class:"ml-0.5em"},{default:H(()=>t[20]||(t[20]=[G("/www/abc123",-1)])),_:1,__:[20]})]),L("li",null,[$(i,null,{default:H(()=>t[23]||(t[23]=[G("test",-1)])),_:1,__:[23]}),t[27]||(t[27]=G(" Match: ",-1)),$(i,null,{default:H(()=>t[24]||(t[24]=[G("/www/test/1.txt",-1)])),_:1,__:[24]}),t[28]||(t[28]=G()),$(i,null,{default:H(()=>t[25]||(t[25]=[G("/www/test_abc",-1)])),_:1,__:[25]}),t[29]||(t[29]=G(" Mismatch: ",-1)),$(i,null,{default:H(()=>t[26]||(t[26]=[G("/www/1.php",-1)])),_:1,__:[26]})]),L("li",null,[$(i,null,{default:H(()=>t[30]||(t[30]=[G("cache/test/",-1)])),_:1,__:[30]}),t[35]||(t[35]=G(" Match: ",-1)),$(i,null,{default:H(()=>t[31]||(t[31]=[G("/www/cache/test/1.txt",-1)])),_:1,__:[31]}),t[36]||(t[36]=G()),$(i,null,{default:H(()=>t[32]||(t[32]=[G("/cache/test/",-1)])),_:1,__:[32]}),t[37]||(t[37]=G(" Mismatch: ",-1)),$(i,null,{default:H(()=>t[33]||(t[33]=[G("/www/cache/test",-1)])),_:1,__:[33]}),t[38]||(t[38]=G()),$(i,null,{default:H(()=>t[34]||(t[34]=[G("/cache/",-1)])),_:1,__:[34]})])]),_:1,__:[39]})])}}}),ke={class:"flex mb-12px"},je={class:"w-240px mr-12px"},Pe=F({__name:"index",setup(l,{expose:s}){const{t:o}=S(),{site:u,setPid:r}=re(),d=V("");let p=-1,w="";const x=async()=>{if(""===d.value.trim())return void i.error("Please enter file name");const{message:l}=await(s={path_id:p,path:w,filename:d.value},e.post("/tamper_core/add_white_files.json",s,{requestOptions:{loading:t.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;a(l)&&(l.status?(i.success(l.msg),d.value="",C()):i.error(l.msg))},{table:g,columns:y}=_([{key:"filename",title:"File name"},h({width:100,options:e=>[{label:o("Public.Btn.Del"),onClick:()=>{b(e)}}]})]),b=async l=>{f({title:"Delete file whitelist [".concat(l.filename,"]"),content:"After Delete whitelist, the file will be protected. want to continue?",onConfirm:async()=>{const{message:s}=await(n={path_id:l.id,path:w,filename:l.filename},e.post("/tamper_core/remove_white_files.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var n;a(s)&&(s.status?(i.success(s.msg),C()):i.error(s.msg))}})},{loading:k,setLoading:P}=c(),C=async()=>{try{P(!0);const{message:t}=await j({path:u.path});a(t)&&(r(t.pid),p=(e=t).pid,w=e.path,n(e.white_files)?g.data=e.white_files.map(t=>({id:e.pid,filename:t})):g.data=[])}finally{P(!1)}var e};return C(),s({init:C}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return B(),A("div",null,[L("div",ke,[L("div",je,[$(a,{value:E(d),"onUpdate:value":t[0]||(t[0]=e=>N(d)?d.value=e:null),placeholder:"File name",onKeyup:K(x,["enter"])},null,8,["value"])]),$(l,{type:"primary",onClick:x},{default:H(()=>[G(Y(e.$t("Public.Btn.Add")),1)]),_:1})]),$(s,{loading:E(k),"loading-num":6,"max-height":230,data:E(g).data,columns:E(y)},null,8,["loading","data","columns"]),$(n,{class:"mt-16px"},{default:H(()=>[L("li",null,[t[3]||(t[3]=G(" Full path or single filename are allowed such as: ",-1)),$(i,null,{default:H(()=>t[1]||(t[1]=[G("/test/index.php",-1)])),_:1,__:[1]}),t[4]||(t[4]=G(", ",-1)),$(i,null,{default:H(()=>t[2]||(t[2]=[G("index.php",-1)])),_:1,__:[2]})]),t[17]||(t[17]=L("li",null,"Note: Only be an absolute path or file name, relative paths are not supported",-1)),t[18]||(t[18]=L("div",null,"Example:",-1)),L("li",null,[$(i,null,{default:H(()=>t[5]||(t[5]=[G("index.php",-1)])),_:1,__:[5]}),t[10]||(t[10]=G(" Match: ",-1)),$(i,null,{default:H(()=>t[6]||(t[6]=[G("./index.php",-1)])),_:1,__:[6]}),t[11]||(t[11]=G()),$(i,null,{default:H(()=>t[7]||(t[7]=[G("./test/index.php",-1)])),_:1,__:[7]}),t[12]||(t[12]=G(" Mismatch: ",-1)),$(i,null,{default:H(()=>t[8]||(t[8]=[G("./abc_index.php",-1)])),_:1,__:[8]}),t[13]||(t[13]=G()),$(i,null,{default:H(()=>t[9]||(t[9]=[G("./index.php/1.txt",-1)])),_:1,__:[9]})]),L("li",null,[$(i,null,{default:H(()=>t[14]||(t[14]=[G("/test/index.php",-1)])),_:1,__:[14]}),t[16]||(t[16]=G(" match only: ",-1)),$(i,null,{default:H(()=>t[15]||(t[15]=[G("/test/index.php",-1)])),_:1,__:[15]})])]),_:1,__:[17,18]})])}}}),Ce={class:"p-20px"},Oe={class:"flex items-center text-12px text-#666"},Re={key:0,class:"ml-12px"},We={class:"h-500px"},De=F({__name:"index",props:{open:{type:Boolean,default:!1},site:{}},emits:["changeOpen"],setup(e,{emit:t}){const a=e,l=t,s=J(a,"site");let i=-1;const n=V(a.open),o=V(),u=async e=>{e?await P({paths:[{path:s.value.path,ps:s.value.ps}]}):await C({path_id:i}),n.value=e,l("changeOpen",e),o.value.init()},r=V("basic"),d=[{key:"basic",label:"Basic Setting",component:ce},{key:"suffix",label:"Protected file suffix",component:fe},{key:"protected file",label:"Protected File",component:xe},{key:"directory whitelist",label:"Directory whitelist",component:be},{key:"file whitelist",label:"File whitelist",component:Pe}];var p;return p={site:s.value,setPid:e=>{i=e}},U(ue,p),(e,t)=>{const a=ee,l=ie,s=q;return B(),A("div",Ce,[$(l,{class:"mb-16px",type:E(n)?"success":"error","show-icon":!1,bordered:!1},{default:H(()=>[L("div",Oe,[t[1]||(t[1]=L("span",{class:"mr-12px"},"Protection switch",-1)),$(a,{value:E(n),"onUpdate:value":u},null,8,["value"]),E(n)?Q("",!0):(B(),A("span",Re," Protection directory closed, be security risks, Recommended open protection immediately "))])]),_:1},8,["type"]),L("div",We,[$(s,{ref_key:"tabsRef",ref:o,value:E(r),"onUpdate:value":t[0]||(t[0]=e=>N(r)?r.value=e:null),options:d},null,8,["value"])])])}}}),ze=F({__name:"index",props:{site:{}},emits:["changeHotlink"],setup(e,{emit:t}){const a=t,l=J(e,"site"),s=e=>{a("changeHotlink",e)};return(e,t)=>(B(),A("div",null,[$(oe,{class:"p-20px",site:E(l),onChangeHotlink:s},null,8,["site"])]))}}),qe={class:"p-20px"},Me={class:"tools-card"},Ue={class:"tools-img"},Fe={class:"tools-name"},$e={class:"tools-desc"},Ae={class:"ml-0.5em"},Be={class:"tools-card"},Le={class:"tools-img"},Ee={class:"tools-name"},Te={class:"tools-desc"},He={class:"ml-0.5em"},Ie={class:"tools-card"},Se={class:"tools-img"},Ve={class:"tools-name"},Ke={class:"tools-card flex-col!"},Ne={class:"flex items-center! w-full pb-10px"},Ge={class:"tools-name"},Ye={class:"tools-card flex-col!"},Je={class:"flex items-center! w-full pb-10px"},Qe={class:"tools-name min-w-auto!"},Xe=s(F({__name:"index",props:{site:{}},setup(e){const t=Z(()=>r(()=>import("./index285.js?v=1769066082311"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54]))),l=Z(()=>r(()=>import("./index286.js?v=1769066082311"),__vite__mapDeps([55,7,6,2,3,4,5,9,8,14,15,16,17,18,11,12,13,19,20,21,22,23,24,25,26,27,28,29,30,31,32,1,10,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54]))),{t:s}=S(),i=J(e,"site"),n=O(),c=X({status:!1,number:0,pid:-1}),_=V(!1),m=V(!1),h=async e=>{try{_.value=!0;const t=s(e?"WP.index_46":"WP.index_47");f({title:s("WP.index_48"),content:t,onConfirm:async()=>{await W({path:i.value.path}),m.value=e}})}finally{_.value=!1}},v=x(s("WP.index_43")),w=async()=>{v.data.row=i.value,v.show=!0},q=x(),M=async()=>{q.title="".concat(s("WP.index_32")," [").concat(i.value.name,"]"),q.data.site=i.value,q.show=!0},U=V(!1),F=async e=>{try{U.value=!0,await g({source:200}),await y("tamper_core"),e?await P({paths:[{path:i.value.path,ps:i.value.ps}]}):await C({path_id:c.pid}),pe()}finally{U.value=!1}},T=x("File Protection [".concat(i.value.name,"]"),{site:i.value,open:!1,onChangeOpen:e=>{c.status=e}}),I=async()=>{await g({source:200}),await y("tamper_core"),T.data.open=c.status,T.show=!0},K=X({status:!1,number:0}),N=V(!1),Q=async e=>{try{N.value=!0,await g({source:201}),await y("btwaf"),e?await D({site_name:i.value.name}):await z({site_name:i.value.name}),pe()}finally{n.setRefresh(!0),N.value=!1}},te=async()=>{await g({source:201}),await y("btwaf"),p({row:{siteName:i.value.name},onRefresh:()=>{pe(),n.setRefresh(!0)}})},le=V(!1),ie=V(!1),oe=async e=>{try{ie.value=!0;const{message:t}=await b({id:i.value.id,name:i.value.name},!1);if(a(t)){const a={id:i.value.id,name:i.value.name,fix:t.fix,domains:t.domains,return_rule:t.return_rule,status:e,http_status:"true"===t.http_status};await k(a,!1),le.value=e}}finally{ie.value=!1}},ue=x("Hotlink Protection [".concat(i.value.name,"]"),{site:i.value,onChangeHotlink:e=>{le.value=e}}),re=()=>{ue.show=!0},de=e=>{U.value=e,N.value=e,ie.value=e,_.value=e},pe=async()=>{try{de(!0);const{message:e}=await R({id:i.value.id,path:i.value.path,site_name:i.value.name});if(a(e)&&(c.status=1===e.file_status,c.number=e.file_count,K.status=1===e.firewall_status,K.number=e.firewall_count,le.value=1===e.hotlink_status,m.value=1===e.virus_scanning,1===e.file_status)){const{message:e}=await j({path:i.value.path});a(e)&&(c.pid=e.pid)}}finally{de(!1)}};return pe(),(e,a)=>{const s=ne,i=ee,n=u,r=se,p=ae,f=d;return B(),A("div",qe,[L("div",Me,[L("div",Ue,[$(s,{lazy:!0,"preview-disabled":!0,width:"24",src:"".concat(E(o),"images/soft-ico/ico-tamper_core.png")},null,8,["src"])]),L("div",Fe,Y(e.$t("WP.Label.index_5")),1),$(i,{value:E(c).status,loading:E(U),"onUpdate:value":F},null,8,["value","loading"]),$(r,{quaternary:"",size:"small",onClick:I},{default:H(()=>[$(n,{name:"setting",size:"18"})]),_:1}),L("div",$e,[$(p,{type:"error",size:"small",bordered:!1},{default:H(()=>[G(Y(E(c).number),1)]),_:1}),L("span",Ae,Y(e.$t("WP.Config.index_6")),1)])]),L("div",Be,[L("div",Le,[$(s,{lazy:!0,"preview-disabled":!0,width:"26",src:"".concat(E(o),"images/soft-ico/ico-btwaf.png")},null,8,["src"])]),L("div",Ee,Y(e.$t("WP.Label.index_6")),1),$(i,{value:E(K).status,loading:E(N),"onUpdate:value":Q},null,8,["value","loading"]),$(r,{quaternary:"",size:"small",onClick:te},{default:H(()=>[$(n,{name:"setting",size:"18"})]),_:1}),L("div",Te,[$(p,{type:"error",size:"small",bordered:!1},{default:H(()=>[G(Y(E(K).number),1)]),_:1}),L("span",He,Y(e.$t("WP.Config.index_7")),1)])]),L("div",Ie,[L("div",Se,[$(n,{name:"soft-hotlink",size:"24"})]),L("div",Ve,Y(e.$t("WP.Label.index_7")),1),$(i,{value:E(le),loading:E(ie),"onUpdate:value":oe},null,8,["value","loading"]),$(r,{quaternary:"",size:"small",onClick:re},{default:H(()=>[$(n,{name:"setting",size:"18"})]),_:1})]),L("div",Ke,[L("div",Ne,[a[4]||(a[4]=L("div",{class:"tools-img"},[L("i",{class:"i-healthicons:health-vulnerability-through-social-determinants-outline-24px text-26px text-primary!"})],-1)),L("div",Ge,Y(e.$t("WP.index_43")),1),$(i,{value:E(m),loading:E(_),"onUpdate:value":h},null,8,["value","loading"]),$(r,{quaternary:"",size:"small",onClick:w},{default:H(()=>[$(n,{name:"setting",size:"18"})]),_:1})]),a[5]||(a[5]=L("div",{class:"w-full color-#999"},"Check plugins and themes for security risks",-1))]),L("div",Ye,[L("div",Je,[a[6]||(a[6]=L("div",{class:"tools-img"},[L("i",{class:"i-material-symbols:library-add-check-outline text-26px text-#20a53a!"})],-1)),L("div",Qe,Y(e.$t("WP.TableRow.index_4")),1),$(r,{quaternary:"",size:"small",onClick:M},{default:H(()=>[$(n,{name:"setting",size:"18"})]),_:1})]),a[7]||(a[7]=L("div",{class:"w-full color-#999"}," Check the integrity of the core files of this WP version to ensure they are not infected with malicious viruses! ",-1))]),$(f,{show:E(T).show,"onUpdate:show":a[0]||(a[0]=e=>E(T).show=e),title:E(T).title,data:E(T).data,width:800,component:De},null,8,["show","title","data"]),$(f,{show:E(ue).show,"onUpdate:show":a[1]||(a[1]=e=>E(ue).show=e),title:E(ue).title,data:E(ue).data,component:ze},null,8,["show","title","data"]),$(f,{show:E(v).show,"onUpdate:show":a[2]||(a[2]=e=>E(v).show=e),title:E(v).title,data:E(v).data,width:800,"min-height":500,component:E(t)},null,8,["show","title","data","component"]),$(f,{show:E(q).show,"onUpdate:show":a[3]||(a[3]=e=>E(q).show=e),title:E(q).title,data:E(q).data,width:600,"min-height":190,component:E(l)},null,8,["show","title","data","component"])])}}}),[["__scopeId","data-v-c7bf07c5"]]);export{Xe as default};
