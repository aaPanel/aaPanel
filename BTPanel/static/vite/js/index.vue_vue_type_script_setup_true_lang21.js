import{_ as e}from"./index.js?v=1769066082311";import{_ as a}from"./index186.js?v=1769066082311";import{aa as l,a7 as t,o as s,r as i,g9 as n,ga as o,d as u,q as r,M as _,gb as d}from"./page_layout.js?v=1769066082311";import{db as p,dU as c,e2 as v,di as f,aC as g,dS as m,dV as h,av as y,dg as x,d_ as w,d3 as b}from"./naive.js?v=1769066082311";import{k,ae as C,P as D,r as z,c as $,a2 as U,V as j,a3 as P,W as M,U as S,ak as R,R as B,F as E,O as L,j as V,a4 as q,t as A,e as F,an as O,S as T}from"./vue.js?v=1769066082311";import{_ as W,e as G,d as H}from"./public.js?v=1769066082311";import{_ as I}from"./index.vue_vue_type_script_setup_true_lang.js?v=1769066082311";const J=k({__name:"index",props:{value:{default:()=>[]},valueModifiers:{}},emits:["update:value"],setup(e){const a=C(e,"value"),{t:s}=D(),i=z(null),n=z("all"),o=z(null),u=$(()=>""===n.value?"primary":"default"),r=$(()=>{if(""===n.value){const[e,t]=a.value;if(e!==t)return"".concat(l(e,"yyyy-MM-dd")," ~ ").concat(l(t,"yyyy-MM-dd"))}return s("Public.Search.CustomTime")}),_=e=>e>Date.now(),d=[{label:s("Public.All"),value:"all"},{label:s("Public.Search.Last7"),value:"l7"},{label:s("Public.Search.Last30"),value:"l30"}],m=e=>{switch(o.value=null,e){case"all":a.value=[];break;case"l7":a.value=[Date.now()-6048e5,Date.now()];break;case"l30":a.value=[Date.now()-2592e6,Date.now()]}},h=e=>{var l;e&&e[0]!==e[1]&&(n.value="",a.value=e,null==(l=i.value)||l.setShow(!1))},y=e=>{e||o.value&&o.value[0]===o.value[1]&&(o.value=null)};return(e,a)=>{const l=v,s=c,x=g,w=t,b=f,k=p;return j(),U(k,{size:8},{default:P(()=>[M(s,{value:S(n),"onUpdate:value":[a[0]||(a[0]=e=>R(n)?n.value=e:null),m],class:"bt-radio"},{default:P(()=>[(j(),B(E,null,L(d,e=>M(l,{key:e.value,value:e.value},{default:P(()=>[V(q(e.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"]),M(b,{ref_key:"popoverRef",ref:i,trigger:"click",placement:"bottom-end",style:{padding:0},"arrow-point-to-center":!0,"onUpdate:show":y},{trigger:P(()=>[M(x,{type:S(u)},{default:P(()=>[V(q(S(r)),1)]),_:1},8,["type"])]),default:P(()=>[M(w,{value:S(o),"onUpdate:value":[a[1]||(a[1]=e=>R(o)?o.value=e:null),h],type:"daterange",panel:!0,actions:null,"is-date-disabled":_},null,8,["value"])]),_:1},512)]),_:1})}}}),K={class:"p-20px"},N={key:0},Q={key:1},X=k({__name:"config",props:{info:{}},emits:["refresh"],setup(e,{expose:a,emit:l}){const t=e,o=l,{t:u}=D(),r=A(t,"info"),_=z(null),d=F({split_type:"day",split_hour:2,split_minute:2,save:180,split_size:10}),p={split_size:{trigger:["input","blur"],validator:()=>!("size"===d.split_type&&d.split_size<0)||new Error(u("Docker.Container.log.index_23"))},split_day:{trigger:["input","blur"],validator:()=>{if("day"===d.split_type){if(d.split_hour>23||d.split_hour<0)return new Error(u("Docker.Container.log.index_24"));if(d.split_minute>59||d.split_minute<0)return new Error(u("Docker.Container.log.index_25"))}return!0}},save:{trigger:["input","blur"],validator:()=>!(d.save>1800||d.save<0)||new Error(u("Docker.Container.log.index_26"))}},v=()=>{i("Path","/var/lib/docker/containers/history_logs"),window.location.href=window.location.origin+"/files"};return d.split_type=r.value.split_type,d.split_size=r.value.split_size,d.split_hour=r.value.split_hour,d.split_minute=r.value.split_minute,d.save=b(r.value.save),a({onConfirm:async()=>{var e;await(null==(e=_.value)?void 0:e.validate()),await n({pid:r.value.id,type:"add",log_path:r.value.logs_path,split_type:d.split_type,split_size:d.split_size,split_hour:d.split_hour,split_minute:d.split_minute,save:"".concat(d.save)}),o("refresh")}}),(e,a)=>{const l=s,t=m,i=h,n=c,o=x,u=w,r=y,f=I,g=W;return j(),B("div",K,[M(f,{ref_key:"formRef",ref:_,model:S(d),rules:p},{default:P(()=>[M(t,{label:e.$t("Docker.Container.log.index_8")},{default:P(()=>[a[5]||(a[5]=T("div",{class:"mr-16px"},"/var/lib/docker/containers/history_logs",-1)),M(l,{onClick:v},{default:P(()=>[V(q(e.$t("Docker.Container.log.index_9")),1)]),_:1})]),_:1,__:[5]},8,["label"]),M(t,{label:e.$t("Docker.Container.log.index_10")},{default:P(()=>[M(n,{value:S(d).split_type,"onUpdate:value":a[0]||(a[0]=e=>S(d).split_type=e)},{default:P(()=>[M(i,{value:"size"},{default:P(()=>[V(q(e.$t("Docker.Container.log.index_11")),1)]),_:1}),M(i,{value:"day"},{default:P(()=>[V(q(e.$t("Docker.Container.log.index_12")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),"size"===S(d).split_type?(j(),U(t,{key:0,label:e.$t("Docker.Container.log.index_13"),path:"split_size"},{default:P(()=>[M(r,{class:"w-120px"},{default:P(()=>[M(o,{value:S(d).split_size,"onUpdate:value":a[1]||(a[1]=e=>S(d).split_size=e),min:0,"show-button":!1},null,8,["value"]),M(u,null,{default:P(()=>a[6]||(a[6]=[V("MB",-1)])),_:1,__:[6]})]),_:1})]),_:1},8,["label"])):O("",!0),"day"===S(d).split_type?(j(),U(t,{key:1,label:e.$t("Docker.Container.log.index_14"),path:"split_day"},{default:P(()=>[M(r,{class:"w-auto"},{default:P(()=>[M(u,null,{default:P(()=>[V(q(e.$t("Docker.Container.log.index_15")),1)]),_:1})]),_:1}),M(r,{class:"w-120px ml-12px"},{default:P(()=>[M(o,{value:S(d).split_hour,"onUpdate:value":a[2]||(a[2]=e=>S(d).split_hour=e),min:0,max:23,"show-button":!1},null,8,["value"]),M(u,null,{default:P(()=>[V(q(e.$t("Docker.Container.log.index_16")),1)]),_:1})]),_:1}),M(r,{class:"w-120px ml-12px"},{default:P(()=>[M(o,{value:S(d).split_minute,"onUpdate:value":a[3]||(a[3]=e=>S(d).split_minute=e),min:0,max:59,"show-button":!1},null,8,["value"]),M(u,null,{default:P(()=>[V(q(e.$t("Docker.Container.log.index_17")),1)]),_:1})]),_:1})]),_:1},8,["label"])):O("",!0),M(t,{label:e.$t("Docker.Container.log.index_18"),path:"save"},{default:P(()=>[M(r,{class:"w-120px"},{default:P(()=>[M(o,{value:S(d).save,"onUpdate:value":a[4]||(a[4]=e=>S(d).save=e),min:0,max:1800,"show-button":!1},null,8,["value"]),M(u,null,{default:P(()=>[V(q(e.$t("Docker.Container.log.index_19")),1)]),_:1})]),_:1})]),_:1},8,["label"])]),_:1},8,["model"]),M(g,{class:"mt-8px"},{default:P(()=>["size"===S(d).split_type?(j(),B("li",N,q(e.$t("Docker.Container.log.index_20")),1)):O("",!0),"day"===S(d).split_type?(j(),B("li",Q,q(e.$t("Docker.Container.log.index_21")),1)):O("",!0),T("li",null,q(e.$t("Docker.Container.log.index_22")),1)]),_:1})])}}}),Y={class:"h-540px"},Z=k({__name:"index",props:{id:{default:""}},setup(l,{expose:t}){const s=A(l,"id"),{t:i}=D(),n=F({time_search:[]}),c=z({logs:i("Docker.Container.log.index_4"),split_status:!1,split_type:"",split_size:0,split_hour:0,split_minute:0,save:"",id:"",name:"",logs_path:"",size:0}),v=G(i("Docker.Container.log.index_5"),{info:c.value,onRefresh:()=>{h()}}),{loading:f,setLoading:m}=H(),h=async()=>{if(s.value)try{m(!0),c.value.logs="";const{message:e}=await o(0===n.time_search.length?{id:s.value}:{id:s.value,time_search:n.time_search.map(e=>Math.round(e/1e3))});u(e)&&(c.value=e,c.value.logs=e.logs||i("Docker.Container.log.index_4"))}finally{m(!1)}},y=()=>{h()},x=()=>{const e=_();window.open("".concat(e,"/download?filename=").concat(c.value.logs_path))},w=async()=>{await d({log_path:c.value.logs_path}),h()},b=()=>{h()};return h(),t({getContent:h}),(l,t)=>{const s=p,i=r,o=g,u=J,_=a,d=e;return j(),B("div",null,[O("",!0),O("",!0),M(s,{class:"mb-16px",justify:"space-between"},{default:P(()=>[M(s,{class:"items-center"},{default:P(()=>[M(o,{onClick:y},{default:P(()=>[V(q(l.$t("Public.Btn.Refresh")),1)]),_:1}),M(i,{class:"mx-0!",vertical:""}),M(o,{onClick:x},{default:P(()=>[V(q(l.$t("Public.Btn.Download")),1)]),_:1}),M(o,{onClick:w},{default:P(()=>[V(q(l.$t("Public.Btn.Clear")),1)]),_:1})]),_:1}),M(u,{value:S(n).time_search,"onUpdate:value":[t[1]||(t[1]=e=>S(n).time_search=e),b]},null,8,["value"])]),_:1}),T("div",Y,[M(_,{class:"h-full",lang:"log","font-size":"12",loading:S(f),content:S(c).logs},null,8,["loading","content"])]),M(d,{show:S(v).show,"onUpdate:show":t[2]||(t[2]=e=>S(v).show=e),title:S(v).title,data:S(v).data,width:520,footer:!0,component:X},null,8,["show","title","data"])])}}});export{Z as _};
