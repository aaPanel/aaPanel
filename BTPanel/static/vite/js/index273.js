import{_ as e,c as a,f as l,a as t,d as n,h as s,u as i}from"./public.js?v=1769066082311";import{eq as o,aN as u,u as d,_ as r,m as c,er as p,X as v,p as m,aL as f,o as x,T as _,d as g}from"./page_layout.js?v=1769066082311";import{k as b,e as w,r as S,R as y,V as h,W as P,a3 as k,U as $,S as I,a4 as C,a0 as j,P as H,o as N,n as U,b as B,j as O,ak as z,c as A,w as E,a2 as L,an as T}from"./vue.js?v=1769066082311";import{j as q,k as R}from"./php.js?v=1769066082311";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang.js?v=1769066082311";import{dS as W,dW as D,db as F,d9 as M,dV as X,dU as G,dk as J}from"./naive.js?v=1769066082311";import{L as K}from"./leader-line-vue.js?v=1769066082311";const Q={class:"p-16px"},Y=b({__name:"server-select",props:{callBack:{type:Function,default:()=>{}}},setup(a,{expose:l}){const t=a,n=w({webServer:"nginx"}),s=S([{label:"Nginx",value:"nginx"},{label:"Apache",value:"apache"},{label:"Openlitespeed",value:"openlitespeed"}]);return l({onConfirm:async()=>{await o({status:"disable",reserve:n.webServer}),t.callBack()}}),(a,l)=>{const t=D,i=W,o=V,u=e;return h(),y("div",Q,[P(o,{class:"my-16px",model:$(n)},{default:k(()=>[P(i,{label:a.$t("Soft.Plugin.index_8")},{default:k(()=>[P(t,{class:"w-300px!",value:$(n).webServer,"onUpdate:value":l[0]||(l[0]=e=>$(n).webServer=e),options:$(s)},null,8,["value","options"])]),_:1},8,["label"])]),_:1},8,["model"]),P(u,null,{default:k(()=>[I("li",null,C(a.$t("Soft.Plugin.index_18")),1)]),_:1})])}}}),Z={class:"p-16px"},ee={class:"border-view mb-20px",id:"nginx-select"},ae={class:"border-view",id:"proxy-select"},le={class:"flex items-center my-20px"},te={class:"mr-10px"},ne={class:"w-280px"},se={class:"w-280px"},ie=m(b({__name:"version-select",setup(a,{expose:l}){const t=u(),{webserver:n}=j(t),{t:s}=H(),i=d(),o=S(1),m=S([{name:"Nginx",icon:"nginx",value:"1.24",version:[{label:"Nginx 1.24",value:"1.24"},{label:"Nginx 1.25",value:"1.25"},{label:"Nginx 1.26",value:"1.26"},{label:"Nginx 1.27",value:"1.27"},{label:"Nginx 1.28",value:"1.28"}],disabled:!1},{name:"Apache",icon:"apache",value:"2.4",version:[{label:"Apache 2.4",value:"2.4"}],disabled:!1},{name:"Openlitespeed",icon:"openlitespeed",value:"1.8",version:[{label:"Openlitespeed 1.8",value:"1.8"}],disabled:!1}]);let f=null;N(async()=>{await t.getPHPConfig(),await U(),m.value.forEach(e=>{e.icon===n.value&&(e.disabled=!0)}),setTimeout(()=>{(()=>{const e=document.getElementById("nginx-select"),a=document.getElementById("proxy-select");e&&a?f=K.setLine(e,a,{color:"var(--color-border)",size:2,path:"grid",startSocket:"right",endSocket:"right"}):console.warn("Elements not found, will retry on mounted")})()},500)}),B(()=>{f&&f.remove()});return l({onConfirm:async()=>{const e=c.loading(s("Home.Install.index_13"));try{const e=m.value.filter(e=>e.disabled);for(const a of m.value)e.includes(a)||await p({sName:a.icon,version:a.value,type:o.value,id:50,Skip:!0});await v(),i.getConfigSimple()}finally{e.close()}}}),(a,l)=>{const t=r,n=D,s=F,i=X,u=M,d=G,c=e;return h(),y("div",Z,[I("div",ee,[P(s,{class:"flex-nowrap! items-center"},{default:k(()=>[P(t,{name:"soft-".concat($(m)[0].icon),size:"32"},null,8,["name"]),P(n,{value:$(m)[0].value,"onUpdate:value":l[0]||(l[0]=e=>$(m)[0].value=e),options:$(m)[0].version,disabled:$(m)[0].disabled},null,8,["value","options","disabled"])]),_:1})]),I("div",ae,[P(s,{class:"flex-nowrap! items-center"},{default:k(()=>[P(t,{name:"soft-".concat($(m)[1].icon),size:"32"},null,8,["name"]),P(n,{value:$(m)[1].value,"onUpdate:value":l[1]||(l[1]=e=>$(m)[1].value=e),options:$(m)[1].version,disabled:$(m)[1].disabled},null,8,["value","options","disabled"])]),_:1}),P(s,{class:"flex-nowrap! items-center mt-12px"},{default:k(()=>[P(t,{name:"soft-".concat($(m)[2].icon),size:"32"},null,8,["name"]),P(n,{value:$(m)[2].value,"onUpdate:value":l[2]||(l[2]=e=>$(m)[2].value=e),options:$(m)[2].version,disabled:$(m)[2].disabled},null,8,["value","options","disabled"])]),_:1})]),I("div",le,[I("span",te,C(a.$t("Home.Install.index_4")),1),P(d,{value:$(o),"onUpdate:value":l[3]||(l[3]=e=>z(o)?o.value=e:null)},{default:k(()=>[P(u,{trigger:"hover"},{trigger:k(()=>[P(i,{value:1},{default:k(()=>[O(C(a.$t("Home.Install.index_5")),1)]),_:1})]),default:k(()=>[I("div",ne,C(a.$t("Home.Install.index_6")),1)]),_:1}),P(u,{trigger:"hover"},{trigger:k(()=>[P(i,{value:0},{default:k(()=>[O(C(a.$t("Home.Install.index_7")),1)]),_:1})]),default:k(()=>[I("div",se,C(a.$t("Home.Install.index_8")),1)]),_:1})]),_:1},8,["value"])]),P(c,{class:"mt-10px"},{default:k(()=>[I("li",null,C(a.$t("Soft.Plugin.index_19")),1)]),_:1})])}}}),[["__scopeId","data-v-4bcfd2a2"]]),oe=m(b({__name:"index",setup(o,{expose:u}){const{t:r}=H(),c=d(),{isMultiServiceInstall:p,taskCount:v}=j(c),m=S(!1),b=A(()=>v.value>0&&p.value),{table:w,columns:y}=a([{key:"webserver",title:r("Soft.Plugin.index_8")},{key:"status",title:r("Soft.Plugin.index_9"),render:e=>P("span",{class:e.status?"text-primary":"text-error"},[e.status?r("Soft.Plugin.index_10"):r("Soft.Plugin.index_11")])},l({width:190,options:e=>[{label:r("Home.index_7"),onClick:()=>{t({title:r("Home.index_7"),content:"The restart process will make the website inaccessible. Do you want to continue?",onConfirm:async()=>{await f({name:e.name,type:"restart"})}})}},{label:r("Soft.Plugin.index_12"),onClick:()=>{U(e.name)}}]})]),N=async e=>{i(e?{title:r("Soft.Plugin.index_14"),width:400,footer:!0,component:ie}:{title:r("Soft.Plugin.index_13"),width:480,footer:!0,data:{callBack:()=>{V(),c.getConfigSimple()}},component:Y})},U=async e=>{t({title:r("Soft.Plugin.index_15"),content:r("Soft.Plugin.index_16"),onConfirm:async()=>{await q({server:e})}})},{loading:B,setLoading:z}=n();E(()=>b.value,e=>{e||V()});const V=async()=>{try{z(!0);const{message:e}=await R();g(e)&&(m.value=e.status,w.data=Object.entries(e).filter(([e])=>"status"!==e).map(([e,a])=>({webserver:e.charAt(0).toUpperCase()+e.slice(1),name:e,status:a})))}finally{z(!1)}};return V(),u({init:V}),(a,l)=>{const t=J,n=F,i=x,o=e,u=s,d=_;return h(),L(d,{show:$(B)||$(b),description:$(b)?a.$t("Soft.Plugin.index_2"):""},{default:k(()=>[P(n,{class:"items-center mt-10px"},{default:k(()=>[I("span",null,C(a.$t("Soft.Plugin.index_17")),1),P(t,{value:$(m),"onUpdate:value":N,disabled:$(b)},null,8,["value","disabled"])]),_:1}),P(o,{class:"my-16px"},{default:k(()=>[I("li",null,[O(C(a.$t("Soft.Plugin.index_3"))+" ",1),l[0]||(l[0]=I("span",{class:"text-warning"},"8188, 8189, 8190, 8288, 8289, 8290, 80, 443",-1))]),I("li",null,C(a.$t("Soft.Plugin.index_4")),1),I("li",null,C(a.$t("Soft.Plugin.index_5")),1),l[1]||(l[1]=I("li",null,[O("If one of the services fails to start, click "),I("b",null,"Repair"),O(" to repair it.")],-1)),I("li",null,[O(C(a.$t("Soft.Plugin.index_6")),1),P(i,{class:"ml-5px",target:"_blank",href:"https://www.aapanel.com/docs/faq/multi-webserver_hosting.html"},{default:k(()=>[O(C(a.$t("Soft.Plugin.index_7")),1)]),_:1})])]),_:1,__:[1]}),$(m)?(h(),L(u,{key:0,data:$(w).data,columns:$(y),loading:$(B)},null,8,["data","columns","loading"])):T("",!0)]),_:1},8,["show","description"])}}}),[["__scopeId","data-v-030ea397"]]);export{oe as O};
