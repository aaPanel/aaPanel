import{k as e,P as a,W as t,w as l,R as s,V as n,a3 as i,U as o,ak as r,an as d,j as u,a4 as c,a2 as m,r as v,e as p,a0 as _,S as h,F as x,O as f,au as k,H as g,I as w,b as y,a6 as b,l as C,v as T,o as j}from"./vue.js?v=1769066082311";import{dp as U,m as E,x as S,_ as I,p as L}from"./page_layout.js?v=1769066082311";import{c as R,f as F,a as $,h as D,d as P,e as q,i as z}from"./public.js?v=1769066082311";import{_ as B}from"./index114.js?v=1769066082311";import{_ as A}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1769066082311";import{o as H,d as K,g as O,s as V,l as W,e as X,a as Y,u as G,b as J,c as M,T as N}from"./terminal2.js?v=1769066082311";import{aC as Q,dS as Z,au as ee,db as ae,dT as te}from"./naive.js?v=1769066082311";import{_ as le}from"./index.js?v=1769066082311";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1769066082311";import{_ as ne}from"./index.vue_vue_type_script_setup_true_lang.js?v=1769066082311";import"./__commonjsHelpers__.js?v=1769066082311";import"./common.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1769066082311";import"./xterm.js?v=1769066082311";import"./xterm-addon-canvas.js?v=1769066082311";const ie=e({__name:"index",setup(e,{expose:m}){const{t:v}=a(),p=U(),{keys:_,columns:h}=R([{key:"host",title:v("Term.index_8"),ellipsis:{tooltip:{width:"trigger"}},render:e=>t("span",{class:"cursor-pointer w-100%",onClick:()=>f(e)},[e.host])},F({width:130,options:e=>[{label:v("Site.TableOP.index_7"),onClick:()=>{const a={title:v("Term.index_22"),data:{isEdit:!0,row:e}};H(a)}},{label:v("Public.Btn.Del"),onClick:()=>{$({title:v("Term.index_6"),content:v("Term.index_7",[e.host]),onConfirm:async({hide:a})=>{await K({host:e.host}),k(),a()}})}}]})]),x=()=>{const e={title:v("Term.index_19"),data:{isEdit:!1}};H(e)},f=e=>{p.server={...e,time:new Date}},k=async()=>{await O()};return l(()=>p.isRefresh,e=>{e&&(p.setRefresh(!1),k())}),m({init:k}),(e,a)=>{const l=Q,m=D,v=A;return n(),s("div",null,[t(v,null,{toolsLeft:i(()=>[t(l,{type:"primary",onClick:x},{default:i(()=>[u(c(e.$t("Term.index_19")),1)]),_:1})]),toolsRight:i(()=>[d("",!0)]),table:i(()=>[t(m,{"checked-row-keys":o(_),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>r(_)?_.value=e:null),loading:o(W),"max-height":"calc(100vh - 250px)",data:o(V),columns:o(h)},null,8,["checked-row-keys","loading","data","columns"])]),_:1})])}}}),oe={class:"p-20px"},re=e({__name:"form",props:{data:{}},setup(e,{expose:l}){const{t:r}=a(),d=e,{isEdit:u,row:c,getList:m}=d.data,_=v(null),h=p({name:"",content:""}),x={name:{required:!0,message:r("Security.Conf.Index_28"),trigger:["blur","input"]},content:{required:!0,message:r("Security.Conf.Index_28"),trigger:["blur","input"]}};return u&&c&&(h.name=c.title,h.content=c.shell),l({onConfirm:async({hide:e})=>{var a;await(null==(a=_.value)?void 0:a.validate()),u?await X({shell:h.content,title:c?c.title:"",new_title:h.name}):await Y({shell:h.content,title:h.name}),null==m||m(),e()}}),(e,a)=>{const l=ee,r=Z,d=ne;return n(),s("div",oe,[t(d,{ref_key:"formRef",ref:_,model:o(h),rules:x},{default:i(()=>[t(r,{label:e.$t("Docker.Compose.form.index_3"),path:"name"},{default:i(()=>[t(l,{class:"w-280px!",value:o(h).name,"onUpdate:value":a[0]||(a[0]=e=>o(h).name=e),placeholder:e.$t("Term.idnex_1")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(r,{label:e.$t("Docker.LocalImage.build_5"),path:"content"},{default:i(()=>[t(l,{class:"w-280px!",type:"textarea",rows:6,value:o(h).content,"onUpdate:value":a[1]||(a[1]=e=>o(h).content=e),placeholder:e.$t("Term.index_2")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])])}}}),de=e({__name:"index",setup(e,{expose:l}){const{t:d}=a(),m=U(),{terminals:p}=G(),_=v(""),h=v([]),{loading:x,setLoading:f}=P(),k=()=>{_.value?w.data=h.value.filter(e=>e.title.includes(_.value)):w.data=h.value},{keys:g,table:w,columns:y}=R([{key:"title",title:d("Term.index_4"),sorter:"default",ellipsis:{tooltip:{width:"trigger"}},render:e=>t("span",{class:"cursor-pointer w-100%",onClick:()=>{var a;a=e.shell,z(a)}},[e.title])},F({width:170,options:e=>[{label:d("Run"),onClick:()=>{p.value.length?m.setCommand(e.shell):E.error(d("There are currently no activated terminals"))}},{label:d("file.paste"),onClick:()=>{p.value.length?m.setCommand(e.shell,!1):E.error(d("There are currently no activated terminals"))}},{label:d("Public.Btn.Edit"),onClick:()=>{j(e)}},{label:d("Public.Btn.Del"),onClick:()=>{$({title:d("Term.index_20"),content:d("Term.index_21",[e.title]),onConfirm:async({hide:a})=>{await J({title:e.title}),b(),a()}})}}]})]),b=async()=>{try{f(!0);const{message:e}=await M();S(e)&&(h.value=e,w.data=e)}finally{g.value=[],f(!1)}},C=q(d("Term.index_3"),{isEdit:!1,getList:b}),T=()=>{C.data.isEdit=!1,C.title=d("Term.index_3"),C.show=!0},j=e=>{C.data.row=e,C.data.isEdit=!0,C.title=d("Term.index_5"),C.show=!0};return b(),l({init:b}),(e,a)=>{const l=Q,d=se,m=D,v=A,p=le;return n(),s("div",null,[t(v,null,{toolsLeft:i(()=>[t(l,{type:"primary",onClick:T},{default:i(()=>[u(c(e.$t("Term.index_3")),1)]),_:1})]),toolsRight:i(()=>[t(d,{class:"w-180px!",value:o(_),"onUpdate:value":[a[0]||(a[0]=e=>r(_)?_.value=e:null),k],placeholder:e.$t("Term.index_4"),clearable:""},null,8,["value","placeholder"])]),table:i(()=>[t(m,{"checked-row-keys":o(g),"onUpdate:checkedRowKeys":a[1]||(a[1]=e=>r(g)?g.value=e:null),loading:o(x),"max-height":"calc(100vh - 250px)",data:o(w).data,columns:o(y)},null,8,["checked-row-keys","loading","data","columns"])]),_:1}),t(p,{show:o(C).show,"onUpdate:show":a[2]||(a[2]=e=>o(C).show=e),title:o(C).title,data:o(C).data,width:480,footer:!0,component:re},null,8,["show","title","data"])])}}}),ue=e({__name:"index",setup(e){const{t:l}=a(),i=v("server"),d=[{key:"server",label:l("Term.index_23"),component:ie},{key:"command",label:l("Term.index_24"),component:de}];return(e,a)=>{const l=B;return n(),s("div",null,[t(l,{class:"w-300px!",value:o(i),"onUpdate:value":a[0]||(a[0]=e=>r(i)?i.value=e:null),options:d},null,8,["value"])])}}}),ce=["onClick","onContextmenu"],me=["title"],ve=["onClick"],pe=L(e({__name:"menu",setup(e){const l=U(),{isFull:r}=_(l),{activeTerminalId:p,terminals:y,setActiveTerminal:b,onServerList:C}=G(),{t:T}=a(),j=v(0),E=v(0),S=v({id:"",host:"",port:0,ps:"",state:!1}),L=v(!1),R=["Copy session","Close session","Close to right","Close other"],F=()=>{const e={title:T("Term.index_19"),data:{isEdit:!1}};H(e)},$=e=>{var a;const t=p.value===e,l=y.value.findIndex(a=>a.id===e);if(y.value=y.value.filter(a=>a.id!==e),t&&y.value.length>0){const e=l>0?l-1:0;p.value=(null==(a=y.value[e])?void 0:a.id)||"aaaaaaaaa"}else 0===y.value.length&&(p.value="aaaaaaaaa")};return document.addEventListener("click",()=>{L.value=!1}),(e,a)=>{const l=I,v=ae;return n(),m(v,{class:"head gap-0! xterm-head"},{default:i(()=>[(n(!0),s(x,null,f(o(y),e=>(n(),s("div",{key:e.id,class:g(["item",{"item-active":o(p)===e.id}]),onClick:a=>o(b)(e.id),onContextmenu:k(a=>{return t=a,l=e,S.value=l,j.value=t.clientX,E.value=t.clientY,void(L.value=!0);var t,l},["prevent"])},[h("div",{class:"text",title:e.ps},[h("span",{class:g(["icon",{"icon-active":!e.state}])},null,2),u(c(e.ps?e.ps:e.host),1)],8,me),t(l,{name:"base-close",class:"close-terminal",size:16,onClick:k(a=>$(e.id),["stop"])},null,8,["onClick"])],42,ce))),128)),h("div",{class:"add-terminal",onClick:F},[t(l,{name:"base-add",size:24})]),h("div",{class:"absolute right-0px add-terminal",onClick:a[0]||(a[0]=e=>r.value=!o(r))},[t(l,{name:"base-full",size:24})]),o(L)?(n(),s("div",{key:0,class:"context-menu",style:w({top:o(E)+"px",left:o(j)+"px"})},[h("ul",null,[(n(),s(x,null,f(R,(e,a)=>h("li",{key:a,onClick:a=>(e=>{if(!S.value)return;let a;switch(e){case"Copy session":C(S.value);break;case"Close session":$(S.value.id);break;case"Close to right":a=y.value.findIndex(e=>e.id===S.value.id),-1!==a&&(y.value.splice(a+1),setTimeout(()=>{var e;b((null==(e=y.value[a])?void 0:e.id)||"aaaaaaaaa")},20));break;case"Close other":y.value=y.value.filter(e=>e.id===S.value.id),setTimeout(()=>{b(S.value.id)},20)}L.value=!1})(e)},c(e),9,ve)),64))])],4)):d("",!0)]),_:1})}}}),[["__scopeId","data-v-48cd70b1"]]),_e={class:"terminal bg-#333333"},he=L(e({__name:"index",setup(e){const a=U(),{server:r,isShow:d}=_(a),{activeTerminalId:u,terminals:c,setActiveTerminal:v,onServerList:p,onUpdateState:k,resetTerminals:w}=G();return l(()=>r.value,e=>{null!==e&&p(e)},{deep:!0}),y(()=>{w()}),(e,a)=>{const l=ae;return n(),m(l,{vertical:"",class:"gap-0!"},{default:i(()=>[t(pe),h("div",_e,[(n(),m(b,null,[(n(!0),s(x,null,f(o(c),e=>C((n(),m(N,{key:e.id,data:e,active:o(u)===e.id,onUpdateFull:o(v),onUpdateState:o(k)},null,8,["data","active","onUpdateFull","onUpdateState"])),[[T,e.id===o(u)]])),128))],1024)),h("div",{class:g(["terminal-contract-tool",{active:!o(d)}]),onClick:a[0]||(a[0]=e=>d.value=!o(d))},null,2)])]),_:1})}}}),[["__scopeId","data-v-79cb6909"]]),xe={class:"p-16px box"},fe=L(e({__name:"index",setup(e){const a=U(),{isShow:r,isFull:d}=_(a),u=v(null);l(()=>d.value,e=>{var a;e?(r.value=!1,null==(a=u.value)||a.requestFullscreen()):document.exitFullscreen().catch(e=>{console.log(e.message)})});const c=()=>{document.fullscreenElement?d.value=!0:d.value=!1};return j(()=>{document.addEventListener("fullscreenchange",c)}),y(()=>{document.removeEventListener("fullscreenchange",c)}),(e,a)=>{const l=ae,d=te;return n(),s("div",xe,[t(d,{class:"p-16px h-100%"},{default:i(()=>[h("div",{class:"h-100%",ref_key:"contentRef",ref:u},[t(l,{class:"flex-nowrap! h-100%"},{default:i(()=>[t(he,{class:"flex-1 overflow-hidden"}),C(t(ue,null,null,512),[[T,o(r)]])]),_:1})],512)]),_:1})])}}}),[["__scopeId","data-v-57762b9d"]]);export{fe as default};
