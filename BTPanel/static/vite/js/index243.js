import{_ as e}from"./index135.js?v=1767769852656";import{d as t,_ as a}from"./public.js?v=1767769852656";import{u as s,T as o,_ as r,q as l,o as i,n as p,d as n,p as u}from"./page_layout.js?v=1767769852656";import{_ as c}from"./logo.js?v=1767769852656";import{u as y}from"./useOperate.js?v=1767769852656";import{J as f,K as d}from"./php.js?v=1767769852656";import{u as m}from"./index244.js?v=1767769852656";import{k as _,ad as v,ae as x,R as b,V as h,a2 as g,an as T,W as k,a3 as j,j as w,a4 as S,P as A,a0 as $,c as q,r as C,e as L,aG as P,o as U,a5 as V,U as M,F as R,O as W,S as I}from"./vue.js?v=1767769852656";import{_ as z}from"./index.vue_vue_type_script_setup_true_lang14.js?v=1767769852656";import{dT as O,e1 as B,da as D,aC as G,G as F}from"./naive.js?v=1767769852656";import"./common.js?v=1767769852656";import"./__commonjsHelpers__.js?v=1767769852656";import"./soft.js?v=1767769852656";import"./site.js?v=1767769852656";import"./useModal2.js?v=1767769852656";const H={class:"flex gap-4"},J=_({__name:"tren-type",props:v({showSort:{type:Boolean,default:!0}},{sort:{default:"desc"},sortModifiers:{},type:{default:"traffic"},typeModifiers:{}}),emits:["update:sort","update:type"],setup(e){const t=x(e,"sort"),a=x(e,"type");return(s,o)=>{const r=B,l=O;return h(),b("div",H,[e.showSort?(h(),g(l,{key:0,value:t.value,"onUpdate:value":o[0]||(o[0]=e=>t.value=e),size:"small"},{default:j(()=>[k(r,{value:"desc"},{default:j(()=>[w(S(s.$t("Desc")),1)]),_:1}),k(r,{value:"asc"},{default:j(()=>[w(S(s.$t("Asc")),1)]),_:1})]),_:1},8,["value"])):T("",!0),k(l,{value:a.value,"onUpdate:value":o[1]||(o[1]=e=>a.value=e),size:"small"},{default:j(()=>[k(r,{value:"traffic"},{default:j(()=>[w(S(s.$t("Traffic")),1)]),_:1}),k(r,{value:"req_count"},{default:j(()=>[w(S(s.$t("Requests")),1)]),_:1}),k(r,{value:"ip_count"},{default:j(()=>o[2]||(o[2]=[w("IP",-1)])),_:1,__:[2]}),k(r,{value:"uv"},{default:j(()=>o[3]||(o[3]=[w("UV",-1)])),_:1,__:[3]}),k(r,{value:"pv"},{default:j(()=>o[4]||(o[4]=[w("PV",-1)])),_:1,__:[4]})]),_:1},8,["value"])])}}}),K=["textContent"],Y={key:1},E={class:"font-bold text-16px text-font2"},N={class:"text-font2"},Q={class:"text-font2"},X={class:"font-bold text-16px text-font2"},Z={class:"font-bold text-16px text-font2"},ee=u(_({__name:"index",props:{name:{type:String,default:""},showTops5:{type:Boolean,default:!0}},setup(u){const{t:_}=A(),{openMonitor:v}=y(),x=m(),O=s(),{siteMonitorStatus:B}=$(O),{webserver:H,isMonitorInstall:ee}=$(x),te=q(()=>"openlitespeed"!==H.value&&(ee.value||B.value)),ae=C(!1),se=u,oe=L({sort:"desc",top5Type:"traffic",trenType:"traffic"}),re={traffic:_("Traffic"),req_count:_("Requests"),ip_count:"IP",uv:"UV",pv:"PV"},le=C([]),ie=q(()=>re[oe.trenType]),pe=e=>"traffic"===e?"traffic_bytes":e,ne=(e,t)=>"traffic"===t?p(e):e,ue=L({today:{traffic_human:"-",req_count:"-",ip_count:"-",uv:"-",pv:"-"},yesterday:{traffic_human:"-",req_count:"-",ip_count:"-",uv:"-",pv:"-"},day_before:{traffic_human:"-",req_count:"-",ip_count:"-",uv:"-",pv:"-"}}),ce=[{key:"traffic_human",label:_("Traffic")},{key:"req_count",label:_("Requests")},{key:"ip_count",label:"IP"},{key:"uv",label:"UV"},{key:"pv",label:"PV"}],ye=P({grid:{left:150,right:50,top:20,bottom:20},tooltip:{trigger:"axis",backgroundColor:"var(--chart-tooltip-bg-color)",textStyle:{color:"var(--chart-tooltip-text-color)"},formatter:e=>{const t=Array.isArray(e)?e[0]:e,a=t.name||t.axisValueLabel||"",s=Array.isArray(t.value)?t.value[0]:t.value;return"".concat(a,"<br/>").concat(re[oe.top5Type],": ").concat(ne(s,oe.top5Type))}},xAxis:{type:"value",axisLabel:{formatter:e=>ne(e,oe.top5Type)}},yAxis:{type:"category",data:[],axisTick:{show:!1},axisLine:{show:!1},axisLabel:{width:130,overflow:"truncate",ellipsis:"...",lineHeight:18,margin:4,align:"right"}},series:[{type:"bar",data:[],barWidth:14,label:{show:!0,position:"right",color:"#666",formatter:e=>ne(e.value,oe.top5Type)},itemStyle:{color:"#20a53a",borderRadius:[0,6,6,0]}}]}),fe=P({grid:{left:80,right:30,top:20,bottom:20},tooltip:{trigger:"axis",backgroundColor:"var(--chart-tooltip-bg-color)",textStyle:{color:"var(--chart-tooltip-text-color)"},formatter:e=>{var t;const a=Array.isArray(e)?e[0]:e,s=a.name||a.axisValueLabel||"",o=Array.isArray(a.value)?null!=(t=a.value[1])?t:a.value[0]:a.value;return"".concat(s,"<br/>").concat(ie.value,": ").concat(ne(o,oe.trenType))}},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",axisLabel:{formatter:e=>ne(e,oe.trenType)}},series:[{type:"line",data:[],smooth:!0,symbol:"circle",symbolSize:6,itemStyle:{color:"#fff",borderColor:"#20a53a",borderWidth:2},lineStyle:{color:"#20a53a",width:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(32,165,58,0.35)"},{offset:1,color:"rgba(32,165,58,0.05)"}]}}}]}),de=()=>{var e;const t=pe(oe.trenType);fe.xAxis={...fe.xAxis,data:le.value.map(e=>e.date.substring(5))},fe.series=[{...null==(e=fe.series)?void 0:e[0],data:le.value.map(e=>e[t]||0)}]},{loading:me,setLoading:_e}=t(),ve=async()=>{try{let e;if(_e(!0),se.name){e=(await f({site_name:se.name})).message}else{e=(await d({metric:oe.top5Type,order:oe.sort})).message}n(e)&&(le.value=e.trend_7days.points,Object.assign(ue,e.overview_three_days),de(),se.name||(e=>{var t;ae.value=0===e.top5_sites.items.length;const a=pe(oe.top5Type);ye.yAxis={...ye.yAxis,data:e.top5_sites.items.map(e=>e.site).reverse()},ye.series=[{...null==(t=ye.series)?void 0:t[0],data:e.top5_sites.items.map(e=>e[a]||0).reverse()}]})(e))}finally{_e(!1)}};return U(()=>{"openlitespeed"!==H.value&&(ee.value||B.value)&&ve()}),(t,s)=>{const p=i,n=V("i18n-t"),u=D,y=r,f=G,d=F,m=l,_=a,x=o,A=e;return h(),g(A,{install:M(te)},{desc:j(()=>["openlitespeed"==M(H)?(h(),b("span",{key:0,textContent:S(t.$t("This feature is not currently supported by the OpenLiteSpeed service"))},null,8,K)):(h(),b("span",Y,[k(n,{keypath:"Please use {a} or enable Site Monitor in the Settings"},{a:j(()=>[k(p,{class:"font-bold",onClick:s[0]||(s[0]=e=>M(v)(se.name))},{default:j(()=>s[5]||(s[5]=[w("Website statistics-v2",-1)])),_:1,__:[5]})]),_:1})]))]),default:j(()=>[k(x,{class:"py-16px px-30px",show:M(me)},{default:j(()=>[k(u,{class:"justify-between!"},{default:j(()=>[(h(),b(R,null,W(ce,e=>k(u,{class:"flex-col! items-center",key:e.key},{default:j(()=>[I("span",null,[s[6]||(s[6]=I("span",{class:"circle"},null,-1)),I("span",null,S(e.label),1)]),I("span",E,S(M(ue).today[e.key]),1),I("span",N,S(t.$t("Public.Search.Yesterday"))+" "+S(M(ue).yesterday[e.key]),1),I("span",Q,S(t.$t("Day Before"))+" "+S(M(ue).day_before[e.key]),1)]),_:2},1024)),64)),k(u,{class:"flex-col! items-center justify-center! cursor-pointer",onClick:ve},{default:j(()=>[k(u,{class:"items-center",size:5},{default:j(()=>[k(y,{name:"base-refresh",color:"#20a53a"}),k(f,{type:"primary",text:""},{default:j(()=>[w(S(t.$t("Refresh")),1)]),_:1})]),_:1}),s[7]||(s[7]=I("img",{src:c,class:"w-40px h-40px"},null,-1))]),_:1,__:[7]})]),_:1}),se.showTops5?(h(),b(R,{key:0},[k(u,{class:"my-25px justify-between! items-center"},{default:j(()=>[I("div",X,S(t.$t("Today Top 5 Websites")),1),k(J,{sort:M(oe).sort,"onUpdate:sort":[s[1]||(s[1]=e=>M(oe).sort=e),ve],type:M(oe).top5Type,"onUpdate:type":[s[2]||(s[2]=e=>M(oe).top5Type=e),ve]},null,8,["sort","type"])]),_:1}),M(ae)?(h(),g(d,{key:0,class:"h-200px justify-center"})):(h(),g(z,{key:1,type:"bar",height:"200px",option:M(ye)},null,8,["option"]))],64)):T("",!0),k(u,{class:"my-25px justify-between! items-center"},{default:j(()=>[I("div",Z,S(t.$t("Last 7 Days Statistics")),1),k(J,{showSort:!1,type:M(oe).trenType,"onUpdate:type":[s[3]||(s[3]=e=>M(oe).trenType=e),de]},null,8,["type"])]),_:1}),k(z,{type:"line",height:"260px",option:M(fe)},null,8,["option"]),k(m),k(_,{class:"mt-10px"},{default:j(()=>[I("li",null,[w(S(t.$t("This is a simplified website statistics report. For more detailed data, please use"))+" ",1),k(f,{type:"primary",text:"",onClick:s[4]||(s[4]=e=>M(v)(se.name))},{default:j(()=>s[8]||(s[8]=[w("Website statistics-v2",-1)])),_:1,__:[8]})])]),_:1})]),_:1},8,["show"])]),_:1},8,["install"])}}}),[["__scopeId","data-v-dba23c8a"]]);export{ee as default};
