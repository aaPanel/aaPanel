import{_ as a}from"./index184.js?v=1752142539265";import{_ as e,a as t,d as n,c as s}from"./public.js?v=1752142539265";import{u as l,p as i,m as p,c as o,eB as d,d as u,e9 as r,e as m,w as c,eC as v,eD as _,eE as b,eF as h,eG as x,eH as y,eI as w}from"./page_layout.js?v=1752142539265";import{i as f,p as P,k as g,P as D,r as A,U as $,X as k,V as C,Q as j,a2 as S,j as U,a3 as B,W as N,e as H,an as I,ah as q,F as z,t as E}from"./vue.js?v=1752142539265";import{_ as F}from"./common.js?v=1752142539265";import{_ as L,ay as T,bR as M,cD as R,bX as X,cz as G,bZ as Q,c1 as V,aq as W,bN as Z}from"./naive.js?v=1752142539265";import{at as J}from"./site.js?v=1752142539265";import{_ as K}from"./index.vue_vue_type_script_setup_true_lang.js?v=1752142539265";import"./__commonjsHelpers__.js?v=1752142539265";const O=Symbol("php-admin");function Y(a,e,t,n){return new Promise((s=>{const l="".concat(a,"/index.php?lang=en"),i=document.createElement("form"),p='\n\t\t\t<input type="text" name="pma_username" id="pma_username" value="'.concat(t,'" />\n\t\t\t<input type="password" name="pma_password" id="pma_password" value="').concat(n,'" />\n\t\t\t<input type="text" name="server" value="1" />\n\t\t\t<input type="text" name="target" value="index.php" />\n\t\t\t<input type="text" name="db" id="db" value="').concat(e,'" />\n\t\t');i.action=l,i.setAttribute("public-data",l),i.method="post",i.target="_blank",i.style.display="none",i.innerHTML=p,document.body.appendChild(i),i.submit(),document.body.removeChild(i),s(i)}))}async function aa(a,e){const{data:t}=await F.get("/phpmyadmin/index.php?lang=en"),n={session:"",token:""},s=t.match(/"set_session"\s+value="(\w+)"/),l=t.match(/"token"\s+value="(\w+)"/);s&&s.length>1&&(n.session=s[1]||""),l&&l.length>1&&(n.token=l[1]||"");const i=document.createElement("form");i.action="/phpmyadmin/index.php",i.method="post",i.target="_blank",i.style.display="none";const p='\n\t\t<input  name="set_session" id="input_session" value="'.concat(n.session,'" />\n\t\t<input type="text" name="pma_username" id="pma_username" value="').concat(a,'" size="24" />\n\t\t<input type="password" name="pma_password" id="pma_password" value="').concat(e,'" size="24" />\n\t\t<input  name="token" id="input_token" value="').concat(n.token,'" />\n\t\t<input  name="target" id="input_target" value="index.php" />\n\t\t<input  name="server" value="1" id="input_server" />\n\t');i.innerHTML=p,document.body.appendChild(i),i.submit(),document.body.removeChild(i)}const ea={class:"p-4px"},ta={class:"mb-16px"},na={class:"text-error"},sa={class:"mt-20px"},la="phpmyadmin",ia=m(g({__name:"index",setup(a,{expose:s}){const{t:m}=D(),c=l(),{mysqlInfo:v}=f(O),_=A(!1),b=a=>{n({title:m("Database.PhpAdmin.index_12",[m(a?"Public.Status.Start":"Public.Status.Stop")]),content:m("Database.PhpAdmin.index_13",[m(a?"Public.Status.start":"Public.Status.stop")]),onConfirm:async()=>{await r({name:la,type:a?"start":"stop"}),x()}})},h=async a=>{const e=p.loading(m("Database.PhpAdmin.index_14"));try{const{message:n}=await o({sName:la}),s=M(n,"ext.url",""),l=M(n,"ext.auth",!1);if("panel"==a){if(l)return p.error(m("Database.PhpAdmin.index_15")),void e.close();if(c.isFree)return t({source:160}),void e.close();if(v.value)await aa(v.value.username,v.value.password);else{const{message:a}=await d(),e=M(a,"result","");await aa("root",e)}}else if(v.value)await Y(s,v.value.name,v.value.username,v.value.password);else{const{message:a}=await d(),e=M(a,"result","");await Y(s,"","root",e)}e.close()}catch(n){e.close(),console.error(n)}},x=async()=>{const{message:a}=await o({sName:la});u(a)&&(_.value=a.status)};return x(),s({init:x}),(a,t)=>{const n=L,s=e,l=i,p=T;return k(),$("div",ea,[C("div",ta,[j(n,{checked:N(_),"onUpdate:checked":b},{default:S((()=>[U(B(a.$t("Database.PhpAdmin.index_4")),1)])),_:1},8,["checked"])]),j(s,{class:"mb-20px"},{default:S((()=>[C("li",na,B(a.$t("Database.PhpAdmin.index_5")),1)])),_:1}),j(l,{dashed:""}),C("div",sa,[j(p,{onClick:t[0]||(t[0]=a=>h("panel"))},{default:S((()=>[C("span",null,B(a.$t("Database.PhpAdmin.index_11")),1),t[2]||(t[2]=C("span",{class:"bg-recommend"},null,-1))])),_:1,__:[2]}),j(p,{class:"ml-24px",onClick:t[1]||(t[1]=a=>h())},{default:S((()=>[U(B(a.$t("Database.PhpAdmin.index_6")),1)])),_:1})]),j(s,{class:"mt-16px"},{default:S((()=>[C("li",null,B(a.$t("Database.PhpAdmin.index_7")),1),C("li",null,B(a.$t("Database.PhpAdmin.index_8")),1),C("li",null,B(a.$t("Database.PhpAdmin.index_9")),1),C("li",null,B(a.$t("Database.PhpAdmin.index_10")),1)])),_:1})])}}}),[["__scopeId","data-v-d3598302"]]),pa={class:"w-160px"},oa=g({__name:"index",setup(a,{expose:e}){const{t:t}=D(),n=H({php_version:null}),l=A([]),{loading:i,setLoading:d}=s(),u=async()=>{try{d(!0);const[a,e]=await Promise.all([J(),o({sName:"phpmyadmin"})]),{message:t}=a;c(t)&&(l.value=t.map((a=>({label:a.name,value:a.version}))));const{message:s}=e;n.php_version=M(s,"ext.phpversion",null)}finally{d(!1)}},r=async()=>{const a=n.php_version;null!==a?(await v({phpversion:a}),u()):p.error(t("Database.PhpAdmin.index_32"))};return u(),e({init:u}),(a,e)=>{const t=R,s=T,p=X;return k(),$("div",null,[j(p,{class:"items-center"},{default:S((()=>[C("span",null,B(a.$t("Database.PhpAdmin.index_31")),1),C("div",pa,[j(t,{value:N(n).php_version,"onUpdate:value":e[0]||(e[0]=a=>N(n).php_version=a),loading:N(i),options:N(l)},null,8,["value","loading","options"])]),j(s,{type:"primary",onClick:r},{default:S((()=>[U(B(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1})])}}}),da={class:"p-4px"},ua={class:"w-142px mr-8px"},ra={class:"w-142px mr-8px"},ma={class:"w-240px"},ca={class:"w-240px"},va={class:"w-240px"},_a=g({__name:"index",setup(a,{expose:t}){const{t:s}=D(),l=A(null),d=A(!1),u=A(null),r=A(!1);let m=!1;const c=H({username:"",password:"",repass:""}),v=async()=>{const a=l.value;null!==a?(await _({port:a}),L()):p.error(s("Database.PhpAdmin.index_25"))},f=async a=>{await b({v:a?1:0}),X()},P=async()=>{const a=u.value;null!==a?(await h({port:a}),X()):p.error(s("Database.PhpAdmin.index_26"))},g=a=>{!a&&m?n({title:s("Public.Confirm.Title"),content:s("Database.PhpAdmin.index_27"),onConfirm:async()=>{await w(),L()}}):r.value=a},E=async()=>{""!==c.password.trim()&&""!==c.username.trim()?c.password.length<3||c.username.length<3?p.error(s("Database.PhpAdmin.index_29")):c.password===c.repass?(await x({username:c.username,password:c.password}),L()):p.error(s("Database.PhpAdmin.index_30")):p.error(s("Database.PhpAdmin.index_28"))},F=A(!1),L=async()=>{try{F.value=!0;const{message:a}=await o({sName:"phpmyadmin"}),e=M(a,"ext.port",null);l.value=e?Z(e):null,r.value=M(a,"ext.auth",!1),m=r.value}finally{F.value=!1}},R=A(!1),X=async()=>{try{R.value=!0;const{message:a}=await y();d.value=M(a,"status",!1);const e=M(a,"port",null);u.value=e?Z(e):null}finally{R.value=!1}},J=()=>{Promise.all([L(),X()])};return J(),t({init:J}),(a,t)=>{const n=Q,s=T,p=G,o=i,m=V,_=W,b=e,h=K;return k(),$("div",da,[j(h,{"label-width":"160"},{default:S((()=>[j(p,{label:a.$t("Database.PhpAdmin.index_16")},{default:S((()=>[C("div",ua,[j(n,{value:N(l),"onUpdate:value":t[0]||(t[0]=a=>q(l)?l.value=a:null),min:0,max:66325,"show-button":!1,loading:N(F),placeholder:""},null,8,["value","loading"])]),j(s,{type:"primary",onClick:v},{default:S((()=>[U(B(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1},8,["label"]),j(o,{dashed:""}),j(p,{class:"mt-20px",label:a.$t("Database.PhpAdmin.index_17")},{default:S((()=>[j(m,{value:N(d),loading:N(R),"onUpdate:value":f},null,8,["value","loading"])])),_:1},8,["label"]),j(p,{label:a.$t("Database.PhpAdmin.index_18")},{default:S((()=>[C("div",ra,[j(n,{value:N(u),"onUpdate:value":t[1]||(t[1]=a=>q(u)?u.value=a:null),min:0,max:66325,"show-button":!1,loading:N(R),placeholder:""},null,8,["value","loading"])]),j(s,{type:"primary",onClick:P},{default:S((()=>[U(B(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1},8,["label"]),j(o,{dashed:""}),j(p,{class:"mt-20px",label:a.$t("Database.PhpAdmin.index_19")},{default:S((()=>[j(m,{value:N(r),loading:N(F),"onUpdate:value":g},null,8,["value","loading"])])),_:1},8,["label"]),N(r)?(k(),$(z,{key:0},[j(p,{label:a.$t("Database.PhpAdmin.index_20")},{default:S((()=>[C("div",ma,[j(_,{value:N(c).username,"onUpdate:value":t[2]||(t[2]=a=>N(c).username=a),placeholder:a.$t("Database.PhpAdmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),j(p,{label:a.$t("Database.PhpAdmin.index_21")},{default:S((()=>[C("div",ca,[j(_,{value:N(c).password,"onUpdate:value":t[3]||(t[3]=a=>N(c).password=a),type:"password",placeholder:a.$t("Database.PhpAdmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),j(p,{label:a.$t("Database.PhpAdmin.index_22")},{default:S((()=>[C("div",va,[j(_,{value:N(c).repass,"onUpdate:value":t[4]||(t[4]=a=>N(c).repass=a),type:"password",placeholder:a.$t("Database.PhpAdmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),j(p,{label:" "},{default:S((()=>[j(s,{type:"primary",onClick:E},{default:S((()=>[U(B(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1})],64)):I("",!0),j(b,null,{default:S((()=>[C("li",null,B(a.$t("Database.PhpAdmin.index_24")),1)])),_:1})])),_:1})])}}}),ba={class:"h-580px"},ha=g({__name:"index",props:{row:{default:void 0}},setup(e){const t=E(e,"row"),{t:n}=D(),s=A("service"),l=[{key:"service",label:n("Database.PhpAdmin.index_1"),component:ia},{key:"php",label:n("Database.PhpAdmin.index_2"),component:oa},{key:"safe",label:n("Database.PhpAdmin.index_3"),component:_a}];return P(O,{mysqlInfo:t}),(e,t)=>{const n=a;return k(),$("div",ba,[j(n,{value:N(s),"onUpdate:value":t[0]||(t[0]=a=>q(s)?s.value=a:null),ref:"tabsRef",data:l},null,8,["value"])])}}});export{ha as default};
