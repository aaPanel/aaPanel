const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/map2d.js?v=1767769852656","js/vue.js?v=1767769852656","js/__commonjsHelpers__.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang14.js?v=1767769852656","js/page_layout.js?v=1767769852656","js/naive.js?v=1767769852656","js/common.js?v=1767769852656","js/public.js?v=1767769852656","css/public.css?v=1767769852656","css/page_layout.css?v=1767769852656","js/setting.js?v=1767769852656","js/index203.js?v=1767769852656","js/tools2.js?v=1767769852656","js/rules.js?v=1767769852656","css/map2d.css?v=1767769852656","js/map3d.js?v=1767769852656","js/echartsGl.js?v=1767769852656","js/echarts.js?v=1767769852656","js/interface.js?v=1767769852656","css/map3d.css?v=1767769852656"])))=>i.map(i=>d[i]);
import{s as e}from"./setting.js?v=1767769852656";import{Z as t,a0 as a,r as l,c as r,a2 as i,V as s,a3 as n,q as o,k as c,P as u,ae as d,y as v,R as p,W as f,U as _,ak as x,F as m,O as y,j as w,a4 as h,S as g,l as b,v as k,X as O,aG as W,Y as S,w as q,n as T,_ as $,an as j,a7 as C,I as L}from"./vue.js?v=1767769852656";import{aE as I,i as B,dl as A,aa as E,d as M,n as P,p as z,a7 as D,aI as U,x as F,k as G,c7 as N,q as H,o as K,a as R,aA as V}from"./page_layout.js?v=1767769852656";import{dS as Y,dT as X,e1 as Q,dh as Z,bH as J,aC as ee,dj as te,dc as ae,G as le,dY as re,dk as ie}from"./naive.js?v=1767769852656";import{k as se,c as ne,h as oe,a as ce,u as ue,f as de}from"./public.js?v=1767769852656";import{_ as ve}from"./index.vue_vue_type_script_setup_true_lang14.js?v=1767769852656";import{_ as pe}from"./index203.js?v=1767769852656";import{a as fe,b as _e,s as xe}from"./tools2.js?v=1767769852656";const me=()=>I.post("/btwaf/get_index_map.json"),ye=t("waf-overview-store",()=>{const e=l("today"),t=r(()=>{const t=A(e.value);return E(t,"yyyy-MM-dd")}),a=l(1),i=l(2),s=l(!0),n=l(!1),o=l({today_request:0,malicious_request:0,unprotected_site:0,unprotected_site_list:[],maybe_err_cc:0,maybe_err_cc_list:[],webshell:0,yesterday_request_total:0,yesterday_malicious_request:0}),c=l([]),u=l({qps:0,proxy_time:0,traffic:0,time:0}),d=l(0),v=l(0),p=l(!1),f=l([]),_=l([]),x=l([]),m=l([]),y=l([]),w=l([]),h=l([]),g=e=>{o.value=e.count,c.value=e.traffic_filter||[],u.value={qps:e.qps,time:e.time,traffic:Number(P(e.traffic,!1,2,"KB")),proxy_time:e.proxy_time},s.value=e.open,p.value=e["3D"],f.value=e.map||[],_.value=e.attack_details||[],x.value=e.server_name_top||[],m.value=e.traffic_top||[],y.value=e.url_top||[],w.value=e.type||[],h.value=e.attack_report_log||[]},b=t=>{u.value={qps:t.qps,time:t.time,traffic:Number(P(t.traffic,!1,2,"KB")),proxy_time:t.proxy_time},"today"===e.value&&(o.value.today_request=t.count.today_request,o.value.malicious_request=t.count.malicious_request),t.traffic_filter.length>0&&(c.value=t.traffic_filter),t.map.length>0&&(f.value=t.map),t.attack_details.length>0&&(_.value=t.attack_details),t.server_name_top.length>0&&(x.value=t.server_name_top),t.traffic_top.length>0&&(m.value=t.traffic_top),t.url_top.length>0&&(y.value=t.url_top),t.type.length>0&&(w.value=t.type),t.attack_report_log.length>0&&(h.value=t.attack_report_log)};return{startTime:e,queryStartTime:t,request:a,mapType:i,open:s,count:o,trafficFilter:c,realTime:u,qps:d,proxyTime:v,is3D:p,map:f,attackDetails:_,serverNameTop:x,trafficTop:m,urlTop:y,blockTypes:w,attackReportLogs:h,getInfo:async()=>{try{n.value=!0;const{message:l}=await(e={start_time:t.value,country:0,request:a.value},I.post("/btwaf/overview.json",e));M(l)&&g(l)}finally{n.value=!1}var e},getLoopInfo:async()=>{const{message:e}=await(a={start_time:t.value},I.post("/btwaf/new_overview.json",a));var a;M(e)&&b(e)}}},{persist:{pick:["request","mapType"]}}),we=()=>{const e=ye();return{store:e,...a(e)}};const he=z({},[["render",function(e,t){const a=Y;return s(),i(a,{class:"wap-card"},{header:n(()=>[o(e.$slots,"header",{},void 0,!0)]),"header-extra":n(()=>[o(e.$slots,"header-extra",{},void 0,!0)]),default:n(()=>[o(e.$slots,"default",{},void 0,!0)]),_:3})}],["__scopeId","data-v-ff288151"]]),ge={class:"flex"},be=z(c({__name:"query-date",props:{value:{default:"today"},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=u(),a=l("today"),r=l(null),i=d(e,"value"),o=[{label:t("Public.Search.Yesterday"),value:"yesterday"},{label:t("Public.Search.Today"),value:"today"}],c=e=>{i.value=e},g=e=>{a.value=e?"":"today",i.value=U(e)?E(e,"yyyy-MM-dd"):"today"};return v(()=>{o.map(e=>e.value).includes(i.value)?(a.value=i.value,r.value=null):(a.value="",r.value=new Date(i.value).getTime())}),(e,t)=>{const l=Q,i=X,u=D;return s(),p("div",ge,[f(i,{value:_(a),"onUpdate:value":[t[0]||(t[0]=e=>x(a)?a.value=e:null),c],size:"small",class:"bt-radio"},{default:n(()=>[(s(),p(m,null,y(o,e=>f(l,{key:e.value,value:e.value},{default:n(()=>[w(h(e.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"]),f(u,{value:_(r),"onUpdate:value":[t[1]||(t[1]=e=>x(r)?r.value=e:null),g],type:"date",size:"small",class:"bt-date-picker",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-e100fb9e"]]),ke={class:"text-desc text-12px leading-1"},Oe=z(c({__name:"auto-refresh",props:{show:{type:Boolean,default:!0},open:{type:Boolean,default:!0},seconds:{default:3},refresh:{}},setup(e){const t=e,a=t.seconds,r=l(0),o=l(a),c=l(!1),{loop:u}=se(async()=>{var e;if(0===o.value)try{c.value=!0,await(null==(e=t.refresh)?void 0:e.call(t))}finally{r.value=0,o.value=a,c.value=!1}else o.value-=1,r.value=(a-o.value)/a*100},1);return u(),(e,t)=>{const l=J,u=Z;return s(),i(u,{placement:"bottom"},{trigger:n(()=>[b(f(l,{class:"refresh-progress",type:"circle",status:"success",processing:_(c),"rail-color":"#e8e8e8","stroke-width":12,"offset-degree":180,percentage:_(r)},{default:n(()=>[g("span",ke,h(_(o)),1)]),_:1},8,["processing","percentage"]),[[k,e.show]])]),default:n(()=>[g("span",null,h(e.$t("Waf.Overview.index_8",[_(a)])),1)]),_:1})}}}),[["__scopeId","data-v-cdf03241"]]),We={class:"flex items-center justify-between h-50px px-16px"},Se=c({__name:"index",setup(e){const{store:t,startTime:a}=we(),l=()=>{t.getInfo()},r=async()=>{await t.getLoopInfo()};return(e,t)=>(s(),i(he,null,{default:n(()=>[g("div",We,[f(be,{value:_(a),"onUpdate:value":[t[0]||(t[0]=e=>x(a)?a.value=e:null),l]},null,8,["value"]),f(Oe,{show:"today"===_(a),refresh:r},null,8,["show"])])]),_:1}))}}),qe={class:"flex gap-16px h-160px"},Te={class:"flex-1"},$e={class:"card-title"},je={class:"card-value"},Ce={class:"card-trend"},Le={class:"card-yesterday"},Ie={class:"flex-1"},Be={class:"card-title"},Ae={class:"card-value"},Ee={class:"card-trend"},Me={class:"card-yesterday"},Pe=z(c({__name:"index",setup(e){const{count:t}=we(),a=e=>e.toLocaleString("en-US"),l=r(()=>{const e=100*(t.value.today_request/(t.value.yesterday_request_total||1)-1);return"".concat(e>0?"↑":"↓"," ").concat(e.toFixed(2),"%")}),i=r(()=>{const e=100*(t.value.malicious_request/(t.value.yesterday_malicious_request||1)-1);return"".concat(e>0?"↑":"↓"," ").concat(e.toFixed(2),"%")});return(e,r)=>(s(),p("div",qe,[g("div",Te,[f(he,{class:"request"},{default:n(()=>[g("div",$e,h(e.$t("Waf.Overview.index_1")),1),g("div",je,h(a(_(t).today_request)),1),g("div",Ce,h(_(l)),1),g("div",Le,h(e.$t("Public.Search.Yesterday"))+h(e.$t("Public.Punctuation.Colon"))+h(_(t).yesterday_request_total),1),r[0]||(r[0]=g("div",{class:"card-bg"},[g("i",{class:"i-waf:today"})],-1))]),_:1,__:[0]})]),g("div",Ie,[f(he,{class:"malicious-request"},{default:n(()=>[g("div",Be,h(e.$t("Waf.Overview.index_2")),1),g("div",Ae,h(a(_(t).malicious_request)),1),g("div",Ee,h(_(i)),1),g("div",Me,h(e.$t("Public.Search.Yesterday"))+h(e.$t("Public.Punctuation.Colon"))+h(_(t).yesterday_malicious_request),1),r[1]||(r[1]=g("div",{class:"card-bg"},[g("i",{class:"i-waf:malicious"})],-1))]),_:1,__:[1]})])]))}}),[["__scopeId","data-v-d7e87a24"]]),ze=(e,t,a,l)=>{const{t:r}=u(),i=O("--chart-tooltip-bg-color"),s=O("--color-text-2"),n=O("--color-border"),o=W({grid:{left:"4%",right:"10%",bottom:"0",top:"12%",containLabel:!0},tooltip:{trigger:"axis",backgroundColor:i.value,borderColor:"transparent",position:"right",textStyle:{color:s.value},formatter(e){if(!F(e)||0===e.length)return"";const t=e[0],a=G(t.axisValue),i=document.createElement("div"),s=f(m,null,[f("div",null,[r("Waf.Overview.index_22",[E(a)])]),f("div",null,[f("span",{class:"inline-block w-10px h-10px mr-10px rounded-full",style:{backgroundColor:"".concat(t.color)}},null),t.seriesName+": "+t.value+(l?" "+l:"")])]);return S(s,i),i}},xAxis:c(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:n.value}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:s.value},nameTextStyle:{color:s.value}},series:d()});function c(e=[]){return{type:"category",boundaryGap:!1,data:e,axisLabel:{color:s.value,formatter:e=>E(G(e),"HH:mm:ss")},nameTextStyle:{color:s.value},axisLine:{show:!0,lineStyle:{color:n.value}},axisTick:{show:!0,lineStyle:{color:n.value}}}}function d(e=[]){return[{name:a,type:"line",stack:"Total",data:e,itemStyle:{color:"#20a53a"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.4)"},{offset:.7,color:"rgba(32, 164, 58, 0)"}]}}}]}const v=[],p=[],_=async()=>{var e;await T(),v.length>0&&(e=v[0],(new Date).getTime()-e>6e4)&&(v.shift(),p.shift()),o.xAxis=c(v),o.series=d(p)};return q(()=>e.value,e=>{v.push(1e3*e.time),p.push(e[t]),_()},{deep:!0}),{chartOption:o}},De={class:"ml-6px"},Ue={class:"h-114px p-10px"},Fe=c({__name:"index",setup(e){const{realTime:t}=we(),{chartOption:a}=ze(t,"qps","QPS");return(e,l)=>(s(),i(he,null,{header:n(()=>[l[0]||(l[0]=g("i",{class:"i-waf:qps text-16px"},null,-1)),g("span",De,h(e.$t("Waf.Overview.index_21",[_(t).qps])),1)]),default:n(()=>[g("div",Ue,[f(ve,{type:"line",height:"100%",option:_(a)},null,8,["option"])])]),_:1}))}}),Ge={class:"ml-6px"},Ne={class:"h-114px p-10px"},He=c({__name:"index",setup(e){const{t:t}=u(),{realTime:a}=we(),{chartOption:l}=ze(a,"proxy_time",t("Waf.Overview.index_40"));return(e,t)=>(s(),i(he,null,{header:n(()=>[t[0]||(t[0]=g("i",{class:"i-waf:response text-16px"},null,-1)),g("span",Ge,h(e.$t("Waf.Overview.index_39",[_(a).proxy_time])),1)]),default:n(()=>[g("div",Ne,[f(ve,{type:"line",height:"100%",option:_(l)},null,8,["option"])])]),_:1}))}}),Ke={class:"ml-6px"},Re={class:"h-114px p-10px"},Ve=c({__name:"index",setup(e){const{t:t}=u(),{realTime:a}=we(),{chartOption:l}=ze(a,"traffic",t("Waf.Overview.index_41"),"KB/s");return(e,t)=>(s(),i(he,null,{header:n(()=>[t[0]||(t[0]=g("i",{class:"i-waf:site-traffic text-16px"},null,-1)),g("span",Ke,h(e.$t("Waf.Overview.index_81",[_(a).traffic])),1)]),default:n(()=>[g("div",Re,[f(ve,{type:"line",height:"100%",option:_(l)},null,8,["option"])])]),_:1}))}}),Ye={class:"ml-6px"},Xe={class:"h-176px p-16px"},Qe=c({__name:"index",setup(e){const{t:t}=u(),{store:a,trafficFilter:r}=we(),o=O("--chart-tooltip-bg-color"),c=O("--color-text-2"),d=O("--color-border"),p=()=>{a.getInfo()},x=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:c.value},nameTextStyle:{color:c.value},axisLine:{show:!0,lineStyle:{color:d.value}},axisTick:{show:!0,lineStyle:{color:d.value}}}),y=l([{name:t("Waf.Overview.index_5"),color:"#20a53a",value:[]},{name:t("Waf.Overview.index_4"),color:"#A0BFE0",value:[]},{name:t("Waf.Overview.index_41"),color:"#30aaf6ff",value:[]},{name:t("Waf.Overview.index_42"),color:"#78e1b9ff",value:[]}]),b=()=>y.value.map(e=>({name:e.name,type:"line",data:e.value,symbol:"none",sampling:"average",smooth:!0,showSymbol:!1,itemStyle:{color:e.color},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:N(e.color,.6)},{offset:1,color:N(e.color,0)}]}}})),k={BYTE:{factor:1,suffix:" Byte"},KB:{factor:1024,suffix:" KB"},MB:{factor:1048576,suffix:" MB"},GB:{factor:1024**3,suffix:" GB"}},q=(e,t)=>(e=>{const t=e.toFixed(2);return t.endsWith(".00")?parseInt(t).toString():t})(e/t.factor),T=e=>{const{flow:t,static_flow:a}=e,l=t-a,r=(i=t,Object.values(k).reverse().find(e=>i>=e.factor)||k.BYTE);var i;return{static_flow:q(a,r),dynamic_flow:q(l,r),tmp_size:r.suffix}},$=W({grid:{left:"2%",right:"2%",bottom:"2%",top:"20%",containLabel:!0},legend:{icon:"circle",data:y.value.map(e=>e.name),top:"-2%",itemWidth:10,itemHeight:10,itemGap:16,textStyle:{color:c.value,lineHeight:12,padding:[0,0,-2,0],rich:{a:{verticalAlign:"middle"}}}},tooltip:{trigger:"axis",backgroundColor:o.value,borderColor:"transparent",textStyle:{color:c.value},position:(e,t,a,l,r)=>{var i,s;let n=0,o=0;const c=(null==(i=window.__LAST_VIEWPORT_MOUSE__)?void 0:i.x)||0,u=((null==(s=window.__LAST_VIEWPORT_MOUSE__)?void 0:s.y)||0)-e[1],d=r.contentSize[0]||0,v=r.contentSize[1]||0;return n=e[0]-d-20,o=e[1]-v-30,u<v&&u<300&&(o=e[1]+20),c+d+20>window.innerWidth&&(n=e[0]-d-20),[n,o]},formatter(e){if(!F(e))return"";const a=e[0].data,l=T(a),r=document.createElement("div"),i=f(m,null,[f("div",null,[t("Waf.Overview.index_22",[E(a.timestamp,"yyyy-MM-dd HH:mm")])]),e.map(e=>f("div",null,[f("span",{class:"inline-block w-10px h-10px mr-10px rounded-full",style:{backgroundColor:"".concat(e.color)}},null),e.seriesName,w(": "),e.value,w(" "),e.seriesName===y.value[2].name?"MB":""])),f("div",null,[f("span",{class:"inline-block w-10px h-10px mr-10px"},null),t("Waf.Overview.index_7_1",[a.err_499||0])]),f("div",null,[f("span",{class:"inline-block w-10px h-10px mr-10px"},null),t("Waf.Overview.index_7_2",[a.err_502||0])]),f("div",null,[f("span",{class:"inline-block w-10px h-10px mr-10px"},null),t("Waf.Overview.index_43",[l.dynamic_flow,l.static_flow,l.tmp_size])])]);return S(i,r),r}},xAxis:x(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:d.value}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:c.value},nameTextStyle:{color:c.value}},series:b()});return v(()=>{(e=>{const t=[],a=[],l=[],r=[],i=[];e.forEach(e=>{a.push(e.proxy_count),i.push({...e,value:e.request}),r.push(e.ip_count||0);const s=e.flow?Number((e.flow/1024/1024).toFixed(2)):0;l.push(s);const n=e.hour<10?"0"+e.hour:e.hour,o=e.minute<10?"0"+e.minute:e.minute;t.push("".concat(n,":").concat(o))}),$.xAxis=x(t),y.value[0].value=i,y.value[1].value=a,y.value[2].value=l,y.value[3].value=r,$.series=b()})(r.value)}),(e,t)=>{const a=ee;return s(),i(he,null,{header:n(()=>[t[0]||(t[0]=g("i",{class:"i-waf:traffic-filter text-16px"},null,-1)),g("span",Ye,h(e.$t("Waf.Overview.index_3")),1)]),"header-extra":n(()=>[f(a,{onClick:p},{default:n(()=>t[1]||(t[1]=[g("i",{class:"i-common:refresh text-14px"},null,-1)])),_:1,__:[1]})]),default:n(()=>[g("div",Xe,[f(ve,{type:"line",height:"100%",option:_($)},null,8,["option"])])]),_:1})}}}),Ze=c({__name:"block",setup(e){const{attackDetails:t}=we(),{t:a}=u(),{columns:l}=ne([{key:"ip",width:120,title:a("Waf.Overview.index_27"),ellipsis:{tooltip:!0},render:e=>f("a",{class:"bt-link",href:"javascript:;",onClick:()=>{fe({ip:e.ip})}},[e.ip])},{key:"count",width:90,title:a("Waf.Overview.index_28")},{key:"address",title:a("Waf.Overview.index_29"),ellipsis:{tooltip:!0}}]);return(e,a)=>{const r=oe;return s(),i(r,{"max-height":380,data:_(t),columns:_(l)},null,8,["data","columns"])}}}),Je=c({__name:"request",setup(e){const{attackDetails:t}=we(),{t:a}=u(),{columns:l}=ne([{key:"ip",width:110,title:a("Waf.Overview.index_76"),ellipsis:{tooltip:!0},render:e=>f("a",{class:"bt-link",href:"javascript:;",onClick:()=>{fe({ip:e.ip})}},[e.ip])},{key:"count",width:80,title:a("Waf.Overview.index_77")},{key:"traffic",width:60,title:a("Waf.Overview.index_41"),render:e=>P(e.traffic)},{key:"address",title:a("Waf.Overview.index_29"),ellipsis:{tooltip:!0}}]);return(e,a)=>{const r=oe;return s(),i(r,{"max-height":380,data:_(t),columns:_(l)},null,8,["data","columns"])}}}),et={class:"mx-6px"},tt={class:"leading-20px"},at={class:"flex items-center"},lt={class:"mr-8px text-12px"},rt={class:"flex gap-12px h-475px p-16px"},it={class:"flex-1 flex flex-col w-0"},st={class:"flex items-center relative w-full"},nt={class:"flex items-center gap-8px"},ot={class:"text-desc"},ct={class:"relative flex-1"},ut={class:"w-360px"},dt=c({__name:"index",setup(e){const t=$(()=>R(()=>import("./map2d.js?v=1767769852656"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),a=$(()=>R(()=>import("./map3d.js?v=1767769852656"),__vite__mapDeps([15,16,17,2,6,18,4,1,5,7,8,9,10,3,11,12,13,19]))),{store:l,is3D:o,mapType:c,request:d}=we(),{t:v}=u(),p=r(()=>3===c.value&&o.value?a:t),m=r(()=>1===d.value?Ze:Je),y=e=>{ce({title:v(e?"Waf.Overview.index_35":"Waf.Overview.index_36"),content:v(e?"Waf.Overview.index_37":"Waf.Overview.index_38"),onConfirm:async()=>{await I.post("/plugin?action=a&name=btwaf&s=set_obj_open",{obj:"3D"},{requestOptions:{loading:B.global.t("Waf.Api.overview_2"),successMessage:!0}}),o.value=e,c.value=e?3:2}})},b=()=>{l.getInfo()};return(e,t)=>{const a=pe,l=te,r=H,u=K,v=Q,k=X;return s(),i(he,null,{header:n(()=>[t[2]||(t[2]=g("i",{class:"i-waf:attack-map text-16px"},null,-1)),g("span",et,h(e.$t("Waf.Overview.index_44")),1),f(a,null,{default:n(()=>[g("div",tt,h(e.$t("Waf.Overview.index_45")),1)]),_:1})]),"header-extra":n(()=>[g("div",at,[g("span",lt,h(e.$t("Waf.Overview.index_34")),1),f(l,{value:_(o),size:"small","onUpdate:value":y},null,8,["value"]),f(r,{vertical:""}),f(u,{href:"/btwaf/content_report.html",target:"_blank"},{default:n(()=>[w(h(e.$t("Waf.Overview.index_30")),1)]),_:1})])]),default:n(()=>[g("div",rt,[g("div",it,[g("div",st,[g("div",nt,[_(o)?(s(),i(k,{key:0,value:_(c),"onUpdate:value":t[0]||(t[0]=e=>x(c)?c.value=e:null),size:"small"},{default:n(()=>[f(v,{value:3},{default:n(()=>t[3]||(t[3]=[w("3D",-1)])),_:1,__:[3]}),f(v,{value:2},{default:n(()=>t[4]||(t[4]=[w("2D",-1)])),_:1,__:[4]})]),_:1},8,["value"])):j("",!0),g("span",ot,h(e.$t("Waf.Overview.index_46")),1)]),f(k,{value:_(d),"onUpdate:value":[t[1]||(t[1]=e=>x(d)?d.value=e:null),b],class:"ml-70px",size:"small"},{default:n(()=>[f(v,{value:0},{default:n(()=>[w(h(e.$t("Waf.Overview.index_47")),1)]),_:1}),f(v,{value:1},{default:n(()=>[w(h(e.$t("Waf.Overview.index_48")),1)]),_:1})]),_:1},8,["value"])]),g("div",ct,[(s(),i(C(_(p))))])]),g("div",ut,[(s(),i(C(_(m))))])])]),_:1})}}}),vt={key:0,class:"rank-list"},pt={class:"rank-title"},ft={class:"flex-1 mr-16px"},_t={class:"rank-value"},xt={key:1,class:"flex items-center justify-center h-full"},mt=z(c({__name:"rank",props:{data:{type:Array,default:()=>[]},colors:{type:Array,default:()=>["#418f6b","#bcdeca"]}},setup(e){const t=r(()=>a(e.colors[0],e.colors[1])),a=(e,t)=>{function a(e){return e=function(e){if(3===(e=(e||"").replace(/^#/,"").toLowerCase()).length&&(e=e.split("").map(function(e){return e+e}).join("")),6!==e.length)throw new Error("无效的hex颜色："+e);return e}(e),[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function l(e){function t(e){var t=e.toString(16);return 1===t.length?"0"+t:t}return"#"+t(e[0])+t(e[1])+t(e[2])}function r(e,t,a){return Math.round(e+(t-e)*a)}const i=a(e),s=a(t),n=[];for(let o=0;o<=9;o++){const e=o/9,t=r(i[0],s[0],e),a=r(i[1],s[1],e),c=r(i[2],s[2],e);n.push(l([t,a,c]))}return n};return(a,l)=>{const r=ae,i=J,o=le;return e.data.length>0?(s(),p("div",vt,[(s(!0),p(m,null,y(e.data,(a,l)=>{return s(),p("div",{key:l,class:"rank-item"},[g("span",{class:"rank-num",style:L({backgroundColor:_(t)[l]})},h(l+1),5),g("div",pt,[f(r,null,{default:n(()=>[w(h(a[0]),1)]),_:2},1024)]),g("div",ft,[f(i,{type:"line",percentage:(o=a[1],o/Math.max(...e.data.map(e=>e[1]))*100),color:_(t)[l],height:6,"show-indicator":!1},null,8,["percentage","color"])]),g("div",_t,h(a[1]),1)]);var o}),128))])):(s(),p("div",xt,[f(o,{size:"large"})]))}}}),[["__scopeId","data-v-ba455d5c"]]),yt={class:"ml-6px"},wt={class:"h-350px px-16px py-12px"},ht=c({__name:"index",setup(e){const{serverNameTop:t}=we(),a=r(()=>t.value.slice(0,10));return(e,t)=>(s(),i(he,null,{header:n(()=>[t[0]||(t[0]=g("i",{class:"i-waf:attacked-domain text-16px"},null,-1)),g("span",yt,h(e.$t("Waf.Overview.index_49")),1)]),default:n(()=>[g("div",wt,[f(mt,{data:_(a),colors:["#418f6b","#bcdeca"]},null,8,["data"])])]),_:1}))}}),gt={class:"w-920px p-20px"},bt=c({__name:"more",setup(e){const{t:t}=u(),{queryStartTime:a}=we(),r=l(!1),i=l([]),n=l([{key:"server_name",title:t("Waf.Overview.index_64")},{key:"ip",title:t("Waf.Overview.index_65")},{key:"count",title:t("Waf.Overview.index_66"),sorter:(e,t)=>e.count-t.count},{key:"traffic",title:t("Waf.Overview.index_41"),sorter:(e,t)=>e.traffic-t.traffic,render:e=>P(e.traffic)},{key:"static_count",title:t("Waf.Overview.index_67"),sorter:(e,t)=>e.static_count-t.static_count},{key:"static_traffic",title:t("Waf.Overview.index_68"),sorter:(e,t)=>e.static_traffic-t.static_traffic,render:e=>P(e.static_traffic)},{key:"session_count",title:t("Waf.Overview.index_83"),sorter:(e,t)=>e.session_count-t.session_count}]),o=e=>{n.value.forEach(t=>{const a=t;if(a.key===e.columnKey){const t="ascend"===a.sortOrder?"descend":"ascend";a.sortOrder="boolean"==typeof e.order?t:e.order}else a.sortOrder=!1})};return(async()=>{try{r.value=!0;const{message:t}=await(e={start_time:a.value},I.post("/btwaf/get_traffic_top.json",e));M(t)&&(i.value=t.traffic_top||[])}finally{r.value=!1}var e})(),(e,t)=>{const a=oe;return s(),p("div",gt,[f(a,{"max-height":460,loading:_(r),data:_(i),columns:_(n),"onUpdate:sorter":o},null,8,["loading","data","columns"])])}}}),kt={class:"mx-6px"},Ot={class:"leading-20px"},Wt={class:"h-350px p-16px"},St=c({__name:"index",setup(e){const{t:t}=u(),{trafficTop:a}=we(),l=r(()=>a.value.map(e=>[e.ip,e.count]).slice(0,10)),o=()=>{ue({title:t("Waf.Overview.index_51"),component:bt})};return(e,t)=>{const a=pe,r=ee;return s(),i(he,null,{header:n(()=>[t[6]||(t[6]=g("i",{class:"i-waf:traffic-ranking text-16px"},null,-1)),g("span",kt,h(e.$t("Waf.Overview.index_50")),1),f(a,null,{default:n(()=>[g("div",Ot,[w(h(e.$t("Waf.Overview.index_52")),1),t[0]||(t[0]=g("br",null,null,-1)),w(" 1."+h(e.$t("Waf.Overview.index_53")),1),t[1]||(t[1]=g("br",null,null,-1)),w(" 2."+h(e.$t("Waf.Overview.index_54")),1),t[2]||(t[2]=g("br",null,null,-1)),w(" 3."+h(e.$t("Waf.Overview.index_55")),1),t[3]||(t[3]=g("br",null,null,-1)),w(" 4."+h(e.$t("Waf.Overview.index_56")),1),t[4]||(t[4]=g("br",null,null,-1)),w(" 5."+h(e.$t("Waf.Overview.index_57")),1),t[5]||(t[5]=g("br",null,null,-1)),w(" "+h(e.$t("Waf.Overview.index_58")),1)])]),_:1})]),"header-extra":n(()=>[f(r,{type:"primary",text:"",onClick:o},{default:n(()=>[w(h(e.$t("Public.Btn.More"))+">> ",1)]),_:1})]),default:n(()=>[g("div",Wt,[f(mt,{data:_(l),colors:["#06a6c7","#a5f1fc"]},null,8,["data"])])]),_:1})}}}),qt={class:"w-1020px p-20px"},Tt=c({__name:"more",setup(e){const{t:t}=u(),{queryStartTime:a}=we(),r=l(!1),i=l([]),n=l([{key:"server_name",title:t("Waf.Overview.index_64")},{key:"url",title:t("Waf.Overview.index_69"),ellipsis:{tooltip:!0}},{key:"count",title:t("Waf.Overview.index_66"),sorter:(e,t)=>e.count-t.count},{key:"traffic",title:t("Waf.Overview.index_41"),sorter:(e,t)=>e.traffic-t.traffic,render:e=>P(e.traffic)},{key:"static_count",title:t("Waf.Overview.index_67"),sorter:(e,t)=>e.static_count-t.static_count},{key:"static_traffic",title:t("Waf.Overview.index_68"),sorter:(e,t)=>e.static_traffic-t.static_traffic,render:e=>P(e.static_traffic)},{key:"content_type",title:t("Waf.Overview.index_82"),ellipsis:{tooltip:!0}},{key:"session_count",title:t("Waf.Overview.index_83"),sorter:(e,t)=>e.session_count-t.session_count}]),o=e=>{n.value.forEach(t=>{const a=t;if(a.key===e.columnKey){const t="ascend"===a.sortOrder?"descend":"ascend";a.sortOrder="boolean"==typeof e.order?t:e.order}else a.sortOrder=!1})};return(async()=>{try{r.value=!0;const{message:t}=await(e={start_time:a.value},I.post("/btwaf/get_url_top.json",e));M(t)&&(i.value=t.traffic_top||[])}finally{r.value=!1}var e})(),(e,t)=>{const a=oe;return s(),p("div",qt,[f(a,{"max-height":460,loading:_(r),data:_(i),columns:_(n),"onUpdate:sorter":o},null,8,["loading","data","columns"])])}}}),$t={class:"mx-6px"},jt={class:"leading-20px"},Ct={class:"h-350px p-16px"},Lt=c({__name:"index",setup(e){const{t:t}=u(),{urlTop:a}=we(),l=r(()=>a.value.map(e=>[e.url,e.count]).slice(0,10)),o=()=>{ue({title:t("Waf.Overview.index_63"),component:Tt})};return(e,t)=>{const a=pe,r=ee;return s(),i(he,null,{header:n(()=>[t[3]||(t[3]=g("i",{class:"i-waf:visit-page text-16px"},null,-1)),g("span",$t,h(e.$t("Waf.Overview.index_62")),1),f(a,null,{default:n(()=>[g("div",jt,[w(h(e.$t("Waf.Overview.index_59")),1),t[0]||(t[0]=g("br",null,null,-1)),w(" 1."+h(e.$t("Waf.Overview.index_60")),1),t[1]||(t[1]=g("br",null,null,-1)),w(" 2."+h(e.$t("Waf.Overview.index_61")),1),t[2]||(t[2]=g("br",null,null,-1)),w(" "+h(e.$t("Waf.Overview.index_58")),1)])]),_:1})]),"header-extra":n(()=>[f(r,{type:"primary",text:"",onClick:o},{default:n(()=>[w(h(e.$t("Public.Btn.More"))+">> ",1)]),_:1})]),default:n(()=>[g("div",Ct,[f(mt,{data:_(l),colors:["#0d5450","#4ff9e0"]},null,8,["data"])])]),_:1})}}}),It={class:"ml-6px"},Bt={class:"p-16px h-360px"},At={key:1,class:"flex items-center justify-center h-full"},Et=c({__name:"index",setup(e){const{t:t}=u(),{count:a,blockTypes:l}=we(),r=O("--color-bg-2"),o=O("--chart-tooltip-bg-color"),c=O("--color-text-1"),d=O("--color-text-2"),x=O("--color-text-5"),m=(e,t)=>{let a=0;for(var r=0;r<l.value.length;r++)if(l.value[r][0]===e){a=l.value[r][1];break}return{value:a,percent:a>0&&t>0?(a/t*100).toFixed(0)+"%":"0%"}},y=W({color:["#6ec71e","#4885FF","#fc8b40","#818af8","#31c9d7","#f35e7a","#ab7aee","#14d68b","#cde5ff"],backgroundColor:r.value,title:w(),tooltip:{trigger:"item",confine:!0,backgroundColor:o.value,borderColor:"transparent",textStyle:{color:x.value},formatter(e){const t=e;return"".concat(t.marker," ").concat(t.name,": ").concat(t.value," (").concat(t.percent,"%)")}},legend:{show:!0,orient:"vertical",type:"scroll",right:"0%",top:"center",itemGap:15,icon:"circle",textStyle:{color:x.value,fontSize:13},formatter(e){const t=e.length>12?e.substring(0,12)+"...":e,{value:l,percent:r}=m(e,a.value.malicious_request);return"".concat(t," ").concat(l," (").concat(r,")")},tooltip:{show:!0,textStyle:{color:x.value},formatter(e){const{value:t,percent:l}=m(e.name,a.value.malicious_request);return"".concat(e.name," ").concat(t," (").concat(l,")")}}},series:b()});function w(e=0){return{text:t("Waf.Overview.index_75"),textStyle:{color:c.value,fontSize:16},subtext:"".concat(e),subtextStyle:{color:d.value,fontSize:20,fontWeight:"bold"},itemGap:16,left:"27%",top:"46%",textAlign:"center",textVerticalAlign:"middle"}}function b(e=[]){return[{type:"pie",data:e,radius:["45%","55%"],center:["28%","50%"],clockwise:!0,avoidLabelOverlap:!0,hoverOffset:10,label:{show:!1},labelLine:{show:!1},itemStyle:{labelLine:{lineStyle:{width:2,color:"#fff"},emphasis:{borderWidth:0,shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},emphasis:{scaleSize:15}}]}return v(()=>{(e=>{const t=e.map(e=>({name:e[0],value:e[1]}));y.title=w(a.value.malicious_request),y.series=b(t)})(l.value)}),(e,t)=>{const a=le;return s(),i(he,null,{header:n(()=>[t[0]||(t[0]=g("i",{class:"i-waf:interception-type text-16px"},null,-1)),g("span",It,h(e.$t("Waf.Overview.index_74")),1)]),default:n(()=>[g("div",Bt,[_(l).length>0?(s(),i(ve,{key:0,type:"pie",height:"100%",option:_(y)},null,8,["option"])):(s(),p("div",At,[f(a,{size:"large"})]))])]),_:1})}}}),Mt={class:"ml-6px"},Pt={class:"p-16px h-360px"},zt=c({__name:"index",setup(e){const{t:t}=u(),{attackReportLogs:a}=we(),o=r(()=>a.value.slice(0,20)),c=l([{key:"time_localtime",width:150,title:t("Waf.Overview.index_70"),render:e=>E(e.time_localtime)},{key:"ip",width:120,title:t("Waf.Overview.index_71")},{key:"server_name",width:140,title:t("Waf.Overview.index_64")},{key:"filter_rule",width:160,title:t("Waf.Overview.index_72")},{key:"uri",title:t("Waf.Overview.index_69"),render:e=>f("span",{class:"break-all"},[e.uri])},de({width:200,options:e=>[{label:t("Waf.Block.index_22"),onClick:()=>{fe(e)}},{label:t("Waf.Block.index_23"),onClick:()=>{_e(e,-1!==e.uri.indexOf("?")&&-1!==e.uri.indexOf("="))}},{label:t("Waf.Block.index_24"),onClick:()=>{xe(e)}}]})]);return(e,t)=>{const a=oe;return s(),i(he,null,{header:n(()=>[t[0]||(t[0]=g("i",{class:"i-waf:interception-event text-16px"},null,-1)),g("span",Mt,h(e.$t("Waf.Overview.index_73")),1)]),default:n(()=>[g("div",Pt,[f(a,{"max-height":270,data:_(o),columns:_(c)},null,8,["data","columns"])])]),_:1})}}}),Dt={class:"waf-overview"},Ut={class:"flex flex-wrap items-center gap-20px px-8px"},Ft={class:"text-base font-bold"},Gt={class:"text-default"},Nt={class:"flex flex-col gap-16px"},Ht={class:"flex flex-col gap-16px"},Kt=c({__name:"index",setup(t){const{store:a,open:l}=we(),r=async()=>{await e(),a.getInfo()};return a.getInfo(),(e,t)=>{const a=ee,o=ie,c=re,u=V;return s(),p("div",Dt,[f(u,{"x-gap":"16","y-gap":"16",cols:"24"},{default:n(()=>[_(l)?j("",!0):(s(),i(c,{key:0,span:"24"},{default:n(()=>[f(o,{type:"error","show-icon":!1,bordered:!1},{default:n(()=>[g("div",Ut,[g("span",Ft,h(e.$t("Waf.Overview.index_78")),1),g("span",Gt,h(e.$t("Waf.Overview.index_79")),1),f(a,{type:"primary",onClick:r},{default:n(()=>[w(h(e.$t("Waf.Overview.index_80")),1)]),_:1})])]),_:1})]),_:1})),f(c,{span:"6"},{default:n(()=>[g("div",Nt,[f(Se),f(Pe),f(Fe),f(Ve),f(He),f(ht),f(Et)])]),_:1}),f(c,{span:"18"},{default:n(()=>[g("div",Ht,[f(Qe),f(dt),f(u,{"x-gap":"16","y-gap":"16",cols:"2"},{default:n(()=>[f(c,null,{default:n(()=>[f(St)]),_:1}),f(c,null,{default:n(()=>[f(Lt)]),_:1})]),_:1}),f(zt)])]),_:1})]),_:1})])}}}),Rt=Object.freeze(Object.defineProperty({__proto__:null,default:Kt},Symbol.toStringTag,{value:"Module"}));export{me as g,Rt as i,we as u};
