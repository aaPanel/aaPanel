const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index238.js?v=1767769852656","js/index109.js?v=1767769852656","js/vue.js?v=1767769852656","js/__commonjsHelpers__.js?v=1767769852656","js/naive.js?v=1767769852656","js/common.js?v=1767769852656","js/page_layout.js?v=1767769852656","js/public.js?v=1767769852656","css/public.css?v=1767769852656","css/page_layout.css?v=1767769852656","css/index23.css?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang11.js?v=1767769852656","js/index98.js?v=1767769852656","css/index15.css?v=1767769852656","js/index99.js?v=1767769852656","css/index16.css?v=1767769852656","js/site.js?v=1767769852656","js/index244.js?v=1767769852656","js/domain-input.js?v=1767769852656","css/domain-input.css?v=1767769852656","js/git-ps.js?v=1767769852656","js/php.js?v=1767769852656","css/index106.css?v=1767769852656","js/index239.js?v=1767769852656","js/index.js?v=1767769852656","css/index120.css?v=1767769852656","js/index104.js?v=1767769852656","css/index21.css?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang5.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang6.js?v=1767769852656","css/index17.css?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang7.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang9.js?v=1767769852656","js/index240.js?v=1767769852656","js/index251.js?v=1767769852656","css/index64.css?v=1767769852656","js/index100.js?v=1767769852656","js/theme-monokai.js?v=1767769852656","js/file.js?v=1767769852656","css/index18.css?v=1767769852656","js/index135.js?v=1767769852656","css/index26.css?v=1767769852656","js/refersh.js?v=1767769852656","js/form.vue_vue_type_script_setup_true_lang2.js?v=1767769852656","js/logs.vue_vue_type_script_setup_true_lang.js?v=1767769852656","js/ssl.js?v=1767769852656","js/cert.js?v=1767769852656","js/ssl-lets-progress.js?v=1767769852656","css/ssl-lets-progress.css?v=1767769852656","js/utils3.js?v=1767769852656","js/index222.js?v=1767769852656","js/paypal-js.js?v=1767769852656","css/index53.css?v=1767769852656","js/upload.js?v=1767769852656","js/soft.js?v=1767769852656","css/index107.css?v=1767769852656","js/index241.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang13.js?v=1767769852656","css/index108.css?v=1767769852656","js/index242.js?v=1767769852656","js/ssl-log.js?v=1767769852656","js/index243.js?v=1767769852656","js/logo.js?v=1767769852656","js/useOperate.js?v=1767769852656","js/useModal2.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang14.js?v=1767769852656","css/index109.css?v=1767769852656","js/expired.js?v=1767769852656","js/php2.js?v=1767769852656","js/category.js?v=1767769852656","js/webserver.js?v=1767769852656","js/webserver-result.vue_vue_type_script_setup_true_lang.js?v=1767769852656"])))=>i.map(i=>d[i]);
import{j as e,s as t,aI as a,a as l,A as i,p as n,q as s,r as o,a7 as r,d as u,_ as d,u as c,x as p,du as m,aa as _,m as f,o as v}from"./page_layout.js?v=1767769852656";import{_ as h}from"./index135.js?v=1767769852656";import{_ as y}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1767769852656";import{_ as g}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1767769852656";import{_ as x}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1767769852656";import{de as k,di as w,aC as S,_ as b,dc as P,dd as C,d8 as H,dh as j,aX as T,da as B,bH as D,dj as L,dm as V,au as A,dg as M,dR as R,dV as O,dS as U}from"./naive.js?v=1767769852656";import{k as E,i as W,r as N,o as I,w as $,a2 as q,V as K,U as F,a3 as z,W as Q,S as X,F as Y,P as G,_ as J,a0 as Z,R as ee,H as te,a4 as ae,l as le,v as ie,c as ne,j as se,am as oe,av as re,ak as ue,O as de,x as ce,s as pe,e as me,N as _e,ah as fe,an as ve,p as he}from"./vue.js?v=1767769852656";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1767769852656";import{_ as ge}from"./index133.js?v=1767769852656";import{u as xe,T as ke,t as we,_ as Se,h as be,F as Pe,e as Ce,c as He,f as je,a as Te,d as Be,U as De,m as Le}from"./public.js?v=1767769852656";import{s as Ve,d as Ae,e as Me,f as Re,h as Oe,i as Ue,j as Ee,k as We,l as Ne}from"./site.js?v=1767769852656";import{u as Ie}from"./index244.js?v=1767769852656";import{u as $e}from"./soft2.js?v=1767769852656";import{a as qe,b as Ke,c as Fe}from"./php.js?v=1767769852656";import{u as ze}from"./useOperate.js?v=1767769852656";import{a3 as Qe,a4 as Xe,a5 as Ye,m as Ge,h as Je}from"./common.js?v=1767769852656";import{_ as Ze}from"./index.vue_vue_type_script_setup_true_lang14.js?v=1767769852656";import{_ as et}from"./index.js?v=1767769852656";import{_ as tt}from"./index.vue_vue_type_script_setup_true_lang.js?v=1767769852656";const at=E({__name:"index",props:{disabledKeys:{type:Array,default:()=>[]},hideKeys:{type:Array,default:()=>[]},storeKey:{type:String,default:""},loading:{type:Boolean,default:!1}},setup(l){const i=W("tableRef"),n=N(!1),s=N([]),o=N([]),r=N([]),u=()=>{n.value=!0},d=()=>{n.value=!1},c=()=>{if(!i)return;const e=k(o.value.filter(e=>s.value.includes(String(e.key)))),t=e.length;if(t>0){const l=Math.floor(100/t),i=100-l*t;e.forEach((e,t)=>{if(a(e.width)||!e.width)return;let n=l;t<i&&(n+=1),e.width="".concat(n,"%")})}"selection"===o.value[0].type&&e.unshift(o.value[0]),i.value.setColumns(e)},p=e=>{if(s.value.includes(e)?s.value=s.value.filter(t=>t!==e):s.value.push(e),l.storeKey&&t(l.storeKey,s.value.join(",")),l.loading){const e=$(()=>l.loading,t=>{t||c(),e()})}else c()};return I(()=>{if(i){const t=i.value.getColumns();0===o.value.length&&(o.value=k(t)),(()=>{if(l.storeKey){const t=e(l.storeKey);t&&(s.value=t.split(","))}})(),(()=>{const e=o.value.filter(e=>"selection"!==e.type);0===s.value.length&&(s.value=e.filter(e=>!l.hideKeys.includes(String(e.key))).map(e=>String(e.key))),r.value=e.map(e=>({key:String(e.key),disabled:"operate"===e.key||l.disabledKeys.includes(String(e.key)),label:()=>Q(Y,null,[Q(b,{checked:s.value.includes(String(e.key))},null),Q("span",{class:"ml-8px"},[String(e.title).includes("Requests")?"Requests":String(e.title)])])}))})();const a=$(()=>l.loading,e=>{e||c(),a()})}}),(e,t)=>{const a=S,l=w;return K(),q(l,{placement:"bottom-end",show:F(n),"show-arrow":!0,"arrow-point-to-center":!0,options:F(r),onSelect:p,onClickoutside:d},{default:z(()=>[Q(a,{onClick:u},{default:z(()=>t[0]||(t[0]=[X("i",{class:"i-famicons:settings-outline text-16px"},null,-1)])),_:1,__:[0]})]),_:1},8,["show","options"])}}}),lt=()=>{const{t:e}=G();return{openAddSiteModal:()=>{xe({title:e("Site.PHP.index_9"),width:700,height:540,footer:!0,component:J(()=>l(()=>import("./index238.js?v=1767769852656"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])))})},openBackupModal:t=>{xe({title:e("Site.PHP.index_33",[t.name]),width:720,minHeight:200,data:{row:t},component:J(()=>l(()=>import("./index239.js?v=1767769852656"),__vite__mapDeps([24,25,2,3,5,7,6,4,9,8,26,27,28,29,30,31,32,33,17])))})},openSiteConfig:(t,a={})=>{xe({title:e("Site.PHP.index_13",[t.name,t.addtime]),width:860,height:700,data:{siteInfo:t,config:Object.assign({menu:"",subMenu:""},a)},component:J(()=>l(()=>import("./index240.js?v=1767769852656").then(e=>e.i),__vite__mapDeps([34,6,2,3,4,5,7,8,9,35,36,18,29,30,31,33,15,16,17,1,10,11,12,13,14,25,26,22,37,38,39,40,41,42,43,44,27,28,45,46,47,48,49,50,51,52,53,54,55,21,56])))})},openDeleteSiteConfig:t=>{xe({title:1===t.length?"".concat(e("Site.Cert.index_56")," [").concat(t[0].name,"]"):"".concat(e("Site.Cert.index_57")),width:480,minHeight:248,footer:!0,data:{rows:t},component:J(()=>l(()=>import("./index241.js?v=1767769852656"),__vite__mapDeps([57,6,2,3,4,5,7,8,9,17,18,58,39,59])))})},openSiteAdvancedModal:t=>{xe({title:e("Database.Mysql.index_3"),width:950,height:620,data:{menu:t},component:J(()=>l(()=>import("./index242.js?v=1767769852656"),__vite__mapDeps([60,35,2,3,4,5,6,7,8,9,36,1,10,18,37,38,39,40,11,17,22])))})},openSslLogsModal:t=>{xe({title:e("SSL.Domain.index_5"),width:700,height:450,data:{path:t},component:J(()=>l(()=>import("./ssl-log.js?v=1767769852656"),__vite__mapDeps([61,27,6,2,3,4,5,7,8,9,28])))})},openSiteStatisticsModal:(t=!1,a)=>{xe({title:a?"[".concat(a,"] ").concat(e("Website statistics")):e("Website statistics"),width:900,minHeight:450,data:{name:a,showTops5:t},component:J(()=>l(()=>import("./index243.js?v=1767769852656"),__vite__mapDeps([62,41,6,2,3,4,5,7,8,9,42,63,64,55,17,65,22,18,66,67])))})}}},it={class:"website-name"},nt={key:1,class:"flex-center w-24px h-24px rounded-50%"},st=["src"],ot={class:"flex flex-col flex-1 w-0 overflow-hidden"},rt={class:"flex items-center gap-8px"},ut={class:"min-w-0"},dt={class:"website-description"},ct=n(E({__name:"Name",props:{ico:{type:String,default:""},name:{type:String,default:"--"},description:{type:String,default:"--"}},emits:["clickName","clickServer","blur"],setup(e,{emit:t}){const a=i(),{theme:l}=Z(a),n=t,s=()=>{n("clickName")},o=()=>{n("clickServer")},r=()=>{window.open("http://".concat(e.name))},u=e=>{n("blur",e)};return(t,a)=>{const i=P,n=S,d=ke;return K(),ee("div",it,[X("div",{class:"website-icon",onClick:o},[e.ico?(K(),ee("div",nt,[X("img",{src:e.ico,class:"w-full h-full"},null,8,st)])):(K(),ee("div",{key:0,class:te(["flex-center w-24px h-24px rounded-50%","dark"!==F(l)&&"bg-#F1F9F3"])},[X("i",{class:te(["i-mdi:earth text-18px","dark"!==F(l)&&"text-primary"])},null,2)],2))]),X("div",ot,[X("div",rt,[X("div",ut,[Q(i,{class:"max-w-full",tooltip:{contentStyle:{maxWidth:"200px"}}},{default:z(()=>[X("span",{class:te(["cursor-pointer","dark"!==F(l)&&"text-primary"]),onClick:s},ae(e.name),3)]),_:1})]),Q(n,{type:"primary",text:"",onClick:r},{default:z(()=>a[0]||(a[0]=[X("i",{class:"i-fa-solid:external-link-alt"},null,-1)])),_:1,__:[0]})]),X("div",dt,[Q(d,{value:e.description,onBlur:u},null,8,["value"])])])])}}}),[["__scopeId","data-v-5103c19c"]]),pt={class:"i-famicons:play-circle-outline"},mt={class:"i-famicons:pause-circle-outline text-warning"},_t=n(E({__name:"Status",props:{status:{type:String,default:"0"},checkedValue:{type:String,default:"1"},unCheckedValue:{type:String,default:"0"},onUpdateValue:{type:Function}},setup(e){const t=()=>{var t;null==(t=e.onUpdateValue)||t.call(e,e.status===e.checkedValue?e.unCheckedValue:e.checkedValue)};return(a,l)=>(K(),ee("div",{class:"website-status",onClick:t},[le(X("i",pt,null,512),[[ie,e.status===e.checkedValue]]),le(X("i",mt,null,512),[[ie,e.status===e.unCheckedValue]])]))}}),[["__scopeId","data-v-a66f2bce"]]),ft=E({__name:"Backup",props:{count:{type:Number,default:0},lastTime:{type:String,default:""}},emits:["showBackup"],setup(e,{emit:t}){const a=t,l=()=>{a("showBackup")},i=t=>Qe(new Date,e.lastTime||new Date)>=t,n=ne(()=>{if(0===e.count)return"Backup now";const t=Qe(new Date,e.lastTime||new Date);return 0===t?"Today":1===t?"Yesterday":"".concat(t," days ago")}),s=ne(()=>i(30)||e.count<=0?"error":i(7)?"warning":"primary");return(t,a)=>{const i=C,o=H;return K(),ee("div",{class:"flex items-center gap-8px cursor-pointer",onClick:l},[Q(i,{type:F(s),size:"small",bordered:!1},{default:z(()=>[se(ae(e.count),1)]),_:1},8,["type"]),Q(o,{disabled:0===e.count},{trigger:z(()=>[X("div",{class:te({"text-error":"error"===F(s),"text-warning":"warning"===F(s)})},ae(F(n)),3)]),default:z(()=>[se(" "+ae(e.lastTime),1)]),_:1},8,["disabled"])])}}}),vt={class:"inline-flex items-center w-full"},ht={class:"flex-1 text-right"},yt={class:"flex-1 text-left"},gt=E({__name:"Quick",props:{path:{type:String,default:""},phpVersion:{type:String,default:""}},emits:["showPhp"],setup(e,{emit:t}){const a=t,l=oe(),i=()=>{o("Path",e.path),l.push("/files")},n=()=>{a("showPhp")};return(t,a)=>{const l=S,o=H,r=s;return K(),ee("div",vt,[X("div",ht,[Q(o,{trigger:"hover"},{trigger:z(()=>[Q(l,{text:"",onClick:i},{default:z(()=>a[0]||(a[0]=[X("i",{class:"i-fa:folder-open-o text-13px"},null,-1)])),_:1,__:[0]})]),default:z(()=>[se(" "+ae(e.path),1)]),_:1})]),Q(r,{vertical:""}),X("div",yt,[Q(l,{text:"",onClick:n},{default:z(()=>[se(ae(e.phpVersion),1)]),_:1})])])}}}),xt={class:"flex justify-end"},kt=n(E({__name:"ExpiredDate",props:{value:{type:String,default:"0000-00-00"},onUpdateValue:{type:Function}},setup(e){const{t:t}=G(),a=re("popoverRef"),l=N(null),i=ne(()=>{const t=new Date(e.value);return"0000-00-00"!==e.value&&Xe(t,Ye())}),n=ne(()=>"0000-00-00"===e.value?t("Site.PHP.index_34"):i.value?t("Site.PHP.index_28"):e.value),s=e=>Xe(e,Ge(Ye(),1)),o=ne(()=>{const t=new Date(e.value);return"0000-00-00"!==e.value&&Xe(t,Ge(Ye(),7))}),u=async()=>{var t,l;await(null==(t=e.onUpdateValue)?void 0:t.call(e,"0000-00-00")),null==(l=a.value)||l.setShow(!1)},d=async()=>{var t,i;if(null===l.value)return;const n=Je(l.value,"yyyy-MM-dd");await(null==(t=e.onUpdateValue)?void 0:t.call(e,n)),null==(i=a.value)||i.setShow(!1)},c=()=>{l.value="0000-00-00"===e.value?null:new Date(e.value).getTime()};return(e,t)=>{const p=S,m=T,_=r,f=j;return K(),q(f,{ref_key:"popoverRef",ref:a,placement:"bottom",trigger:"click"},{trigger:z(()=>[Q(p,{type:F(i)?"error":F(o)?"warning":"default",text:!0,onClick:c},{default:z(()=>[se(ae(F(n)),1)]),_:1},8,["type"])]),default:z(()=>[Q(_,{value:F(l),"onUpdate:value":t[0]||(t[0]=e=>ue(l)?l.value=e:null),type:"date",panel:!0,actions:null,"is-date-disabled":s},{footer:z(()=>[X("div",xt,[Q(m,{size:"small"},{default:z(()=>[Q(p,{onClick:u},{default:z(()=>[se(ae(e.$t("Site.PHP.index_34")),1)]),_:1}),Q(p,{disabled:null===F(l),onClick:d},{default:z(()=>[se(ae(e.$t("Public.Btn.Confirm")),1)]),_:1},8,["disabled"])]),_:1})])]),_:1},8,["value"])]),_:1},512)}}}),[["__scopeId","data-v-4583ec55"]]),wt=["onClick"],St={class:"whitespace-nowrap mr-10px"},bt={class:"w-120px"},Pt=E({__name:"Ssl",props:{config:{type:[Number,Object],default:-1},sslApplyList:{type:Array,default:()=>[]}},emits:["click"],setup(e,{emit:t}){const a=t,{openSslLogsModal:l}=lt(),i=()=>{a("click")};return(t,a)=>{const n=S,s=D,o=d,r=B;return F(u)(e.config)?(K(),q(n,{key:0,type:e.config.endtime<0?"error":"primary",text:"",onClick:i},{default:z(()=>[se(ae(e.config.endtime<0?t.$t("Site.PHP.index_28"):t.$t("Site.PHP.index_29",[e.config.endtime])),1)]),_:1},8,["type"])):e.sslApplyList.length>0?(K(!0),ee(Y,{key:1},de(e.sslApplyList,e=>(K(),ee("div",{class:"flex flex-nowrap! p-10px cursor-pointer justify-between items-center",key:e.task_name,onClick:t=>{return a=t,i=e.task_log,a.stopPropagation(),void l(i);var a,i}},[X("span",St,ae(e.task_name),1),Q(r,{class:"items-center flex-nowrap!"},{default:z(()=>[X("div",bt,[Q(s,{class:"w-full",type:"line",status:"success","indicator-placement":"inside",percentage:e.task_status,processing:100!==e.task_status},null,8,["percentage","processing"])]),Q(o,{name:"base-left-logs",size:"18",color:"#666666"})]),_:2},1024)],8,wt))),128)):(K(),q(n,{key:2,type:"warning",text:"",onClick:i},{default:z(()=>[se(ae(t.$t("Site.PHP.index_30")),1)]),_:1}))}}}),Ct={class:"text-left"},Ht={class:"cursor-pointer"},jt=E({__name:"Requests",props:{name:{type:String,default:""},total:{type:[Number,String],default:0},value:{type:Array,default:()=>[]}},setup(e){const{openSiteStatisticsModal:t}=lt(),a=ne(()=>e.total.toLocaleString("en-US")),l=ne(()=>({xAxis:{type:"category",data:e.value.map(e=>e.date)},yAxis:{type:"value",show:!1},series:[{name:"页面浏览量",data:e.value.map(e=>e.value),type:"line",lineStyle:{color:"#20a53a",width:2},areaStyle:{color:"rgba(32, 165, 58, 0.1)"},symbol:"none"}],grid:{left:0,right:0,top:0,bottom:0}}));return(i,n)=>(K(),ee("div",{class:"flex flex-col gap-3px cursor-pointer",onClick:n[0]||(n[0]=a=>F(t)(!1,e.name))},[X("div",Ct,ae(F(a)),1),X("div",Ht,[Q(Ze,{type:"line",option:F(l),height:"15px"},null,8,["option"])])]))}}),Tt={class:"flex w-full items-center"},Bt={class:"flex-1 flex items-center justify-end"},Dt={class:"flex-1 flex justify-start"},Lt=E({__name:"Waf",props:{siteName:{type:String,default:""},total:{type:Number,default:0},status:{type:Boolean,default:!1},onUpdateStatus:{type:Function}},setup(e){const{openSiteWaf:t}=ze();return(a,l)=>{const i=S,n=s,o=L;return K(),ee("div",Tt,[X("div",Bt,[Q(i,{text:"",onClick:l[0]||(l[0]=a=>F(t)(e.siteName))},{default:z(()=>[se(ae(e.total),1)]),_:1})]),Q(n,{vertical:""}),X("div",Dt,[Q(o,{value:e.status,size:"small","onUpdate:value":e.onUpdateStatus},null,8,["value","onUpdate:value"])])])}}}),Vt={class:"inline-flex items-center"},At=E({__name:"OperateMenu",emits:["clickConfig","clickLog","clickOperate"],setup(e,{emit:t}){const a=t,l=[{key:"scan",label:"Security Scan",icon:()=>Q("i",{class:"i-ant-design:security-scan-outlined text-18px"},null)},{key:"delete",label:"Delete WebSite",icon:()=>Q("i",{class:"i-weui:delete-outlined text-18px"},null)}],i=e=>{a("clickOperate",e)};return(e,t)=>{const n=S,o=s,r=w;return K(),ee("div",Vt,[Q(n,{type:"primary",text:"",onClick:t[0]||(t[0]=e=>a("clickConfig"))},{default:z(()=>t[2]||(t[2]=[se("Conf",-1)])),_:1,__:[2]}),Q(o,{vertical:""}),Q(n,{class:"mr-8px",type:"primary",text:"",onClick:t[1]||(t[1]=e=>a("clickLog"))},{default:z(()=>t[3]||(t[3]=[se("Log",-1)])),_:1,__:[3]}),Q(r,{trigger:"click",options:l,onSelect:i},{default:z(()=>t[4]||(t[4]=[X("i",{class:"i-famicons:ellipsis-vertical text-18px cursor-pointer"},null,-1)])),_:1,__:[4]})])}}}),Mt=n(E({__name:"index",emits:["fetchTable","update:sorter","update:monitorMap"],setup(t,{expose:a,emit:l}){const i=l,n=Ie(),s=c(),{isFree:o,siteMonitorStatus:r}=Z(s),{webserver:d,waf:f,isWafInstall:v,monitor:h,isMonitorInstall:y}=Z(n),{t:g}=G(),{openBackupModal:x,openSiteConfig:k,openDeleteSiteConfig:w}=lt(),{setSiteStatus:b}=ze(),P=N([{type:"selection",width:40,minWidth:40,maxWidth:40},{key:"name",title:g("Site.PHP.index_17"),minWidth:160,sorter:!0,sortOrder:!1,render:e=>Q(ct,{ico:e.ico,name:e.name,description:e.ps,onClickName:()=>{k(e)},onClickServer:()=>{k(e,{menu:"webserver"})},onBlur:async t=>{await Ve({id:e.id,ps:t}),e.ps=t}},null)},{key:"status",title:g("Public.Table.Status"),align:"center",className:"sort-center",width:90,minWidth:90,maxWidth:90,sorter:!0,sortOrder:!1,render:e=>Q(_t,{status:e.status,onUpdateValue:t=>{b(t,e)}},null)},{key:"backup_count",title:g("Site.PHP.index_19"),width:"10%",minWidth:110,render:e=>Q(ft,{count:e.backup_count,lastTime:e.last_backup_time,onShowBackup:()=>{x(e)}},null)},{key:"path",title:"Quick action",align:"center",width:"8%",minWidth:100,render:e=>Q(gt,{path:e.path,phpVersion:e.php_version,onShowPhp:()=>{k(e,{menu:"php"})}},null)},we({type:"site",minWidth:70,callback:()=>{i("fetchTable")}}),{key:"edate",title:"Expiration",align:"center",width:"8%",minWidth:80,render:e=>Q(kt,{value:e.edate,onUpdateValue:async t=>{await Ae({id:e.id,edate:t}),e.edate=t}},null)},{key:"site_ssl",title:g("Site.PHP.index_27"),align:"center",width:100,minWidth:100,maxWidth:100,sorter:!0,sortOrder:!1,className:"sort-center",render:e=>{const t=U.value.filter(t=>t.target_id===e.id);return Q(Pt,{config:e.ssl,sslApplyList:t,onClick:()=>{k(e,{menu:"ssl"})}},null)}},{key:"requests",sorter:!0,sortOrder:!1,className:"requests",title:()=>Q("span",{class:"inline-flex items-center gap-6px"},[Q("span",null,[se("Requests")]),Q(j,{trigger:"hover"},{trigger:()=>Q("i",{class:"i-uiw:question-circle-o text-16px text-desc cursor-pointer"},null),default:()=>Q(Se,null,{default:()=>["",Q("li",null,[se("The monitoring report data will be updated as the website list is refreshed")]),Q("li",null,[se("The monitoring report plugin will use the plugin's data; if it is not installed, free monitoring report data will be used.")])]})})]),align:"center",width:"12%",minWidth:120,render:e=>{if("nginx"!==d.value&&"apache"!==d.value)return"--";if(!r.value&&o.value)return Q(S,{type:"primary",text:!0,onClick:()=>{Pe({source:216})}},{default:()=>[se("Active")]});if(!y.value&&!r.value)return Q(S,{type:"primary",text:!0,onClick:()=>{$e("monitor",async()=>{await n.getConfig(),i("fetchTable"),D()})}},{default:()=>[1===h.value.is_install?g("Public.Btn.Update"):g("Public.Btn.Install")]});const t=H.value[e.name];if(!V(t)){const a=T(t),l=B(t);return Q(jt,{name:e.name,total:a,value:l},null)}return"--"}},{key:"waf",title:"WAF",align:"center",width:"10%",minWidth:100,render:e=>{if("nginx"!==d.value)return"--";if(o.value)return Q(S,{type:"primary",text:!0,onClick:()=>{Pe({source:216})}},{default:()=>[se("Active")]});if(!v.value)return Q(S,{type:"primary",text:!0,onClick:()=>{$e("btwaf",async()=>{await n.getConfig(),i("fetchTable"),M()})}},{default:()=>[1===f.value.is_install?g("Public.Btn.Update"):g("Public.Btn.Install")]});const t=L.value.find(t=>t.siteName===e.name);if(u(t)){const a=A(t);return Q(Lt,{siteName:e.name,total:a,status:t.open,onUpdateStatus:async a=>{await Fe({siteName:e.name,obj:"open"}),t.open=a}},null)}return"--"}},{key:"operate",title:g("Public.Table.Operation"),align:"right",width:110,minWidth:110,maxWidth:110,render:e=>Q(At,{onClickConfig:()=>{k(e)},onClickLog:()=>{k(e,{menu:"logs"})},onClickOperate:t=>{switch(t){case"scan":k(e,{menu:"logs",subMenu:"security"});break;case"delete":w([e])}}},null)}]),C=e=>{P.value.forEach(t=>{const a=t;a.key===e.columnKey?a.sortOrder=e.order:a.sortOrder=!1});const t="descend"===e.order?"desc":"ascend"===e.order?"asc":"";if("requests"===e.columnKey)return void i("update:monitorMap",t);const a=t?"".concat(e.columnKey," ").concat(t):"";i("update:sorter",a)},H=ce({}),T=e=>e.total?e.total.request:0,B=e=>e.list.map(e=>({date:e.date,value:e.request})),D=async()=>{if("nginx"!==d.value&&"apache"!==d.value)return;if(o.value&&!r.value)return;const{message:e}=await qe((()=>{const e=new Date,t=Ge(e,-30);return{start_date:_(t,"yyyy-MM-dd"),end_date:_(e,"yyyy-MM-dd")}})());u(e)&&(H.value=e)},L=N([]),A=e=>e.total.reduce((e,t)=>e+t.value,0),M=async()=>{if(o.value)return;if(!v.value)return;const{message:e}=await Ke({p:1,limit:1e3,search:""});u(e)&&(L.value=p(e.data)?e.data.map(e=>({open:e.open,total:e.total,siteName:e.siteName})):[])};let R=null;const O=N(!1),U=N([]),E=async()=>{R&&clearTimeout(R);const{message:e}=await m();p(e)&&(U.value=e,e.length>0?(O.value=!0,R=window.setTimeout(()=>{E()},3e3)):(O.value&&i("fetchTable"),R&&clearTimeout(R)))};return(()=>{const t=e("site-php-order","");if(t){const[e,a]=t.split(" "),l=P.value.find(t=>t.key===e);l&&(l.sortOrder="asc"===a?"ascend":"descend")}})(),a({getMonitorData:D,getNginxWafConfig:M,getSSLApplyList:E,getColumns:()=>P.value,setColumns:e=>{P.value=e}}),(e,t)=>{const a=be;return K(),q(a,pe(e.$attrs,{columns:F(P),"onUpdate:sorter":C}),null,16,["columns"])}}}),[["__scopeId","data-v-fca1cf0d"]]),Rt={class:"p-20px"},Ot={class:"flex-1"},Ut={class:"mt-12px"},Et={class:"px-20px pt-24px pb-8px"},Wt={class:"w-150px"},Nt=E({__name:"set",props:{data:{}},setup(e){const{t:t}=G(),a=e,{setOptions:l}=a.data,i=N(""),n=async()=>{const e=i.value.trim();""!==e?(await Oe({name:e}),i.value="",await _(),null==l||l(c.data)):f.error(t("Site.PHP.index_46"))},s=Ce(),o=N(null),r=me({id:-1,name:""}),u={name:{required:!0,message:t("Site.PHP.index_46"),trigger:["blur","change"]}},d=async({hide:e})=>{var t;await(null==(t=o.value)?void 0:t.validate()),await Ue(_e(r)),await _(),null==l||l(c.data),e()},{table:c,columns:m}=He([{key:"name",title:"Name"},je({width:120,options:e=>[{label:t("Public.Btn.Edit"),disabled:0===e.id,onClick:()=>{(e=>{r.id=e.id,r.name=e.name,s.title="".concat(t("Site.PHP.index_48")," [").concat(e.name,"]"),s.show=!0})(e)}},{label:t("Public.Btn.Delete"),disabled:0===e.id,onClick:()=>{Te({title:"".concat(t("Site.PHP.index_49")," [").concat(e.name,"]"),content:t("Site.PHP.index_50"),onConfirm:async({hide:t})=>{await Me({id:e.id}),await _(),null==l||l(c.data,e.id),t()}})}}]})]),_=async()=>{const{message:e}=await Re();c.data=p(e)?e:[]};return _(),(e,t)=>{const a=A,l=S,p=B,_=M,f=R,v=tt,h=et;return K(),ee("div",Rt,[Q(p,null,{default:z(()=>[X("div",Ot,[Q(a,{value:F(i),"onUpdate:value":t[0]||(t[0]=e=>ue(i)?i.value=e:null),placeholder:e.$t("Site.PHP.index_46")},null,8,["value","placeholder"])]),X("div",null,[Q(l,{type:"primary",onClick:n},{default:z(()=>[se(ae(e.$t("Site.Cert.index_62")),1)]),_:1})])]),_:1}),X("div",Ut,[Q(_,{"max-height":300,data:F(c).data,columns:F(m)},null,8,["data","columns"])]),Q(h,{show:F(s).show,"onUpdate:show":t[2]||(t[2]=e=>F(s).show=e),title:F(s).title,width:350,footer:!0,onConfirm:d},{default:z(()=>[X("div",Et,[Q(v,{ref_key:"formRef",ref:o,model:F(r),rules:u},{default:z(()=>[Q(f,{label:e.$t("Site.PHP.index_47"),path:"name"},{default:z(()=>[X("div",Wt,[Q(a,{value:F(r).name,"onUpdate:value":t[1]||(t[1]=e=>F(r).name=e),placeholder:""},null,8,["value"])])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["show","title"])])}}}),It={class:"w-160px"},$t=E({__name:"index",props:{value:{default:null}},emits:["change","update:value"],setup(e,{emit:t}){const a=t,l=fe(e,"value"),{t:i}=G(),{loading:n,setLoading:s}=Be(),o=N([]),r=async e=>{a("change"),a("update:value",e),sessionStorage.setItem("typeValue",e)},u=Ce(i("Site.PHP.index_44"),{setOptions:(e,t)=>{t===l.value&&(l.value=-1),o.value=e.map(e=>({label:e.name,value:e.id})),c()}}),d=()=>{u.show=!0},c=()=>{o.value.unshift({label:i("Site.PHP.index_45"),value:-1})};return c(),I(()=>{(async()=>{try{s(!0);const{message:e}=await Re();p(e)?o.value=e.map(e=>({label:e.name,value:e.id})):o.value=[],c()}finally{s(!1);const e=sessionStorage.getItem("typeValue");l.value=e?Number(e):-1}})()}),(e,t)=>{const a=S,i=O,s=et;return K(),ee("div",It,[Q(i,{value:F(l),"onUpdate:value":t[0]||(t[0]=e=>ue(l)?l.value=e:null),loading:F(n),options:F(o),onUpdateValue:r},{action:z(()=>[Q(a,{block:"",onClick:d},{default:z(()=>[se(ae(e.$t("Site.PHP.index_43")),1)]),_:1})]),_:1},8,["value","loading","options"]),Q(s,{show:F(u).show,"onUpdate:show":t[1]||(t[1]=e=>F(u).show=e),width:350,title:F(u).title,data:F(u).data,component:Nt},null,8,["show","title","data"])])}}}),qt=E({__name:"index",setup(a){const i=Ie(),n=c(),{web:s,webserver:o}=Z(i),{t:r}=G(),{openAddSiteModal:u,openSiteAdvancedModal:d,openDeleteSiteConfig:p,openSiteStatisticsModal:m}=lt(),{tableConfig:_,tableData:f,pageConfig:k,tableParams:b,fetchTable:P,resetTable:C,setLoading:H}=De({params:{p:1,limit:10,table:"sites",search:"",order:e("site-php-order",""),type:-1,re_order:""},immediate:!1,fetchFn:Ne}),j=re("siteTableRef");he("tableRef",j);const B=N(!1),D=N([]),L=[{label:r("Site.PHP.index_5"),key:"default-page"},{label:r("Site.PHP.index_6"),key:"default-site"},{label:r("Site.PHP.index_7"),key:"php-version"},{label:r("Site.PHP.index_86"),key:"https"},{label:r("CDN Resolution"),key:"global"}],V=[{key:"enable",type:"confirm",label:r("Site.Batch.index_1"),confirm:{title:r("Site.Batch.index_2"),desc:r("Site.Batch.index_3"),columns:[{key:"name",title:r("Site.PHP.index_17")}],api:e=>Ee(!0,{id:e.id,name:e.name},!1),done:()=>{P(!1)}}},{key:"disable",type:"confirm",label:r("Site.Batch.index_4"),confirm:{title:r("Site.Batch.index_5"),desc:r("Site.Batch.index_6"),columns:[{key:"name",title:r("Site.PHP.index_17")}],api:e=>Ee(!1,{id:e.id,name:e.name},!1),done:()=>{P(!1)}}},{key:"backup",type:"confirm",label:r("Site.Batch.index_7"),confirm:{title:r("Site.Batch.index_8"),desc:r("Site.Batch.index_9"),columns:[{key:"name",title:r("Site.PHP.index_17")}],api:e=>We({id:e.id},!1),done:()=>{P(!1)}}},{key:"expired",label:r("Site.PHP.index_70"),onBatch:e=>{xe({title:r("Site.PHP.index_71"),width:380,minHeight:72,footer:!0,data:{rows:e},component:J(()=>l(()=>import("./expired.js?v=1767769852656"),__vite__mapDeps([68,11,2,3,4,5,7,6,9,8,17,18,58])))})}},{key:"php",label:r("Site.PHP.index_66"),onBatch:e=>{xe({title:r("Site.PHP.index_65"),width:500,minHeight:198,footer:!0,data:{rows:e,refresh:W},component:J(()=>l(()=>import("./php2.js?v=1767769852656"),__vite__mapDeps([69,7,6,2,3,4,5,9,8,11,17,18,58])))})}},{key:"category",label:r("Crontab.Planned.index_19"),onBatch:e=>{xe({title:r("Site.Batch.index_22"),width:350,minHeight:72,footer:!0,data:{rows:e},component:J(()=>l(()=>import("./category.js?v=1767769852656"),__vite__mapDeps([70,11,2,3,4,5,6,7,8,9,17,18])))})}},{key:"webserver",label:"Switch service",onBatch:e=>{xe({title:"Batch switch service",width:450,minHeight:150,footer:!0,data:{rows:e},component:J(()=>l(()=>import("./webserver.js?v=1767769852656"),__vite__mapDeps([71,7,6,2,3,4,5,9,8,11,18,22,72])))})}},{key:"delete",label:r("Site.Batch.index_10"),onBatch:e=>{p(e)}}],A=()=>{u()},M=e=>{b.value.order=e,t("site-php-order",e),P()},R=e=>{b.value.p=1,b.value.limit=100,b.value.re_order=e,P()},O=e=>{d(e)},E=async()=>{var e,t,a;await C(),null==(e=j.value)||e.getNginxWafConfig(),null==(t=j.value)||t.getMonitorData(),null==(a=j.value)||a.getSSLApplyList(),D.value=[]},W=async(e=!1)=>{var t,a,l;await P(e,!0),null==(t=j.value)||t.getSSLApplyList(),null==(a=j.value)||a.getNginxWafConfig(),null==(l=j.value)||l.getMonitorData(),D.value=[]},Y=async()=>{try{H(!0),await i.getConfig(),B.value=s.value.setup,s.value.setup&&await W()}finally{H(!1)}};return $(()=>i.isRefresh,e=>{e&&(i.setRefresh(!1),W())}),$(()=>n.taskCount,()=>{Y()}),H(!0),I(async()=>{Y()}),(e,t)=>{const a=v,l=S,i=w,n=T,r=ge,u=ye,c=at,p=x,C=g,H=y,N=h,I=U;return K(),q(I,null,{default:z(()=>[Q(N,{install:F(s).setup},{desc:z(()=>[X("span",null,ae(e.$t("Site.PHP.index_1")),1),Q(a,{class:"ml-4px",onClick:t[0]||(t[0]=e=>F(Le)("nginx"))},{default:z(()=>[se(ae(e.$t("Site.PHP.index_2")),1)]),_:1}),t[8]||(t[8]=X("span",{class:"mx-4px"},"|",-1)),Q(a,{onClick:t[1]||(t[1]=e=>F(Le)("apache"))},{default:z(()=>[se(ae(e.$t("Site.PHP.index_3")),1)]),_:1})]),default:z(()=>[Q(H,{class:"p-16px",feedback:!0},{toolsLeft:z(()=>[Q(l,{type:"primary",class:"add-site-btn",onClick:A},{default:z(()=>[se(ae(e.$t("Site.PHP.index_4")),1)]),_:1}),Q(n,null,{default:z(()=>[Q(l,{onClick:t[2]||(t[2]=e=>F(d)())},{default:z(()=>[se(ae(e.$t("Database.Mysql.index_3")),1)]),_:1}),Q(i,{trigger:"hover",options:L,onSelect:O},{default:z(()=>[Q(l,null,{default:z(()=>t[9]||(t[9]=[X("i",{class:"i-fa:angle-down"},null,-1)])),_:1,__:[9]})]),_:1})]),_:1}),Q(l,{onClick:t[3]||(t[3]=e=>F(m)(!0))},{default:z(()=>[se(ae(e.$t("Statistics")),1)]),_:1}),F(B)?(K(),q(r,{key:0,"soft-name":F(o),"is-web-site":!0},null,8,["soft-name"])):ve("",!0)]),toolsRight:z(()=>[Q($t,{value:F(b).type,"onUpdate:value":t[4]||(t[4]=e=>F(b).type=e),onChange:E},null,8,["value"]),Q(u,{value:F(b).search,"onUpdate:value":t[5]||(t[5]=e=>F(b).search=e),placeholder:e.$t("Site.PHP.index_8"),onSearch:E},null,8,["value","placeholder"]),Q(c,{"store-key":"site-php-columns",loading:F(_).loading,"hide-keys":["quota"],"disabled-keys":["name"]},null,8,["loading"])]),table:z(()=>[Q(Mt,pe({ref_key:"siteTableRef",ref:j,"checked-row-keys":F(D),"onUpdate:checkedRowKeys":t[6]||(t[6]=e=>ue(D)?D.value=e:null)},F(_),{onFetchTable:F(P),"onUpdate:sorter":M,"onUpdate:monitorMap":R}),null,16,["checked-row-keys","onFetchTable"])]),pageLeft:z(()=>[Q(p,{"checked-row-keys":F(D),"onUpdate:checkedRowKeys":t[7]||(t[7]=e=>ue(D)?D.value=e:null),data:F(f),options:V},null,8,["checked-row-keys","data"])]),pageRight:z(()=>[Q(C,pe(F(k),{"store-key":"site-php-page",onRefresh:W}),null,16)]),_:1})]),_:1},8,["install"])]),_:1})}}}),Kt=Object.freeze(Object.defineProperty({__proto__:null,default:qt},Symbol.toStringTag,{value:"Module"}));export{Kt as i,lt as u};
