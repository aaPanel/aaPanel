import{Z as e,a0 as t,r as a,c as i,o as r,b as n,k as s,P as c,R as o,V as l,S as u,W as d,F as y,O as f,H as p,a4 as h,U as m,a2 as S,a3 as v,l as g,an as b,j as x,v as k,X as w,aG as _,y as M,s as C,I}from"./vue.js?v=1767769852656";import{aE as T,i as j,d as P,q as E,p as O,f as R,x as L,m as A,ap as N,aA as B,c7 as D,bs as F,br as z}from"./page_layout.js?v=1767769852656";import{dm as H,aC as $,bH as q,dS as W,dY as U,dd as V,dc as X,G as Z}from"./naive.js?v=1767769852656";import{C as Y,a as K,h as J}from"./public.js?v=1767769852656";import{_ as G}from"./index.vue_vue_type_script_setup_true_lang16.js?v=1767769852656";import"./__commonjsHelpers__.js?v=1767769852656";import"./common.js?v=1767769852656";import"./echarts.js?v=1767769852656";const Q=e("site-security-store",()=>{const e=a(!1),t=a(""),r=a({score:0,risk_count:{warning:0,low:0,middle:0,high:0}}),n=a([]),s=a(0),c=a({xss:0,sql_injection:0,file_traversal:0,php_execution:0,sensitive_files:0}),o=a({}),l=a({}),u=a({status:"init",msg:"",bar:0,type:""}),d=i(()=>"scanning"===u.value.status);return{isNone:e,scanInfo:u,scanTime:t,isScanning:d,scoreInfo:r,ipTop:n,duration:s,totalAttack:c,details:o,detailsLoading:l,getResult:async()=>{const{message:a}=await T.post("/project/webbasicscanning/get_scan_result");if(P(a)){if(H(a))return void(e.value=!0);e.value=!1,t.value=a.scan_time,r.value={score:a.score,risk_count:a.risk_count},n.value=a.ip_top,s.value=a.duration,c.value=a.total_attack,o.value=a.details,Object.keys(a.details).forEach(e=>{l.value[e]=!1})}else e.value=!0},startScan:()=>{e.value=!1,u.value.status="scanning",u.value.msg="",u.value.bar=0,u.value.type="",Object.keys(l.value).forEach(e=>{l.value[e]=!0}),Object.keys(o.value).forEach(e=>{o.value[e]=[]})},endScan:()=>{u.value.status="init",u.value.msg="",u.value.bar=0,u.value.type="",Object.keys(l.value).forEach(e=>{l.value[e]=!1})},setScanInfo:(e,t)=>{u.value.msg=e,u.value.bar=t},setScanType:e=>{u.value.type=e,l.value[e]=!1},setScanResult:(e,t)=>{o.value[e].push(...t)}}}),ee=()=>{const e=Q();return{store:e,...t(e)}};var te={};!function e(t,a,i,r){var n=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),s="function"==typeof Path2D&&"function"==typeof DOMMatrix;function c(){}function o(e){var i=a.exports.Promise,r=void 0!==i?i:t.Promise;return"function"==typeof r?new r(e):(e(c,c),null)}var l,u,d,y,f,p,h=function(e,t){return{transform:function(a){if(e)return a;if(t.has(a))return t.get(a);var i=new OffscreenCanvas(a.width,a.height);return i.getContext("2d").drawImage(a,0,0),t.set(a,i),i},clear:function(){t.clear()}}}(function(){if(!t.OffscreenCanvas)return!1;try{var e=new OffscreenCanvas(1,1),a=e.getContext("2d");a.fillRect(0,0,1,1);var i=e.transferToImageBitmap();a.createPattern(i,"no-repeat")}catch(r){return!1}return!0}(),new Map),m=(d=Math.floor(1e3/60),y={},f=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(l=function(e){var t=Math.random();return y[t]=requestAnimationFrame(function a(i){f===i||f+d-1<i?(f=i,delete y[t],e()):y[t]=requestAnimationFrame(a)}),t},u=function(e){y[e]&&cancelAnimationFrame(y[e])}):(l=function(e){return setTimeout(e,d)},u=function(e){return clearTimeout(e)}),{frame:l,cancel:u}),S=function(){var t,a,r={};return function(){if(t)return t;if(!i&&n){var s=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{t=new Worker(URL.createObjectURL(new Blob([s])))}catch(c){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("ðŸŽŠ Could not load worker",c),null}!function(e){function t(t,a){e.postMessage({options:t||{},callback:a})}e.init=function(t){var a=t.transferControlToOffscreen();e.postMessage({canvas:a},[a])},e.fire=function(i,n,s){if(a)return t(i,null),a;var c=Math.random().toString(36).slice(2);return a=o(function(n){function o(t){t.data.callback===c&&(delete r[c],e.removeEventListener("message",o),a=null,h.clear(),s(),n())}e.addEventListener("message",o),t(i,c),r[c]=o.bind(null,{data:{callback:c}})})},e.reset=function(){for(var t in e.postMessage({reset:!0}),r)r[t](),delete r[t]}}(t)}return t}}(),v={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function g(e,t,a){return function(e,t){return t?t(e):e}(e&&null!=e[t]?e[t]:v[t],a)}function b(e){return e<0?0:Math.floor(e)}function x(e,t){return Math.floor(Math.random()*(t-e))+e}function k(e){return parseInt(e,16)}function w(e){return e.map(_)}function _(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:k(t.substring(0,2)),g:k(t.substring(2,4)),b:k(t.substring(4,6))}}function M(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function C(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function I(e){var t=e.angle*(Math.PI/180),a=e.spread*(Math.PI/180);return{x:e.x,y:e.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*e.startVelocity+Math.random()*e.startVelocity,angle2D:-t+(.5*a-Math.random()*a),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:e.color,shape:e.shape,tick:0,totalTicks:e.ticks,decay:e.decay,drift:e.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*e.gravity,ovalScalar:.6,scalar:e.scalar,flat:e.flat}}function T(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var a=t.tick++/t.totalTicks,i=t.x+t.random*t.tiltCos,r=t.y+t.random*t.tiltSin,n=t.wobbleX+t.random*t.tiltCos,c=t.wobbleY+t.random*t.tiltSin;if(e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-a)+")",e.beginPath(),s&&"path"===t.shape.type&&"string"==typeof t.shape.path&&Array.isArray(t.shape.matrix))e.fill(function(e,t,a,i,r,n,s){var c=new Path2D(e),o=new Path2D;o.addPath(c,new DOMMatrix(t));var l=new Path2D;return l.addPath(o,new DOMMatrix([Math.cos(s)*r,Math.sin(s)*r,-Math.sin(s)*n,Math.cos(s)*n,a,i])),l}(t.shape.path,t.shape.matrix,t.x,t.y,.1*Math.abs(n-i),.1*Math.abs(c-r),Math.PI/10*t.wobble));else if("bitmap"===t.shape.type){var o=Math.PI/10*t.wobble,l=.1*Math.abs(n-i),u=.1*Math.abs(c-r),d=t.shape.bitmap.width*t.scalar,y=t.shape.bitmap.height*t.scalar,f=new DOMMatrix([Math.cos(o)*l,Math.sin(o)*l,-Math.sin(o)*u,Math.cos(o)*u,t.x,t.y]);f.multiplySelf(new DOMMatrix(t.shape.matrix));var p=e.createPattern(h.transform(t.shape.bitmap),"no-repeat");p.setTransform(f),e.globalAlpha=1-a,e.fillStyle=p,e.fillRect(t.x-d/2,t.y-y/2,d,y),e.globalAlpha=1}else if("circle"===t.shape)e.ellipse?e.ellipse(t.x,t.y,Math.abs(n-i)*t.ovalScalar,Math.abs(c-r)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):function(e,t,a,i,r,n,s,c,o){e.save(),e.translate(t,a),e.rotate(n),e.scale(i,r),e.arc(0,0,1,s,c,o),e.restore()}(e,t.x,t.y,Math.abs(n-i)*t.ovalScalar,Math.abs(c-r)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if("star"===t.shape)for(var m=Math.PI/2*3,S=4*t.scalar,v=8*t.scalar,g=t.x,b=t.y,x=5,k=Math.PI/x;x--;)g=t.x+Math.cos(m)*v,b=t.y+Math.sin(m)*v,e.lineTo(g,b),m+=k,g=t.x+Math.cos(m)*S,b=t.y+Math.sin(m)*S,e.lineTo(g,b),m+=k;else e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(r)),e.lineTo(Math.floor(n),Math.floor(c)),e.lineTo(Math.floor(i),Math.floor(t.wobbleY));return e.closePath(),e.fill(),t.tick<t.totalTicks}function j(e,a){var s,c=!e,l=!!g(a||{},"resize"),u=!1,d=g(a,"disableForReducedMotion",Boolean),y=n&&!!g(a||{},"useWorker")?S():null,f=c?M:C,p=!(!e||!y)&&!!e.__confetti_initialized,v="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function k(t,a,n){for(var c=g(t,"particleCount",b),l=g(t,"angle",Number),u=g(t,"spread",Number),d=g(t,"startVelocity",Number),y=g(t,"decay",Number),p=g(t,"gravity",Number),S=g(t,"drift",Number),v=g(t,"colors",w),k=g(t,"ticks",Number),_=g(t,"shapes"),M=g(t,"scalar"),C=!!g(t,"flat"),j=function(e){var t=g(e,"origin",Object);return t.x=g(t,"x",Number),t.y=g(t,"y",Number),t}(t),P=c,E=[],O=e.width*j.x,R=e.height*j.y;P--;)E.push(I({x:O,y:R,angle:l,spread:u,startVelocity:d,color:v[P%v.length],shape:_[x(0,_.length)],ticks:k,decay:y,gravity:p,drift:S,scalar:M,flat:C}));return s?s.addFettis(E):(s=function(e,t,a,n,s){var c,l,u=t.slice(),d=e.getContext("2d"),y=o(function(t){function o(){c=l=null,d.clearRect(0,0,n.width,n.height),h.clear(),s(),t()}c=m.frame(function t(){!i||n.width===r.width&&n.height===r.height||(n.width=e.width=r.width,n.height=e.height=r.height),n.width||n.height||(a(e),n.width=e.width,n.height=e.height),d.clearRect(0,0,n.width,n.height),(u=u.filter(function(e){return T(d,e)})).length?c=m.frame(t):o()}),l=o});return{addFettis:function(e){return u=u.concat(e),y},canvas:e,promise:y,reset:function(){c&&m.cancel(c),l&&l()}}}(e,E,f,a,n),s.promise)}function _(a){var i=d||g(a,"disableForReducedMotion",Boolean),r=g(a,"zIndex",Number);if(i&&v)return o(function(e){e()});c&&s?e=s.canvas:c&&!e&&(e=function(e){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=e,t}(r),document.body.appendChild(e)),l&&!p&&f(e);var n={width:e.width,height:e.height};function h(){if(y){var t={getBoundingClientRect:function(){if(!c)return e.getBoundingClientRect()}};return f(t),void y.postMessage({resize:{width:t.width,height:t.height}})}n.width=n.height=null}function m(){s=null,l&&(u=!1,t.removeEventListener("resize",h)),c&&e&&(document.body.contains(e)&&document.body.removeChild(e),e=null,p=!1)}return y&&!p&&y.init(e),p=!0,y&&(e.__confetti_initialized=!0),l&&!u&&(u=!0,t.addEventListener("resize",h,!1)),y?y.fire(a,n,m):k(a,n,m)}return _.reset=function(){y&&y.reset(),s&&s.reset()},_}function P(){return p||(p=j(null,{useWorker:!0,resize:!0})),p}a.exports=function(){return P().apply(this,arguments)},a.exports.reset=function(){P().reset()},a.exports.create=j,a.exports.shapeFromPath=function(e){if(!s)throw new Error("path confetti are not supported in this browser");var t,a;"string"==typeof e?t=e:(t=e.path,a=e.matrix);var i=new Path2D(t),r=document.createElement("canvas").getContext("2d");if(!a){for(var n,c,o=1e3,l=o,u=o,d=0,y=0,f=0;f<o;f+=2)for(var p=0;p<o;p+=2)r.isPointInPath(i,f,p,"nonzero")&&(l=Math.min(l,f),u=Math.min(u,p),d=Math.max(d,f),y=Math.max(y,p));n=d-l,c=y-u;var h=Math.min(10/n,10/c);a=[h,0,0,h,-Math.round(n/2+l)*h,-Math.round(c/2+u)*h]}return{type:"path",path:t,matrix:a}},a.exports.shapeFromText=function(e){var t,a=1,i="#000000",r='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"==typeof e?t=e:(t=e.text,a="scalar"in e?e.scalar:a,r="fontFamily"in e?e.fontFamily:r,i="color"in e?e.color:i);var n=10*a,s=n+"px "+r,c=new OffscreenCanvas(n,n),o=c.getContext("2d");o.font=s;var l=o.measureText(t),u=Math.ceil(l.actualBoundingBoxRight+l.actualBoundingBoxLeft),d=Math.ceil(l.actualBoundingBoxAscent+l.actualBoundingBoxDescent),y=l.actualBoundingBoxLeft+2,f=l.actualBoundingBoxAscent+2;u+=4,d+=4,(o=(c=new OffscreenCanvas(u,d)).getContext("2d")).font=s,o.fillStyle=i,o.fillText(t,y,f);var p=1/a;return{type:"bitmap",bitmap:c.transferToImageBitmap(),matrix:[p,0,0,p,-u*p/2,-d*p/2]}}}(function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:this||{}}(),te,!1);const ae=te.exports;te.exports.create;const ie={class:"site-security-info"},re={class:"my-24px"},ne={class:"flex items-center justify-evenly py-20px"},se={class:"min-w-0"},ce={class:"feature-title"},oe={class:"feature-desc"},le={class:"my-24px"},ue={class:"overview-title"},de=O(s({__name:"info",setup(e){const{t:t}=c(),a=i(()=>[{key:"scan",icon:"i-security:feature-tips",title:t("Security.SiteSecurity.Info.features.scan.title"),desc:t("Security.SiteSecurity.Info.features.scan.desc")},{key:"trojan",icon:"i-security:feature-trojan",title:t("Security.SiteSecurity.Info.features.trojan.title"),desc:t("Security.SiteSecurity.Info.features.trojan.desc")},{key:"log",icon:"i-security:feature-record",title:t("Security.SiteSecurity.Info.features.log.title"),desc:t("Security.SiteSecurity.Info.features.log.desc")}]);return(e,t)=>{const i=E;return l(),o("div",ie,[u("div",re,[d(i)]),u("div",ne,[(l(!0),o(y,null,f(m(a),e=>(l(),o("div",{key:e.key,class:"feature-item"},[u("i",{class:p(["feature-icon",e.icon])},null,2),u("div",se,[u("div",ce,h(e.title),1),u("div",oe,h(e.desc),1)])]))),128))]),u("div",le,[d(i)]),u("div",ue,[t[0]||(t[0]=u("i",{class:"overview-icon i-security:overview"},null,-1)),u("span",null,h(e.$t("Security.SiteSecurity.Info.overviewTitle")),1)]),t[1]||(t[1]=u("div",{class:"flex justify-center mt-24px"},[u("img",{class:"w-900px",src:"/static/vite/images/site-security-bg.png"})],-1))])}}}),[["__scopeId","data-v-41148346"]]),ye={key:0,class:"flex flex-col justify-center items-center w-full h-50px"},fe={class:"flex items-center justify-between w-full"},pe={class:"flex gap-20px items-center text-14px font-bold"},he={class:"text-default"},me={class:"right"},Se={class:"w-full mt-12px"},ve={class:"flex items-center gap-20px justify-between"},ge={class:"text-20px font-bold leading-36px"},be={class:"mt-14px text-14px text-default leading-20px"},xe=O(s({__name:"index",setup(e){const{store:t,isNone:a,scoreInfo:i,scanInfo:s,isScanning:f,scanTime:p}=ee(),{t:w}=c(),{trigger:_}=function(){const e=e=>e?e.then(()=>null):Promise.resolve(null);let t=t=>e(ae(t));return r(()=>{"undefined"!=typeof window&&(t=t=>e(ae(t)))}),n(()=>{}),{trigger:e=>{const a={particleCount:500,spread:80,startVelocity:120,gravity:1,ticks:300,angle:90,origin:{x:.5,y:1},...e||{}};return t(a)},stream:(e=2e3,a)=>new Promise(i=>{const r=Date.now()+e,n=()=>{t({particleCount:8,angle:90,spread:70,origin:{x:.5,y:1},...a?a():{}}),Date.now()<r?requestAnimationFrame(n):i()};n()})}}(),{open:M,send:C,close:I}=Y("/ws_project",{immediate:!1,onMessage:(e,a)=>{if(R(a.data)){const e=JSON.parse(a.data);Object.hasOwnProperty.call(e,"end")&&(t.setScanInfo(e.info,e.bar),e.type&&t.setScanType(e.type),L(e.results)&&e.results.length&&t.setScanResult(e.type,e.results),e.end&&(I(),t.endScan(),T()))}}}),T=async()=>{await t.getResult(),a.value?A.error(w("Security.SiteSecurity.Header.noPhpSite"),{close:!0}):i.value.score>=90&&_()},j=()=>{I(),t.endScan(),a.value=!0},P=()=>{t.startScan(),M(),C({model_index:"safe",mod_name:"webbasicscanning",def_name:"ScanAllSite",ws_callback:"123"})};return(e,t)=>{const i=$,r=q,n=W;return l(),S(n,{class:"p-16px"},{default:v(()=>[m(a)?(l(),o(y,{key:1},[g(u("div",ve,[u("div",null,[u("div",ge,h(e.$t("Security.SiteSecurity.Header.title")),1),u("div",be,h(e.$t("Security.SiteSecurity.Header.desc")),1)]),d(i,{type:"primary",onClick:P},{default:v(()=>[x(h(e.$t("Security.SiteSecurity.Header.scanNow")),1)]),_:1})],512),[[k,m(a)]]),d(de)],64)):(l(),o("div",ye,[u("div",fe,[u("div",pe,[u("div",null,h(m(f)?e.$t("Security.SiteSecurity.Header.scanning"):e.$t("Security.SiteSecurity.Header.lastScanTime")),1),u("span",he,h(m(f)?m(s).msg:m(p)||"--"),1)]),u("div",me,[m(f)?(l(),S(i,{key:0,type:"warning",ghost:"",onClick:j},{default:v(()=>[x(h(e.$t("Security.SiteSecurity.Header.cancelScan")),1)]),_:1})):b("",!0),m(f)?b("",!0):(l(),S(i,{key:1,type:"primary",onClick:P},{default:v(()=>[x(h(e.$t("Security.SiteSecurity.Header.scanNow")),1)]),_:1}))])]),g(u("div",Se,[d(r,{status:"success",processing:"",percentage:m(s).bar,"show-indicator":!1},null,8,["percentage"])],512),[[k,m(f)]])]))]),_:1})}}}),[["__scopeId","data-v-bb415a5d"]]),ke={class:"mb-10px text-16px font-700"},we=s({__name:"score",setup(e){const{t:t}=c(),{scanInfo:a,scoreInfo:i}=ee(),r=N(),n=w("--color-text-1"),s=w("--color-text-3"),o=[{value:0,key:"high",name:t("Security.SiteSecurity.RiskLevel.high"),color:r.value.errorColor},{value:0,key:"middle",name:t("Security.SiteSecurity.RiskLevel.middle"),color:"#ffb84d"},{value:0,key:"low",name:t("Security.SiteSecurity.RiskLevel.low"),color:"#F7E459"},{value:0,key:"none",name:"",color:r.value.primaryColor}],y=_({tooltip:{show:!1},legend:g(),series:p(),graphic:f(i.value.score)});function f(e,a){return[{type:"group",left:"center",top:"40%",children:[{type:"text",left:"center",style:{text:"".concat(e),fontSize:44,fontWeight:700,fill:n.value}},{type:"text",left:"center",top:58,style:{text:a||t("Security.SiteSecurity.Summary.scoreLabel"),fontSize:12,fill:s.value}}]}]}function p(){const e=o.filter(e=>e.value>0);return[{type:"pie",radius:["110%","124%"],center:["50%","70%"],startAngle:180,endAngle:0,clockwise:!0,avoidLabelOverlap:!0,label:{show:!1},labelLine:{show:!1},legendHoverLink:!1,padAngle:e.length>1?2:0,itemStyle:{borderRadius:999},data:[...e.map(e=>({value:e.value,name:e.name,itemStyle:{color:e.color}}))]}]}function g(){const e=new Map,t={};o.forEach((a,i)=>{if("none"===a.key)return;const r="k".concat(i);e.set(a.name,r),t[r]={color:a.color,fontWeight:500}});return{bottom:0,left:"center",itemWidth:12,itemHeight:12,icon:"rect",selectedMode:!1,data:o.filter(e=>e.value>0).map(e=>e.name),formatter:t=>{var a,i;const r=o.find(e=>e.name===t),n=null!=(a=e.get(t))?a:"",s="".concat(t,": ").concat(null!=(i=null==r?void 0:r.value)?i:0);return n?"{".concat(n,"|").concat(s,"}"):s},textStyle:{fontSize:14,rich:t}}}const b=e=>{o.forEach(t=>{var a;t.value=null!=(a=e[t.key])?a:0});const t=o.filter(e=>"none"!==e.key).reduce((e,t)=>e+t.value,0),a=o.find(e=>"none"===e.key);a.value=0!==t?0:1};return M(()=>{var e;"scanning"===a.value.status?(b({}),y.legend=g(),y.series=p(),y.graphic=f("...",t("Security.SiteSecurity.Header.scanning"))):(e=i.value,b(e.risk_count),y.legend=g(),y.series=p(),y.graphic=f(e.score))}),(e,t)=>{const a=W;return l(),S(a,{class:"p-24px h-full"},{default:v(()=>[u("div",ke,h(e.$t("Security.SiteSecurity.Summary.scoreTitle")),1),d(G,{height:"220px",option:m(y)},null,8,["option"])]),_:1})}}}),_e={class:"mb-10px text-16px font-700"},Me=s({__name:"top",setup(e){const{store:t,isScanning:i,ipTop:r}=ee(),{t:n}=c(),s=a([{key:"ip",title:n("Security.SiteSecurity.Top.columns.ip"),render:e=>d($,{text:!0,type:1===e.deny_status?"default":"primary",class:1===e.deny_status?"text-font3 line-through":"",onClick:()=>{1===e.deny_status?y(e.ip):o(e.ip)}},{default:()=>[e.ip]})},{key:"count",title:n("Security.SiteSecurity.Top.columns.count")}]),o=e=>{K({title:n("Security.SiteSecurity.Top.banTitle",[e]),content:n("Security.SiteSecurity.Top.banContent"),onConfirm:async()=>{const{message:a}=await(i={address:e,types:"drop",domain:"",choose:"address",brief:n("Security.SiteSecurity.Top.banBrief")},T.post("/safe/syslog/create_ip_rules",{data:JSON.stringify(i)},{requestOptions:{loading:j.global.t("Component.Pay.index_12"),successMessage:!1}}));var i;L(a)&&a.length>0&&(a[0].status?(A.success(a[0].msg),t.getResult()):A.error(a[0].msg))}})},y=e=>{K({title:n("Security.SiteSecurity.Top.unbanTitle",[e]),content:n("Security.SiteSecurity.Top.unbanContent"),onConfirm:async()=>{const{message:a}=await(i={address:e},T.post("/safe/syslog/remove_ip_rules",{data:JSON.stringify(i)},{requestOptions:{loading:j.global.t("Component.Pay.index_12"),successMessage:!1}}));var i;L(a)&&a.length>0&&A.success(a[0].msg),t.getResult()}})};return(e,t)=>{const a=J,n=W;return l(),S(n,{class:"p-24px h-300px"},{default:v(()=>[u("div",_e,h(e.$t("Security.SiteSecurity.Top.title")),1),d(a,{"max-height":176,loading:m(i),data:m(r),columns:m(s)},null,8,["loading","data","columns"])]),_:1})}}}),Ce=s({__name:"index",setup:e=>(e,t)=>{const a=U,i=B;return l(),S(i,{"x-gap":10,cols:3},{default:v(()=>[d(a,{span:1},{default:v(()=>[d(we)]),_:1}),d(a,{span:2},{default:v(()=>[d(Me)]),_:1})]),_:1})}}),Ie={class:"metric-label"},Te={class:"metric-value"},je={class:"metric-unit"},Pe={class:"metric-desc"},Ee={class:"metric-icon"},Oe=O({__name:"item",props:{label:{type:String},value:{type:[String,Number]},desc:{type:String},unit:{type:String},icon:{type:String}},setup(e){const{isScanning:t}=ee();return(a,i)=>{const r=W;return l(),S(r,{class:"metric-item"},{default:v(()=>[u("div",Ie,h(e.label),1),u("div",Te,[m(t)?(l(),o(y,{key:0},[x(h(a.$t("Security.SiteSecurity.Header.scanning"))+"...",1)],64)):(l(),o(y,{key:1},[x(h(e.value)+" ",1),u("span",je,h(e.unit),1)],64))]),u("div",Pe,h(e.desc),1),u("div",Ee,[u("i",{class:p(e.icon)},null,2)])]),_:1})}}},[["__scopeId","data-v-0379de28"]]),Re=s({__name:"index",setup(e){const{duration:t,totalAttack:a}=ee(),{t:r}=c(),n=i(()=>[{key:"duration",label:r("Security.SiteSecurity.Metric.duration"),value:t.value,unit:r("Security.SiteSecurity.Metric.seconds"),icon:"i-security:time",desc:r("Security.SiteSecurity.Metric.durationDesc")},{key:"xss",label:"XSS",value:a.value.xss,icon:"i-security:xss",desc:r("Security.SiteSecurity.Metric.xssDesc")},{key:"sql",label:"SQL",value:a.value.sql_injection,icon:"i-security:sql",desc:r("Security.SiteSecurity.Metric.sqlDesc")},{key:"scan",label:r("Security.SiteSecurity.Metric.maliciousScan"),value:a.value.file_traversal,icon:"i-security:malicious-scan",desc:r("Security.SiteSecurity.Metric.maliciousScanDesc")},{key:"php",label:r("Security.SiteSecurity.Metric.phpAttack"),value:a.value.php_execution,icon:"i-security:php",desc:r("Security.SiteSecurity.Metric.phpAttackDesc")}]);return(e,t)=>{const a=U,i=B;return l(),S(i,{cols:m(n).length,"x-gap":10},{default:v(()=>[(l(!0),o(y,null,f(m(n),e=>(l(),S(a,{key:e.key},{default:v(()=>[d(Oe,C({ref_for:!0},e),null,16)]),_:2},1024))),128))]),_:1},8,["cols"])}}}),Le={class:"risk-list"},Ae={class:"risk-card__header"},Ne={class:"risk-card__body"},Be={class:"risk-row"},De={class:"risk-row__label"},Fe={class:"risk-row__value"},ze={class:"risk-row"},He={class:"risk-row__label"},$e={class:"risk-row__value"},qe={key:1,class:"risk-empty"},We=O(s({__name:"risk",props:{data:{type:Array,default:()=>[]}},setup(e){const{t:t}=c(),a={0:{textKey:"Security.SiteSecurity.RiskLevel.warning",color:"#fc6d26"},1:{textKey:"Security.SiteSecurity.RiskLevel.low",color:"#d4bb00"},2:{textKey:"Security.SiteSecurity.RiskLevel.middle",color:"#E97B00"},3:{textKey:"Security.SiteSecurity.RiskLevel.high",color:"#CC1515"}},i=e=>({color:D(a[e].color,.1),textColor:a[e].color});return(r,n)=>{const s=V,c=X,p=W,m=Z;return l(),o("div",Le,[e.data.length>0?(l(!0),o(y,{key:0},f(e.data,e=>(l(),S(p,{key:e.name,class:"risk-card"},{default:v(()=>[u("div",Ae,[d(s,{size:"small",bordered:!1,color:i(e.dangerous)},{default:v(()=>{return[x(h((i=e.dangerous,t(a[i].textKey))),1)];var i}),_:2},1032,["color"]),d(c,{class:"risk-card__title"},{default:v(()=>[u("span",{style:I({color:i(e.dangerous).textColor})},h(e.name),5)]),_:2},1024)]),u("div",Ne,[u("div",Be,[u("span",De,h(r.$t("Security.SiteSecurity.Risk.detailLabel")),1),u("span",Fe,h(e.info),1)]),n[0]||(n[0]=u("div",{class:"risk-divider"},null,-1)),u("div",ze,[u("span",He,h(r.$t("Security.SiteSecurity.Risk.repairLabel")),1),u("span",$e,h(e.repair),1)])])]),_:2},1024))),128)):(l(),o("div",qe,[d(m,{size:"large"})]))])}}}),[["__scopeId","data-v-59b580c0"]]),Ue={class:"mb-20px text-16px font-bold"},Ve={class:"security-collapse__header"},Xe={class:"security-collapse__left"},Ze={class:"security-collapse__title"},Ye={key:0,class:"security-collapse__status text-default"},Ke={key:1,class:"security-collapse__status text-default"},Je={class:"security-collapse__expand"},Ge=O(s({__name:"index",setup(e){const{scanInfo:t,details:a,detailsLoading:r}=ee(),{t:n}=c(),s=i(()=>{const e=[{key:"webscan",title:n("Security.SiteSecurity.Project.items.webscan"),icon:"i-security:webscan",riskCount:0,list:[]},{key:"fileleak",title:n("Security.SiteSecurity.Project.items.fileleak"),icon:"i-security:filescan",riskCount:0,list:[]},{key:"webshell",title:n("Security.SiteSecurity.Project.items.webshell"),icon:"i-security:webhorse",riskCount:0,list:[]},{key:"backup",title:n("Security.SiteSecurity.Project.items.backup"),icon:"i-security:backup",riskCount:0,list:[]},{key:"weakpass",title:n("Security.SiteSecurity.Project.items.weakpass"),icon:"i-security:backend",riskCount:0,list:[]},{key:"weblog",title:n("Security.SiteSecurity.Project.items.weblog"),icon:"i-security:ftps",riskCount:0,list:[]}];return Object.entries(a.value).forEach(([t,a])=>{const i=e.find(e=>e.key===t);i&&(i.riskCount=a.length,i.list=a)}),e});return(e,a)=>{const i=z,n=F,c=W;return l(),S(c,{class:"p-24px"},{default:v(()=>[u("div",Ue,h(e.$t("Security.SiteSecurity.Project.title")),1),d(n,{"arrow-placement":"right","display-directive":"show",class:"security-collapse"},{default:v(()=>[(l(!0),o(y,null,f(m(s),a=>(l(),S(i,{key:a.key,name:a.key},{header:v(()=>[u("div",Ve,[u("div",Xe,[u("i",{class:p(["security-collapse__icon",a.icon])},null,2),u("span",Ze,h(a.title),1)]),m(r)[a.key]&&m(t).type!==a.key?(l(),o("span",Ye,h(e.$t("Security.SiteSecurity.Project.waiting")),1)):m(r)[a.key]||m(t).type!==a.key?(l(),o("span",{key:2,class:p(["security-collapse__status",a.riskCount>0?"text-error":"text-primary"])},h(a.riskCount>0?e.$t("Security.SiteSecurity.Project.foundRisk",[a.riskCount]):e.$t("Security.SiteSecurity.Project.noRisk")),3)):(l(),o("span",Ke,h(e.$t("Security.SiteSecurity.Header.scanning"))+"... ",1)),u("span",Je,h(e.$t("Public.Btn.Details")),1)])]),default:v(()=>[d(We,{data:a.list},null,8,["data"])]),_:2},1032,["name"]))),128))]),_:1})]),_:1})}}}),[["__scopeId","data-v-d4aef7d6"]]),Qe={class:"site-security-page"},et=O(s({__name:"index",setup(e){const{store:t,isNone:a}=ee();return t.getResult(),(e,t)=>(l(),o("div",Qe,[d(xe),m(a)?b("",!0):(l(),o(y,{key:0},[d(Ce),d(Re),d(Ge)],64))]))}}),[["__scopeId","data-v-74f36d2b"]]);export{et as default};
