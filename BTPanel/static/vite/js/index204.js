import{_ as a}from"./index184.js?v=1752142539265";import{av as e,_ as s,d as l,ad as t,aw as n,ax as i}from"./public.js?v=1752142539265";import{d as o,fb as r,O as u,_ as c,m as d,e as m,p}from"./page_layout.js?v=1752142539265";import{r as f,k as v,P as h,ad as _,e as x,c as y,o as S,a4 as w,U as g,X as b,V as k,Q as L,a2 as C,a3 as j,W as z,j as $,ah as A,an as R,a1 as N}from"./vue.js?v=1752142539265";import{d3 as U,cx as D,ay as O,bX as T,c3 as H}from"./naive.js?v=1752142539265";import"./common.js?v=1752142539265";import"./__commonjsHelpers__.js?v=1752142539265";const I=f(!1),J=f({}),P=async a=>{try{I.value=!0;const{message:s}=await e({hash:a});o(s)&&(J.value=s)}finally{I.value=!1}},X={class:"text-#20a53a"},M={class:"mt-16px"},Q=m(v({__name:"index",props:{row:{},onRefresh:{}},setup(a){const{t:e}=h(),n=a,{row:i}=_(n),m=f("all"),p=x({domains:i.value.user_for.sites||[]}),v=f([]),R=f([]),N=y((()=>"matched"===m.value?R.value:v.value)),H=({option:a})=>{const e=a.match?"ssl-lock":"ssl-unlock",s=a.match?"text-#20a53a":"text-error";return L(T,{size:5,class:"items-center flex-nowrap!"},{default:()=>[L(c,{name:e,class:s,size:18},null),L("div",{class:"truncate w-full"},[a.label])]})},Q=()=>{l({title:"Deploy SSL Certificate",content:p.domains.length?"Are you sure you want to deploy this certificate?":"Are you sure you want to cancel the deployment",onConfirm:async()=>{const{message:a}=await t({hash:i.value.hash,domains:JSON.stringify(p.domains)});o(a)&&(a.faild?d.error("".concat(e("SSL.index_31"),"（").concat(a.faildList.map((a=>a.siteName)).join(","),"）")):d.success(e("SSL.index_32")),n.onRefresh())}})},V=a=>a.map((a=>({label:a.name,value:a.name,match:a.match})));return S((()=>{(async()=>{await P(i.value.hash);const a=J.value.sites.filter((a=>a.match)),e=J.value.sites.filter((a=>!a.match));v.value=V([...a,...e]),R.value=V(a),p.domains=p.domains.filter((a=>v.value.some((e=>e.value===a))))})()})),(a,e)=>{const l=w("i18n-t"),t=U,n=D,o=r,d=u,f=O,v=c,h=s;return b(),g("div",null,[k("div",null,[L(l,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:C((()=>{var a,e;return[k("span",X,j(null==(e=null==(a=z(i))?void 0:a.verify_domains)?void 0:e.join(",")),1)]})),_:1}),e[2]||(e[2]=k("span",null," site",-1))]),L(n,{type:"segment",animated:"",value:z(m),"onUpdate:value":e[0]||(e[0]=a=>A(m)?m.value=a:null),class:"my-10px"},{default:C((()=>[L(t,{name:"all"},{default:C((()=>[$(j(a.$t("SSL.index_28")),1)])),_:1}),L(t,{name:"matched"},{default:C((()=>[$(j(a.$t("SSL.index_27")),1)])),_:1})])),_:1},8,["value"]),L(d,{show:z(I)},{default:C((()=>[L(o,{"render-source-label":H,"render-target-label":H,value:z(p).domains,"onUpdate:value":e[1]||(e[1]=a=>z(p).domains=a),options:z(N),"source-filterable":"","virtual-scroll":""},null,8,["value","options"])])),_:1},8,["show"]),k("div",M,[L(f,{type:"primary",onClick:Q},{default:C((()=>[$(j(a.$t("SSL.index_29")),1)])),_:1})]),L(h,{class:"mt-20px"},{default:C((()=>[k("li",null,[L(v,{name:"ssl-lock",class:"text-#20a53a",size:18}),e[3]||(e[3]=k("span",{class:"ml-8px"},"This SSL is applicable to the this domain",-1))]),k("li",null,[L(v,{name:"ssl-unlock",class:"text-error",size:18}),e[4]||(e[4]=k("span",{class:"ml-8px"},'After using this SSL, accessing the domain will show a "Not Secure" warning',-1))])])),_:1})])}}}),[["__scopeId","data-v-1cd65fd9"]]),V={key:0,class:"text-#20a53a"},W={class:"icon-box"},q=m(v({__name:"index",props:{row:{}},setup(a){const e=a,{row:t}=_(e),i=x({domains:"",issuer:"",end_date:"",is_match:1}),o=a=>{l({title:"Deploy SSL Certificate",content:0===a?"Are you sure to deploy this SSL certificate to the panel?":"Are you sure you want to restore it?",onConfirm:async()=>{await n({hash:t.value.hash,recover:a}),window.location.href=window.location.href.split("?")[0]+"?_t="+Date.now()}})};return S((()=>{(async()=>{await P(t.value.hash),i.domains=J.value.panel[0].info.subject,i.issuer=J.value.panel[0].info.issuer,i.end_date=J.value.panel[0].info.notAfter,i.is_match=J.value.panel[0].match})()})),(a,e)=>{const l=w("i18n-t"),n=c,r=p,d=T,m=H,f=u,v=O,h=s;return b(),g("div",null,[k("div",null,[L(l,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:C((()=>[z(t)?(b(),g("span",V,j(z(t).verify_domains.join(",")),1)):R("",!0)])),_:1}),e[2]||(e[2]=k("span",null," panel",-1))]),L(f,{show:z(I),class:"my-16px"},{default:C((()=>[L(m,{type:"info","show-icon":!1},{default:C((()=>[L(d,{class:"py-2px text-12px items-center flex-nowrap!"},{default:C((()=>[e[3]||(e[3]=k("b",{class:"text-nowrap!"},"Current SSL",-1)),L(n,{name:"ssl-lock",class:"text-#20a53a",size:18}),L(r,{vertical:""}),k("div",null,[k("div",null,[$(j(a.$t("Config.Safe.index_37")),1),k("b",null,j(z(i).domains),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_38")),1),k("b",null,j(z(i).issuer),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_39")),1),k("b",null,j(z(i).end_date),1)])])])),_:1,__:[3]})])),_:1}),k("div",W,[L(n,{name:"file-back",size:40,color:"#0a8c46"})]),L(m,{type:z(i).is_match?"success":"error","show-icon":!1},{default:C((()=>[L(d,{class:"py-2px text-12px items-center flex-nowrap! text-primary"},{default:C((()=>[e[4]||(e[4]=k("b",{class:"text-nowrap!"},"New SSL",-1)),z(i).is_match?(b(),N(n,{key:0,name:"ssl-lock",class:"text-#20a53a",size:18})):(b(),N(n,{key:1,name:"ssl-unlock",class:"text-error",size:18})),L(r,{vertical:""}),k("div",null,[k("div",null,[$(j(a.$t("Config.Safe.index_37")),1),k("b",null,j(z(t).verify_domains.join(",")),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_38")),1),k("b",null,j(z(t).provider+" "+z(t).issuer),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_39")),1),k("b",null,j(z(t).end_date),1)])])])),_:1,__:[4]})])),_:1},8,["type"])])),_:1},8,["show"]),k("div",null,[L(v,{type:"primary",onClick:e[0]||(e[0]=a=>o(0))},{default:C((()=>[$(j(a.$t("SSL.index_29")),1)])),_:1})]),L(r,{class:"my-16px!"}),L(d,{class:"items-center"},{default:C((()=>[e[6]||(e[6]=k("span",{class:"text-desc"},"Restore to panel self-signed certificate?",-1)),L(v,{type:"primary",ghost:"",onClick:e[1]||(e[1]=a=>o(1))},{default:C((()=>e[5]||(e[5]=[$("Restore")]))),_:1,__:[5]})])),_:1,__:[6]}),L(h,{class:"mt-20px"},{default:C((()=>[k("li",null,[L(n,{name:"ssl-lock",class:"text-#20a53a",size:18}),e[7]||(e[7]=k("span",{class:"ml-8px"},"This SSL is applicable to the this panel",-1))]),k("li",null,[L(n,{name:"ssl-unlock",class:"text-error",size:18}),e[8]||(e[8]=k("span",{class:"ml-8px"},'After using this SSL, accessing the panel will show a "Not Secure" warning',-1))])])),_:1})])}}}),[["__scopeId","data-v-5d5ba104"]]),B={class:"text-#20a53a"},E={class:"mt-16px"},F=v({__name:"index",props:{row:{},onRefresh:{}},setup(a){const{t:e}=h(),t=a,{row:n}=_(t),m=f("all"),p=x({domains:n.value.user_for.mails}),v=f([]),S=f([]),R=y((()=>"matched"===m.value?S.value:v.value)),N=({option:a})=>{const e=a.match?"ssl-lock":"ssl-unlock",s=a.match?"text-#20a53a":"text-error";return L(T,{size:5,class:"items-center flex-nowrap!"},{default:()=>[L(c,{name:e,class:s,size:18},null),L("div",{class:"truncate w-full"},[a.label])]})},H=()=>{l({title:"Deploy SSL Certificate",content:p.domains.length?"Are you sure you want to deploy this certificate?":"Are you sure you want to cancel the deployment",onConfirm:async()=>{try{const{message:a}=await i({hash:n.value.hash,domains:JSON.stringify(p.domains)});o(a)&&(a.faild?d.error("".concat(e("SSL.index_31"),"（").concat(a.faildList.map((a=>a.siteName)).join(","),"）")):d.success(e("SSL.index_32")))}finally{t.onRefresh()}}})},X=a=>a.map((a=>({label:a.domain,value:a.domain,match:a.match})));return(async()=>{await P(n.value.hash);const a=J.value.mails.filter((a=>a.match)),e=J.value.mails.filter((a=>!a.match));v.value=X([...a,...e]),S.value=X(a)})(),(a,e)=>{const l=w("i18n-t"),t=U,i=D,o=r,d=u,f=O,v=c,h=s;return b(),g("div",null,[k("div",null,[L(l,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:C((()=>{var a,e;return[k("span",B,j(null==(e=null==(a=z(n))?void 0:a.verify_domains)?void 0:e.join(",")),1)]})),_:1}),e[2]||(e[2]=k("span",null," mail",-1))]),L(i,{type:"segment",animated:"",value:z(m),"onUpdate:value":e[0]||(e[0]=a=>A(m)?m.value=a:null),class:"my-10px"},{default:C((()=>[L(t,{name:"all"},{default:C((()=>[$(j(a.$t("SSL.index_28")),1)])),_:1}),L(t,{name:"matched"},{default:C((()=>[$(j(a.$t("SSL.index_27")),1)])),_:1})])),_:1},8,["value"]),L(d,{show:z(I)},{default:C((()=>[L(o,{"render-source-label":N,"render-target-label":N,value:z(p).domains,"onUpdate:value":e[1]||(e[1]=a=>z(p).domains=a),options:z(R),"source-filterable":"","virtual-scroll":""},null,8,["value","options"])])),_:1},8,["show"]),k("div",E,[L(f,{type:"primary",onClick:H},{default:C((()=>[$(j(a.$t("SSL.index_29")),1)])),_:1})]),L(h,{class:"mt-20px"},{default:C((()=>[k("li",null,[L(v,{name:"ssl-lock",class:"text-#20a53a",size:18}),e[3]||(e[3]=k("span",{class:"ml-8px"},"This SSL is applicable to the this domain",-1))]),k("li",null,[L(v,{name:"ssl-unlock",class:"text-error",size:18}),e[4]||(e[4]=k("span",{class:"ml-8px"},'After using this SSL, accessing the domain will show a "Not Secure" warning',-1))])])),_:1})])}}}),G=v({__name:"index",props:{data:{}},setup(e){const{t:s}=h(),l=e,{row:t,onRefresh:n,menu:i}=l.data,o=f("site"),r=[{key:"site",label:s("Home.index_68"),component:Q,data:{row:t,onRefresh:n}},{key:"mail",label:"Mail",component:F,data:{row:t,onRefresh:n}},{key:"panel",label:"Panel",component:q,data:{row:t}}];return o.value=i||"site",(e,s)=>{const l=a;return b(),N(l,{value:z(o),"onUpdate:value":s[0]||(s[0]=a=>A(o)?o.value=a:null),data:r},null,8,["value"])}}});export{G as default};
