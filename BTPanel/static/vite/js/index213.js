import{_ as a}from"./index245.js?v=1763625242172";import{a as e,_ as s}from"./public.js?v=1763625242172";import{h5 as l,c as t,_ as n,e3 as i,m as o,f_ as r,T as u,p as c,h6 as d,q as m,h7 as p}from"./page_layout.js?v=1763625242172";import{r as f,k as v,P as h,af as _,e as x,c as y,o as S,a5 as w,R as g,S as b,U as k,X as L,a3 as C,a4 as j,V as z,j as $,aj as R,an as A,a2 as N}from"./vue.js?v=1763625242172";import{d9 as U,el as D,dR as T,aC as H,dk as I}from"./naive.js?v=1763625242172";import"./common.js?v=1763625242172";import"./__commonjsHelpers__.js?v=1763625242172";const J=f(!1),O=f({}),P=async a=>{try{J.value=!0;const{message:e}=await l({hash:a});t(e)&&(O.value=e)}finally{J.value=!1}},q={class:"text-#20a53a"},M={class:"mt-16px"},V=c(v({__name:"index",props:{row:{},onRefresh:{}},setup(a){const{t:l}=h(),c=a,{row:d}=_(c),m=f("all"),p=x({domains:d.value.user_for.sites||[]}),v=f([]),A=f([]),N=y((()=>"matched"===m.value?A.value:v.value)),I=({option:a})=>{const e=a.match?"ssl-lock":"ssl-unlock",s=a.match?"text-#20a53a":"text-error";return L(U,{size:5,class:"items-center flex-nowrap!"},{default:()=>[L(n,{name:e,class:s,size:18},null),L("div",{class:"truncate w-full"},[a.label])]})},V=()=>{e({title:"Deploy SSL Certificate",content:p.domains.length?"Are you sure you want to deploy this certificate?":"Are you sure you want to cancel the deployment",onConfirm:async()=>{const{message:a}=await i({hash:d.value.hash,domains:JSON.stringify(p.domains)});t(a)&&(a.faild?o.error("".concat(l("SSL.index_31"),"（").concat(a.faildList.map((a=>a.siteName)).join(","),"）")):o.success(l("SSL.index_32")),c.onRefresh())}})},X=a=>a.map((a=>({label:a.name,value:a.name,match:a.match})));return S((()=>{(async()=>{await P(d.value.hash);const a=O.value.sites.filter((a=>a.match)),e=O.value.sites.filter((a=>!a.match));v.value=X([...a,...e]),A.value=X(a),p.domains=p.domains.filter((a=>v.value.some((e=>e.value===a))))})()})),(a,e)=>{const l=w("i18n-t"),t=D,i=T,o=r,c=u,f=H,v=n,h=s;return g(),b("div",null,[k("div",null,[L(l,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:C((()=>{var a,e;return[k("span",q,j(null==(e=null==(a=z(d))?void 0:a.verify_domains)?void 0:e.join(",")),1)]})),_:1}),e[2]||(e[2]=k("span",null," site",-1))]),L(i,{type:"segment",animated:"",value:z(m),"onUpdate:value":e[0]||(e[0]=a=>R(m)?m.value=a:null),class:"my-10px"},{default:C((()=>[L(t,{name:"all"},{default:C((()=>[$(j(a.$t("SSL.index_28")),1)])),_:1}),L(t,{name:"matched"},{default:C((()=>[$(j(a.$t("SSL.index_27")),1)])),_:1})])),_:1},8,["value"]),L(c,{show:z(J)},{default:C((()=>[L(o,{"render-source-label":I,"render-target-label":I,value:z(p).domains,"onUpdate:value":e[1]||(e[1]=a=>z(p).domains=a),options:z(N),"source-filterable":"","virtual-scroll":""},null,8,["value","options"])])),_:1},8,["show"]),k("div",M,[L(f,{type:"primary",onClick:V},{default:C((()=>[$(j(a.$t("SSL.index_29")),1)])),_:1})]),L(h,{class:"mt-20px"},{default:C((()=>[k("li",null,[L(v,{name:"ssl-lock",class:"text-#20a53a",size:18}),e[3]||(e[3]=k("span",{class:"ml-8px"},"This SSL is applicable to the this domain",-1))]),k("li",null,[L(v,{name:"ssl-unlock",class:"text-error",size:18}),e[4]||(e[4]=k("span",{class:"ml-8px"},'After using this SSL, accessing the domain will show a "Not Secure" warning',-1))])])),_:1})])}}}),[["__scopeId","data-v-1cd65fd9"]]),X={key:0,class:"text-#20a53a"},B={class:"icon-box"},E=c(v({__name:"index",props:{row:{}},setup(a){const l=a,{row:t}=_(l),i=x({domains:"",issuer:"",end_date:"",is_match:1}),o=a=>{e({title:"Deploy SSL Certificate",content:0===a?"Are you sure to deploy this SSL certificate to the panel?":"Are you sure you want to restore it?",onConfirm:async()=>{await d({hash:t.value.hash,recover:a}),window.location.href=window.location.href.split("?")[0]+"?_t="+Date.now()}})};return S((()=>{(async()=>{await P(t.value.hash),i.domains=O.value.panel[0].info.subject,i.issuer=O.value.panel[0].info.issuer,i.end_date=O.value.panel[0].info.notAfter,i.is_match=O.value.panel[0].match})()})),(a,e)=>{const l=w("i18n-t"),r=n,c=m,d=U,p=I,f=u,v=H,h=s;return g(),b("div",null,[k("div",null,[L(l,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:C((()=>[z(t)?(g(),b("span",X,j(z(t).verify_domains.join(",")),1)):A("",!0)])),_:1}),e[2]||(e[2]=k("span",null," panel",-1))]),L(f,{show:z(J),class:"my-16px"},{default:C((()=>[L(p,{type:"info","show-icon":!1},{default:C((()=>[L(d,{class:"py-2px text-12px items-center flex-nowrap!"},{default:C((()=>[e[3]||(e[3]=k("b",{class:"text-nowrap!"},"Current SSL",-1)),L(r,{name:"ssl-lock",class:"text-#20a53a",size:18}),L(c,{vertical:""}),k("div",null,[k("div",null,[$(j(a.$t("Config.Safe.index_37")),1),k("b",null,j(z(i).domains),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_38")),1),k("b",null,j(z(i).issuer),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_39")),1),k("b",null,j(z(i).end_date),1)])])])),_:1,__:[3]})])),_:1}),k("div",B,[L(r,{name:"file-back",size:40,color:"#0a8c46"})]),L(p,{type:z(i).is_match?"success":"error","show-icon":!1},{default:C((()=>[L(d,{class:"py-2px text-12px items-center flex-nowrap! text-primary"},{default:C((()=>[e[4]||(e[4]=k("b",{class:"text-nowrap!"},"New SSL",-1)),z(i).is_match?(g(),N(r,{key:0,name:"ssl-lock",class:"text-#20a53a",size:18})):(g(),N(r,{key:1,name:"ssl-unlock",class:"text-error",size:18})),L(c,{vertical:""}),k("div",null,[k("div",null,[$(j(a.$t("Config.Safe.index_37")),1),k("b",null,j(z(t).verify_domains.join(",")),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_38")),1),k("b",null,j(z(t).provider+" "+z(t).issuer),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_39")),1),k("b",null,j(z(t).end_date),1)])])])),_:1,__:[4]})])),_:1},8,["type"])])),_:1},8,["show"]),k("div",null,[L(v,{type:"primary",onClick:e[0]||(e[0]=a=>o(0))},{default:C((()=>[$(j(a.$t("SSL.index_29")),1)])),_:1})]),L(c,{class:"my-16px!"}),L(d,{class:"items-center"},{default:C((()=>[e[6]||(e[6]=k("span",{class:"text-desc"},"Restore to panel self-signed certificate?",-1)),L(v,{type:"primary",ghost:"",onClick:e[1]||(e[1]=a=>o(1))},{default:C((()=>e[5]||(e[5]=[$("Restore")]))),_:1,__:[5]})])),_:1,__:[6]}),L(h,{class:"mt-20px"},{default:C((()=>[k("li",null,[L(r,{name:"ssl-lock",class:"text-#20a53a",size:18}),e[7]||(e[7]=k("span",{class:"ml-8px"},"This SSL is applicable to the this panel",-1))]),k("li",null,[L(r,{name:"ssl-unlock",class:"text-error",size:18}),e[8]||(e[8]=k("span",{class:"ml-8px"},'After using this SSL, accessing the panel will show a "Not Secure" warning',-1))])])),_:1})])}}}),[["__scopeId","data-v-5d5ba104"]]),F={class:"text-#20a53a"},G={class:"mt-16px"},K=v({__name:"index",props:{row:{},onRefresh:{}},setup(a){const{t:l}=h(),i=a,{row:c}=_(i),d=f("all"),m=x({domains:c.value.user_for.mails}),v=f([]),S=f([]),A=y((()=>"matched"===d.value?S.value:v.value)),N=({option:a})=>{const e=a.match?"ssl-lock":"ssl-unlock",s=a.match?"text-#20a53a":"text-error";return L(U,{size:5,class:"items-center flex-nowrap!"},{default:()=>[L(n,{name:e,class:s,size:18},null),L("div",{class:"truncate w-full"},[a.label])]})},I=()=>{e({title:"Deploy SSL Certificate",content:m.domains.length?"Are you sure you want to deploy this certificate?":"Are you sure you want to cancel the deployment",onConfirm:async()=>{try{const{message:a}=await p({hash:c.value.hash,domains:JSON.stringify(m.domains)});t(a)&&(a.faild?o.error("".concat(l("SSL.index_31"),"（").concat(a.faildList.map((a=>a.siteName)).join(","),"）")):o.success(l("SSL.index_32")))}finally{i.onRefresh()}}})},q=a=>a.map((a=>({label:a.domain,value:a.domain,match:a.match})));return(async()=>{await P(c.value.hash);const a=O.value.mails.filter((a=>a.match)),e=O.value.mails.filter((a=>!a.match));v.value=q([...a,...e]),S.value=q(a)})(),(a,e)=>{const l=w("i18n-t"),t=D,i=T,o=r,p=u,f=H,v=n,h=s;return g(),b("div",null,[k("div",null,[L(l,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:C((()=>{var a,e;return[k("span",F,j(null==(e=null==(a=z(c))?void 0:a.verify_domains)?void 0:e.join(",")),1)]})),_:1}),e[2]||(e[2]=k("span",null," mail",-1))]),L(i,{type:"segment",animated:"",value:z(d),"onUpdate:value":e[0]||(e[0]=a=>R(d)?d.value=a:null),class:"my-10px"},{default:C((()=>[L(t,{name:"all"},{default:C((()=>[$(j(a.$t("SSL.index_28")),1)])),_:1}),L(t,{name:"matched"},{default:C((()=>[$(j(a.$t("SSL.index_27")),1)])),_:1})])),_:1},8,["value"]),L(p,{show:z(J)},{default:C((()=>[L(o,{"render-source-label":N,"render-target-label":N,value:z(m).domains,"onUpdate:value":e[1]||(e[1]=a=>z(m).domains=a),options:z(A),"source-filterable":"","virtual-scroll":""},null,8,["value","options"])])),_:1},8,["show"]),k("div",G,[L(f,{type:"primary",onClick:I},{default:C((()=>[$(j(a.$t("SSL.index_29")),1)])),_:1})]),L(h,{class:"mt-20px"},{default:C((()=>[k("li",null,[L(v,{name:"ssl-lock",class:"text-#20a53a",size:18}),e[3]||(e[3]=k("span",{class:"ml-8px"},"This SSL is applicable to the this domain",-1))]),k("li",null,[L(v,{name:"ssl-unlock",class:"text-error",size:18}),e[4]||(e[4]=k("span",{class:"ml-8px"},'After using this SSL, accessing the domain will show a "Not Secure" warning',-1))])])),_:1})])}}}),Q=v({__name:"index",props:{data:{}},setup(e){const{t:s}=h(),l=e,{row:t,onRefresh:n,menu:i}=l.data,o=f("site"),r=[{key:"site",label:s("Home.index_68"),component:V,data:{row:t,onRefresh:n}},{key:"mail",label:"Mail",component:K,data:{row:t,onRefresh:n}},{key:"panel",label:"Panel",component:E,data:{row:t}}];return o.value=i||"site",(e,s)=>{const l=a;return g(),N(l,{value:z(o),"onUpdate:value":s[0]||(s[0]=a=>R(o)?o.value=a:null),data:r},null,8,["value"])}}});export{Q as default};
