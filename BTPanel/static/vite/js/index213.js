import{_ as a}from"./index245.js?v=1764233927359";import{_ as e,a as s}from"./public.js?v=1764233927359";import{h7 as l,d as t,f_ as n,T as i,_ as o,e4 as r,m as u,p as c,q as d,h8 as m,h9 as p}from"./page_layout.js?v=1764233927359";import{r as f,k as v,P as h,af as _,e as x,c as y,o as S,a5 as w,R as g,V as b,S as k,W as L,a3 as C,a4 as j,U as z,j as $,ak as A,an as R,a2 as N}from"./vue.js?v=1764233927359";import{el as U,dP as D,aC as T,da as P,dk as H}from"./naive.js?v=1764233927359";import"./common.js?v=1764233927359";import"./__commonjsHelpers__.js?v=1764233927359";const I=f(!1),J=f({}),O=async a=>{try{I.value=!0;const{message:e}=await l({hash:a});t(e)&&(J.value=e)}finally{I.value=!1}},q={class:"text-#20a53a"},M={class:"mt-16px"},V=c(v({__name:"index",props:{row:{},onRefresh:{}},setup(a){const{t:l}=h(),c=a,{row:d}=_(c),m=f("all"),p=x({domains:d.value.user_for.sites||[]}),v=f([]),R=f([]),N=y(()=>"matched"===m.value?R.value:v.value),H=({option:a})=>{const e=a.match?"ssl-lock":"ssl-unlock",s=a.match?"text-#20a53a":"text-error";return L(P,{size:5,class:"items-center flex-nowrap!"},{default:()=>[L(o,{name:e,class:s,size:18},null),L("div",{class:"truncate w-full"},[a.label])]})},V=()=>{s({title:"Deploy SSL Certificate",content:p.domains.length?"Are you sure you want to deploy this certificate?":"Are you sure you want to cancel the deployment",onConfirm:async()=>{const{message:a}=await r({hash:d.value.hash,domains:JSON.stringify(p.domains)});t(a)&&(a.faild?u.error("".concat(l("SSL.index_31"),"（").concat(a.faildList.map(a=>a.siteName).join(","),"）")):u.success(l("SSL.index_32")),c.onRefresh())}})},W=a=>a.map(a=>({label:a.name,value:a.name,match:a.match}));return S(()=>{(async()=>{await O(d.value.hash);const a=J.value.sites.filter(a=>a.match),e=J.value.sites.filter(a=>!a.match);v.value=W([...a,...e]),R.value=W(a),p.domains=p.domains.filter(a=>v.value.some(e=>e.value===a))})()}),(a,s)=>{const l=w("i18n-t"),t=U,r=D,u=n,c=i,f=T,v=o,h=e;return b(),g("div",null,[k("div",null,[L(l,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:C(()=>{var a,e;return[k("span",q,j(null==(e=null==(a=z(d))?void 0:a.verify_domains)?void 0:e.join(",")),1)]}),_:1}),s[2]||(s[2]=k("span",null," site",-1))]),L(r,{type:"segment",animated:"",value:z(m),"onUpdate:value":s[0]||(s[0]=a=>A(m)?m.value=a:null),class:"my-10px"},{default:C(()=>[L(t,{name:"all"},{default:C(()=>[$(j(a.$t("SSL.index_28")),1)]),_:1}),L(t,{name:"matched"},{default:C(()=>[$(j(a.$t("SSL.index_27")),1)]),_:1})]),_:1},8,["value"]),L(c,{show:z(I)},{default:C(()=>[L(u,{"render-source-label":H,"render-target-label":H,value:z(p).domains,"onUpdate:value":s[1]||(s[1]=a=>z(p).domains=a),options:z(N),"source-filterable":"","virtual-scroll":""},null,8,["value","options"])]),_:1},8,["show"]),k("div",M,[L(f,{type:"primary",onClick:V},{default:C(()=>[$(j(a.$t("SSL.index_29")),1)]),_:1})]),L(h,{class:"mt-20px"},{default:C(()=>[k("li",null,[L(v,{name:"ssl-lock",class:"text-#20a53a",size:18}),s[3]||(s[3]=k("span",{class:"ml-8px"},"This SSL is applicable to the this domain",-1))]),k("li",null,[L(v,{name:"ssl-unlock",class:"text-error",size:18}),s[4]||(s[4]=k("span",{class:"ml-8px"},'After using this SSL, accessing the domain will show a "Not Secure" warning',-1))])]),_:1})])}}}),[["__scopeId","data-v-1cd65fd9"]]),W={key:0,class:"text-#20a53a"},B={class:"icon-box"},E=c(v({__name:"index",props:{row:{}},setup(a){const l=a,{row:t}=_(l),n=x({domains:"",issuer:"",end_date:"",is_match:1}),r=a=>{s({title:"Deploy SSL Certificate",content:0===a?"Are you sure to deploy this SSL certificate to the panel?":"Are you sure you want to restore it?",onConfirm:async()=>{await m({hash:t.value.hash,recover:a}),window.location.href=window.location.href.split("?")[0]+"?_t="+Date.now()}})};return S(()=>{(async()=>{await O(t.value.hash),n.domains=J.value.panel[0].info.subject,n.issuer=J.value.panel[0].info.issuer,n.end_date=J.value.panel[0].info.notAfter,n.is_match=J.value.panel[0].match})()}),(a,s)=>{const l=w("i18n-t"),u=o,c=d,m=P,p=H,f=i,v=T,h=e;return b(),g("div",null,[k("div",null,[L(l,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:C(()=>[z(t)?(b(),g("span",W,j(z(t).verify_domains.join(",")),1)):R("",!0)]),_:1}),s[2]||(s[2]=k("span",null," panel",-1))]),L(f,{show:z(I),class:"my-16px"},{default:C(()=>[L(p,{type:"info","show-icon":!1},{default:C(()=>[L(m,{class:"py-2px text-12px items-center flex-nowrap!"},{default:C(()=>[s[3]||(s[3]=k("b",{class:"text-nowrap!"},"Current SSL",-1)),L(u,{name:"ssl-lock",class:"text-#20a53a",size:18}),L(c,{vertical:""}),k("div",null,[k("div",null,[$(j(a.$t("Config.Safe.index_37")),1),k("b",null,j(z(n).domains),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_38")),1),k("b",null,j(z(n).issuer),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_39")),1),k("b",null,j(z(n).end_date),1)])])]),_:1,__:[3]})]),_:1}),k("div",B,[L(u,{name:"file-back",size:40,color:"#0a8c46"})]),L(p,{type:z(n).is_match?"success":"error","show-icon":!1},{default:C(()=>[L(m,{class:"py-2px text-12px items-center flex-nowrap! text-primary"},{default:C(()=>[s[4]||(s[4]=k("b",{class:"text-nowrap!"},"New SSL",-1)),z(n).is_match?(b(),N(u,{key:0,name:"ssl-lock",class:"text-#20a53a",size:18})):(b(),N(u,{key:1,name:"ssl-unlock",class:"text-error",size:18})),L(c,{vertical:""}),k("div",null,[k("div",null,[$(j(a.$t("Config.Safe.index_37")),1),k("b",null,j(z(t).verify_domains.join(",")),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_38")),1),k("b",null,j(z(t).provider+" "+z(t).issuer),1)]),k("div",null,[$(j(a.$t("Config.Safe.index_39")),1),k("b",null,j(z(t).end_date),1)])])]),_:1,__:[4]})]),_:1},8,["type"])]),_:1},8,["show"]),k("div",null,[L(v,{type:"primary",onClick:s[0]||(s[0]=a=>r(0))},{default:C(()=>[$(j(a.$t("SSL.index_29")),1)]),_:1})]),L(c,{class:"my-16px!"}),L(m,{class:"items-center"},{default:C(()=>[s[6]||(s[6]=k("span",{class:"text-desc"},"Restore to panel self-signed certificate?",-1)),L(v,{type:"primary",ghost:"",onClick:s[1]||(s[1]=a=>r(1))},{default:C(()=>s[5]||(s[5]=[$("Restore",-1)])),_:1,__:[5]})]),_:1,__:[6]}),L(h,{class:"mt-20px"},{default:C(()=>[k("li",null,[L(u,{name:"ssl-lock",class:"text-#20a53a",size:18}),s[7]||(s[7]=k("span",{class:"ml-8px"},"This SSL is applicable to the this panel",-1))]),k("li",null,[L(u,{name:"ssl-unlock",class:"text-error",size:18}),s[8]||(s[8]=k("span",{class:"ml-8px"},'After using this SSL, accessing the panel will show a "Not Secure" warning',-1))])]),_:1})])}}}),[["__scopeId","data-v-5d5ba104"]]),F={class:"text-#20a53a"},G={class:"mt-16px"},K=v({__name:"index",props:{row:{},onRefresh:{}},setup(a){const{t:l}=h(),r=a,{row:c}=_(r),d=f("all"),m=x({domains:c.value.user_for.mails}),v=f([]),S=f([]),R=y(()=>"matched"===d.value?S.value:v.value),N=({option:a})=>{const e=a.match?"ssl-lock":"ssl-unlock",s=a.match?"text-#20a53a":"text-error";return L(P,{size:5,class:"items-center flex-nowrap!"},{default:()=>[L(o,{name:e,class:s,size:18},null),L("div",{class:"truncate w-full"},[a.label])]})},H=()=>{s({title:"Deploy SSL Certificate",content:m.domains.length?"Are you sure you want to deploy this certificate?":"Are you sure you want to cancel the deployment",onConfirm:async()=>{try{const{message:a}=await p({hash:c.value.hash,domains:JSON.stringify(m.domains)});t(a)&&(a.faild?u.error("".concat(l("SSL.index_31"),"（").concat(a.faildList.map(a=>a.siteName).join(","),"）")):u.success(l("SSL.index_32")))}finally{r.onRefresh()}}})},q=a=>a.map(a=>({label:a.domain,value:a.domain,match:a.match}));return(async()=>{await O(c.value.hash);const a=J.value.mails.filter(a=>a.match),e=J.value.mails.filter(a=>!a.match);v.value=q([...a,...e]),S.value=q(a)})(),(a,s)=>{const l=w("i18n-t"),t=U,r=D,u=n,p=i,f=T,v=o,h=e;return b(),g("div",null,[k("div",null,[L(l,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:C(()=>{var a,e;return[k("span",F,j(null==(e=null==(a=z(c))?void 0:a.verify_domains)?void 0:e.join(",")),1)]}),_:1}),s[2]||(s[2]=k("span",null," mail",-1))]),L(r,{type:"segment",animated:"",value:z(d),"onUpdate:value":s[0]||(s[0]=a=>A(d)?d.value=a:null),class:"my-10px"},{default:C(()=>[L(t,{name:"all"},{default:C(()=>[$(j(a.$t("SSL.index_28")),1)]),_:1}),L(t,{name:"matched"},{default:C(()=>[$(j(a.$t("SSL.index_27")),1)]),_:1})]),_:1},8,["value"]),L(p,{show:z(I)},{default:C(()=>[L(u,{"render-source-label":N,"render-target-label":N,value:z(m).domains,"onUpdate:value":s[1]||(s[1]=a=>z(m).domains=a),options:z(R),"source-filterable":"","virtual-scroll":""},null,8,["value","options"])]),_:1},8,["show"]),k("div",G,[L(f,{type:"primary",onClick:H},{default:C(()=>[$(j(a.$t("SSL.index_29")),1)]),_:1})]),L(h,{class:"mt-20px"},{default:C(()=>[k("li",null,[L(v,{name:"ssl-lock",class:"text-#20a53a",size:18}),s[3]||(s[3]=k("span",{class:"ml-8px"},"This SSL is applicable to the this domain",-1))]),k("li",null,[L(v,{name:"ssl-unlock",class:"text-error",size:18}),s[4]||(s[4]=k("span",{class:"ml-8px"},'After using this SSL, accessing the domain will show a "Not Secure" warning',-1))])]),_:1})])}}}),Q=v({__name:"index",props:{data:{}},setup(e){const{t:s}=h(),l=e,{row:t,onRefresh:n,menu:i}=l.data,o=f("site"),r=[{key:"site",label:s("Home.index_68"),component:V,data:{row:t,onRefresh:n}},{key:"mail",label:"Mail",component:K,data:{row:t,onRefresh:n}},{key:"panel",label:"Panel",component:E,data:{row:t}}];return o.value=i||"site",(e,s)=>{const l=a;return b(),N(l,{value:z(o),"onUpdate:value":s[0]||(s[0]=a=>A(o)?o.value=a:null),data:r},null,8,["value"])}}});export{Q as default};
