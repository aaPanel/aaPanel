System.register(["./vue-legacy.js?v=1747989938512","./public-legacy.js?v=1747989938512","./page_layout-legacy.js?v=1747989938512","./naive-legacy.js?v=1747989938512","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1747989938512","./quota-legacy.js?v=1747989938512"],(function(e,a){"use strict";var t,o,l,n,i,u,c,s,r,d,m,p,_,b,g,k,v,y,A,h,w,f,x,F,S,D,V,q,H,j,U,P,L,C,N,E,M,O,$,Y,B,I,R,z,T,W,X,G,J,K,Q,Z,ee,ae,te,oe,le,ne,ie,ue;return{setters:[e=>{t=e.X,o=e.O,l=e.P,n=e.F,i=e.d,u=e.am,c=e.r,s=e.e,r=e.R,d=e.a0,m=e.a1,p=e.V,_=e.S,b=e.ao,g=e.U,k=e.c,v=e._,y=e.j,A=e.u,h=e.f,w=e.k,f=e.v,x=e.w,F=e.t,S=e.i},e=>{D=e.d,V=e.i,q=e.a,H=e.j,j=e.f},e=>{U=e.ab,P=e.c,L=e.a7,C=e.ac,N=e.n,E=e.m,M=e.ad,O=e.ae,$=e.af,Y=e.ag,B=e.Y,I=e.ah,R=e.i,z=e._,T=e.O,W=e.a1},e=>{X=e.T,G=e.bU,J=e.c3,K=e.cj,Q=e.cn,Z=e.co,ee=e._,ae=e.c0,te=e.bY,oe=e.cq,le=e.a2,ne=e.cp},e=>{ie=e._},e=>{ue=e.a}],execute:function(){var a=document.createElement("style");a.textContent=".inline-item{width:100%;display:flex;align-items:center;justify-content:space-between}.inline-item .left-item{flex:1;margin-right:20px}\n",document.head.appendChild(a),e("b",_e);const ce=e("a",t("aapanelsub-account-store",(()=>{const e=ge(),{t:a}=o(),t=async()=>{try{u(!0);const{message:a}=await U(e.search);P(a)&&(e.table.data=a.list,e.table.total=a.page.count,e.account_total=a.account_total)}finally{u(!1)}},{loading:i,setLoading:u}=D(),c=async()=>{const{message:a}=await L();P(a)&&(e.packageSourceList=a.list,e.packageList=a.list.map((e=>({label:e.package_name,value:e.package_id}))),a.list.length>0&&(e.expendFormState.package_id=a.list[0].package_id,r(e.expendFormState.package_id)))},s=async()=>{const t=await C();if(P(t)){let o={};e.diskMountSourceList=t.message,e.diskMountPointList=t.message.map((e=>(e.is_default&&(o=e),{label:`${e.mountpoint} (${N(e.used)}/${N(e.total)}) ${a("Account.Account.account_533924-7")}:${e.is_group_quota?a("Account.Account.account_533924-5"):a("Account.Account.account_533924-6")}`,value:e.mountpoint}))),t.message.length>0&&(e.expendFormState.mountpoint=o.mountpoint||t.message[0].mountpoint,e.currentChangeDisk=0===Object.keys(o).length?t.message[0]:o)}},r=async a=>{const t=e.packageSourceList.find((e=>e.package_id===a));if(t){const{package_name:a,disk_space_quota:o,monthly_bandwidth_limit:l,max_site_limit:n,max_database:i,php_start_children:u,php_max_children:c,remark:s}=t;e.wpForData.package_name=a,e.wpForData.disk_space_quota=0==o?{value:"",unlimited:!0}:{value:o/1024/1024,unlimited:!1},e.wpForData.monthly_bandwidth_limit=0==l?{value:"",unlimited:!0}:{value:l/1024/1024,unlimited:!1},e.wpForData.max_site_limit=0===n?{value:"",unlimited:!0}:{value:n,unlimited:!1},e.wpForData.max_database=0==i?{value:"",unlimited:!0}:{value:i,unlimited:!1},e.wpForData.php_start_children=u,e.wpForData.php_max_children=c,e.wpForData.remark=s}},d=()=>{e.acForData.username="",e.acForData.password="",e.acForData.email="",e.acForData.expire_date="0000-00-00",e.expendFormState.package_id=void 0,e.domainForData.domain="",m()},m=()=>{e.wpForData.package_name="",e.wpForData.disk_space_quota={value:"",unlimited:!1},e.wpForData.monthly_bandwidth_limit={value:"",unlimited:!1},e.wpForData.max_site_limit={value:"",unlimited:!1},e.wpForData.max_database={value:"",unlimited:!1},e.wpForData.php_start_children=1,e.wpForData.php_max_children=1,e.wpForData.remark=""};return{init:t,addHost:async()=>{if(e.table.total>=30)return E.error(a("Account.Account.account_533924-9",[30])),!1;d(),await c(),await s(),e.addVisible=!0,e.isEdit=!1},setLoading:u,loading:i,onLogin:async e=>{const{message:a}=await M({account_id:e});P(a)&&window.open(a.login_url+"?token="+a.token)},modifyStatus:async e=>{const{status:t,username:o}=e;q({title:`${a(0===t?"Site.PHP.index_21_2":"Site.PHP.index_21_3")} ${a("Account.Account.account_533924-0",[o])}`,content:a(0===t?"Account.Account.account_533924-1":"Account.Account.account_533924-2"),onConfirm:async()=>{await O({...e,status:0===t?1:0}),e.status=0===t?1:0}})},removeAccount:async e=>{q({title:a("Account.Account.account_673836-0",[e.username]),content:()=>l(n,null,[l("div",null,[a("Account.Account.account_673836-1")])]),onConfirm:async()=>{await Y({account_id:e.account_id,is_del_resources:!0}),t()}})},form_save:async()=>{"yes"!==e.domainForData.website_and_email||e.isEdit||await(e.accountDomainFormRef?.validate()),await(e.accountFormRef?.validate());const{domainForData:o,isSupportAuto:l}=e;if(!l&&"yes"===e.domainForData.website_and_email&&!e.isEdit)return E.error("Your domain name does not support Create a website and email"),!1;const n=function(){const{package_id:a,mountpoint:t}=e.expendFormState,{username:o,password:l,email:n,expire_date:i,remark:u}=e.acForData,{disk_space_quota:c,monthly_bandwidth_limit:s,max_site_limit:r,max_database:d,php_start_children:m,php_max_children:p}=e.wpForData;return Object.assign({},{username:o,password:l,email:n,expire_date:i,package_id:a,mountpoint:t,disk_space_quota:c.unlimited?0:String(1024*Number(c.value)*1024),monthly_bandwidth_limit:s.unlimited?0:String(1024*Number(s.value)*1024),max_site_limit:r.unlimited?0:r.value,max_database:d.unlimited?0:d.value,php_start_children:m,php_max_children:p,remark:u})}();if(n.domain="yes"===o.website_and_email?o.domain:null,n.automatic_dns=2===o.dns_record&&"yes"===o.website_and_email?1:0,Number(n.disk_space_quota)>0&&!e.isEdit){const{is_group_quota:t,free:o}=e.currentChangeDisk;if(!t)return E.error(a("Account.Account.account_533924-3")),!1;if(o<Number(n.disk_space_quota))return E.error(a("Account.Account.account_533924-4")),!1}try{e.isEdit?(delete n.mountpoint,await O({account_id:e.current_account_id,...n}),d(),t()):(await $(n),d(),t())}catch(i){return Promise.reject(i)}},form_reset:d,package_form_reset:m,getPackageList:c,getDiskList:s,changePackage:r,copyInfo:e=>{const{url:a,user:t,pass:o}=e;V(`Access address: ${a}\nUsername: ${t}\ninit Password: ${o}`)}}}))),se={key:0,class:"color-desc"},re=i({__name:"automatic",props:{domain:{}},setup(e,{expose:a}){const t=u(),o=e,n=c(),i=s((()=>n.value?.support.includes("auto"))),v=()=>{t.push("/ssl_domain/domain")};return a({getParseStatus:async()=>{const{message:e}=await H({domain:o.domain});P(e)&&(n.value=e)},parseStatus:n,isSupportAuto:i}),(e,a)=>{const t=X,o=G,u=J;return r(),d(o,null,{default:m((()=>[p(n)?b("",!0):(r(),_("span",se," *The program will use the APl to automatically add the required DNS records forthe mail server and complete the installation of the SSL certifcate. ")),p(n)?(r(),d(o,{key:1},{default:m((()=>[p(i)?(r(),d(u,{key:1,type:"success"},{default:m((()=>a[2]||(a[2]=[k(" Your domain has been connccted to the domain managementccnter, and you can use this fcature to complcte onc-click deployment. ")]))),_:1})):(r(),d(u,{key:0,type:"error"},{default:m((()=>[l(o,{class:"items-center flex-nowrap!"},{default:m((()=>[a[1]||(a[1]=g("span",null,"Your domain has not yet been integrated with the Domain Name Management Center.",-1)),l(t,{type:"primary",size:"small",ghost:"",onClick:v},{default:m((()=>a[0]||(a[0]=[k("Add Now")]))),_:1})])),_:1})])),_:1}))])),_:1})):b("",!0)])),_:1})}}}),de=i({props:{options:Array,modelValue:Object,rules:Object,exclude:Array},setup(e,{attrs:a,slots:t,expose:o}){const i=c(null),u=y({});return o(u),h((()=>{Object.assign(u,{validate:i.value?.validate,restoreValidation:i.value?.restoreValidation})})),()=>l(n,null,[l(oe,A(a,{model:e.modelValue,ref:i,rules:e.rules}),{default:()=>l(n,null,[e.options?.filter((a=>!e.exclude?.includes(a.key))).map((o=>function(e,a,t,o){const{label:n,key:i,type:u,options:c,el:s}=e;switch(u){case"input":case"password":return l(K,A({label:n,path:i},t),{default:()=>[l(ee,A({value:a[i],"onUpdate:value":e=>a[i]=e},s),null)]});case"select":return l(K,A({label:n,path:e.key},t),{default:()=>[l(ne,A({options:c,value:a[i],"onUpdate:value":e=>a[i]=e},s),null)]});case"checkbox":return l(K,A({label:n,path:e.key},t),{default:()=>[l(le,A({checked:a[i],"onUpdate:checked":e=>a[i]=e},s),null)]});case"date-picker":return l(K,A({label:n,path:e.key},t),{default:()=>[l(W,A({"formatted-value":a[i],"onUpdate:formatted-value":e=>a[i]=e,type:"date","value-format":"yyyy-MM-dd"},s),null)]});case"input-number":return l(K,A({label:n,path:e.key},t),{default:()=>[l(be,A({value:a[i],"onUpdate:value":e=>a[i]=e},s),null)]});case"custom-item":return l(K,A({label:n,path:e.key},t,{disabled:t.disabled}),{default:()=>[e.slots?.default(t)]});case"custom-slot":return l(K,A({label:n,path:e.key},t,{disabled:t.disabled}),{default:()=>[o&&o[e.key]?.()]})}}(o,e.modelValue,a,t)))])})])}});function me(){const e=[{type:"input",label:R.global.t("Account.Account.FormHooks-122755-1"),key:"username",el:{disabled:!0}},{type:"custom-slot",label:R.global.t("Account.Account.FormHooks-122755-2"),key:"password"},{type:"input",label:R.global.t("Account.Account.FormHooks-122755-4"),key:"email"},{type:"custom-slot",label:R.global.t("Account.Account.FormHooks-122755-5"),key:"expire_date"},{type:"input",label:R.global.t("Account.Account.FormHooks-122755-14"),key:"remark"}],a=y({username:"",password:"",email:"",expire_date:"0000-00-00",remark:""}),t=y({username:[{required:!0,message:R.global.t("Account.Account.FormHooks-122755-7"),trigger:"blur"}],password:[{required:!0,message:R.global.t("Account.Account.FormHooks-122755-8"),trigger:"blur"}],email:[{required:!0,message:R.global.t("Account.Account.FormHooks-122755-10"),trigger:"blur"}]});return[i({props:{isEdit:Boolean},setup(o,{attrs:n,expose:i,slots:u}){const s=c(),r=y({});return i(r),h((()=>{Object.assign(r,{validate:s.value?.validate,restoreValidation:s.value?.restoreValidation})})),o.isEdit?(e[0].el.disabled=!0,t.password[0].required=!1):(e[0].el.disabled=!1,t.password[0].required=!0),()=>{return l(de,A({options:e,modelValue:a,"onUpdate:modelValue":e=>a=e,"label-placement":"left","label-width":"130px"},n,{rules:t,ref:s}),"function"==typeof(o=u)||"[object Object]"===Object.prototype.toString.call(o)&&!S(o)?u:{default:()=>[u]});var o}}}),a]}const pe=i({props:{modelValue:Object},setup(e,{attrs:a}){const t=y({value:e.modelValue?.value?e.modelValue?.value:0,unlimited:!!e.modelValue?.unlimited&&e.modelValue?.unlimited});return x(t,(a=>{e.modelValue.value=a.value,e.modelValue.unlimited=a.unlimited})),()=>l("div",{class:"inline-item"},[l("div",{class:"left-item"},[l(be,{value:t.value,"onUpdate:value":e=>t.value=e,disabled:e.modelValue?.unlimited||a.disabled},null)]),l("div",{class:"right-item"},[l(ae,{value:t.unlimited,"onUpdate:value":e=>t.unlimited=e,disabled:a.disabled},{checked:()=>R.global.t("Account.Account.FormHooks-122755-12"),unchecked:()=>R.global.t("Account.Account.FormHooks-122755-12")})])])}});function _e(){const e=[{type:"input",label:R.global.t("Account.Account.FormHooks-122755-13"),key:"package_name"},{type:"input",label:R.global.t("Account.Account.FormHooks-122755-14"),key:"remark"},{type:"custom-item",label:R.global.t("Account.Account.FormHooks-122755-15"),key:"disk_space_quota",slots:{default:e=>l(pe,A({modelValue:a.disk_space_quota,"onUpdate:modelValue":e=>a.disk_space_quota=e},e),null)}},{type:"custom-item",label:R.global.t("Account.Account.FormHooks-122755-16"),key:"monthly_bandwidth_limit",slots:{default:e=>l(pe,A({modelValue:a.monthly_bandwidth_limit,"onUpdate:modelValue":e=>a.monthly_bandwidth_limit=e},e),null)}},{type:"custom-item",label:R.global.t("Account.Account.FormHooks-122755-17"),key:"max_site_limit",slots:{default:e=>l(pe,A({modelValue:a.max_site_limit,"onUpdate:modelValue":e=>a.max_site_limit=e},e),null)}},{type:"input-number",label:R.global.t("Account.Account.FormHooks-122755-18"),key:"php_start_children"},{type:"input-number",label:R.global.t("Account.Account.FormHooks-122755-19"),key:"php_max_children"},{type:"custom-item",label:R.global.t("Account.Account.FormHooks-122755-21"),key:"max_database",slots:{default:e=>l(pe,A({modelValue:a.max_database,"onUpdate:modelValue":e=>a.max_database=e},e),null)}}],a=y({package_name:"",remark:"",disk_space_quota:{value:0,unlimited:!0},monthly_bandwidth_limit:{value:0,unlimited:!0},max_site_limit:{value:0,unlimited:!0},php_start_children:1,php_max_children:3,max_email_account:{value:1,unlimited:!1},max_database:{value:0,unlimited:!0}}),t=y({package_name:[{required:!0,message:R.global.t("Account.Account.FormHooks-122755-22"),trigger:"blur"}],disk_space_quota:[{required:!0,message:R.global.t("Account.Account.FormHooks-122755-24"),trigger:"blur",validator:(e,a)=>!!a.unlimited||!!(a.value&&a.value>0)}],monthly_bandwidth_limit:[{required:!0,message:R.global.t("Account.Account.FormHooks-122755-25"),trigger:"blur",validator:(e,a)=>!!a.unlimited||!!(a.value&&a.value>0)}],max_site_limit:[{required:!0,message:R.global.t("Account.Account.FormHooks-122755-26"),trigger:"blur",validator:(e,a)=>!!a.unlimited||!!(a.value&&a.value>0)}],php_start_children:[{required:!0,validator:(e,a)=>!!a||new Error(R.global.t("Account.Account.FormHooks-122755-27"))}],php_max_children:[{required:!0,validator:(e,a)=>a>0||new Error(R.global.t("Account.Account.FormHooks-122755-28"))}],max_email_account:[{required:!0,message:R.global.t("Account.Account.FormHooks-122755-29"),trigger:"blur",validator:(e,a)=>!!a.unlimited||!!(a.value&&a.value>0)}],max_database:[{required:!0,message:R.global.t("Account.Account.FormHooks-122755-30"),trigger:"blur",validator:(e,a)=>!!a.unlimited||!!(a.value&&a.value>0)}]}),o=c();return[i({props:{isDisable:Boolean,exclude:Array},setup(i,{expose:u}){const s=y({}),r=c(!1);return u(s),h((()=>{Object.assign(s,{validate:o.value?.validate,restoreValidation:o.value?.restoreValidation})})),x(i,(e=>{"isDisable"in e&&(r.value=e.isDisable)}),{immediate:!0}),()=>l(n,null,[l(de,{exclude:i.exclude,options:e,modelValue:a,"onUpdate:modelValue":e=>a=e,"label-placement":"left","label-width":"130px",rules:t,ref:o,disabled:r.value},null)])}}),a]}const be=i({props:{value:Number},emits:["update:value"],setup(e,{emit:a,attrs:t}){const o=F(e,"value"),n=c(e.value);function i(e){isNaN(Number(e))?(n.value=0,a("update:value",1)):(n.value=Math.round(e),a("update:value",Number(Math.floor(e))))}return x(o,(e=>{n.value=e})),()=>l(te,A(t,{value:n.value,clearable:!0,"onUpdate:value":i,min:1}),null)}}),ge=e("u",t("account-state-store",(()=>{const e=ce(),{t:a}=o(),t=c(!1),n=c(!1),u=c(null),r=c(null),d=c(30),m=y({data:[],total:0,loading:!1}),p=c([{title:a("Account.Account.accountState-721844-0"),key:"username",width:130,render:a=>l("span",{class:"text-primary cursor-pointer",onClick:()=>e.onLogin(a.account_id)},[a.username])},{title:a("Account.Account.accountState-721844-1"),key:"package_name",width:100},{title:a("Account.Account.accountState-721844-2"),key:"email"},{title:a("Account.Account.accountState-721844-20"),key:"login_info",width:80,render:t=>l("span",{class:"text-primary cursor-pointer",onClick:()=>e.copyInfo({url:t.login_url,user:t.username,pass:t.init_password})},[a("Public.Btn.Copy")])},{key:"quota",title:a("Account.Account.accountState-721844-3"),render:e=>l("span",{class:0===e.disk_space_status?"text-error":""},[0===e.disk_space_used&&0===e.disk_space_quota?"-":N(e.disk_space_used,!0,0),k(" /")," ",0===e.disk_space_quota?l("img",{class:"icon",title:"",src:ue},null):N(e.disk_space_quota,!0,0)])},{key:"bandwidth",title:a("Account.Account.accountState-721844-7"),render:e=>l("span",{class:0===e.monthly_bandwidth_status?"text-error":""},[N(e.monthly_bandwidth_used,!0,2),k(" /")," ",0===e.monthly_bandwidth_limit?l("img",{class:"icon",title:"",src:ue},null):N(e.monthly_bandwidth_limit,!0,0)])},{title:a("Account.Account.accountState-721844-8"),key:"status",width:68,render:t=>{const o=new Map([[-1,a("Account.Account.accountState-721844-9")],[0,a("Account.Account.accountState-721844-10")],[1,a("Account.Account.accountState-721844-11")],[2,a("Account.Account.accountState-721844-12")]]);return l("span",{onClick:()=>e.modifyStatus(t),class:"cursor-pointer "+(1===t.status||-1===t.status?"text-primary":"text-error")},[o.get(t.status)])}},{title:a("Account.Account.accountState-721844-13"),key:"expire_date",width:106,render:e=>"0000-00-00"===e.expire_date?a("Account.Account.account_index_10"):e.expire_date},{title:a("Account.Account.accountState-721844-14"),key:"remark",render:e=>e.remark?e.remark:"--"},j({title:a("Public.Table.Action"),align:"right",width:200,options:o=>[{label:a("Account.Account.accountState-721844-15"),onClick:async()=>{e.onLogin(o.account_id)}},{label:a("Account.Account.accountState-721844-16"),onClick:async()=>{await e.getPackageList(),await e.getDiskList(),g.value=Number(o.account_id),n.value=!0,V.username=o.username,V.password="",V.email=o.email,V.expire_date=o.expire_date,V.remark=o.remark,P.value.package_id=Number(o.package_id),P.value.mountpoint=o.mountpoint,e.changePackage(o.package_id),H.domain=o.domain,t.value=!0}},{label:a("Account.Account.accountState-721844-17"),onClick:async()=>{e.removeAccount(o)}}]})]),_=c([]),b=y({p:1,rows:10,type_id:-1,search_value:""}),g=c(null),A=c([]),x=c([]),F=c([]),S=c([]),[D,V]=me(),[q,H,U]=function(){const{isUserAutoMatic:e,isExistWhite:a}=v(B()),t=I(),o=c(!1),n=y({website_and_email:"yes",domain:"",dns_record:2}),u=c(""),r=y({domain:[{required:!0,message:R.global.t("SSL.index_21"),trigger:"blur"}]}),d=c(),m=()=>{""!==n.domain.trim()?u.value!==n.domain&&(d.value?.getParseStatus(),u.value=n.domain):u.value=""},p=s((()=>d.value?.isSupportAuto));return[i({props:{isEdit:Boolean},setup(i,{expose:u}){const s=c(),p=y({});return u(p),h((()=>{(async()=>{try{o.value=!0,await t.getMailInfo(),t.install&&e.value&&a.value||(n.website_and_email="no")}finally{o.value=!1}})(),Object.assign(p,{validate:s.value?.validate,restoreValidation:s.value?.restoreValidation})})),()=>l(T,{show:o.value},{default:()=>[w(l(ie,{ref:s,model:n,rules:r},{default:()=>[l(K,{label:"Create a website and email"},{default:()=>[l(Q,{class:"w-150px",value:n.website_and_email,onUpdateValue:e=>n.website_and_email=e,"onUpdate:value":m,disabled:!e.value||!t.install||!a.value},{default:()=>[l(Z,{value:"yes"},{default:()=>[k("Yes")]}),l(Z,{value:"no"},{default:()=>[k("No")]})]}),w(l(J,{"show-icon":!1},{default:()=>[l("div",{class:"flex items-center"},[l(z,{name:"base-info",size:17,class:"mr-8px"},null),l("span",{class:"leading-17px"},[t.install&&e.value?"API not enabled or 127.0.0.1 not added to the API whitelist":"Current Mail Server is not installed or sub-panel version is lower than 1.0.9"])])]}),[[f,!t.install||!e.value||!a.value]])]}),w(l(K,{label:"Domain",path:"domain"},{default:()=>[l(ee,{value:n.domain,onUpdateValue:e=>n.domain=e,onBlur:m},null)]}),[[f,"yes"===n.website_and_email]]),w(l(K,{label:"DNS record"},{default:()=>[l(Q,{value:n.dns_record,onUpdateValue:e=>{n.dns_record=e,m()}},{default:()=>[l(Z,{value:2},{default:()=>[l("div",{class:"flex h-15px items-center mr-16px"},[l("div",null,[k("Automatic")]),l(z,{name:"ssl-stars",size:22},null)])]}),l(Z,{value:1},{default:()=>[k("Manual")]})]})]}),[[f,"yes"===n.website_and_email]]),w(l(K,{label:" "},{default:()=>[l(re,{ref:d,domain:n.domain},null)]}),[[f,"yes"===n.website_and_email]])]}),[[f,!i.isEdit]]),w(l(ie,null,{default:()=>[w(l(K,{label:"Domain"},{default:()=>[l(ee,{value:n.domain,disabled:!0},null)]}),[[f,n.domain]])]}),[[f,i.isEdit]])]})}}),n,p]}(),P=c({package_id:-1,mountpoint:""}),L=c(),[C,E]=_e();return{addVisible:t,search:b,table:m,columns:p,keys:_,isEdit:n,accountFormRef:u,accountDomainFormRef:r,account_total:d,acForData:V,domainForData:H,expendFormState:P,wpForData:E,packageList:A,packageSourceList:x,diskMountPointList:F,diskMountSourceList:S,current_account_id:g,currentChangeDisk:L,initAccountForm:()=>D,initPackageForm:()=>C,initDomainForm:()=>q,isSupportAuto:U}})))}}}));
