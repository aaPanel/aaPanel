const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/old.js?v=1767769852656","js/index.js?v=1767769852656","js/vue.js?v=1767769852656","js/__commonjsHelpers__.js?v=1767769852656","js/common.js?v=1767769852656","js/public.js?v=1767769852656","js/page_layout.js?v=1767769852656","js/naive.js?v=1767769852656","css/page_layout.css?v=1767769852656","css/public.css?v=1767769852656","css/index120.css?v=1767769852656","js/details4.js?v=1767769852656","css/details.css?v=1767769852656","css/old.css?v=1767769852656","js/new2.js?v=1767769852656","js/update-back.js?v=1767769852656","css/new.css?v=1767769852656","js/file-detail.js?v=1767769852656","js/risk-info-form.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang10.js?v=1767769852656","js/alarm.js?v=1767769852656","js/toolview.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang6.js?v=1767769852656","css/index17.css?v=1767769852656","js/index102.js?v=1767769852656","css/index20.css?v=1767769852656","js/index41.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang12.js?v=1767769852656","js/soft.js?v=1767769852656","js/site.js?v=1767769852656","js/index171.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang14.js?v=1767769852656","css/index32.css?v=1767769852656","js/index251.js?v=1767769852656","css/index64.css?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang5.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang7.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang9.js?v=1767769852656","js/index.vue_vue_type_script_setup_true_lang11.js?v=1767769852656","js/index98.js?v=1767769852656","css/index15.css?v=1767769852656","js/index109.js?v=1767769852656","css/index23.css?v=1767769852656","js/echarts.js?v=1767769852656","js/security-news-detail.js?v=1767769852656","js/risk-repair.js?v=1767769852656","js/risk-ignore-list.js?v=1767769852656","css/risk-ignore-list.css?v=1767769852656","js/risk-report.js?v=1767769852656","js/file3.js?v=1767769852656","css/risk-report.css?v=1767769852656","js/index196.js?v=1767769852656","js/leader-line-vue.js?v=1767769852656","css/index93.css?v=1767769852656"])))=>i.map(i=>d[i]);
import{u as e,o as t,_ as a,c5 as l,P as s,gs as n,d as i,x as o,gt as r,a as c,gu as u,m as d,bl as m,p,ap as v,bs as x,gv as _,gw as y,br as f,gx as g,aA as h,T as w,q as b,aa as k,bx as S,ch as C,bw as H,gy as M,c7 as T,k as I,n as j,aI as D,gz as L,gA as z,gB as N}from"./page_layout.js?v=1767769852656";import{d3 as $,di as P,dS as B,da as A,dX as R,aC as E,dh as O,bH as F,dd as U,dY as Z,dj as J,dV as G,dR as V,eh as Q,_ as W,bJ as X,G as Y,dP as K,dQ as q,el as ee,d5 as te}from"./naive.js?v=1767769852656";import{k as ae,R as le,V as se,q as ne,I as ie,U as oe,i as re,p as ce,a0 as ue,an as de,F as me,S as pe,a4 as ve,W as xe,j as _e,a3 as ye,r as fe,a2 as ge,P as he,c as we,_ as be,O as ke,ag as Se,s as Ce,ak as He,ay as Me,Z as Te,n as Ie,e as je,aG as De,H as Le,X as ze,o as Ne,b as $e,w as Pe,l as Be,v as Ae,d as Re,am as Ee,ae as Oe,x as Fe}from"./vue.js?v=1767769852656";import{_ as Ue}from"./index.js?v=1767769852656";import{b as Ze,l as Je,u as Ge,a as Ve,j as Qe,c as We,f as Xe,p as Ye,d as Ke,k as qe,h as et,q as tt,$ as at,_ as lt,e as st,S as nt,C as it,m as ot,a0 as rt}from"./public.js?v=1767769852656";import{a as ct,_ as ut}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1767769852656";import{H as dt}from"./index102.js?v=1767769852656";import{_ as mt,d as pt}from"./index41.js?v=1767769852656";import{_ as vt}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1767769852656";import{a as xt}from"./soft.js?v=1767769852656";import{g as _t,a as yt,d as ft,s as gt,b as ht,c as wt,e as bt,f as kt,h as St,i as Ct,j as Ht,S as Mt,k as Tt,l as It,m as jt,n as Dt,o as Lt,p as zt,q as Nt,r as $t,t as Pt,u as Bt,v as At,w as Rt,x as Et,y as Ot,z as Ft,A as Ut}from"./toolview.js?v=1767769852656";import{_ as Zt}from"./index251.js?v=1767769852656";import{_ as Jt}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1767769852656";import{_ as Gt}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1767769852656";import{_ as Vt}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1767769852656";import{_ as Qt}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1767769852656";import{_ as Wt}from"./index109.js?v=1767769852656";import{_ as Xt}from"./index.vue_vue_type_script_setup_true_lang.js?v=1767769852656";import{_ as Yt}from"./index.vue_vue_type_script_setup_true_lang10.js?v=1767769852656";import{_ as Kt}from"./index.vue_vue_type_script_setup_true_lang14.js?v=1767769852656";import{aq as qt}from"./echarts.js?v=1767769852656";import{_ as ea}from"./index171.js?v=1767769852656";const ta=ae({__name:"index",props:{padding:{type:[String,Number],default:"16px"}},setup:e=>(t,a)=>(se(),le("div",{style:ie({padding:oe($)(e.padding)})},[ne(t.$slots,"default")],4))}),aa=Symbol("home");function la(){return re(aa)}const sa={class:"flex items-center cursor-pointer"},na={class:"text-[#fc6d26] font-bold"},ia=ae({__name:"auth",setup(a){const l=e(),{isFree:s,isPro:n,authExpired:i}=ue(l),o=()=>{Ze({source:27})},r=()=>{Ze({source:28})};return(e,a)=>{const l=t;return se(),le("div",sa,[oe(s)?(se(),le(me,{key:0},[pe("img",{class:"w-48px",src:"data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1622528816731'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='2577'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='48'%20height='48'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e@font-face%20{%20font-family:%20element-icons;%20src:%20url('chrome-extension://moombeodfomdpjnpocobemoiaemednkg/fonts/element-icons.woff')%20format('woff'),%20url('chrome-extension://moombeodfomdpjnpocobemoiaemednkg/fonts/element-icons.ttf%20')%20format('truetype');%20}%20%3c/style%3e%3c/defs%3e%3cpath%20d='M87.04%20309.76h849.92c45.056%200%2081.92%2036.864%2081.92%2081.92v240.64c0%2045.056-36.864%2081.92-81.92%2081.92H87.04c-45.056%200-81.92-36.864-81.92-81.92v-240.64c0-45.056%2036.864-81.92%2081.92-81.92z'%20fill='%238a8a8a'%20p-id='2578'%20data-spm-anchor-id='a313x.7781069.0.i0'%20class='selected'%3e%3c/path%3e%3cpath%20d='M174.08%20475.136l51.712%20165.376%2051.712-165.376H174.08z%20m10.752-91.648H125.44l-46.592%2073.728h75.776l30.208-73.728zM276.48%20456.704l-30.208-73.728h-40.96l-30.208%2073.728H276.48z%20m-193.536%2018.432l51.2%2063.488%2067.072%2082.432-47.104-145.92H82.944z%20m183.808-91.648L296.96%20456.704h76.8l-47.616-73.728H266.752z%20m-15.36%20236.032l89.088-109.056%2028.672-35.328h-71.68l-46.08%20144.384zM529.92%20430.592h-67.584v162.304h30.72V532.992h36.352c39.936%200%2059.904-17.408%2059.904-51.2s-19.968-51.2-59.392-51.2z%20m-36.864%2027.136h34.816c10.752%200%2018.432%202.048%2023.552%205.632%204.608%203.584%207.168%209.728%207.168%2017.92%200%208.704-2.56%2014.848-6.656%2018.432-5.12%203.584-13.312%205.632-23.552%205.632h-34.816v-47.616zM733.696%20567.296l-2.56-25.6c-1.536-13.824-7.68-23.04-18.432-27.648%206.144-2.56%2011.264-7.168%2014.848-12.288%204.608-6.656%207.168-14.848%207.168-23.04%200-15.36-5.12-27.648-15.872-36.352-9.728-7.68-23.04-11.264-39.424-11.264h-72.704v162.304h30.72V528.896h38.4c8.704%200%2014.336%201.536%2018.432%205.12%204.096%203.072%206.144%208.704%207.168%2016.896l2.048%2019.456c1.024%209.728%203.584%2016.384%207.168%2022.016l0.512%201.024h34.816l-3.584-4.608c-5.12-5.632-8.192-12.8-8.704-21.504z%20m-96.256-109.568h38.4c10.24%200%2017.408%201.536%2021.504%205.12%204.096%203.072%206.144%208.704%206.144%2016.384%200%207.168-2.048%2012.8-6.144%2016.384-5.12%204.096-12.288%205.632-21.504%205.632h-38.4v-43.52zM890.88%20452.096c-14.336-15.872-33.792-24.064-58.88-24.064s-44.544%208.192-58.88%2024.576c-13.824%2015.36-20.48%2034.816-20.48%2059.904%200%2024.576%206.656%2044.544%2020.48%2059.904%2014.336%2015.872%2033.792%2024.064%2058.88%2024.064%2024.576%200%2044.544-8.192%2058.88-24.064%2013.824-15.36%2020.48-35.328%2020.48-59.904%200-25.088-6.656-45.568-20.48-60.416z%20m-58.88%203.584c15.872%200%2027.648%204.608%2035.84%2014.848%208.192%2010.24%2012.288%2024.064%2012.288%2041.984%200%2017.408-4.096%2031.744-12.288%2041.472-8.192%209.728-20.48%2014.848-35.84%2014.848s-27.648-5.12-35.84-15.36c-8.192-10.24-12.288-23.552-12.288-40.96%200-17.408%204.096-31.232%2012.288-40.96%208.704-10.752%2020.48-15.872%2035.84-15.872z'%20fill='%23FFFFFF'%20p-id='2579'%3e%3c/path%3e%3c/svg%3e",onClick:o}),pe("div",{class:"ml-8px text-default",onClick:o},ve(e.$t("Component.Auth.index_1")),1)],64)):de("",!0),oe(n)?(se(),le(me,{key:1},[pe("img",{class:"w-48px",src:"data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1622511998564'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5405'%20data-spm-anchor-id='a313x.7781069.0.i4'%20width='70'%20height='70'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e@font-face%20{%20font-family:%20element-icons;%20src:%20url('chrome-extension://moombeodfomdpjnpocobemoiaemednkg/fonts/element-icons.woff')%20format('woff'),%20url('chrome-extension://moombeodfomdpjnpocobemoiaemednkg/fonts/element-icons.ttf%20')%20format('truetype');%20}%20%3c/style%3e%3c/defs%3e%3cpath%20d='M87.04%20309.76h849.92c45.056%200%2081.92%2036.864%2081.92%2081.92v240.64c0%2045.056-36.864%2081.92-81.92%2081.92H87.04c-45.056%200-81.92-36.864-81.92-81.92v-240.64c0-45.056%2036.864-81.92%2081.92-81.92z'%20fill='%23FFB800'%20p-id='5406'%20data-spm-anchor-id='a313x.7781069.0.i3'%20class=''%3e%3c/path%3e%3cpath%20d='M174.08%20475.136l51.712%20165.376%2051.712-165.376H174.08z%20m10.752-91.648H125.44l-46.592%2073.728h75.776l30.208-73.728zM276.48%20456.704l-30.208-73.728h-40.96l-30.208%2073.728H276.48z%20m-193.536%2018.432l51.2%2063.488%2067.072%2082.432-47.104-145.92H82.944z%20m183.808-91.648L296.96%20456.704h76.8l-47.616-73.728H266.752z%20m-15.36%20236.032l89.088-109.056%2028.672-35.328h-71.68l-46.08%20144.384zM529.92%20430.592h-67.584v162.304h30.72V532.992h36.352c39.936%200%2059.904-17.408%2059.904-51.2s-19.968-51.2-59.392-51.2z%20m-36.864%2027.136h34.816c10.752%200%2018.432%202.048%2023.552%205.632%204.608%203.584%207.168%209.728%207.168%2017.92%200%208.704-2.56%2014.848-6.656%2018.432-5.12%203.584-13.312%205.632-23.552%205.632h-34.816v-47.616zM733.696%20567.296l-2.56-25.6c-1.536-13.824-7.68-23.04-18.432-27.648%206.144-2.56%2011.264-7.168%2014.848-12.288%204.608-6.656%207.168-14.848%207.168-23.04%200-15.36-5.12-27.648-15.872-36.352-9.728-7.68-23.04-11.264-39.424-11.264h-72.704v162.304h30.72V528.896h38.4c8.704%200%2014.336%201.536%2018.432%205.12%204.096%203.072%206.144%208.704%207.168%2016.896l2.048%2019.456c1.024%209.728%203.584%2016.384%207.168%2022.016l0.512%201.024h34.816l-3.584-4.608c-5.12-5.632-8.192-12.8-8.704-21.504z%20m-96.256-109.568h38.4c10.24%200%2017.408%201.536%2021.504%205.12%204.096%203.072%206.144%208.704%206.144%2016.384%200%207.168-2.048%2012.8-6.144%2016.384-5.12%204.096-12.288%205.632-21.504%205.632h-38.4v-43.52zM890.88%20452.096c-14.336-15.872-33.792-24.064-58.88-24.064s-44.544%208.192-58.88%2024.576c-13.824%2015.36-20.48%2034.816-20.48%2059.904%200%2024.576%206.656%2044.544%2020.48%2059.904%2014.336%2015.872%2033.792%2024.064%2058.88%2024.064%2024.576%200%2044.544-8.192%2058.88-24.064%2013.824-15.36%2020.48-35.328%2020.48-59.904%200-25.088-6.656-45.568-20.48-60.416z%20m-58.88%203.584c15.872%200%2027.648%204.608%2035.84%2014.848%208.192%2010.24%2012.288%2024.064%2012.288%2041.984%200%2017.408-4.096%2031.744-12.288%2041.472-8.192%209.728-20.48%2014.848-35.84%2014.848s-27.648-5.12-35.84-15.36c-8.192-10.24-12.288-23.552-12.288-40.96%200-17.408%204.096-31.232%2012.288-40.96%208.704-10.752%2020.48-15.872%2035.84-15.872z'%20fill='%23FFFFFF'%20p-id='5407'%20data-spm-anchor-id='a313x.7781069.0.i5'%20class=''%3e%3c/path%3e%3c/svg%3e",onClick:r}),pe("div",{class:"ml-8px",onClick:r},[_e(ve(e.$t("Component.Auth.index_4"))+" ",1),pe("span",na,ve(oe(i)),1)]),xe(l,{class:"ml-8px",onClick:r},{default:ye(()=>[_e(ve(e.$t("Component.Auth.index_2")),1)]),_:1})],64)):de("",!0)])}}}),oa={class:"cursor-pointer"},ra=ae({__name:"lang",setup(t){const n=e(),i=fe([]),o=async e=>{await l({name:e}),s()};return i.value=n.langList.map(e=>({key:e.name,title:e.title})),(e,t)=>{const l=a,s=P;return se(),ge(s,{trigger:"hover",options:oe(i),onSelect:o},{default:ye(()=>[pe("div",oa,[xe(l,{name:"base-lang",size:"18",color:"#666"})])]),_:1},8,["options"])}}}),ca={key:0},ua=["title"],da={class:"run-time"},ma=p(ae({__name:"index",setup(a){const{t:l}=he(),p=e(),{userInfo:v,username:x,authExpired:_}=ue(p),{server:y}=la(),f=we(()=>y.value?y.value.system.split(" ")[0].toLowerCase():""),g=we(()=>y.value?y.value.system:"--"),h=we(()=>y.value?y.value.time:"--"),w=we(()=>y.value?y.value.version:"--"),b=fe("--"),k=we(()=>"--"!==b.value&&b.value!==w.value),S=async()=>{const{message:e}=await r();i(e)&&(!1===e.local_is_latest?Ge({width:500,minHeight:508,isNotScroll:!0,data:{info:e},component:be(()=>c(()=>import("./old.js?v=1767769852656"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])))}):Ge({width:530,minHeight:282,data:{info:e},component:be(()=>c(()=>import("./new2.js?v=1767769852656"),__vite__mapDeps([14,1,2,3,4,5,6,7,8,9,10,15,11,12,16])))}))},C=()=>{Ve({title:l("Home.index_9"),content:l("Home.index_10"),onConfirm:async()=>{try{await u(),d.success(l("Home.index_11"))}finally{try{await m()}finally{s()}}}})},H=()=>{Qe()};return(async()=>{const{message:e}=await n();if(i(e)){if(b.value=e.is_beta?e.beta.version:e.version,!0===e.local_is_latest)return;const{ignore:t}=e;o(t)&&!t.includes(b.value)&&S()}})(),(e,a)=>{const l=t,s=ct,n=A,i=R,o=B;return se(),ge(o,{class:"mb-16px"},{default:ye(()=>[xe(n,{class:"min-h-52px px-16px",justify:"space-between"},{default:ye(()=>[xe(n,{class:"items-center text-#666",size:16},{default:ye(()=>[xe(s,{"icon-name":"user","icon-size":"18"},{default:ye(()=>[oe(v).status?(se(),le("span",ca,ve(oe(x)),1)):(se(),ge(l,{key:1,onClick:a[0]||(a[0]=e=>oe(Je)())},{default:ye(()=>[_e(ve(e.$t("Home.index_2")),1)]),_:1}))]),_:1}),xe(ut),xe(s,{"icon-name":oe(f),"icon-size":"14"},{default:ye(()=>[pe("div",{class:"system-info",title:oe(g)},ve(e.$t("Home.index_3"))+ve(oe(g)),9,ua)]),_:1},8,["icon-name"]),pe("div",da,ve(e.$t("Home.index_4"))+ve(oe(h)),1)]),_:1}),xe(n,{class:"items-center",size:16},{default:ye(()=>[oe(v).status&&"Lifetime"!==oe(_)?(se(),ge(dt,{key:0})):de("",!0),xe(ia),xe(l,{type:"default"},{default:ye(()=>[_e(ve(oe(w)),1)]),_:1}),xe(ra),xe(mt,null,{default:ye(()=>a[1]||(a[1]=[pe("div",{class:"flex items-center cursor-pointer text-18px text-#666"},[pe("i",{class:"i-ant-design:skin-outlined"})],-1)])),_:1,__:[1]}),xe(i,{dot:!0,show:oe(k)},{default:ye(()=>[xe(l,{onClick:S},{default:ye(()=>[_e(ve(e.$t("Home.index_5")),1)]),_:1})]),_:1},8,["show"]),xe(l,{onClick:C},{default:ye(()=>[_e(ve(e.$t("Home.index_6")),1)]),_:1}),xe(l,{onClick:H},{default:ye(()=>[_e(ve(e.$t("Home.index_7")),1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-5c30d0df"]]),pa={class:"flex items-center gap-12px h-50px px-16px text-default text-13px whitespace-nowrap overflow-hidden"},va={class:"text-[#fc6d26] font-bold"},xa={class:"flex items-center gap-16px whitespace-nowrap"},_a=p(ae({__name:"index",setup(a){const l=e(),{isFree:s,isPro:n,isLifetime:i,authExpired:o}=ue(l),{proRecommend:r}=la(),c=()=>{Ze({source:45})};return(e,a)=>{const l=E,u=t,d=B;return oe(r).show&&!oe(i)?(se(),ge(d,{key:0,class:"mb-16px"},{default:ye(()=>[pe("div",pa,[oe(s)?(se(),le(me,{key:0},[xe(l,{type:"primary",size:"small",onClick:c},{default:ye(()=>[_e(ve(e.$t("Component.Auth.index_3")),1)]),_:1}),a[0]||(a[0]=pe("img",{class:"w-48px",src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMy4wLjYsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMTAwIDM0LjUiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDEwMCAzNC41OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7Y2xpcC1wYXRoOnVybCgjU1ZHSURfMl8pO2ZpbGw6Izg5ODk4OTt9DQoJLnN0MXtmaWxsOiM4OTg5ODk7fQ0KCS5zdDJ7Zm9udC1mYW1pbHk6J01pY3Jvc29mdFlhSGVpLUJvbGQnO30NCgkuc3Qze2ZvbnQtc2l6ZTozMHB4O30NCjwvc3R5bGU+DQo8Zz4NCgk8Zz4NCgkJPGc+DQoJCQk8ZGVmcz4NCgkJCQk8cmVjdCBpZD0iU1ZHSURfMV8iIHk9IjIiIHdpZHRoPSIzNy4yIiBoZWlnaHQ9IjMxLjciLz4NCgkJCTwvZGVmcz4NCgkJCTxjbGlwUGF0aCBpZD0iU1ZHSURfMl8iPg0KCQkJCTx1c2UgeGxpbms6aHJlZj0iI1NWR0lEXzFfIiAgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7Ii8+DQoJCQk8L2NsaXBQYXRoPg0KCQkJPHBhdGggY2xhc3M9InN0MCIgZD0iTTcuOCwySDE3bC02LjMsOC4zTDcuOCwyeiBNMCwxMS4xbDYuNC04LjNsMi45LDguM0gweiBNMC4xLDEyLjdoOS44bDYuNiwxOS43TDAuMSwxMi43eiBNMTIsMTEuMWw2LjYtOC42DQoJCQkJbDYuNiw4LjZMMTIsMTEuMUwxMiwxMS4xeiBNMTEuNSwxMi43aDE0LjFsLTcuMSwyMC45TDExLjUsMTIuN3ogTTIwLjIsMmg5LjJsLTIuOSw4LjNMMjAuMiwyeiBNMjcuOCwxMS4xbDIuOS04LjNsNi40LDguM0gyNy44eg0KCQkJCSBNMjcuMywxMi43aDkuOEwyMC42LDMyLjRMMjcuMywxMi43eiIvPg0KCQk8L2c+DQoJPC9nPg0KPC9nPg0KPHRleHQgdHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgMSA0My4xOSAyOC42NTk5KSIgY2xhc3M9InN0MSBzdDIgc3QzIj5Qcm88L3RleHQ+DQo8L3N2Zz4NCg=="},null,-1))],64)):de("",!0),oe(n)?(se(),le(me,{key:1},[a[1]||(a[1]=pe("img",{class:"w-60px",src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMy4wLjYsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMTIwIDM3IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMjAgMzc7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+DQoJLnN0MHtjbGlwLXBhdGg6dXJsKCNTVkdJRF8yXyk7ZmlsbDojRjM5QzEyO30NCgkuc3Qxe2ZpbGw6I0YzOUMxMjt9DQoJLnN0Mntmb250LWZhbWlseTonTWljcm9zb2Z0WWFIZWktQm9sZCc7fQ0KCS5zdDN7Zm9udC1zaXplOjI5cHg7fQ0KPC9zdHlsZT4NCjxnPg0KCTxnPg0KCQk8Zz4NCgkJCTxkZWZzPg0KCQkJCTxyZWN0IGlkPSJTVkdJRF8xXyIgeD0iMi43IiB5PSIzIiB3aWR0aD0iMzcuMiIgaGVpZ2h0PSIzMS43Ii8+DQoJCQk8L2RlZnM+DQoJCQk8Y2xpcFBhdGggaWQ9IlNWR0lEXzJfIj4NCgkJCQk8dXNlIHhsaW5rOmhyZWY9IiNTVkdJRF8xXyIgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIvPg0KCQkJPC9jbGlwUGF0aD4NCgkJCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMC42LDNoOS4ybC02LjMsOC4zTDEwLjYsM3ogTTIuNywxMi4xbDYuNC04LjNsMi45LDguM0gyLjd6IE0yLjgsMTMuN2g5LjhsNi42LDE5LjdMMi44LDEzLjd6IE0xNC44LDEyLjENCgkJCQlsNi42LTguNmw2LjYsOC42TDE0LjgsMTIuMUwxNC44LDEyLjF6IE0xNC4zLDEzLjdoMTQuMWwtNy4xLDIwLjlMMTQuMywxMy43eiBNMjIuOSwzaDkuMmwtMi45LDguM0wyMi45LDN6IE0zMC42LDEyLjFsMi45LTguMw0KCQkJCWw2LjUsOC4zSDMwLjZ6IE0zMCwxMy43aDkuOEwyMy40LDMzLjRMMzAsMTMuN3oiLz4NCgkJPC9nPg0KCTwvZz4NCjwvZz4NCjx0ZXh0IHRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIDEgNDYgMjgpIiBjbGFzcz0ic3QxIHN0MiBzdDMiPlBSTzwvdGV4dD4NCjwvc3ZnPg0K"},null,-1)),pe("span",null,[_e(ve(e.$t("Component.Auth.index_4"))+" ",1),pe("span",va,ve(oe(o)),1)]),xe(u,{class:"font-bold!",onClick:c},{default:ye(()=>[_e(ve(e.$t("Component.Auth.index_2")),1)]),_:1})],64)):de("",!0),pe("div",xa,[(se(!0),le(me,null,ke(oe(r).ps,e=>(se(),le("div",{key:e,class:"advantage"},ve(e),1))),128))])])]),_:1})):de("",!0)}}}),[["__scopeId","data-v-bfb22274"]]),ya={class:"flex flex-col items-center w-100% py-24px"},fa={class:"flex items-center mb-8px text-15px text-desc"},ga={key:1},ha={class:"flex items-center h-24px mt-8px text-14px text-desc"},wa=ae({__name:"box",props:{value:{default:0},showText:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},setup(e){const t=e,{t:a}=he(),l=v(),s=!!Se().desc,n=we(()=>o(t.value)),i=[{val:90,type:"error",color:l.value.errorColor,desc:a("Home.index_12")},{val:80,type:"warning",color:l.value.warningColor,desc:a("Home.index_13")},{val:70,type:"success",color:l.value.primaryColor,desc:a("Home.index_14")},{val:30,type:"success",color:l.value.primaryColor,desc:a("Home.index_15")}],o=e=>{const t={val:e,type:"success",color:"#20a53a",desc:a("Home.index_15")};for(let a=0;a<i.length;a++){const l=i[a];if(e>=l.val){t.desc=l.desc,t.color=l.color,t.type=l.type;break}if(e<30){t.type=i[i.length-1].type,t.desc=i[i.length-1].desc,t.color=i[i.length-1].color;break}}return t};return(e,t)=>{const a=F;return se(),le("div",ya,[pe("div",fa,[ne(e.$slots,"title")]),xe(oe(O),Ce(e.$attrs,{trigger:"hover",placement:"bottom-start","display-directive":"show",disabled:e.disabled,"show-arrow":!1,style:{padding:0}}),{trigger:ye(()=>[xe(a,{type:"circle",class:"w-105px! cursor-pointer",status:oe(n).type,"stroke-width":7,"offset-degree":180,percentage:e.value},{default:ye(()=>[pe("div",{class:"w-88px text-17px text-center",style:ie({color:oe(n).color})},[e.showText?ne(e.$slots,"progress",{key:0}):(se(),le("span",ga,ve(e.value)+"%",1))],4)]),_:3},8,["status","percentage"])]),default:ye(()=>[ne(e.$slots,"popover")]),_:3},16,["disabled"]),pe("div",ha,[s?ne(e.$slots,"desc",{key:0}):(se(),le(me,{key:1},[_e(ve(oe(n).desc),1)],64))])])}}}),ba=ae({__name:"tag",props:{value:{default:0},desc:{default:""}},setup(e){const t=e,a=we(()=>t.value>=90?"error":t.value>=80?"warning":"success");return(e,t)=>{const l=U;return se(),ge(l,{type:oe(a),bordered:!1},{default:ye(()=>[_e(ve(e.desc)+" "+ve(e.value)+"%",1)]),_:1},8,["type"])}}});const ka=p({},[["render",function(e,t){const a=x;return se(),ge(a,Ce(e.$attrs,{"arrow-placement":"right","display-directive":"show"}),{default:ye(()=>[ne(e.$slots,"default",{},void 0,!0)]),_:3},16)}],["__scopeId","data-v-f0e03c84"]]),Sa={class:"w-400px p-20px"},Ca={class:"flex items-center mb-12px"},Ha={class:"mx-8px text-14px"},Ma={class:"flex-1"},Ta={class:"p-12px pb-0 text-13px text-default"},Ia={class:"flex justify-between"},ja={class:"flex justify-between mt-8px"},Da={class:"flex-1"},La={class:"p-4px pb-0 text-13px text-default"},za={class:"table table-fixed whitespace-nowrap"},Na={class:"flex-1"},$a={class:"mt-10px"},Pa={class:"flex items-center"},Ba={class:"mr-4px"},Aa=ae({__name:"info",props:{value:{default:0},load:{}},setup(t,{expose:a}){const l=e(),{isFree:s}=ue(l),{t:n}=he(),{onServerReady:r}=la(),c=fe(["basic"]),u=fe(["load"]),d=fe({user:0,nice:0,system:0,idle:0,iowait:0,irq:0,softirq:0,steal:0,guest:0,guest_nice:0,total_processes:0,active_processes:0}),{table:m,columns:p}=We([{key:"proc_name",title:n("Home.index_24"),ellipsis:{tooltip:!0},render:e=>{const t=n("Home.index_29",[e.explain,e.exe_path,e.cwd_path,e.num_threads]);return xe("span",{title:t},[e.proc_name])}},{key:"cpu_percent",title:n("Home.index_25"),width:100},Xe({width:80,options:e=>[{label:n("Home.index_98"),disabled:1===e.important,onClick:()=>{const t=e.explain.split("The process of")[1];Ye({title:n("Home.index_27"),content:()=>xe("span",{class:"text-error text-14px"},[n("Home.index_28",[e.proc_name,t])]),onConfirm:async()=>{await _({pid:e.pid}),k(!0,!0)}})}}]})]),v=async()=>{u.value.includes("top5")?await k(!0,!0):b()},x=()=>{Ze({source:141})},{loading:g,setLoading:h}=Ke(),{loop:w,clearTimer:b}=qe(async()=>{await k()},5),k=async(e=!1,t=!1)=>{try{if(s.value)return;t&&b(),e&&h(!0);const{message:a}=await y();i(a)&&(m.data=o(a.CPU_high_occupancy_software_list)?a.CPU_high_occupancy_software_list:[]),t&&w()}finally{e&&h(!1)}};return r("load-info",e=>{d.value=e.cpu_times}),a({clearTimer:b,onUpdateCollapse:v}),(e,t)=>{const a=f,l=E,n=et;return se(),le("div",Sa,[pe("div",Ca,[pe("div",Ha,ve(e.$t("Home.index_31")),1),xe(ba,{value:e.value},null,8,["value"])]),xe(ka,{"expanded-names":oe(c),"onUpdate:expandedNames":t[0]||(t[0]=e=>He(c)?c.value=e:null),class:"mb-16px"},{default:ye(()=>[xe(a,{name:"basic"},{header:ye(()=>[pe("div",Ma,ve(e.$t("Home.index_32")),1)]),default:ye(()=>[pe("div",Ta,[pe("div",Ia,[pe("span",null,ve(e.$t("Home.index_33")),1),pe("span",null,ve(e.load.one.toFixed(2))+" / "+ve(e.load.five.toFixed(2))+" / "+ve(e.load.fifteen.toFixed(2)),1)]),pe("div",ja,[pe("span",null,ve(e.$t("Home.index_34")),1),pe("span",null,ve(oe(d).active_processes)+" / "+ve(oe(d).total_processes),1)])])]),_:1})]),_:1},8,["expanded-names"]),xe(ka,{"expanded-names":oe(u),"onUpdate:expandedNames":[t[1]||(t[1]=e=>He(u)?u.value=e:null),v],accordion:!0},{default:ye(()=>[xe(a,{name:"load"},{header:ye(()=>[pe("div",Da,ve(e.$t("Home.index_35")),1)]),default:ye(()=>[pe("div",La,[pe("table",za,[pe("tbody",null,[pe("tr",null,[t[2]||(t[2]=pe("td",null,[pe("span",null,"user")],-1)),pe("td",null,[pe("span",null,ve(oe(d).user),1)]),t[3]||(t[3]=pe("td",null,[pe("span",null,"nice")],-1)),pe("td",null,[pe("span",null,ve(oe(d).nice),1)])]),pe("tr",null,[t[4]||(t[4]=pe("td",null,[pe("span",null,"system")],-1)),pe("td",null,[pe("span",null,ve(oe(d).system),1)]),t[5]||(t[5]=pe("td",null,[pe("span",null,"idle")],-1)),pe("td",null,[pe("span",null,ve(oe(d).idle),1)])]),pe("tr",null,[t[6]||(t[6]=pe("td",null,[pe("span",null,"iowait")],-1)),pe("td",null,[pe("span",null,ve(oe(d).iowait),1)]),t[7]||(t[7]=pe("td",null,[pe("span",null,"irq")],-1)),pe("td",null,[pe("span",null,ve(oe(d).irq),1)])]),pe("tr",null,[t[8]||(t[8]=pe("td",null,[pe("span",null,"softirq")],-1)),pe("td",null,[pe("span",null,ve(oe(d).softirq),1)]),t[9]||(t[9]=pe("td",null,[pe("span",null,"steal")],-1)),pe("td",null,[pe("span",null,ve(oe(d).steal),1)])]),pe("tr",null,[t[10]||(t[10]=pe("td",null,[pe("span",null,"guest")],-1)),pe("td",null,[pe("span",null,ve(oe(d).guest),1)]),t[11]||(t[11]=pe("td",null,[pe("span",null,"guest_nice")],-1)),pe("td",null,[pe("span",null,ve(oe(d).guest_nice),1)])])])])])]),_:1}),xe(a,{name:"top5"},{header:ye(()=>[pe("div",Na,ve(e.$t("Home.index_20")),1)]),default:ye(()=>[pe("div",$a,[xe(n,{loading:oe(g),"loading-num":5,data:oe(m).data,columns:oe(p)},Me({_:2},[oe(s)?{name:"empty",fn:ye(()=>[pe("div",Pa,[pe("span",Ba,ve(e.$t("Home.index_21")),1),xe(l,{class:"w-90px h-24px px-0",type:"primary",onClick:x},{default:ye(()=>[_e(ve(e.$t("Home.index_22")),1)]),_:1})])]),key:"0"}:void 0]),1032,["loading","data","columns"])])]),_:1})]),_:1},8,["expanded-names"])])}}}),Ra=p(Aa,[["__scopeId","data-v-d5229aa0"]]),Ea={class:"mr-6px"},Oa=ae({__name:"index",setup(e){const{onServerReady:t}=la(),a=fe({one:0,five:0,fifteen:0,max:0,limit:0,safe:0}),l=we(()=>{const{one:e,max:t}=a.value;return t>0?Math.round(e/t*100):0}),s=fe(),n=e=>{var t,a;e?null==(t=s.value)||t.onUpdateCollapse():null==(a=s.value)||a.clearTimer()};return t("load",e=>{a.value=e.load}),(e,t)=>(se(),ge(wa,{value:oe(l),"onUpdate:show":n},{title:ye(()=>[pe("span",Ea,ve(e.$t("Home.index_30")),1),t[0]||(t[0]=pe("a",{class:"bt-ico-ask cursor-pointer!",href:"https://www.aapanel.com/forum/d/1265-what-does-the-data-in-load-status-represent",target:"_blank"}," ? ",-1))]),popover:ye(()=>[xe(Ra,{ref_key:"infoRef",ref:s,value:oe(l),load:oe(a)},null,8,["value","load"])]),_:1},8,["value"]))}}),Fa={class:"w-400px p-20px"},Ua={class:"flex items-center mb-12px"},Za={class:"mx-8px text-14px"},Ja={class:"flex-1"},Ga={class:"p-12px pb-0 text-13px text-default"},Va={class:"mt-8px"},Qa={class:"flex-1"},Wa={class:"p-12px pb-0 text-13px text-default leading-22px"},Xa={class:"flex-1"},Ya={class:"mt-10px"},Ka={class:"flex items-center"},qa={class:"mr-4px"},el=ae({__name:"info",props:{cpu:{}},setup(t,{expose:a}){const l=e(),{isFree:s}=ue(l),{t:n}=he(),r=t,c=fe(["info"]),u=fe(["load"]),d=we(()=>{const{cpu:e}=r;return n("Home.index_23",[e.cpuNum,e.physicalNum,e.logicalNum])}),m=we(()=>{const{cpu:e}=r,t=[];for(let a=0;a<e.loadList.length;a+=3){const l=e.loadList.slice(a,a+3);t.push(l)}return t}),{table:p,columns:v}=We([{key:"proc_name",title:n("Home.index_24"),ellipsis:{tooltip:!0},render:e=>{const t=n("Home.index_29",[e.explain,e.exe_path,e.cwd_path,e.num_threads]);return xe("span",{title:t},[e.proc_name])}},{key:"cpu_percent",title:n("Home.index_25"),width:100},Xe({width:80,options:e=>[{label:n("Home.index_98"),disabled:1===e.important,onClick:()=>{const t=e.explain.split("The process of")[1];Ye({title:n("Home.index_27"),content:()=>xe("span",{class:"text-error text-14px"},[n("Home.index_28",[e.proc_name,t])]),onConfirm:async()=>{await _({pid:e.pid}),S(!0,!0)}})}}]})]),x=async()=>{u.value.includes("top5")?await S(!0,!0):k()},g=()=>{Ze({source:141})},{loading:h,setLoading:w}=Ke(),{loop:b,clearTimer:k}=qe(async()=>{await S()},5),S=async(e=!1,t=!1)=>{try{if(s.value)return;t&&k(),e&&w(!0);const{message:a}=await y();i(a)&&(p.data=o(a.CPU_high_occupancy_software_list)?a.CPU_high_occupancy_software_list:[]),t&&b()}finally{e&&w(!1)}};return a({clearTimer:k,onUpdateCollapse:x}),(e,t)=>{const a=f,l=E,n=et;return se(),le("div",Fa,[pe("div",Ua,[pe("div",Za,ve(e.$t("Home.index_16")),1),xe(ba,{value:e.cpu.percent},null,8,["value"])]),xe(ka,{"expanded-names":oe(c),"onUpdate:expandedNames":t[0]||(t[0]=e=>He(c)?c.value=e:null),class:"mb-16px"},{default:ye(()=>[xe(a,{name:"info"},{header:ye(()=>[pe("div",Ja,ve(e.$t("Home.index_18")),1)]),default:ye(()=>[pe("div",Ga,[pe("div",null,ve(e.cpu.name),1),pe("div",Va,ve(oe(d)),1)])]),_:1})]),_:1},8,["expanded-names"]),xe(ka,{"expanded-names":oe(u),"onUpdate:expandedNames":[t[1]||(t[1]=e=>He(u)?u.value=e:null),x],accordion:!0},{default:ye(()=>[xe(a,{name:"load"},{header:ye(()=>[pe("div",Qa,ve(e.$t("Home.index_19")),1)]),default:ye(()=>[pe("div",Wa,[(se(!0),le(me,null,ke(oe(m),(t,a)=>(se(),le("div",{key:"".concat(a+1),class:"flex justify-between"},[pe("span",null,ve(e.$t("Home.index_36"))+" "+ve(t.map((e,t)=>t+1+3*a).join(" / ")),1),pe("span",null,ve(t.map(e=>e+"%").join(" / ")),1)]))),128))])]),_:1}),xe(a,{name:"top5"},{header:ye(()=>[pe("div",Xa,ve(e.$t("Home.index_20")),1)]),default:ye(()=>[pe("div",Ya,[xe(n,{loading:oe(h),"loading-num":5,data:oe(p).data,columns:oe(v)},Me({_:2},[oe(s)?{name:"empty",fn:ye(()=>[pe("div",Ka,[pe("span",qa,ve(e.$t("Home.index_21")),1),xe(l,{class:"w-90px h-24px px-0",type:"primary",onClick:g},{default:ye(()=>[_e(ve(e.$t("Home.index_22")),1)]),_:1})])]),key:"0"}:void 0]),1032,["loading","data","columns"])])]),_:1})]),_:1},8,["expanded-names"])])}}}),tl=ae({__name:"index",setup(e){const{onServerReady:t}=la(),a=fe({name:"",percent:0,cpuNum:0,logicalNum:0,physicalNum:0,loadList:[]}),l=fe(),s=e=>{var t,a;e?null==(t=l.value)||t.onUpdateCollapse():null==(a=l.value)||a.clearTimer()};return t("cpu",e=>{var t;a.value={name:(t=e.cpu)[3]||"--",percent:t[0]||0,cpuNum:t[5]||0,logicalNum:t[1]||0,physicalNum:t[4]||0,loadList:t[2]||[]}}),(e,t)=>(se(),ge(wa,{value:oe(a).percent,"onUpdate:show":s},{title:ye(()=>[pe("span",null,ve(e.$t("Home.index_16")),1)]),desc:ye(()=>[pe("span",null,ve(oe(a).logicalNum)+" "+ve(e.$t("Home.index_17")),1)]),popover:ye(()=>[xe(el,{ref_key:"infoRef",ref:l,value:oe(a).percent,cpu:oe(a)},null,8,["value","cpu"])]),_:1},8,["value"]))}}),al={class:"w-400px p-20px"},ll={class:"flex items-center mb-12px"},sl={class:"mx-8px text-14px"},nl={class:"flex justify-end flex-1"},il={class:"flex-1"},ol={class:"p-12px pb-0 text-13px text-default"},rl={class:"flex"},cl={class:"flex items-center w-45%"},ul={class:"w-70px mr-2px text-right"},dl={class:"flex-1"},ml={class:"flex items-center flex-1"},pl={class:"w-90px mr-2px text-right"},vl={class:"flex-1"},xl={class:"flex mt-8px"},_l={class:"flex items-center w-45%"},yl={class:"w-70px mr-2px text-right"},fl={class:"flex-1"},gl={class:"flex items-center flex-1"},hl={class:"w-90px mr-2px text-right"},wl={class:"flex-1"},bl={class:"flex-1"},kl={class:"mt-10px"},Sl={class:"flex items-center"},Cl={class:"mr-4px"},Hl=ae({__name:"info",props:{value:{default:0},memory:{},confirm:{type:Function,default:()=>!1}},setup(t,{expose:a}){const l=t,s=e(),{isFree:n}=ue(s),{t:r}=he(),c=fe(["info"]),u=()=>{Ye({title:r("Home.index_49"),content:()=>xe("span",{class:"text-error"},[r("Home.index_47")]),onConfirm:({hide:e})=>{e(),l.confirm()}})},{table:d,columns:m}=We([{key:"proc_name",title:r("Home.index_24"),ellipsis:{tooltip:{width:"trigger"}},render:e=>{const t="Remark: ".concat(e.explain,"\nStarting path: ").concat(e.exe_path,"\nRun directory: ").concat(e.cwd_path,"\nNumber of threads: ").concat(e.num_threads);return xe("span",{title:t},[e.proc_name])}},{key:"memory_usage",title:r("Home.index_48"),width:100},Xe({width:80,options:e=>[{label:r("Home.index_26"),disabled:1===e.important,onClick:()=>{const t=e.explain.split("The process of")[1];Ye({title:r("Home.index_49"),content:()=>xe("span",{class:"text-error text-14px"},[r("Home.index_50",[e.proc_name,t])]),onConfirm:async()=>{await _({pid:e.pid}),b(!0,!0)}})}}]})]),p=async()=>{c.value.includes("top5")?await b(!0,!0):w()},v=()=>{Ze({source:141})},{loading:x,setLoading:g}=Ke(),{loop:h,clearTimer:w}=qe(async()=>{await b()},5),b=async(e=!1,t=!1)=>{try{if(n.value)return;t&&w(),e&&g(!0);const{message:a}=await y();i(a)&&(d.data=o(a.memory_high_occupancy_software_list)?a.memory_high_occupancy_software_list:[]),t&&h()}finally{e&&g(!1)}};return a({clearTimer:w,onUpdateCollapse:p}),(e,t)=>{const a=E,l=f,s=et;return se(),le("div",al,[pe("div",ll,[pe("div",sl,ve(e.$t("Home.index_37")),1),xe(ba,{value:e.value},null,8,["value"]),pe("div",nl,[xe(a,{type:"primary",onClick:u},{default:ye(()=>[_e(ve(e.$t("Home.index_40")),1)]),_:1})])]),xe(ka,{"expanded-names":oe(c),"onUpdate:expandedNames":[t[0]||(t[0]=e=>He(c)?c.value=e:null),p]},{default:ye(()=>[xe(l,{name:"info"},{header:ye(()=>[pe("div",il,ve(e.$t("Home.index_41")),1)]),default:ye(()=>[pe("div",ol,[pe("div",rl,[pe("div",cl,[pe("div",ul,ve(e.$t("Home.index_42")),1),pe("div",dl,ve(e.memory.memRealUsed)+" MB",1)]),pe("div",ml,[pe("div",pl,ve(e.$t("Home.index_43")),1),pe("div",vl,ve(e.memory.memTotal)+" MB",1)])]),pe("div",xl,[pe("div",_l,[pe("div",yl,ve(e.$t("Home.index_44")),1),pe("div",fl,ve(e.memory.memFree)+" MB",1)]),pe("div",gl,[pe("div",hl,ve(e.$t("Home.index_45")),1),pe("div",wl,ve(e.memory.memBuffers)+"/"+ve(e.memory.memCached)+" MB",1)])])])]),_:1}),xe(l,{name:"top5"},{header:ye(()=>[pe("div",bl,ve(e.$t("Home.index_46")),1)]),default:ye(()=>[pe("div",kl,[xe(s,{loading:oe(x),"loading-num":5,data:oe(d).data,columns:oe(m)},Me({_:2},[oe(n)?{name:"empty",fn:ye(()=>[pe("div",Sl,[pe("span",Cl,ve(e.$t("Home.index_21")),1),xe(a,{class:"w-90px h-24px px-0",type:"primary",onClick:v},{default:ye(()=>[_e(ve(e.$t("Home.index_22")),1)]),_:1})])]),key:"0"}:void 0]),1032,["loading","data","columns"])])]),_:1})]),_:1},8,["expanded-names"])])}}}),Ml={class:"text-15px leading-20px"},Tl={key:0},Il={key:1},jl=ae({__name:"index",setup(e){const{onServerReady:t}=la(),a=fe({memTotal:0,memFree:0,memBuffers:0,memCached:0,memRealUsed:0}),l=fe(0),s=fe(!1),n=fe(!1),o=fe(".");let r=null;const c=async()=>{s.value=!0,n.value=!0,r=window.setInterval(()=>{if("..."===o.value?o.value=".":o.value+=".",l.value>1){const e=l.value-.2*l.value;l.value=e>1?e:1}},400);try{const{message:e}=await g();n.value=!1,u(),i(e)&&setTimeout(()=>{a.value=e,l.value=d(),s.value=!1},2e3)}catch(e){s.value=!1,n.value=!1,u()}},u=()=>{r&&clearInterval(r)},d=()=>{const{memTotal:e,memRealUsed:t}=a.value;return e>0?Math.round(t/e*1e3)/10:0},m=fe(),p=e=>{var t,a;e?null==(t=m.value)||t.onUpdateCollapse():null==(a=m.value)||a.clearTimer()};return t("memory",e=>{s.value||(a.value=e.mem,l.value=d())}),(e,t)=>(se(),ge(wa,{value:oe(l),disabled:oe(s),"show-text":oe(s),"onUpdate:show":p},{title:ye(()=>[pe("span",null,ve(e.$t("Home.index_37")),1)]),progress:ye(()=>[pe("div",Ml,[oe(n)?(se(),le("span",Tl,ve(e.$t("Home.index_38"))+ve(oe(o)),1)):(se(),le("span",Il,[_e(ve(e.$t("Home.index_39")),1),t[0]||(t[0]=pe("br",null,null,-1)),t[1]||(t[1]=_e("0 B",-1))]))])]),desc:ye(()=>[pe("span",null,ve(oe(a).memRealUsed)+" / "+ve(oe(a).memTotal)+"(MB)",1)]),popover:ye(()=>[xe(Hl,{ref_key:"infoRef",ref:m,value:oe(l),memory:oe(a),confirm:c},null,8,["value","memory"])]),_:1},8,["value","disabled","show-text"]))}}),Dl={class:"w-380px p-20px"},Ll={class:"flex items-center mb-12px"},zl={class:"mx-8px text-14px"},Nl={class:"flex justify-end flex-1"},$l={class:"flex-1"},Pl={class:"p-12px pb-0 text-13px text-default"},Bl={class:"mt-8px"},Al={class:"mt-8px"},Rl={class:"mt-8px"},El={class:"flex-1"},Ol={class:"p-12px pb-0 text-13px text-default"},Fl={class:"mt-8px"},Ul={class:"mt-8px"},Zl={class:"mt-8px"},Jl={class:"mt-8px"},Gl=ae({__name:"info",props:{value:{default:0},data:{}},setup(t){const a=e(),l=fe(["info","inode"]);return(e,t)=>{const s=E,n=vt,i=f;return se(),le("div",Dl,[pe("div",Ll,[pe("div",zl,ve(e.$t("Home.index_51")),1),xe(ba,{value:e.value,desc:e.$t("Home.index_97")},null,8,["value","desc"]),pe("div",Nl,[xe(s,{type:"primary",onClick:t[0]||(t[0]=e=>(async()=>{a.isFree?Ze({source:350}):(await tt("disk_analysis"),await xt({name:"disk_analysis",title:"Disk analysis",admin:!0}))})())},{default:ye(()=>[_e(ve(e.$t("Home.index_52")),1)]),_:1})])]),xe(ka,{"expanded-names":oe(l),"onUpdate:expandedNames":t[1]||(t[1]=e=>He(l)?l.value=e:null)},{default:ye(()=>[xe(i,{name:"info"},{header:ye(()=>[pe("div",$l,ve(e.$t("Home.index_53")),1)]),default:ye(()=>[pe("div",Pl,[pe("div",null,ve(e.$t("Home.index_54"))+ve(e.data.type),1),pe("div",Bl,ve(e.$t("Home.index_55"))+ve(e.data.path),1),xe(n,{class:"mt-8px",height:22,value:e.value,"indicator-placement":"inside"},null,8,["value"]),pe("div",Al,ve(e.$t("Home.index_56"))+ve(e.data.size[2])+ve(e.$t("Home.index_57"))+ve(e.data.size[0]),1),pe("div",Rl,ve(e.$t("Home.index_58"))+ve(e.data.size[1])+ve(e.$t("Home.index_59"))+ve(e.data.size[4]),1)])]),_:1}),xe(i,{name:"inode"},{header:ye(()=>[pe("div",El,ve(e.$t("Home.index_60")),1)]),default:ye(()=>[pe("div",Ol,[pe("div",null,ve(e.$t("Home.index_61"))+ve(e.data.filesystem),1),pe("div",Fl,ve(e.$t("Home.index_62"))+ve(e.data.inodes[0]),1),pe("div",Ul,ve(e.$t("Home.index_63"))+ve(e.data.inodes[1]),1),pe("div",Zl,ve(e.$t("Home.index_64"))+ve(e.data.inodes[2]),1),pe("div",Jl,ve(e.$t("Home.index_65"))+ve(e.data.inodes[3]),1)])]),_:1})]),_:1},8,["expanded-names"])])}}}),Vl=ae({__name:"index",props:{item:{}},setup:e=>(e,t)=>(se(),ge(wa,{value:e.item.percent},{title:ye(()=>[pe("span",null,ve(e.item.path),1)]),desc:ye(()=>[pe("span",null,ve(e.item.size[1])+" / "+ve(e.item.size[0]),1)]),popover:ye(()=>[xe(Gl,{value:e.item.percent,data:e.item},null,8,["value","data"])]),_:1},8,["value"]))}),Ql=ae({__name:"index",setup(e){const{defer:t}=at(),{onServerReady:a}=la(),l=fe([]);return a("state",e=>{l.value=e.disk.map(e=>(e.percent=(e=>{const[,,,t]=e;return parseFloat(t)})(e.size),e))}),(e,a)=>{const s=Z,n=h,i=B;return se(),ge(i,{class:"mb-16px",title:e.$t("Home.index_66")},{default:ye(()=>[xe(n,{cols:"2 800:4 1000:5 1200:6"},{default:ye(()=>[oe(t)(2)?(se(),ge(s,{key:0},{default:ye(()=>[xe(Oa)]),_:1})):de("",!0),oe(t)(3)?(se(),ge(s,{key:1},{default:ye(()=>[xe(tl)]),_:1})):de("",!0),oe(t)(4)?(se(),ge(s,{key:2},{default:ye(()=>[xe(jl)]),_:1})):de("",!0),(se(!0),le(me,null,ke(oe(l),e=>(se(),ge(s,{key:e.path},{default:ye(()=>[xe(Vl,{item:e},null,8,["item"])]),_:2},1024))),128))]),_:1})]),_:1},8,["title"])}}}),Wl=Te("home-security",()=>{const e=fe("overview"),t=fe({score:85,scoreLevel:"Good",riskNum:3,subtitle:"The overall security status of the system is good. It is recommended to check the security configuration regularly."}),a=fe({day:1,time:"--",virus:"--"}),l=fe({risk_scan:{status:!1,icon:"home-risk",name:"Risk Scan"},safe_detect:{status:!1,icon:"home-safeDetect",name:"Safety Testing"},file_detection:{status:!1,icon:"home-ware",name:"Malicious file detection"},vul_scan:{status:!1,icon:"home-web",name:"Vulnerability Scanning"},tamper:{status:!1,icon:"home-tamper",name:"Tamper-proof"}}),s=fe([{title:"Bug",type:"loophole",tips:"Timely discovery of vulnerabilities in the website and timely upgrade of the version can prevent hackers from taking advantage of the situation.",value:0},{title:"Malicious files",type:"file",tips:"Detection of malicious files (such as viruses, Trojans) that may steal information or damage the system",value:0},{title:"Risk",type:"risk",tips:"Conduct comprehensive inspections on websites/panel/systems to eliminate hidden risks",value:0},{title:"Baseline issues",type:"server",tips:"Check whether the server configuration meets security standards",value:0},{title:"Tamper-proof",type:"tamper",tips:"Tamper-proof for Enterprise：Real-time protection to see if web page content is illegally modified",value:0}]);return{menu:e,scoreData:t,safe:a,capabilitySwitch:l,risk_details:s,getSafeOverviewData:async()=>{const{message:e}=await _t();if(i(e)){const{security_status:n,risk_details:i}=e;t.value.score=e.score,t.value.scoreLevel=e.level,t.value.riskNum=e.risk_count,t.value.subtitle=e.level_description,a.value.day=e.protect_days,a.value.time=e.risk_scan_time.slice(0,10)||"-",a.value.virus=e.virus_update_time.slice(0,10)||"-",l.value.risk_scan.status=n.risk_scan,l.value.safe_detect.status=n.safe_detect,l.value.file_detection.status=n.file_detection,l.value.vul_scan.status=n.vul_scan,l.value.tamper.status=n.tamper,s.value[0].value=i.vul_scan.total||0,s.value[1].value=i.file_detection.total||0,s.value[2].value=i.homepage_risk.total||0,s.value[3].value=i.safe_detect.total||0,s.value[4].value=i.tamper.total||0}}}}),Xl=Wl(),{risk_details:Yl}=ue(Xl),Kl=ae({props:{value:{type:Number,required:!0},iconName:{type:String,required:!0}},setup:e=>()=>xe(me,null,[xe(a,{size:32,name:e.iconName},null),e.value>0?xe("div",{class:"absolute top-15px right-20px bg-red-500 text-white rounded-full px-2 py-1 text-xs"},[e.value]):""])}),ql=e=>{var t;return(null==(t=Yl.value.find(t=>t.type===e))?void 0:t.value)||0},es=e=>{switch(e){case 1:return{text:"Medium",style:"color: #FF9900"};case 2:return{text:"High",style:"color: #FF0000"};case 3:return{text:"Urgent",style:"color: #ba281e"};default:return{text:"--",style:"color: #000000"}}},ts=Te("home-security-file",()=>{const e=fe({status:!1,isHasMounts:!1}),t=fe(!1),a=fe(!1),l=fe("--"),s=fe([{title:"Total Scanned",value:0,style:"color: var(--home-risk-file-info-item-color)"},{title:"High risk",value:0,style:"color: #F50606;",id:2},{title:"Moderate",value:0,style:"color: #FF9900",id:1},{title:"Low risk",value:0,style:"color: #DDC400",id:0}]),n=fe([]),o=fe([]);return{lastScanTime:l,riskLevelsOverview:s,dynamicKill:t,autoIntercept:a,ossConfig:e,monitorPath:n,excludePath:o,getConfig:async()=>{const{message:l}=await yt();if(i(l)){const s=l.data;a.value=s.quarantine,t.value=s.dynamic_detection,e.value={status:s.scan_oss,isHasMounts:s.has_oss_mounts},n.value=s.monitor_dirs.map(e=>({path:e})),o.value=s.exclude_dirs.map(e=>({path:e}))}}}}),as={class:"home-security-file"},ls={class:"text-right lastScan-time mb-2"},ss={class:"infoList"},ns={class:"text-[1.2rem] info-title mb-[1.6rem]"},is=ae({__name:"file-info",setup(e){const t=ts(),{lastScanTime:a,riskLevelsOverview:l}=ue(t);return(e,t)=>(se(),le("div",as,[pe("div",ls,ve(e.$t("Home.Security.index_9"))+"："+ve(oe(a)),1),pe("div",ss,[(se(!0),le(me,null,ke(oe(l),e=>(se(),le("div",{class:"flex-1 text-center item-list",key:e.title},[pe("div",ns,ve(e.title),1),pe("div",{class:"text-[2.4rem]",style:ie(e.style)},ve(e.value),5)]))),128))])]))}}),os=p(is,[["__scopeId","data-v-3b66d740"]]),rs={class:"p-20px h-full"},cs={class:"relative"},us={class:"flex items-center absolute right-0 top-0"},ds={class:"mr-[.8rem]"},ms={key:0},ps={key:1},vs=ae({__name:"file-advanced",setup(e){const{t:t}=he(),a=ts(),{autoIntercept:l,dynamicKill:s,monitorPath:n,excludePath:i}=ue(a),r=fe("monitor"),c=[{key:"monitor",label:"Monitor Directory"},{key:"exclude",label:"Exclude Directory"},{key:"ignore",label:"Ignore File"}],u=fe(""),{keys:d,table:m,columns:p}=We([{title:t("Site.DelSite.index_2"),key:"path",width:200},Xe({width:100,options:e=>[{label:t("Public.Btn.Del"),onClick:async()=>{if("ignore"===r.value)return await ft({md5:e.md5}),void h();Ve({title:"ignore"===r.value?t("Public.Btn.Cancel"):t("Public.Btn.Del"),content:"Are you sure you want to delete this path? [".concat(e.path,"]"),onConfirm:async()=>{const t="monitor"===r.value;await gt({[t?"delete_monitor_path":"delete_exclude_path"]:e.path}),await a.getConfig(),m.data=t?n.value:i.value}})}}]})]),v=we(()=>{const e=p.value;if("ignore"===r.value){const[a,...l]=e;return[a,{title:"MD5",key:"md5"},{title:t("Config.Safe.index_152"),key:"time",width:150},...l]}return e}),x=async e=>{const a=e?"Whether to enable automatic isolation (not recommended), this feature will have a probability of isolating normal files.":"Whether dynamic detection is turned off, this feature will make it possible to isolate normal files.";Ve({title:t("Home.Security.index_25"),content:a,onConfirm:async()=>{await gt({quarantine:e,dynamic_detection:s.value}),l.value=e}})},_=async()=>{const e="monitor"===r.value;await gt({[e?"add_monitor_path":"add_exclude_path"]:u.value}),await a.getConfig(),u.value="",m.data=e?n.value:i.value},y=async e=>{r.value=e,"monitor"===e?m.data=n.value:"exclude"===e?m.data=i.value:await h()},{loading:f,setLoading:g}=Ke(),h=async()=>{try{g(!0);const{message:e}=await ht();o(e)&&(m.data=e.map(e=>({path:e.filepath,md5:e.md5_to_add,time:e.timestamp})))}finally{g(!1)}};return(async()=>{m.data=n.value})(),(e,t)=>{const a=Wt,s=J,n=Qt,i=E,o=et,p=Jt,g=lt;return se(),le("div",rs,[pe("div",cs,[xe(a,{value:oe(r),"onUpdate:value":[t[0]||(t[0]=e=>He(r)?r.value=e:null),y],options:c},null,8,["value"]),pe("div",us,[pe("span",ds,ve(e.$t("Home.Security.index_25")),1),xe(s,{value:oe(l),size:"small","onUpdate:value":x},null,8,["value"])])]),xe(p,null,Me({table:ye(()=>[xe(o,{keys:oe(d),"onUpdate:keys":t[2]||(t[2]=e=>He(d)?d.value=e:null),"row-key":"path",data:oe(m).data,columns:oe(v),"max-height":300,loading:oe(f)},null,8,["keys","data","columns","loading"])]),_:2},["ignore"!==oe(r)?{name:"toolsLeft",fn:ye(()=>[xe(n,{class:"w-[350px]",value:oe(u),"onUpdate:value":t[1]||(t[1]=e=>He(u)?u.value=e:null),placeholder:e.$t("Site.Placeholder.Index_5")},null,8,["value","placeholder"]),xe(i,{type:"primary",onClick:_},{default:ye(()=>[_e(ve(e.$t("Public.Btn.Add")),1)]),_:1})]),key:"0"}:void 0]),1024),xe(g,{class:"mt-16px"},{default:ye(()=>["ignore"!==oe(r)?(se(),le("li",ms,"Avoid adding full disk path monitoring, such as /")):de("",!0),"ignore"===oe(r)?(se(),le("li",ps,"Ignore items will be matched based on the md5 value of the file, and identical files will be ignored")):de("",!0)]),_:1})])}}}),xs={class:"flex items-center"},_s={class:"flex items-center"},ys={class:"mr-[.8rem]"},fs=ae({__name:"file-switch",setup(e){const{t:t}=he(),a=ts(),{dynamicKill:l,autoIntercept:s,ossConfig:n}=ue(a),i=st(t("Config.Alarm.index_21")),o=async e=>{const a=t(e?"Home.Security.index_28":"Home.Security.index_29"),n=t(e?"Home.Security.index_30":"Home.Security.index_31");Ve({title:a,content:n,onConfirm:async()=>{await gt({quarantine:s.value,dynamic_detection:e}),l.value=e}})};return(async()=>{await a.getConfig()})(),(e,t)=>{const a=J,s=E,n=Ue;return se(),le("div",xs,[de("",!0),de("",!0),xe(s,{size:"small",onClick:t[0]||(t[0]=e=>oe(i).show=!0)},{default:ye(()=>t[3]||(t[3]=[_e("Advanced Settings",-1)])),_:1,__:[3]}),t[4]||(t[4]=pe("span",{class:"text-[#999] mx-[1.2rem]"},"|",-1)),pe("div",_s,[pe("span",ys,ve(e.$t("Home.Security.index_26")),1),xe(a,{value:oe(l),size:"small","onUpdate:value":o},null,8,["value"])]),xe(n,{show:oe(i).show,"onUpdate:show":t[1]||(t[1]=e=>oe(i).show=e),title:oe(i).title,data:oe(i).data,width:800,"min-height":500,footer:!1,component:vs},null,8,["show","title","data"])])}}}),gs={class:"p-16px"},hs=ae({__name:"file-ignore-result",props:{data:{}},setup(e){const{t:t}=he(),a=e,{table:l,columns:s}=We([{key:"filepath",title:t("Site.TableRow.index_2"),width:"70%"},{key:"success",title:t("Public.Table.Status"),render:e=>xe("span",{class:e.success?"text-primary":"text-error"},[_e(" "),e.success?t("Site.PHP.index_35"):t("Mail.Mass.index_7"),_e(" ")])}]);return Ie(()=>{l.data=a.data.message}),(e,t)=>{const a=et;return se(),le("div",gs,[xe(a,{data:oe(l).data,columns:oe(s),"max-height":200},null,8,["data","columns"])])}}}),ws=ae({__name:"file-list",setup(t){const a=be(()=>c(()=>import("./file-detail.js?v=1767769852656"),__vite__mapDeps([17,6,2,3,7,4,5,9,8,1,10]))),{t:l}=he(),s=ts(),n=e(),r=Wl(),{risk_details:u}=ue(r),{riskLevelsOverview:m,lastScanTime:p}=ue(s),v=st(),x=je({p:1,limit:30,day:""}),_=[{label:l("Home.Security.index_12"),value:""},{label:l("Home.Security.index_13"),value:1},{label:l("Home.Security.index_14"),value:7},{label:l("Home.Security.index_15"),value:30}],{keys:y,table:f,columns:g}=We([{type:"selection"},{title:l("Component.SelectPath.index_3"),key:"filename",ellipsis:{tooltip:{width:"trigger"}}},{title:l("Home.Security.index_1"),key:"threat_type",width:86,render:e=>xe(U,{type:"info"},{default:()=>[e.threat_type]})},{title:"MD5",key:"md5",ellipsis:{tooltip:{width:"trigger"}}},{title:l("Account.Logs.logsState-131428-1"),key:"risk_level_desc",width:80,render:e=>{var t;let a=null==(t=m.value.find(t=>t.id===e.risk_level))?void 0:t.style;return xe("span",{style:a},[_e(" "),e.risk_level_desc,_e(" ")])}},{title:l("Home.Security.index_16"),key:"time",width:140},Xe({width:160,options:e=>[{label:l("Ftp.Table.index_8"),onClick:()=>{Ve({title:"Ignore malicious file",content:"Are you sure you want to ignore this malicious file? [".concat(e.filename,"]"),onConfirm:async()=>{const{filepath:t,md5:a}=e,{message:s}=await wt({files:JSON.stringify([{filepath:t,md5:a}])});o(s)&&(s[0].success?d.success(l("Home.Security.index_20")):d.error(s[0].message)),b()}})}},{label:l("Home.Security.index_17"),onClick:()=>{n.isFree?Ze({source:399}):Ve({title:l("Home.Security.index_18"),content:l("Home.Security.index_19"),onConfirm:async()=>{await bt({file_list:JSON.stringify([{filepath:e.filepath,md5:e.md5}]),action_type:"delete"},!1),d.success(l("Home.Security.index_20")),b()}})}},{label:l("Security.Anti.Index_21"),onClick:()=>{v.data=e,v.title="[".concat(e.filename,"] ").concat(l("Home.Security.index_21")),v.show=!0}}]})]),h=[{key:"delete",type:"confirm",label:l("Home.Security.index_17"),confirm:{title:l("Crontab.Planned.index_16",[l("Home.Security.index_22")]),desc:l("Crontab.Planned.index_17",[l("Home.Security.index_22")]),columns:[g.value[1]],api:e=>bt({file_list:JSON.stringify([{filepath:e.filepath,md5:e.md5}]),action_type:"delete"},!1),done:async()=>{await b(),y.value=[]}}},{key:"ignore",label:l("Ftp.Table.index_8"),onBatch:e=>{Ve({title:l("Ftp.Table.index_8"),content:"Are you sure you want to ignore these malicious files?",onConfirm:async()=>{const{message:t}=await wt({files:JSON.stringify(e.map(e=>({filepath:e.filepath,md5:e.md5})))});o(t)&&Ge({title:l("Public.Table.Result"),width:480,data:{message:t},component:hs}),y.value=[],b()}})}}],w=e=>{x.day=e,f.data=[],b()},b=async()=>{try{f.loading=!0;const{message:e}=await kt({day:x.day?x.day:null,p:x.p,limit:x.limit});if(i(e)){f.data=e.detected.map((e,t)=>({...e,keyid:t})),u.value[1].value=e.total_detected,p.value=e.last_scan_time;const{total_scanned_files:t,risk_stats:a}=e;m.value[0].value=t,m.value[1].value=a[2],m.value[2].value=a[1],m.value[3].value=a[0],f.total=e.total_detected}}finally{f.loading=!1}};return b(),(e,t)=>{const l=G,s=et,n=Vt,i=Gt,o=Jt,r=lt,c=Ue;return se(),le("div",null,[xe(o,null,{toolsLeft:ye(()=>[xe(l,{value:oe(x).day,"onUpdate:value":[t[0]||(t[0]=e=>oe(x).day=e),w],options:_,class:"mr-[1rem] !w-[12rem]"},null,8,["value"])]),toolsRight:ye(()=>[xe(fs)]),table:ye(()=>[xe(s,{"loading-num":3,"checked-row-keys":oe(y),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>He(y)?y.value=e:null),"row-key":"keyid",loading:oe(f).loading,data:oe(f).data,columns:oe(g),"max-height":"220px"},null,8,["checked-row-keys","loading","data","columns"])]),pageLeft:ye(()=>[xe(n,{"checked-row-keys":oe(y),"onUpdate:checkedRowKeys":t[2]||(t[2]=e=>He(y)?y.value=e:null),"row-key":"keyid",data:oe(f).data,options:h},null,8,["checked-row-keys","data"])]),pageRight:ye(()=>[xe(i,{"show-size-picker":!1,"show-quick-jumper":!1,page:oe(x).p,"onUpdate:page":t[3]||(t[3]=e=>oe(x).p=e),"page-size":oe(x).limit,"onUpdate:pageSize":t[4]||(t[4]=e=>oe(x).limit=e),"item-count":oe(f).total,onRefresh:b},null,8,["page","page-size","item-count"])]),_:1}),xe(r,{class:"mt-16px"},{default:ye(()=>[pe("li",null,ve(e.$t("Home.Security.index_10")),1),de("",!0)]),_:1}),xe(c,{show:oe(v).show,"onUpdate:show":t[5]||(t[5]=e=>oe(v).show=e),title:oe(v).title,data:oe(v).data,width:500,"min-height":400,footer:!1,component:oe(a)},null,8,["show","title","data","component"])])}}}),bs={class:"text-20px"},ks=ae({__name:"index",setup:e=>(e,t)=>(se(),le(me,null,[pe("div",bs,ve(e.$t("Home.Security.index_32")),1),xe(os),xe(ws)],64))}),Ss={class:"text-20px"},Cs={class:"w-250px"},Hs=ae({__name:"index",setup(e){const{t:t}=he(),a=fe(null),l=je({status:!0,type:[],method:[]}),s={type:{trigger:"change",type:"array",required:!0,message:t("Home.Security.index_36")},method:{trigger:"change",type:"array",required:!0,message:t("Config.Safe.index_7")}},n=()=>({status:l.status,safe_type:l.type.join(","),sender:l.method.join(",")}),o=async()=>{var e;await(null==(e=a.value)?void 0:e.validate()),await St(n()),n()},{loading:r,setLoading:c}=Ke();return(async()=>{try{c(!0);const{message:e}=await yt();if(i(e)){const t=e.data;l.status=t.alertable.status,l.method=t.alertable.sender,l.type=t.alertable.safe_type}}finally{c(!1)}})(),(e,t)=>{const n=J,i=V,c=W,u=Q,d=Yt,m=E,p=Xt,v=w;return se(),ge(v,{show:oe(r)},{default:ye(()=>[pe("div",Ss,ve(e.$t("Home.Security.index_33")),1),xe(p,{class:"p-16px",ref_key:"formRef",ref:a,model:oe(l),rules:s},{default:ye(()=>[xe(i,{label:e.$t("Home.Security.index_34")},{default:ye(()=>[xe(n,{value:oe(l).status,"onUpdate:value":t[0]||(t[0]=e=>oe(l).status=e)},null,8,["value"])]),_:1},8,["label"]),xe(i,{label:e.$t("Docker.App.Backup.index_5"),path:"type"},{default:ye(()=>[xe(u,{value:oe(l).type,"onUpdate:value":t[1]||(t[1]=e=>oe(l).type=e)},{default:ye(()=>[xe(c,{value:"webshell",label:e.$t("Home.Security.index_35")},null,8,["label"])]),_:1},8,["value"])]),_:1},8,["label"]),xe(i,{label:e.$t("Config.Safe.index_6"),path:"method"},{default:ye(()=>[pe("div",Cs,[xe(d,{value:oe(l).method,"onUpdate:value":t[2]||(t[2]=e=>oe(l).method=e)},null,8,["value"])])]),_:1},8,["label"]),xe(i,{label:" "},{default:ye(()=>[xe(m,{type:"primary",onClick:o},{default:ye(()=>[_e(ve(e.$t("Public.Btn.Save")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])}}}),Ms=e(),Ts=Te("home-security-loophole",()=>({scanRes:fe([]),scanResShow:fe(!1),scanContentShow:fe(!0),onVulScanSwitch:()=>{Ms.isFree?Ze({source:399}):Ge({title:"Setting up automatic scanning",width:"550px",height:"200px",footer:!0,component:be(()=>c(()=>import("./risk-info-form.js?v=1767769852656"),__vite__mapDeps([18,19,2,3,7,4,20,6,5,9,8,21,22,1,10,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])))})}})),Is={class:"p-16px"},js={class:"mb-[2rem]"},Ds={class:"flex flex-nowrap items-center justify-between"},Ls={key:0,class:"relative"},zs={key:0,class:"loading-icon"},Ns={class:"pr-[2rem]"},$s=["innerHTML"],Ps={class:"text-[1.6rem] mt-[1.2rem]"},Bs={class:"relative"},As={class:"text-[1.5rem]"},Rs=p(ae({__name:"loophole-scan",setup(t){const{t:l}=he(),s=Ts(),n=Wl(),o=e(),{scanResShow:r,scanContentShow:c,scanRes:u}=ue(s),d=fe("success"),m=fe(!1),p=fe({scanTitle:l("Home.Security.index_39"),scanTime:l("Home.Security.index_40"),scanCheckButton:l("Home.Security.index_41")}),v=async()=>{if(o.isFree)Ze({source:399});else{d.value="loading",p.value.scanTitle=l("Home.Security.index_42")+"...";try{m.value=!0;const{message:e}=await Ct();i(e)&&(p.value.scanTitle=l("Home.Security.index_43"),p.value.scanTime="".concat(l("Logs.Panel.index_13"),"：").concat(k(e.time)),p.value.scanCheckButton=l("Home.Security.index_41"),c.value=!1,e.info.length?(r.value=!1,u.value=e.info,d.value="danger",p.value.scanCheckButton=l("Home.Security.index_41"),p.value.scanTitle="".concat(l("Security.Anti.Index_7")," [<span class='text-primary px-2px'>").concat(e.site_num,"</span>] ").concat(l("Home.Security.index_45")," <span class='text-error'>").concat(e.loophole_num,"</span>")):(r.value=!0,p.value.scanTitle=l("Home.Security.index_44")),n.risk_details[0].value=e.loophole_num)}catch(e){console.log(e),d.value="success"}finally{m.value=!1}}};return(async()=>{const{message:e}=await Ht();if(i(e)){const{loophole_num:t,site_num:a,time:s}=e.data;t>0?(p.value.scanTitle="<span class='text-error'>".concat(t,"</span> ").concat(l("Home.Security.index_46")," <span class='text-primary'>").concat(a,"</span>"),p.value.scanTime="".concat(l("Home.Security.index_9"),":").concat(s),d.value="danger",p.value.scanCheckButton=l("Home.Security.index_41")):(p.value.scanTitle="".concat(l("Home.Security.index_47")," ").concat(a),p.value.scanTime="".concat(l("Home.Security.index_9"),":").concat(s),p.value.scanCheckButton=l("Home.Security.index_41"),d.value="success")}})(),(e,t)=>{const l=a,n=A,i=E,o=b;return se(),le("div",Is,[pe("div",js,[pe("div",Ds,[xe(n,{class:"flex-nowrap!"},{default:ye(()=>["loading"==oe(d)?(se(),le("div",Ls,[oe(m)?(se(),le("div",zs)):de("",!0),xe(l,{name:"home-scanning-scan",size:80,color:"#20a53a"})])):de("",!0),pe("div",null,["success"==oe(d)?(se(),ge(l,{key:0,name:"home-scanning-success",size:80,color:"#20a53a"})):de("",!0),"danger"==oe(d)?(se(),ge(l,{key:1,name:"home-scanning-danger",size:80,color:"#ef0808"})):de("",!0)]),pe("div",Ns,[pe("div",{class:"text-[2rem] font-bold",innerHTML:oe(p).scanTitle},null,8,$s),pe("div",Ps,ve(oe(p).scanTime),1)])]),_:1}),pe("div",Bs,[xe(i,{type:"primary",text:"",class:"absolute top-[5rem] right-1rem",onClick:oe(s).onVulScanSwitch},{default:ye(()=>[_e(ve(e.$t("Home.Security.index_38"))+">> ",1)]),_:1},8,["onClick"]),xe(i,{class:"h-[4rem] w-[10rem]",type:"loading"==oe(d)?"default":"primary",size:"large",onClick:v},{default:ye(()=>[pe("span",As,ve(oe(p).scanCheckButton),1)]),_:1},8,["type"])])])]),xe(o)])}}}),[["__scopeId","data-v-a91fb030"]]),Es={class:"px-16px"},Os={key:0,class:"info"},Fs={class:"webedit-con flex items-center justify-center"},Us={class:"thumbnail-introduce mt-[0rem]"},Zs={class:"text-[1.8rem] font-bold"},Js={key:1,class:"scan"},Gs={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[38rem] border-[#e8e8e8] flex items-center justify-center"},Vs={class:"flex flex-column items-center"},Qs={class:"absolute mt-[10.5rem] text-[2rem] leading-[0.14rem]"},Ws={key:1},Xs={class:"flex items-center mb-[2rem] text-[#333]"},Ys={class:"w-[26rem]"},Ks={class:"overflow-auto h-[34rem] scrollable"},qs={class:"w-[25rem] flex-shrink-0"},en={class:"ml-[1.2rem]"},tn={class:"whitespace-nowrap"},an={class:"text-font2 text-[1.2rem] w-auto"},ln={class:"flex items-center justify-between w-full"},sn={class:"flex items-center ml-[1.2rem]"},nn={class:"text-[#999] ml-[1.2rem]"},on={class:"bg-[#f6f6f6] text-[#999] p-[2rem] ml-[1.2rem]"},rn={class:"flex items-center"},cn=p(ae({__name:"loophole-view",setup(e){const a=Ts(),{scanResShow:l,scanContentShow:s,scanRes:n}=ue(a),i=fe(["1"]),o={4:["error","Critical"],3:["warning","High"],2:["info","Medium"],1:["success","Low"]},r=e=>o[e]||["default","Unknown"];return(e,a)=>{const o=X,c=lt,u=U,d=A,m=t,p=f,v=x;return se(),le("div",Es,[oe(s)?(se(),le("div",Os,[pe("div",Fs,[xe(o,{class:"max-w-[90rem] mr-[4rem] w-[36rem]",width:"100%",src:oe(Mt)},null,8,["src"]),pe("div",Us,[pe("span",Zs,ve(e.$t("Home.Security.index_49"))+"：",1),xe(c,null,{default:ye(()=>[pe("li",null,[_e(ve(e.$t("Home.Security.index_50"))+": ",1),a[1]||(a[1]=pe("br",null,null,-1)),a[2]||(a[2]=_e(" XunRui CMS、pbootcms、Apple CMS、eyoucms、Ocean CMS、 ",-1)),a[3]||(a[3]=pe("br",null,null,-1)),a[4]||(a[4]=_e(" ThinkCMF、zfaka、dedecms、MetInfo、emlog、 ",-1)),a[5]||(a[5]=pe("br",null,null,-1)),a[6]||(a[6]=_e("Empire CMS、discuz、Thinkphp、Wordpress、Z-Blog、 ",-1)),a[7]||(a[7]=pe("br",null,null,-1)),a[8]||(a[8]=_e("Ultimate CMS、ShopXO、HYBBS、ECShop、SchoolCMS、 ",-1)),a[9]||(a[9]=pe("br",null,null,-1)),a[10]||(a[10]=_e("phpcms、likeshop、iCMS、WellCMS、chanzhiEPS、 ",-1)),a[11]||(a[11]=pe("br",null,null,-1)),a[12]||(a[12]=_e("PHPOK、LaySNS、Knight CMS、openSNS、QiBo CMS、 ",-1)),a[13]||(a[13]=pe("br",null,null,-1)),a[14]||(a[14]=_e("ZZZCMS、prestashop、ThinkphpSHOP、DouPHP、 ",-1)),a[15]||(a[15]=pe("br",null,null,-1)),a[16]||(a[16]=_e("cmseasy、piwigo、phpwind、XingYunHai CMS ",-1))]),pe("li",null,ve(e.$t("Home.Security.index_51")),1),pe("li",null,ve(e.$t("Home.Security.index_52")),1)]),_:1})])])])):(se(),le("div",Js,[oe(l)?(se(),le("div",Gs,[pe("div",Vs,[xe(o,{class:"w-[34.0rem] h-[30.1rem]",width:"100%",src:oe(Tt),"preview-disabled":""},null,8,["src"]),pe("span",Qs,ve(e.$t("Home.Security.index_53")),1)])])):(se(),le("div",Ws,[pe("div",Xs,[pe("span",Ys,ve(e.$t("Layout.Sider.site_1")),1),pe("span",null,ve(e.$t("Mail.MailBox.index_4")),1)]),pe("div",Ks,[xe(v,{modelValue:oe(i),"onUpdate:modelValue":a[0]||(a[0]=e=>He(i)?i.value=e:null),accordion:"","arrow-placement":"right"},{default:ye(()=>[(se(!0),le(me,null,ke(oe(n),(t,a)=>(se(),ge(p,{key:a},{header:ye(()=>[xe(d,{class:"items-center flex-nowrap! w-full"},{default:ye(()=>[pe("div",qs,[xe(u,{size:"small",color:t.cms.length>0?{color:"#f2711c",borderColor:"#f2711c",textColor:"white"}:{color:"#67c23a",borderColor:"#67c23a",textColor:"white"}},{default:ye(()=>[_e(ve(t.cms.length)+" items ",1)]),_:2},1032,["color"]),pe("span",en,ve(t.name),1)]),pe("span",tn,ve(t.cms_name+"--"+t.version_info),1),pe("div",an,ve(e.$t("Home.Security.index_54")),1)]),_:2},1024)]),default:ye(()=>[xe(v,{accordion:"","arrow-placement":"right"},{default:ye(()=>[(se(!0),le(me,null,ke(t.cms,(t,a)=>(se(),ge(p,{key:a},{header:ye(()=>[pe("div",ln,[pe("div",sn,[xe(u,{type:r(t.dangerous)[0],size:"small"},{default:ye(()=>[_e(ve(r(t.dangerous)[1]),1)]),_:2},1032,["type"]),pe("span",nn,ve(t.ps),1)]),xe(m,{class:"mb-[.2rem] mr-[1.6rem]"},{default:ye(()=>[_e(ve(e.$t("Public.Btn.Details")),1)]),_:1})])]),default:ye(()=>[pe("div",on,ve(e.$t("Home.Security.index_55"))+": "+ve(t.repair),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])])]))])),pe("div",null,[pe("div",rn,[_e(ve(e.$t("Home.Security.index_56"))+"： ",1),xe(m,{target:"_blank",href:"https://www.aapanel.com/forum/t/support"},{default:ye(()=>a[17]||(a[17]=[_e(" https://www.aapanel.com/forum/t/support ",-1)])),_:1,__:[17]})])])])}}}),[["__scopeId","data-v-0e08d546"]]),un={class:"text-20px"},dn=ae({__name:"index",setup:e=>(e,t)=>(se(),le(me,null,[pe("div",un,ve(e.$t("Home.Security.index_37")),1),xe(Rs),xe(cn)],64))}),mn={class:"risk-chart"},pn={class:"circle-box"},vn={class:"circle-box-inner"},xn={class:"circle-box-value"},_n={class:"circle-box-desc"},yn={class:"flex-1 m-[1rem]"},fn={key:0,class:"mb-[1rem]"},gn={class:"text-error"},hn={class:"mb-[1rem]"},wn={class:"mt-[1rem]"},bn={class:"flex h-[3.2rem]"},kn={class:"text-[30px] mr-[2rem]"},Sn={class:"bg-[#ef0808] px-2"},Cn={class:"bg-[#f0ad4e] px-2"},Hn={class:"bg-[#a1a1a1] px-2"},Mn=p(ae({__name:"risk-score",setup(e){const{t:t}=he(),a=Wl(),{scoreData:l}=ue(a),s=[{color:"#ef0808",percentage:60,type:"danger"},{color:"#f0ad4e",percentage:80,type:"warn"},{color:"#e8d544",percentage:90,type:"alert"},{color:"#20a53a",percentage:100,type:"safe"}],n=we(()=>s.find(e=>l.value.score<=e.percentage)),o=je({total:0,high_risk:0,medium_risk:0,low_risk:0}),r=(e=[])=>[{type:"category",show:!1,boundaryGap:!1,data:e}],c=(e=[])=>[{name:t("Home.Security.index_71"),type:"line",data:e,itemStyle:{color:"#ec958d"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"#fcdcd5"},{offset:1,color:"#fcdcd5"}]}}}],u=De({tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{width:1,type:"solid"}}},grid:{top:"30%",left:"0",right:"0",bottom:"0%",containLabel:!1},yAxis:{show:!1},xAxis:r(),series:c()});return(async()=>{const{message:e}=await It();if(i(e)){o.total=e.total,o.high_risk=e.high_risk,o.medium_risk=e.medium_risk,o.low_risk=e.low_risk;const t=e.trend_list.map(e=>k(e.timestamp)),a=e.trend_list.map(e=>e.count);u.xAxis=r(t),u.series=c(a)}})(),(e,t)=>{var a;const s=A;return se(),le("div",null,[pe("div",{class:Le(["flex items-center mt-[2rem]","circle-".concat(null==(a=oe(n))?void 0:a.type)])},[pe("div",mn,[pe("div",pn,[t[1]||(t[1]=pe("div",{class:"circle-box-bg"},null,-1)),pe("div",vn,[pe("div",xn,[_e(ve(oe(l).score)+" ",1),t[0]||(t[0]=pe("div",{class:"unit"},null,-1))]),pe("div",_n,ve(oe(l).scoreLevel),1)])])]),pe("div",yn,[oe(l).riskNum>0?(se(),le("div",fn,[pe("span",gn,ve(oe(l).riskNum),1),_e(" "+ve(e.$t("Home.Security.index_68")),1)])):de("",!0),pe("template",null,[pe("div",hn,ve(e.$t("Home.Security.index_69")),1)]),pe("p",null,ve(oe(l).subtitle),1)])],2),pe("div",wn,[pe("div",null,ve(e.$t("Home.Security.index_70")),1),pe("div",bn,[pe("span",kn,ve(oe(o).total),1),xe(s,{class:"items-end color-white"},{default:ye(()=>[pe("span",Sn,ve(oe(o).high_risk),1),pe("span",Cn,ve(oe(o).medium_risk),1),pe("span",Hn,ve(oe(o).low_risk),1)]),_:1})]),xe(Kt,{height:60,option:oe(u)},null,8,["option"])])])}}}),[["__scopeId","data-v-56656608"]]),Tn={class:"flex items-center justify-between flex-nowrap text-[11px]"},In={class:"text-[30px] mx-[0.4rem] text-primary"},jn={class:"leading-[2rem]"},Dn={class:"flex items-center"},Ln={class:"flex ml-[0.6rem]"},zn=["title"],Nn={class:"flex flex-wrap mt-15 justify-center!"},$n=["onClick"],Pn=ae({__name:"risk-info",setup(t){const{t:l}=he(),s=Wl(),{safe:n,capabilitySwitch:i,risk_details:o,menu:r}=ue(s),c=e(),u=Ts(),d=async e=>{const t=l(e?"Home.Security.index_64":"Home.Security.index_65"),a=l(e?"Home.Security.index_66":"Home.Security.index_67");await Ve({title:t,content:a,onConfirm:async()=>{await jt({dynamic_detection:e}),i.value.file_detection.status=e}})};return(e,t)=>{const l=a,s=b,m=J,p=A,v=O;return se(),le("div",null,[pe("div",Tn,[pe("div",null,[_e(ve(e.$t("Security.Anti.Index_35")),1),pe("strong",In,ve(oe(n).day),1),_e(ve(e.$t("Crontab.arrange.index_41")),1)]),pe("div",jn,[pe("div",Dn,[t[0]||(t[0]=pe("span",null,"Protection",-1)),pe("ul",Ln,[(se(!0),le(me,null,ke(oe(i),(e,t)=>(se(),le("li",{class:"mr-[0.1rem]",key:t,title:e.name},[xe(l,{name:e.icon+(e.status?"-active":""),size:14},null,8,["name"])],8,zn))),128))])]),pe("div",null,"Last Scan："+ve(oe(n).time),1),pe("div",null,"Last Virus DB Update："+ve(oe(n).virus),1)])]),xe(s,{class:"!mb-[1.8rem] !mt-0"}),xe(p,{class:"text-[14px] text-bold"},{default:ye(()=>[xe(p,{size:4,class:"items-center! mr-[1rem]"},{default:ye(()=>[t[1]||(t[1]=pe("span",null,"Malware Scan",-1)),xe(m,{size:"small",value:oe(i).file_detection.status,onUpdateValue:d},null,8,["value"])]),_:1,__:[1]}),xe(p,{size:4,class:"items-center!"},{default:ye(()=>[pe("span",null,ve(e.$t("Home.Security.index_63")),1),xe(m,{size:"small",value:oe(i).vul_scan.status,"onUpdate:value":oe(u).onVulScanSwitch},null,8,["value","onUpdate:value"])]),_:1})]),_:1}),xe(s,{class:"my-[1rem]!"}),pe("div",Nn,[(se(!0),le(me,null,ke(oe(o),(e,a)=>(se(),le("div",{key:a,class:"flex flex-col items-center w-[12rem] mb-[1rem] w-1/3"},[pe("div",null,[pe("span",null,ve(e.title),1),xe(v,{trigger:"hover"},{trigger:ye(()=>t[2]||(t[2]=[pe("span",{class:"ml-4px bt-ico-ask"},"?",-1)])),default:ye(()=>[pe("span",null,ve(e.tips),1)]),_:2},1024)]),pe("div",{class:Le(["text-[22px] cursor-pointer",e.value>0?"text-[#ef0808]":"text-[#20a53a]"]),onClick:t=>(async e=>{if("tamper"===e){if(c.isFree)return void Ze({source:399});await tt("tamper_core"),await xt({name:"tamper_core",title:"Tamper-proof for Enterprise\t",admin:!0})}else r.value=e})(e.type)},ve(e.value),11,$n)]))),128)),t[3]||(t[3]=pe("div",{class:"w-1/3"},null,-1))])])}}}),Bn=ae({__name:"security-trend",setup(e){const{loading:t,setLoading:a}=Ke(),l=fe(!0),s=fe(null);let n=null;const o=ze("--chart-tooltip-bg-color");return Ne(()=>{(async()=>{if(s.value){n=qt(s.value);try{a(!0);const{message:e}=await Dt();if(i(e)){l.value=e.trend_list.length>0;const t=e.trend_list.map(e=>k(e.timestamp,"MM-dd")),a=e.trend_list.map(e=>e.handled_risks),s=e.trend_list.map(e=>e.unhandled_risks),i=e.trend_list.map(e=>e.risk_scan),r=e.trend_list.map(e=>e.vul_scan),c=e.trend_list.map(e=>e.server_risks),u={tooltip:{trigger:"axis",backgroundColor:o.value,borderColor:"transparent",textStyle:{color:"#c7c7c7"},axisPointer:{type:"shadow",label:{show:!0}}},grid:{top:"10%",right:"5%",bottom:"15%",left:"5%",containLabel:!0},legend:{bottom:0,itemWidth:12,itemHeight:10,itemGap:10,textStyle:{fontSize:10,color:"#666666"},data:["Unaddressed","Processed","Home","Bug","Baseline"]},xAxis:{type:"category",data:t},yAxis:{type:"value",min:0},series:[{name:"Unaddressed",type:"line",smooth:!0,showSymbol:!1,sampling:"average",data:s},{name:"Processed",type:"line",smooth:!0,showSymbol:!1,sampling:"#20a53a",data:a},{name:"Home",type:"bar",barWidth:"8px",itemStyle:{normal:{color:"rgb(29, 159, 234, 1)"}},data:i},{name:"Bug",type:"bar",barWidth:"8px",itemStyle:{normal:{color:"rgb(30,67,180,1)"}},data:r},{name:"Baseline",type:"bar",barWidth:"8px",itemStyle:{normal:{color:"rgb(70,44,104,1)"}},data:c}]};n.setOption(u)}}finally{a(!1)}}})()}),$e(()=>{null==n||n.dispose()}),(e,a)=>{const n=Y,i=w;return se(),ge(i,{show:oe(t)},{default:ye(()=>[pe("span",null,ve(e.$t("Home.Security.index_79")),1),oe(l)?(se(),le("div",{key:0,ref_key:"chartContainer",ref:s,style:{height:"230px"}},null,512)):(se(),ge(n,{key:1,description:"No data available"}))]),_:1},8,["show"])}}}),An={class:"security-risk-news"},Rn=ae({__name:"security-news",setup(e){const t=be(()=>c(()=>import("./security-news-detail.js?v=1767769852656"),__vite__mapDeps([45,6,2,3,7,4,5,9,8,1,10,23,24,25,26,27,28,29,30,31,32,19,33,22,34,35,36,37,38,39,40,41,42,43,20,21,44]))),{t:a}=he(),l=st(),{table:s,columns:n}=We([{key:"description",title:a("Home.Security.index_72"),ellipsis:{tooltip:{width:"trigger"}}},{key:"title",title:a("Home.Security.index_73"),align:"center",width:80,render:e=>{const{text:t,style:a}=es(e.level);return xe("span",{style:a},[_e("["),t,_e("]")])}},{key:"title",title:"Time",width:60,render:e=>k(e.time,"MM-dd")},Xe({width:80,options:e=>[{label:a("Security.Anti.Index_21"),onClick:()=>{l.title="[".concat(e.file_path,"] ").concat(a("Security.Anti.Index_21")),l.data.row=e,l.show=!0}}]})]),{loading:o,setLoading:r}=Ke();return(async()=>{try{r(!0);const{message:e}=await Lt();i(e)&&(s.data=e.events)}finally{r(!1)}})(),(e,a)=>{const i=et,r=q,c=K,u=Ue;return se(),le("div",An,[xe(c,{"default-value":"security"},{default:ye(()=>[xe(r,{name:"security",tab:"Security News"},{default:ye(()=>[xe(i,{loading:oe(o),data:oe(s).data,columns:oe(n),"loading-num":4,"max-height":"160"},null,8,["loading","data","columns"])]),_:1})]),_:1}),xe(u,{show:oe(l).show,"onUpdate:show":a[0]||(a[0]=e=>oe(l).show=e),title:oe(l).title,data:oe(l).data,width:500,footer:!1,"min-height":380,component:oe(t)},null,8,["show","title","data","component"])])}}}),En={class:"text-20px"},On={class:"flex"},Fn={class:"flex"},Un=ae({__name:"index",setup:e=>(Wl().getSafeOverviewData(),(e,t)=>{const a=b;return se(),le(me,null,[pe("div",En,ve(e.$t("Home.Security.index_57")),1),pe("div",On,[xe(Mn,{class:"w-50%"}),xe(Pn,{class:"w-50%"})]),xe(a,{class:"my-6!"}),pe("div",Fn,[xe(Bn,{class:"w-50%"}),xe(Rn,{class:"w-50%"})])],64)})}),Zn=Wl(),Jn=e(),{risk_details:Gn}=ue(Zn),Vn=Te("HOME-SECURITY-RISKS-STORE",()=>{const e=fe(""),t=fe(""),a=fe("Scanning, please wait patiently..."),l=fe(!1),s=fe(!1),n=fe(""),o=fe(!1),r=fe(!1),c=fe(!0),u=fe(!1),m=fe(),p=fe(!0),v=fe(!1),x=fe("primary"),_=fe(100),y=fe("!text-[#20a53A]"),f=fe("safe"),g=fe(),h=fe("The current server has not been scanned for security and may be at risk"),w=fe(""),b=fe([]),k=fe(),S=fe([]),C=fe(!0),H=fe([]),M=fe([]),T=fe(!0),I=fe(!1),j=fe(!1),D=je({progress:1,repairProgress:!1,repairText:"Repairing.."}),L=je({processPercentage:0,processColor:"#20a53a"}),z={risk:{type:"danger",label:"Risk Items",list:[]},security:{type:"primary",label:"Risk-free item",list:[]},ignore:{type:"warning",label:"Ignored items",list:[]}},N=je({cannot_automatically:0,failed:0,success:0}),$=fe(0),{table:P,columns:B}=We([{title:"Risk Items",key:"m_name",width:150,ellipsis:{tooltip:{width:"trigger"}}},{title:"Fixes",key:"msg",ellipsis:{tooltip:{width:"trigger"}}},{title:"Information",key:"type",width:100,align:"center",render:e=>Array.isArray(e.type)&&e.type.length>0?xe("span",{class:"h-[3.2rem] inline-block whitespace-pre-wrap"},[_e(" "),e.type.join("，"),_e(" ")]):"None"},{title:"Operation Results",key:"status",width:120,align:"right",render:e=>e.status?xe("span",{class:"text-[#20a53a]"},[_e(" Repair Success ")]):xe("span",{class:"text-[red]"},[_e(" Repair failed ")])}]),A=je({1:{text:"Low",bg:"rgba(232, 213, 68, 0.1)",color:"#D4BB00"},2:{text:"Medium",bg:"rgba(240, 173, 78, 0.14)",color:"#f0ad4e"},3:{text:"High",bg:"rgba(239, 8, 8, 0.1)",color:"#EF0808"}}),R=fe("overview"),E=je({risk:0,malware:0,web:0,baseline:0}),O=()=>{100==_.value?(y.value="!text-[#20a53A]",f.value="safe",L.processColor="#20a53A"):_.value>=80&&_.value<=99?(y.value="!text-[#E8D544]",f.value="risk",L.processColor="#E8D544"):_.value>=60&&_.value<=79?(y.value="!text-[#F0AD4E]",L.processColor="#F0AD4E",f.value="warn"):_.value<60&&(y.value="!text-[#EF0808]",L.processColor="#EF0808",f.value="danger")},F=e=>{S.value=e.is_autofix,localStorage.setItem("isAutoFix",JSON.stringify(S.value));for(const t in z){const a=e[t];if(Array.isArray(a)){for(let e=0;e<a.length;e++){const l=z[t].list.find(t=>t.m_name==a[e].m_name);a[e].show=(null==l?void 0:l.show)||!1,a[e].selection=(null==l?void 0:l.selection)||!1}Object.keys(z).includes(t)&&"risk"==t&&k.value&&a&&(k.value=[...k.value,...a]),z[t].list=a}}n.value=e.check_time,x.value="primary",o.value=!0,v.value=!0,U(),m.value=" !animate-none",localStorage.setItem("scanData",JSON.stringify(k.value)),localStorage.setItem("lastScanTime",JSON.stringify(n.value))},U=()=>{var e;null==(e=k.value)||e.forEach(e=>{S.value.includes(e.m_name)?(e.selection=!0,H.value.push(e)):e.selection=!1}),H.value.length>0?(C.value=!1,s.value=!0):C.value=!0},Z=async(e=!1)=>{var t,s;l.value=!0,a.value="Scanning, please wait...";try{const a={};let l;if(e&&(a.force=1),e){l=(await Et(a)).message}else{l=(await Ot()).message}i(l)&&(l.interrupt||(k.value=[],F(l),_.value=null!=(t=l.score)?t:0,$.value=k.value.length,Gn.value[2].value=$.value,h.value="Security scan completed.",M.value=null!=(s=l.ignore)?s:[]))}catch(n){console.log(n)}l.value=!1},J=async e=>{var t,a;P.data=[],r.value=!0,N.cannot_automatically=e.cannot_automatically.length,N.failed=e.failed.length,N.success=e.success.length,b.value=[];for(const l in e)for(const t of e[l])b.value.push({m_name:t.m_name,type:t.result.type,msg:t.result.msg,status:t.result.status,name:l});P.data=b.value,l.value=!1,k.value=null==(t=k.value)?void 0:t.filter(t=>!e.success.some(e=>e.m_name===t.m_name)),$.value=(null==(a=k.value)?void 0:a.length)||0,Gn.value[2].value=$.value,localStorage.setItem("scanData",JSON.stringify(k.value))};return{showAnimation:u,scanScore:_,scanTextClass:y,scanOuterClass:f,animateFlag:m,scanPreText:h,riskNum:$,scanButtonType:x,repairAutoRiskButton:o,cookieRepair:p,scanItemText:w,processData:L,lastScanTime:n,scanSelectShow:v,allSelect:s,allSelectionDis:C,isIgnoreAll:I,ignoreData:M,emptyDetail:c,loading:l,loadingText:a,isShow:T,activeMent:e,activeMentIgnore:t,is_autofix:S,levelData:A,allData:k,repairData:D,resultConfirm:r,resultItemLength:N,resultTable:P,resultColumn:B,reportPopup:j,onIgnore:async e=>{try{l.value=!0,a.value="Ignoring risk items, please wait patiently...",await Ft({m_name:e.m_name}),Z(!1)}finally{l.value=!1}},onScan:async()=>{if(T.value=!1,c.value=!1,_.value=100,f.value="safe",y.value="!text-[#20a53A]","info"==x.value){clearInterval(g.value),await $t();const{message:e}=await Pt();i(e)&&(F(e),_.value="?",y.value="!text-[#EF0808]",f.value="danger",l.value=!1,$.value=e.risk.length,Gn.value[2].value=$.value,h.value="Scan interruption ")}else{L.processPercentage=0,u.value=!0,h.value="Security scan in progress...",$.value=0,w.value="Testing...",m.value="",x.value="info",p.value=!0,o.value=!1,Z(!0);try{clearInterval(g.value),g.value=setInterval(async function(){const{message:e}=await Bt();i(e)&&(L.processPercentage=e.percentage,$.value=e.count,Gn.value[2].value=$.value,w.value=e.status,_.value=e.score,e.count&&100!=e.percentage&&(y.value="!text-[#EF0808]",f.value="danger",h.value="A security scan is in progress. "),100==e.percentage&&clearInterval(g.value),O())},1e3)}catch(e){console.log(e)}}},onRepairAll:async()=>{var e;if(Jn.isFree)Ze({source:399});else try{const t=null==(e=k.value)?void 0:e.filter(e=>1==e.selection).map(e=>e.m_name);if(0==(null==t?void 0:t.length))return l.value=!1,void d.error("There are currently no risk items that can be automatically repaired!");l.value=!0,a.value="It is being repaired. It may take a long time. Please wait patiently...",D.progress=0;const{message:s}=await At(JSON.stringify({m_name:t}));if(i(s)){D.repairProgress=!0;const e=setInterval(async()=>{const{message:t}=await Rt();if(i(t)&&(D.progress=t.percentage,D.repairText=t.status,100===t.percentage)){D.repairText="Repair Completed",D.repairProgress=!1,D.progress=100,clearInterval(e);const t=await s;J(t),Z(!0)}},800)}}catch(t){console.log(t)}finally{l.value=!1}},onRepair:async(e,t)=>{var s,n;if(Jn.isFree)return void Ze({source:399});const o=null==(s=k.value)?void 0:s.filter(e=>1==e.selection).map(e=>e.m_name);try{if(!e&&0==(null==o?void 0:o.length))return void d.error("Please select the risk items that need to be repaired!");l.value=!0,a.value="It is being repaired. It may take a long time. Please wait patiently...";const{message:s}=await At(JSON.stringify({m_name:e?[null==t?void 0:t.m_name]:o}));i(s)&&(e&&s.success.length>0?(d.success("Repair Success"),$.value--,Gn.value[2].value=$.value,k.value=null==(n=k.value)?void 0:n.filter(e=>e.m_name!==(null==t?void 0:t.m_name)),J(s)):J(s))}catch(r){console.log(r)}finally{l.value=!1}},vulnerabilityInvolvesSoftware:e=>{const t=Object.keys(e.soft_name);let a="";return t.forEach((l,s)=>{s===t.length-1?a+="".concat(t,":").concat(e.soft_name[l]):a+="".concat(t,":").concat(e.soft_name[l],"\n")}),a},onToggle:(e,t)=>{e.show||t.forEach(e=>e.show=!1),e.show=!e.show},repairTypeActive:R,tootipTotal:E,getScanTotal:async()=>{const{message:e}=await zt();if(i(e)){const{vulnerability:t,malware:a,security:l,baseline:s}=e.data;if(E.malware=a,E.risk=l,E.web=t,E.baseline=s,E.risk){h.value="<span class='text-error'>".concat(E.risk,"</span> risks have been detected, please fix them in time");const{message:e}=await Nt();i(e)&&(S.value=e.is_autofix,k.value=e.risk,n.value=e.check_time,v.value=!0,o.value=!0,T.value=!1,c.value=!1,u.value=!0,_.value=e.score,O(),U())}}}}}),Qn={class:"flex items-center p-[2rem]"},Wn={class:"flex items-center w-full"},Xn={key:0,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},Yn={key:1,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},Kn={class:"w-full text-[2rem] flex flex-col ml-[3rem]"},qn={class:"flex items-center w-full justify-between"},ei={class:"w-420px"},ti=["innerHTML"],ai={key:1},li={class:"mx-[4px] text-[2.4rem] mx-[4px] text-error"},si={class:"flex items-center"},ni={key:0,class:"text-[1.4rem] text-font2 mt-[1rem]"},ii={key:1,class:"text-[1.4rem] text-font2 mt-[1rem]"},oi={key:3,class:"text-[1.4rem] mt-[12px] text-font2 flex items-center"},ri={key:4,class:"text-[1.4rem] mt-[12px] text-[#F0AD4E] flex items-center"},ci=p(ae({__name:"risk-scan",setup(e){const t=Vn(),{showAnimation:a,scanScore:l,scanTextClass:s,scanOuterClass:n,animateFlag:i,scanPreText:o,riskNum:r,scanButtonType:c,repairAutoRiskButton:u,cookieRepair:d,scanItemText:m,processData:p,lastScanTime:v}=ue(t);return(e,x)=>{const _=E,y=F;return se(),le("div",Qn,[pe("div",Wn,[oe(a)?de("",!0):(se(),le("div",Xn,x[1]||(x[1]=[pe("span",{class:"inline-block scan-icon-img icon-img-safe"},null,-1),pe("span",{class:"scan-icon-img-bg"},null,-1),pe("span",{class:"text-[3.2rem] h-[4.4rem] w-[0.7rem] text-[#20a53a] font-bold absolute-center"},"i",-1)]))),oe(a)?(se(),le("div",Yn,[pe("p",{class:Le("box-text w-[5.8rem] "+oe(s))},ve(oe(l)),3),pe("span",{class:Le("scan-icon-img icon-img-"+oe(n))},null,2),x[4]||(x[4]=pe("span",{class:"circle-inner"},null,-1)),pe("span",{class:Le("circle-outer "+oe(n))},null,2),pe("div",{class:Le("animate-box"+oe(i))},[pe("div",{class:Le("animate-box-left linear-"+oe(n))},null,2),x[2]||(x[2]=pe("div",{class:"animate-box-right"},null,-1)),x[3]||(x[3]=pe("div",{class:"animate-box-bottom"},null,-1))],2)])):de("",!0),pe("div",Kn,[pe("div",qn,[pe("span",ei,[oe(r)?(se(),le("span",ai,[pe("span",li,ve(oe(r)),1),_e(" "+ve(e.$t("Home.Security.index_89")),1)])):(se(),le("span",{key:0,innerHTML:oe(o)},null,8,ti))]),pe("div",si,[oe(u)&&oe(d)?de("",!0):(se(),ge(_,{key:0,class:Le("w-[9rem] "+("info"==oe(c)?"bg-[#CBCBCB]":"")),type:oe(c),round:"",onClick:oe(t).onScan},{default:ye(()=>[_e(ve("info"==oe(c)?e.$t("Home.Security.index_90"):e.$t("Home.Security.index_41")),1)]),_:1},8,["class","type","onClick"])),oe(u)&&oe(d)?(se(),le("span",{key:1,round:"",onClick:x[0]||(x[0]=(...e)=>oe(t).onScan&&oe(t).onScan(...e)),class:"!p-[0] bt-link text-[1.2rem] mr-4px whitespace-nowrap"},ve(e.$t("Ftp.Log.Index_12")),1)):de("",!0),oe(u)&&oe(d)?(se(),ge(_,{key:2,round:"",type:oe(c),onClick:oe(t).onRepairAll},{default:ye(()=>[_e(ve(e.$t("Home.Security.index_91")),1)]),_:1},8,["type","onClick"])):de("",!0)])]),"info"===oe(c)||oe(u)?de("",!0):(se(),le("span",ni,ve(e.$t("Home.Security.index_92")),1)),"info"==oe(c)?(se(),le("span",ii,ve(oe(m)),1)):de("",!0),"info"==oe(c)?(se(),ge(y,{key:2,class:"mt-[1.6rem] h-[1rem]","process-color":oe(p).processColor,percentage:oe(p).processPercentage,"stroke-width":10,"show-text":!1},null,8,["process-color","percentage"])):de("",!0),oe(u)?(se(),le("span",oi,ve(e.$t("Home.Security.index_9"))+"："+ve(oe(v)),1)):de("",!0),oe(u)&&oe(d)?(se(),le("span",ri,ve(e.$t("Home.Security.index_93")),1)):de("",!0)])])])}}}),[["__scopeId","data-v-f660504b"]]),ui={key:0,class:"text-[1.4rem] w-full flex items-center justify-between px-[0.8rem]"},di={class:"items-center flex"},mi={class:"flex items-center"},pi=ae({__name:"risk-select",setup(e){const l=Vn(),{scanSelectShow:s,allSelect:n,allSelectionDis:i,allData:o,isIgnoreAll:r,is_autofix:c,reportPopup:u}=ue(l),d=we(()=>{var e;return null==(e=o.value)?void 0:e.filter(e=>1==e.selection).map(e=>e.m_name).length});return Pe(n,e=>{var t,a;e?null==(t=o.value)||t.forEach(e=>{c.value.includes(e.m_name)&&(e.selection=!0)}):null==(a=o.value)||a.forEach(e=>{e.selection=!1})}),(e,o)=>{const c=W,m=t,p=a,v=E;return oe(s)?(se(),le("div",ui,[pe("div",di,[xe(c,{checked:oe(n),"onUpdate:checked":o[0]||(o[0]=e=>He(n)?n.value=e:null),disabled:oe(i)},{default:ye(()=>[_e(ve(e.$t("Public.SelectAll")),1)]),_:1},8,["checked","disabled"]),xe(m,{onClick:o[1]||(o[1]=e=>oe(l).onRepair(!1)),class:Le(oe(d)?"ml-[20px] text-[1.4rem]":"ml-[20px] text-[1.4rem] text-[#999] cursor-not-allowed ")},{default:ye(()=>[_e(ve(e.$t("Home.Security.index_94")),1)]),_:1},8,["class"])]),pe("div",mi,[xe(m,{onClick:o[2]||(o[2]=e=>r.value=!0)},{default:ye(()=>[_e(ve(e.$t("Home.Security.index_95")),1)]),_:1}),o[5]||(o[5]=pe("span",{class:"text-[#999] mx-[1.2rem]"},"|",-1)),xe(v,{type:"primary",text:"",onClick:o[3]||(o[3]=e=>u.value=!0)},{default:ye(()=>[xe(p,{name:"home-safe-report",class:"mr-4px"}),o[4]||(o[4]=_e(" View Report ",-1))]),_:1,__:[4]})])])):de("",!0)}}}),vi=["onClick"],xi={class:"module-head flex items-center h-[5.4rem] justify-between border-b-1 px-[0.8rem] w-full"},_i={class:"w-full flex items-center"},yi=["title"],fi={class:"px-[3rem] py-[3.2rem]",style:{background:"var(--home-risk-security-ignore-collapse-bg)"}},gi={class:"flex items-center"},hi={class:"w-100px text-right",style:{color:"var(--home-risk-file-info-item-color)"}},wi=["innerHTML"],bi={class:"flex mt-[16px] items-center"},ki={key:0,class:"collapse-item flex-col !items-start"},Si={key:1,class:"collapse-item"},Ci={class:"flex mt-[16px] items-center"},Hi={class:"w-100px text-right"},Mi={class:"collapse-item"},Ti=p(ae({__name:"risk-list",setup(e){const{t:a}=he(),l=Vn(),{emptyDetail:s,allData:n,loading:i,loadingText:o,activeMent:r,isShow:c,is_autofix:u,levelData:d}=ue(l),m=e=>[{label:"Fix it now",show:!!u.value.includes(e.m_name),onClick:()=>{l.onRepair(!0,e)}},{label:a("Ftp.Table.index_8"),class:"text-[#999]",onClick:()=>{l.onIgnore(e)}},{label:e.show?a("Home.Security.index_83"):a("Security.Anti.Index_21"),onClick:t=>{t.stopPropagation(),l.onToggle(e,n.value)}}];return(e,a)=>{const p=W,v=A,_=t,y=nt,f=S,g=x,h=w;return se(),le(me,null,[oe(s)?de("",!0):(se(),ge(h,{key:0,show:oe(i),class:Le([oe(c)?"h-[24rem]":"h-[34rem]","scan-body mt-16px"]),description:oe(o)},{default:ye(()=>[xe(g,{"expanded-names":oe(r),"onUpdate:expandedNames":a[0]||(a[0]=e=>He(r)?r.value=e:null),accordion:"","arrow-placement":"right"},{default:ye(()=>[pe("div",{class:Le(["module-list overflow-auto",oe(c)?"h-[24rem]":"h-[34rem]"])},[(se(!0),le(me,null,ke(oe(n),(t,s)=>(se(),le("div",{class:"module-item text-[1.2rem] cursor-pointer",key:"".concat(s),onClick:e=>oe(l).onToggle(t,oe(n))},[pe("div",xi,[pe("div",_i,[xe(p,{checked:t.selection,"onUpdate:checked":e=>t.selection=e,disabled:!oe(u).includes(t.m_name)},null,8,["checked","onUpdate:checked","disabled"]),xe(v,{class:Le(["flex-nowrap!",oe(u).includes(t.m_name)?"w-[50rem]!":"w-[30rem]!"])},{default:ye(()=>[pe("span",{class:"text-[1.2rem] h-[2.2rem] px-[8px] rounded-[0.2rem] mx-[8px] whitespace-nowrap flex items-center",style:ie({color:oe(d)[t.level].color,backgroundColor:oe(d)[t.level].bg})},ve(oe(d)[t.level].text),5),pe("div",{class:"truncate",style:ie({color:oe(d)[t.level].color}),title:t.ps?t.ps:t.vuln_name},ve(t.ps?t.ps:t.vuln_name),13,yi)]),_:2},1032,["class"]),oe(u).includes(t.m_name)?de("",!0):(se(),ge(v,{key:0,size:0,class:"text-font2 ml-10px items-center!"},{default:ye(()=>[a[2]||(a[2]=pe("span",null,"Contact Now",-1)),xe(_,{href:"mailto:support@aapanel.com",target:"_blank",class:"ml-2px"},{default:ye(()=>a[1]||(a[1]=[_e("support@aapanel.com",-1)])),_:1,__:[1]})]),_:1,__:[2]}))]),xe(y,{class:"w-200px",options:m(t)},null,8,["options"])]),xe(f,null,{default:ye(()=>[Be(pe("div",fi,[pe("div",gi,[pe("div",hi,ve(t.ps?"Risk Description":"Involved software "),1),Be(pe("div",{class:"collapse-item",innerHTML:t.msg},null,8,wi),[[Ae,t.msg]]),Be(pe("div",{class:"collapse-item"},ve(t.soft_name?oe(l).vulnerabilityInvolvesSoftware(t):""),513),[[Ae,t.soft_name]])]),pe("div",bi,[a[3]||(a[3]=pe("div",{class:"w-100px text-right"},"Solution",-1)),t.tips?(se(),le("div",ki,[(se(!0),le(me,null,ke(t.tips,(e,t)=>(se(),le("p",{key:t,class:Le(0==t?"":"mt-[4px]")},ve(t+1)+"、"+ve(e),3))),128))])):de("",!0),t.vuln_solution?(se(),le("div",Si,ve(t.vuln_solution),1)):de("",!0)]),Be(pe("div",Ci,[pe("div",Hi,ve(e.$t("Home.Security.index_81")),1),pe("div",Mi,ve(t.remind),1)],512),[[Ae,t.remind]])],512),[[Ae,t.show]])]),_:2},1024)],8,vi))),128))],2)]),_:1},8,["expanded-names"])]),_:1},8,["show","class","description"])),oe(s)?(se(),le("div",{key:1,class:Le([oe(c)?"h-[32rem]":"h-[40rem]","scan-body flex justify-center flex-col my-[3rem] relative"])},[a[4]||(a[4]=pe("span",{class:"risk-spin h-[3rem] w-[33%] mb-[12px]"},null,-1)),(se(),le(me,null,ke(4,(e,t)=>pe("span",{class:"risk-spin h-[3rem] w-full mb-[12px]",key:t})),64)),a[5]||(a[5]=pe("span",{class:"risk-spin h-[3rem] w-[60%] mb-[12px]"},null,-1)),(se(),le(me,null,ke(3,(e,t)=>pe("span",{class:"risk-spin h-[3rem] w-full mb-[12px]",key:t})),64)),a[6]||(a[6]=pe("span",{class:"risk-spin h-[3rem] w-[40%] mb-[12px]"},null,-1))],2)):de("",!0)],64)}}}),[["__scopeId","data-v-a3822d9f"]]),Ii={class:"text-20px"},ji=ae({__name:"index",setup(e){const t=be(()=>c(()=>import("./risk-repair.js?v=1767769852656"),__vite__mapDeps([46,5,6,2,3,7,4,8,9,1,10,23,24,25,26,27,28,29,30,31,32,19,33,22,34,35,36,37,38,39,40,41,42,43,20,21,44]))),a=be(()=>c(()=>import("./risk-ignore-list.js?v=1767769852656"),__vite__mapDeps([47,6,2,3,7,4,5,9,8,1,10,23,24,25,26,27,28,29,30,31,32,19,33,22,34,35,36,37,38,39,40,41,42,43,20,21,44,48]))),l=be(()=>c(()=>import("./risk-report.js?v=1767769852656"),__vite__mapDeps([49,6,2,3,7,4,5,9,8,50,22,51]))),s=Vn(),{resultConfirm:n,isIgnoreAll:i,reportPopup:o}=ue(s);return s.getScanTotal(),(e,s)=>{const r=Ue;return se(),le(me,null,[pe("div",Ii,ve(e.$t("Home.Security.index_80")),1),xe(ci),xe(pi),xe(Ti),xe(r,{show:oe(n),"onUpdate:show":s[0]||(s[0]=e=>He(n)?n.value=e:null),title:"Result Confirmation",width:500,component:oe(t)},null,8,["show","component"]),xe(r,{show:oe(i),"onUpdate:show":s[1]||(s[1]=e=>He(i)?i.value=e:null),title:"Ignore risk items",width:700,"min-height":400,component:oe(a)},null,8,["show","component"]),xe(r,{show:oe(o),"onUpdate:show":s[2]||(s[2]=e=>He(o)?o.value=e:null),title:"Security Scan Report",width:1e3,"min-height":800,component:oe(l),footer:!0,"confirm-text":e.$t("Public.Btn.Export"),"hide-close":!0},null,8,["show","component","confirm-text"])],64)}}}),Di=Te("home-security-server",()=>{const e=fe(!1),t=fe("");return{serverScanParams:fe({scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},statusTotal:{},allArr:[],result:{},progressStatus:{},active:{}}),checkTopic:t,isScan:e}}),Li={class:"progress-header"},zi={class:"progress-header-cot"},Ni={key:0,class:"relative"},$i={class:"absolute top-[1.6rem] left-[2.6rem] flex flex-col"},Pi={class:"text-[1.2rem] font-bold leading-none"},Bi={class:"progress-header-cot"},Ai={class:"scanning-progress-title"},Ri={class:"color-#fc6d26"},Ei={class:"scanning-progress-cont"},Oi=p(ae({__name:"server-scan",setup(t){const l=Di(),s=e(),{serverScanParams:n,checkTopic:o,isScan:r}=ue(l),c=je({status:!0,time:0,security_count:0,risk_count:{warning:0,danger:7}}),u=fe(""),d=we(()=>n.value.scanStatus&&!n.value.isEnd?"Scanning":c.status?"Last detection time "+C(c.time):"Currently not undergoing security testing"),m=we(()=>n.value.scanStatus&&!n.value.isEnd?"Scanning-".concat(u.value):n.value.isEnd?"Detection time："+k(n.value.time/1e3,"yyyy-MM-dd"):c.status?"The server may have security risks. It is recommended to check it immediately":"The current security risk is unknown, please check immediately"),{open:p,send:v,close:x}=it("/ws_project",{immediate:!1,onMessage:(e,t)=>{var a;const l=JSON.parse(t.data.replace(/'/g,'"'));l&&"object"==typeof l&&"callback"in l?(x(),n.value.scanStatus=!1,n.value.isEnd=!0,n.value.time=(new Date).getTime(),g()):(u.value=l.name,o.value=l.topic,n.value.progress=parseInt(l.progress),null==(a=n.value.progressConfig[l.topic])||a.push(l),n.value.statusTotal[l.topic]=_(n.value.progressConfig[l.topic]),n.value.allArr.push(l),3===l.status&&n.value.error++,2!==l.status&&3!==l.status||n.value.warn++,1!==l.status&&(n.value.progressColor="#fc6d26"))}}),_=e=>{const t={};return e.length&&e.forEach(e=>{t[e.status]?t[e.status]++:t[e.status]=1}),t},y=()=>{if(s.isFree)Ze({source:399});else{if(n.value.scanStatus&&!n.value.isEnd)return x(),void f();n.value.isEnd&&f(),n.value.scanStatus=!0,p(),v({mod_name:"safe_detect",def_name:"get_safe_scan",ws_callback:""}),r.value=!0}},f=()=>{n.value.scanStatus=!1,n.value.isEnd=!1,n.value.error=0,n.value.warn=0,n.value.time=0,n.value.progress=0,n.value.progressColor="#20a53a",n.value.progressConfig={system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},n.value.statusTotal={},n.value.allArr=[],n.value.result={},n.value.progressStatus={},n.value.active={system_account:!1,sshd_service:!1,file_mode:!1,software:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}},g=()=>{const e=e=>e.sort((e,t)=>t.status-e.status);for(const l in n.value.progressConfig){const t=n.value.progressConfig[l];Array.isArray(t)&&t.length&&e(t)}const t=n.value.allArr;Array.isArray(t)&&t.length&&e(t);const a=n.value.result;if(a&&Object.keys(a).length){const t={};Object.keys(a).forEach(t=>{const l=a[t];Array.isArray(l)&&e(l)});Object.keys(a).sort((e,t)=>{const l=a[e].some(e=>e.status>1);return l===a[t].some(e=>e.status>1)?0:l?-1:1}).forEach(e=>{t[e]=a[e]}),n.value.result=t}};return(async()=>{try{const{message:e}=await Ut();if(i(e)){if(Object.prototype.hasOwnProperty.call(e,"msg"))return void(c.status=!1);c.time=e.time,c.security_count=e.security_count,c.risk_count=e.risk_count}}catch(e){c.status=!1}})(),Re(()=>{x()}),(e,t)=>{const l=a,s=F,i=E;return se(),le("div",Li,[pe("div",zi,[pe("div",{class:Le("progresscirclebar "+(oe(c).status?"security ":"")+"text-["+(100===oe(c).security_count?" #20a53a ":" #fc6d26 ")+"]")},[oe(c).status?(se(),le(me,{key:1},[oe(n).scanStatus&&!oe(n).isEnd?(se(),le("div",Ni,[xe(s,{class:"animate-spin",type:"circle",percentage:70,"stroke-width":4,color:oe(n).warn||oe(n).error?"#fc6d26":"#20a53a"},{default:ye(()=>[_e(ve(),1)]),_:1},8,["color"]),pe("div",$i,[xe(l,{name:"firewall-icon-safe-detect".concat(oe(n).warn||oe(n).error?"-org":""),size:50},null,8,["name"]),pe("span",Pi,ve(e.$t("Home.Security.index_41")),1)])])):(se(),ge(s,{key:1,type:"circle",percentage:oe(c).security_count,color:100===oe(c).security_count?"#20a53a":"#fc6d26"},{default:ye(()=>[_e(ve(oe(c).security_count),1)]),_:1},8,["percentage","color"]))],64)):(se(),ge(l,{key:0,size:100,name:"firewall-icon-safe-detect"}))],2)]),pe("div",Bi,[pe("div",Ai,[oe(n).isEnd?(se(),le(me,{key:1},[t[2]||(t[2]=_e(" Testing completed ",-1)),oe(n).error>0||oe(n).warn>0?(se(),le(me,{key:0},[t[1]||(t[1]=_e(" ，Found ",-1)),oe(n).warn>0?(se(),le(me,{key:0},[pe("span",Ri,ve(oe(n).warn),1),t[0]||(t[0]=_e(" risk items ",-1))],64)):de("",!0)],64)):de("",!0)],64)):(se(),le(me,{key:0},[_e(ve(oe(d)),1)],64))]),oe(n).scanStatus?(se(),ge(s,{key:0,percentage:oe(n).progress,color:oe(n).warn||oe(n).error?"#fc6d26":"#20a53a","stroke-width":10},null,8,["percentage","color"])):de("",!0),pe("div",Ei,ve(oe(m)),1)]),pe("div",null,[xe(i,{size:"large",type:oe(n).scanStatus&&!oe(n).isEnd?"warning":"primary",onClick:y,plain:!(!oe(n).scanStatus||oe(n).isEnd)},{default:ye(()=>[_e(ve(oe(n).scanStatus&&!oe(n).isEnd?"Cancel Scan":(oe(n).isEnd,e.$t("Home.Security.index_41"))),1)]),_:1},8,["type","plain"])])])}}}),[["__scopeId","data-v-0a5f55f9"]]),Fi={class:"progress-cont-list scrollable"},Ui=["onClick"],Zi={class:"progress_type"},Ji={class:"progress_status"},Gi={key:0,class:"text-error"},Vi={key:1,class:"text-warning"},Qi={key:1},Wi={key:2,class:"text-font2"},Xi={key:0},Yi={key:0,class:"progress_fold"},Ki={class:"progress_item_body"},qi={class:"info_cont"},eo={class:"info_cont_desc"},to=p(ae({__name:"server-list",setup(e){const t=Di(),{serverScanParams:l,checkTopic:s,isScan:n}=ue(t),i=[{color:"#888",text:"Not Installed"},{color:"#666",text:"Good"},{color:"#e6a23c",text:"Warn"},{color:"red",text:"Danger"}],o={system_account:"System Account",sshd_service:"SSHD Remote Service",file_mode:"Important file permissions and attributes",software:"Key software detection",other:"Other project testing",backdoor:"Backdoor Detection",proc:"Malicious processes",history:"History Commands",log:"Log troubleshooting",rootkit:"Rootkit detection"};return(e,t)=>{const r=a;return se(),le("div",Fi,[(se(),le(me,null,ke(o,(t,a)=>pe("div",{key:a,class:Le([a+"_item "+(oe(l).active[a]?"active":""),"progress_item"])},[pe("div",{class:"progress_item_header",onClick:e=>(e=>{l.value.active[e]=!l.value.active[e]})(a)},[pe("div",Zi,[xe(r,{class:"title-icon",name:"firewall-icon-"+a},null,8,["name"]),pe("span",null,ve(t),1)]),pe("div",Ji,[oe(l).statusTotal[a]?(se(),le(me,{key:0},[oe(l).statusTotal[a][3]||oe(l).statusTotal[a][2]?(se(),le(me,{key:0},[oe(l).statusTotal[a][3]?(se(),le("span",Gi,ve(oe(l).statusTotal[a][3])+" "+ve(e.$t("Home.Security.index_89")),1)):de("",!0),oe(l).statusTotal[a][2]?(se(),le("span",Vi,ve((oe(l).statusTotal[a][3]?"":"Found ")+oe(l).statusTotal[a][2])+" "+ve(e.$t("Database.tools.index_20")),1)):de("",!0)],64)):oe(l).scanStatus&&oe(s)==a?(se(),le("span",Qi,ve(e.$t("Home.Security.index_97"))+"... ",1)):(se(),le("span",Wi,ve(e.$t("Home.Security.index_98")),1))],64)):(se(),le(me,{key:1},[oe(l).scanStatus&&!oe(l).statusTotal[a]?(se(),le("span",Xi,ve(e.$t("Home.Security.index_99")),1)):de("",!0)],64))]),oe(n)?(se(),le("div",Yi,[xe(r,{name:"base-arrow-bottom"})])):de("",!0)],8,Ui),pe("div",Ki,[oe(l).progressConfig[a]&&oe(l).progressConfig[a].length?(se(!0),le(me,{key:0},ke(oe(l).progressConfig[a],(e,t)=>(se(),le("div",{key:t,class:Le([e.info?"active":"","progress_item_info"])},[pe("div",qi,[pe("div",null,ve(e.name),1),pe("div",{class:Le("text-["+i[e.status<0?0:e.status].color+"]")},ve(i[e.status<0?0:e.status].text),3)]),pe("div",eo,ve(e.info||""),1)],2))),128)):de("",!0)])],2)),64))])}}}),[["__scopeId","data-v-9466c95d"]]),ao={class:"text-20px"},lo=ae({__name:"index",setup:e=>(e,t)=>(se(),le(me,null,[pe("div",ao,ve(e.$t("Home.Security.index_96")),1),xe(Oi),xe(to)],64))}),so={class:"h-600px"},no=ae({__name:"index",setup(e){const l=Wl(),{menu:s}=ue(l),n=[{key:"overview",label:()=>{const e="overview"===s.value;return xe(a,{size:32,name:e?"home-aapanel-active":"home-aapanel"},null)},component:Un},{key:"risk",label:()=>{const e="risk"===s.value?"home-risk-active":"home-risk";return xe(Kl,{value:ql("risk"),iconName:e},null)},component:ji},{key:"file",label:()=>{const e="file"===s.value?"home-ware-active":"home-ware";return xe(Kl,{value:ql("file"),iconName:e},null)},component:ks},{key:"loophole",label:()=>{const e="loophole"===s.value?"home-web-active":"home-web";return xe(Kl,{value:ql("loophole"),iconName:e},null)},component:dn},{key:"server",label:()=>{const e="server"===s.value?"home-safeDetect-active":"home-safeDetect";return xe(Kl,{value:ql("server"),iconName:e},null)},component:lo},{key:"global",label:()=>{const e="global"===s.value;return xe(a,{size:32,name:e?"home-alarm-active":"home-alarm"},null)},component:Hs}];return s.value="overview",(e,a)=>{const l=Zt,i=t,o=ct,r=A;return se(),le("div",so,[xe(l,{"is-icon":"",value:oe(s),"onUpdate:value":a[0]||(a[0]=e=>He(s)?s.value=e:null),data:n,class:"relative"},null,8,["value"]),xe(r,{size:3,class:"absolute right-[2rem] top-[1rem] items-center!"},{default:ye(()=>[xe(o,{"icon-name":"demand"},{default:ye(()=>[xe(i,{href:"mailto:support@aapanel.com",target:"_blank"},{default:ye(()=>a[1]||(a[1]=[_e("support@aapanel.com",-1)])),_:1,__:[1]})]),_:1})]),_:1})])}}}),io={class:"overview-wrapper"},oo={class:"content"},ro={class:"overview-title"},co={class:"href"},uo={class:"bottom-menu"},mo={class:"content"},po={class:"overview-title"},vo={class:"href"},xo={class:"bottom-menu"},_o={class:"content"},yo={class:"overview-title"},fo={class:"href"},go={class:"bottom-menu"},ho={class:"content"},wo={class:"overview-title"},bo={class:"href"},ko={class:"bottom-menu"},So=p(ae({__name:"index",setup(e){const{server:a}=la(),l=we(()=>a.value?a.value.site_total:0),s=we(()=>a.value?a.value.ftp_total:0),n=we(()=>a.value?a.value.database_total:0),o=Ee(),r=()=>{o.push("/site/php")},c=()=>{o.push("/ftp")},u=()=>{o.push("/database/mysql")},d=()=>{Ge({width:900,component:no})},m=fe(0);return(async()=>{const{message:e}=await It();i(e)&&(m.value=e.total)})(),(e,a)=>{const i=t,o=B;return se(),ge(o,{class:"mb-16px",title:e.$t("Home.index_67")},{default:ye(()=>[pe("div",io,[pe("div",{class:"overview-box",onClick:r},[pe("div",oo,[pe("div",ro,ve(e.$t("Home.index_68")),1),pe("div",co,[xe(i,null,{default:ye(()=>[_e(ve(oe(l)),1)]),_:1})])]),pe("div",uo,ve(e.$t("Home.index_72",[e.$t("Home.index_68")])),1)]),pe("div",{class:"overview-box",onClick:c},[pe("div",mo,[pe("div",po,ve(e.$t("Home.index_69")),1),pe("div",vo,[xe(i,null,{default:ye(()=>[_e(ve(oe(s)),1)]),_:1})])]),pe("div",xo,ve(e.$t("Home.index_72",[e.$t("Home.index_69")])),1)]),pe("div",{class:"overview-box",onClick:u},[pe("div",_o,[pe("div",yo,ve(e.$t("Home.index_70")),1),pe("div",fo,[xe(i,null,{default:ye(()=>[_e(ve(oe(n)),1)]),_:1})])]),pe("div",go,ve(e.$t("Home.index_72",[e.$t("Home.index_70")])),1)]),pe("div",{class:"overview-box",onClick:d},[pe("div",ho,[pe("div",wo,ve(e.$t("Home.index_71")),1),pe("div",bo,[xe(i,{type:oe(m)>0?"error":"primary"},{default:ye(()=>[_e(ve(oe(m)),1)]),_:1},8,["type"])])]),pe("div",ko,ve(e.$t("Home.index_73")),1)])])]),_:1},8,["title"])}}}),[["__scopeId","data-v-94e97d0e"]]),Co=["onClick"],Ho={class:"content"},Mo={class:"software-img h-95px"},To=["src"],Io={class:"software-name"},jo={class:"text"},Do={class:"content"},Lo={class:"software-img h-70px"},zo=["src"],No={class:"software-name"},$o={class:"text"},Po={class:"software-btn"},Bo=p(ae({__name:"index",setup(e){const{softList:t,softRecommend:a}=la(),l=fe(!1),s={animation:200,disabled:!1,group:"description",handle:".move",ghostClass:"ghost","item-key":"id"},n=we({get:()=>t.value.length>12?t.value.slice(0,12):t.value,set(e){t.value=e}}),i=we(()=>n.value.length>=12?[]:a.value.list.slice(0,12-n.value.length)),o=we(()=>{const e=12-n.value.length-i.value.length;return e>0?e:0}),r=we(()=>Array.from({length:o.value},e=>e)),c=e=>{const t=e.replace(/-+[{0-9},.,]+$/,"");return"".concat(H,"images/soft-ico/ico-").concat(t,".png")},u=async()=>{const e=t.value.map(e=>e.name).join("|");await M({ssort:e})};return(e,t)=>{const a=ea;return se(),ge(oe(B),{title:e.$t("Home.index_74")},{default:ye(()=>[xe(oe(pt),Ce({modelValue:oe(n),"onUpdate:modelValue":t[0]||(t[0]=e=>He(n)?n.value=e:null)},s,{class:"software-wrapper",onStart:t[1]||(t[1]=e=>l.value=!0),onEnd:t[2]||(t[2]=e=>l.value=!1),onSort:u}),{item:ye(({element:e})=>[pe("div",{class:"software-box",onClick:t=>{xt(e)}},[pe("div",Ho,[t[3]||(t[3]=pe("i",{class:"iconfont icon-drag move",title:""},null,-1)),pe("div",Mo,[pe("img",{src:c(e.name)},null,8,To)]),pe("div",Io,[pe("span",jo,ve(e.title+" "+e.version),1),xe(a,{class:"ml-4px",value:e.status,"show-text":!1},null,8,["value"])])])],8,Co)]),footer:ye(()=>[(se(!0),le(me,null,ke(oe(i),a=>(se(),le("div",{key:a.pid,class:"software-box"},[pe("div",Do,[t[4]||(t[4]=pe("div",{class:"recommend"},"AD",-1)),pe("div",Lo,[pe("img",{"object-fit":"contain",src:c(a.name)},null,8,zo)]),pe("div",No,[pe("div",$o,ve(a.title),1)]),pe("div",Po,[a.isBuy?(se(),ge(oe(E),{key:1,class:"install",onClick:e=>(e=>{ot(e.name)})(a)},{default:ye(()=>[_e(ve(e.$t("Public.Btn.Install")),1)]),_:2},1032,["onClick"])):(se(),le(me,{key:0},[xe(oe(E),{class:"preview",onClick:e=>(e=>{window.open(e.preview)})(a)},{default:ye(()=>[_e(ve(e.$t("Public.Btn.Preview")),1)]),_:2},1032,["onClick"]),xe(oe(E),{class:"buy",onClick:e=>(e=>{Ze({source:Number(e.pay)})})(a)},{default:ye(()=>[_e(ve(e.$t("Component.Auth.index_3")),1)]),_:2},1032,["onClick"])],64))])])]))),128)),(se(!0),le(me,null,ke(oe(r),e=>(se(),le("div",{key:e,class:"software-box"}))),128))]),_:1},16,["modelValue"])]),_:1},8,["title"])}}}),[["__scopeId","data-v-f5b29127"]]);function Ao({series:e,yAxisName:t,tooltipFormatter:a}){const l=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{formatter:e=>k(e,"HH:mm:ss")},axisLine:{lineStyle:{color:"#666"}}}),s=(t=[])=>e.map((e,a)=>({name:e.name,data:t.length>a?t[a]:[],symbolSize:6,type:"line",smooth:!0,symbol:"circle",showSymbol:!1,sampling:"average",lineStyle:{width:1,color:e.color},itemStyle:{color:e.color},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:T(e.color,1)},{offset:.8,color:T(e.color,.4)}]}}}));return{option:De({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{formatter:e=>"x"===e.axisDimension?k(e.value,"HH:mm:ss"):"".concat(parseFloat("".concat(e.value)).toFixed(2))}},formatter:a},grid:{top:"20%",left:"6%",right:"6%",bottom:"4%",containLabel:!0},yAxis:{type:"value",name:t||"",boundaryGap:[0,"100%"],min:0,splitLine:{lineStyle:{color:"#ddd"}},axisLine:{lineStyle:{color:"#666"}}},xAxis:l(),series:s()}),getXAxis:l,getSeries:s}}const Ro={class:"mb-7px"},Eo={class:"text-desc"},Oo=ae({__name:"info",props:{info:{default:()=>({})}},setup:e=>(e,t)=>{const a=Z,l=h;return se(),ge(l,{cols:4,class:"w-full"},{default:ye(()=>[(se(!0),le(me,null,ke(e.info,e=>(se(),ge(a,{class:"text-center pt-35px px-15px",key:e.label},{default:ye(()=>[pe("div",Ro,[Be(pe("i",{class:"spot rounded-5px inline-block w-10px h-10px mr-3px",style:ie({"background-color":e.bgColor})},null,4),[[Ae,e.bgColor]]),pe("span",Eo,ve(e.label),1)]),pe("div",{class:"text-14px",style:ie({color:e.color})},ve(e.value),5)]),_:2},1024))),128))]),_:1})}}),Fo={class:"relative"},Uo={class:"absolute left-50px top-92px flex items-center w-110px z-1"},Zo=ae({__name:"net",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const t=Oe(e,"value"),{t:a}=he(),{onServerReady:l}=la(),s=fe({}),n=je({up:{label:a("Home.index_79"),value:"0 B",bgColor:"#F7B851"},down:{label:a("Home.index_80"),value:"0 B",bgColor:"#52A9FF"},upTotal:{label:a("Home.index_81"),value:"0 B"},downTotal:{label:a("Home.index_82"),value:"0 B"}}),i=fe("KB"),o=fe([{label:"KB/s",value:"KB",disabled:!1},{label:"MB/s",value:"MB",disabled:!1},{label:"GB/s",value:"GB",disabled:!1},{label:"TB/s",value:"TB",disabled:!1}]),r=({option:e})=>"".concat(a("Home.index_83")).concat(e.label),{option:c,getXAxis:u,getSeries:d}=Ao({series:[{name:a("Home.index_79"),color:"#f7b851"},{name:a("Home.index_80"),color:"#52a9ff"}],tooltipFormatter:e=>{let t="",l="";return Object.entries(e).forEach(([,e])=>{t=k(e.name,"HH:mm:ss"),l+='\n\t\t\t\t<div>\n\t\t\t\t\t<span class="inline-block w-10px h-10px mr-10px" style="border-radius: 50%; background: '.concat(e.color,';"></span>\n\t\t\t\t\t<span>').concat(e.seriesName,": ").concat(e.data.value.toFixed(2)," ").concat(i.value,"/s</span>\n\t\t\t\t</div>")}),"\n\t\t\t<div>\n\t\t\t\t<div>".concat(a("Home.index_84")).concat(t,"</div>\n\t\t\t\t").concat(l,"\n\t\t\t</div>")}}),m=e=>{p.forEach(t=>{t.up=I(j(1024*t.upOriginal,!1,2,e)),t.down=I(j(1024*t.downOriginal,!1,2,e))})},p=[],v=e=>{var t;p.length>0&&(t=p[0].date,(new Date).getTime()-t>18e4)&&p.shift(),p.push(e);const a=[],l=[],s=[];p.forEach(e=>{a.push(e.date),l.push({...e,value:e.up}),s.push({...e,value:e.down})}),c.xAxis=u(a),c.series=d([l,s])};return l("network",e=>{s.value=e.network;const{infoData:a,optionData:l}=(()=>{const e={upTotal:0,downTotal:0,up:0,down:0,downPackets:0,upPackets:0},a=Object.assign(e,{date:Date.now(),upOriginal:0,downOriginal:0}),l=Object.entries(s.value).filter(([e])=>"all"===t.value||e===t.value);for(const[,t]of l)Object.keys(t).forEach(l=>{let s=D(t[l])?t[l]:0;l in e||(e[l]=0),e[l]+=s,l in a||(a[l]=0),a[l]+=s});return a.upOriginal=a.up,a.downOriginal=a.down,a.up=I(j(1024*a.up,!1,2,i.value)),a.down=I(j(1024*a.down,!1,2,i.value)),{infoData:e,optionData:a}})();(()=>{var e;let t=(null==(e=ee(p,e=>e.downOriginal))?void 0:e.downOriginal)||0;const a=["KB","MB","GB","TB"];do{t/=1024,a.shift()}while(t>.1&&a.length>0);o.value.forEach(e=>{e.disabled=a.includes("".concat(e.value))})})(),(e=>{n.up.value="".concat(e.up," ").concat(i.value),n.down.value="".concat(e.down," ").concat(i.value),n.upTotal.value=j(e.upTotal),n.downTotal.value=j(e.downTotal)})(a),v(l)}),(e,t)=>{const a=G;return se(),le("div",Fo,[xe(Oo,{info:oe(n)},null,8,["info"]),pe("div",Uo,[xe(a,{value:oe(i),"onUpdate:value":[t[0]||(t[0]=e=>He(i)?i.value=e:null),m],size:"small",options:oe(o),"render-tag":r},null,8,["value","options"])]),xe(Kt,{height:340,option:oe(c)},null,8,["option"])])}}}),Jo={class:"relative"},Go="MB",Vo=ae({__name:"iostat",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=he(),{onServerReady:a}=la(),l=fe({}),s=Oe(e,"value"),n=v(),i=je({read:{label:t("Home.index_85"),value:"0 B",bgColor:"#FF4683"},write:{label:t("Home.index_86"),value:"0 B",bgColor:"#6CC0CF"},second:{label:t("Home.index_87"),value:"0"},io:{label:t("Home.index_88"),value:"0 ms",color:n.value.primaryColor}}),o=[{key:"read_count",label:t("Home.index_89"),unit:"per sec"},{key:"write_count",label:t("Home.index_90"),unit:"per sec"},{key:"read_merged_count",label:t("Home.index_91"),unit:"per sec"},{key:"write_merged_count",label:t("Home.index_92"),unit:"per sec"},{key:"read_time",label:t("Home.index_93"),unit:"ms"},{key:"write_time",label:t("Home.index_94"),unit:"ms"}],{option:r,getXAxis:c,getSeries:u}=Ao({series:[{name:t("Home.index_95"),color:"#FF4683"},{name:t("Home.index_96"),color:"#6CC0CF"}],yAxisName:"".concat(t("Home.index_83")).concat(Go,"/s"),tooltipFormatter:e=>{let a="",l="",s=null;return Object.entries(e).forEach(([,e])=>{a=k(e.name,"HH:mm:ss"),l+='\n\t\t\t<div>\n\t\t\t\t<span class="inline-block w-10px h-10px mr-10px" style="border-radius: 50%; background: '.concat(e.color,';"></span>\n\t\t\t\t<span>').concat(e.seriesName,": ").concat(e.data.value," MB/s</span>\n\t\t\t</div>"),s||(s=e.data)}),o.forEach(e=>{if(null!==s){let t="";const a=s[e.key];"read_time"!==e.key&&"write_time"!==e.key||(t="color: ".concat(a>1e3?n.value.errorColor:n.value.primaryColor,";")),l+='\n\t\t\t\t<div>\n\t\t\t\t\t<span class="inline-block w-10px h-10px mr-10px" style="border-radius: 50%;"></span>\n\t\t\t\t\t<span style="'.concat(t,'">\n\t\t\t\t\t\t').concat(e.label,": ").concat(a," ").concat(e.unit,"\n\t\t\t\t\t</span>\n\t\t\t\t</div>")}}),"\n\t\t<div>\n\t\t\t<div>".concat(t("Home.index_84")).concat(a,"</div>\n\t\t\t").concat(l,"\n\t\t</div>")}}),d=[],m=e=>{var t;d.length>0&&(t=d[0].date,(new Date).getTime()-t>18e4)&&d.shift(),d.push(e);const a=[],l=[],s=[];d.forEach(e=>{a.push(e.date),l.push({...e,value:parseFloat(j(e.read_bytes,!1,2,Go))}),s.push({...e,value:parseFloat(j(e.write_bytes,!1,2,Go))})}),r.xAxis=c(a),r.series=u([l,s])};return a("iostat",e=>{l.value=e.iostat;const{infoData:t,optionData:a}=(()=>{const e={read_bytes:0,write_bytes:0,read_count:0,write_count:0,read_merged_count:0,write_merged_count:0,read_time:0,write_time:0},t=Object.assign(e,{date:Date.now()}),a=Object.entries(l.value);for(const[l,n]of a)if("all"===s.value&&Object.keys(n).forEach(a=>{const l=D(n[a])?n[a]:0;a in e||(e[a]=0),e[a]+=l,a in t||(t[a]=0),t[a]+=l}),s.value===l){Object.keys(n).forEach(a=>{const l=D(n[a])?n[a]:0;e[a]=l,t[a]=l});break}return{infoData:e,optionData:t}})();(e=>{i.read.value=j(e.read_bytes),i.write.value=j(e.write_bytes),i.second.value="".concat(e.read_count+e.write_count);const t=e.write_time>e.read_time?e.write_time:e.read_time;i.io.value="".concat(t," ms"),i.io.color=t>=1e3?n.value.errorColor:n.value.primaryColor})(t),m(a)}),(e,t)=>(se(),le("div",Jo,[xe(Oo,{info:oe(i)},null,8,["info"]),xe(Kt,{height:340,option:oe(r)},null,8,["option"])]))}}),Qo={class:"w-140px mr-16px"},Wo=p(ae({__name:"index",setup(e){const{t:t}=he(),{onServerReady:a}=la(),l=fe("net"),s=fe("all"),n=fe([{label:t("Public.All"),value:"all"}]),i=fe([]),o=we(()=>"net"===l.value?n.value:i.value),r=new Map([["net",t("Home.index_77")],["iostat",t("Home.index_78")]]),c=({option:e})=>"".concat(r.get(l.value),": ").concat(e.label),u=e=>{"net"===e&&(s.value=n.value[0].value),"iostat"===e&&(s.value=i.value[0].value)};return a("monitor",e=>{var a,l;a=e.network,n.value.length!==Object.keys(a).length+1&&(n.value=Object.keys(a).map(e=>({label:e,value:e})),n.value.unshift({label:t("Public.All"),value:"all"})),l=e.iostat,i.value.length!==Object.keys(l).length+1&&(i.value=Object.keys(l).map(e=>({label:e===t("Public.All")?t("Public.All"):e,value:e})))}),(e,t)=>{const a=G,n=q,i=K,r=B;return se(),ge(r,{class:"h-full"},{default:ye(()=>[xe(i,{value:oe(l),"onUpdate:value":[t[3]||(t[3]=e=>He(l)?l.value=e:null),u],class:"home-reset-tab","bar-width":60},{suffix:ye(()=>[pe("div",Qo,[xe(a,{value:oe(s),"onUpdate:value":t[0]||(t[0]=e=>He(s)?s.value=e:null),options:oe(o),"render-tag":c},null,8,["value","options"])])]),default:ye(()=>[xe(n,{tab:e.$t("Home.index_75"),name:"net","display-directive":"show:lazy"},{default:ye(()=>[xe(Zo,{value:oe(s),"onUpdate:value":t[1]||(t[1]=e=>He(s)?s.value=e:null)},null,8,["value"])]),_:1},8,["tab"]),xe(n,{tab:e.$t("Home.index_76"),name:"iostat","display-directive":"show:lazy"},{default:ye(()=>[xe(Vo,{value:oe(s),"onUpdate:value":t[2]||(t[2]=e=>He(s)?s.value=e:null)},null,8,["value"])]),_:1},8,["tab"])]),_:1},8,["value"])]),_:1})}}}),[["__scopeId","data-v-35812b26"]]),Xo=ae({__name:"index",setup(t){const a=be(()=>c(()=>import("./index196.js?v=1767769852656"),__vite__mapDeps([52,6,2,3,7,4,5,9,8,53,54]))),{t:l}=he(),s=e(),n=st(l("Home.index_1"),{memTotal:0}),r=fe(0),u=fe(null),d=async()=>{try{const{message:e}=await L();i(e)?u.value=e:u.value=null}finally{r.value=Date.now()}},m=je({});Pe(r,e=>{e&&u.value&&Object.entries(m).forEach(([,e])=>{u.value&&e(u.value)})},{immediate:!0});const p=Fe({type:0,show:!1,describe:"",pay:"",route:"",name:"",price:"",ps:[]}),v=Fe({type:1,show:!1,describe:"",route:"",list:[]}),x=Fe([]),_=async()=>{const{message:e}=await z();o(e)&&e.forEach(e=>{0===e.type&&e.show&&(p.value=e),1===e.type&&e.show&&(v.value=e)})},y=async()=>{const{message:e}=await N();x.value=o(e)?e:[]},{loop:f}=qe(d);return ce(aa,{server:u,proRecommend:p,softList:x,softRecommend:v,onServerReady:(e,t)=>{m[e]=t}}),Ne(()=>{(async()=>{await Promise.all([d(),_()]),await Promise.all([y()]),f(),s.isFree&&s.aaPanelPro||u.value&&!1===u.value.installed&&(n.data.memTotal=te(u.value,"mem.memTotal",0),n.show=!0)})(),rt()}),(e,t)=>{const l=Z,i=h,o=Ue,r=ta;return se(),ge(r,null,{default:ye(()=>[xe(ma),oe(s).aaPanelPro?de("",!0):(se(),ge(_a,{key:0})),xe(Ql),xe(So),xe(i,{"x-gap":"16",cols:2},{default:ye(()=>[xe(l,null,{default:ye(()=>[xe(Bo)]),_:1}),xe(l,null,{default:ye(()=>[xe(Wo)]),_:1})]),_:1}),xe(o,{show:oe(n).show,"onUpdate:show":t[0]||(t[0]=e=>oe(n).show=e),title:oe(n).title,data:oe(n).data,width:920,"min-height":572,component:oe(a)},null,8,["show","title","data","component"])]),_:1})}}}),Yo=Object.freeze(Object.defineProperty({__proto__:null,default:Xo},Symbol.toStringTag,{value:"Module"}));export{Vn as H,Wl as a,Yo as i,es as r};
