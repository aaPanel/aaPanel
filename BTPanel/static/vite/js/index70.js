import{k as e,P as a,W as t,w as l,R as s,V as n,a3 as i,U as o,ak as r,j as d,a4 as u,r as c,e as m,a0 as p,a2 as v,S as _,an as h,F as x,O as f,au as k,H as w,I as y,a6 as g,l as b,v as C,o as T,b as j}from"./vue.js?v=1764233927359";import{dF as E,x as I,_ as L,p as S}from"./page_layout.js?v=1764233927359";import{c as U,f as F,a as R,h as P,i as $,d as D,e as B}from"./public.js?v=1764233927359";import{_ as q}from"./index107.js?v=1764233927359";import{_ as z}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1764233927359";import{o as A,d as H,g as K,s as O,l as V,e as W,a as X,b as Y,c as G,u as J,T as M}from"./terminal2.js?v=1764233927359";import{aC as N,dR as Q,au as Z,da as ee,dS as ae}from"./naive.js?v=1764233927359";import{_ as te}from"./index.js?v=1764233927359";import{_ as le}from"./index.vue_vue_type_script_setup_true_lang.js?v=1764233927359";import"./__commonjsHelpers__.js?v=1764233927359";import"./common.js?v=1764233927359";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1764233927359";import"./xterm.js?v=1764233927359";import"./xterm-addon-canvas.js?v=1764233927359";const se=e({__name:"index",setup(e,{expose:c}){const{t:m}=a(),p=E(),{keys:v,columns:_}=U([{key:"host",title:m("Term.index_8"),ellipsis:{tooltip:{width:"trigger"}},render:e=>t("span",{class:"cursor-pointer w-100%",onClick:()=>x(e)},[e.host])},F({width:130,options:e=>[{label:m("Site.TableOP.index_7"),onClick:()=>{const a={title:m("Term.index_22"),data:{isEdit:!0,row:e}};A(a)}},{label:m("Public.Btn.Del"),onClick:()=>{R({title:m("Term.index_6"),content:m("Term.index_7",[e.host]),onConfirm:async({hide:a})=>{await H({host:e.host}),f(),a()}})}}]})]),h=()=>{const e={title:m("Term.index_19"),data:{isEdit:!1}};A(e)},x=e=>{p.server={...e,time:new Date}},f=async()=>{await K()};return l(()=>p.isRefresh,e=>{e&&(p.setRefresh(!1),f())}),c({init:f}),(e,a)=>{const l=N,c=P,m=z;return n(),s("div",null,[t(m,null,{toolsLeft:i(()=>[t(l,{type:"primary",onClick:h},{default:i(()=>[d(u(e.$t("Term.index_19")),1)]),_:1})]),table:i(()=>[t(c,{"checked-row-keys":o(v),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>r(v)?v.value=e:null),loading:o(V),"max-height":"calc(100vh - 250px)",data:o(O),columns:o(_)},null,8,["checked-row-keys","loading","data","columns"])]),_:1})])}}}),ne={class:"p-20px"},ie=e({__name:"form",props:{data:{}},setup(e,{expose:l}){const{t:r}=a(),d=e,{isEdit:u,row:p,getList:v}=d.data,_=c(null),h=m({name:"",content:""}),x={name:{required:!0,message:r("Security.Conf.Index_28"),trigger:["blur","input"]},content:{required:!0,message:r("Security.Conf.Index_28"),trigger:["blur","input"]}};return u&&p&&(h.name=p.title,h.content=p.shell),l({onConfirm:async({hide:e})=>{var a;await(null==(a=_.value)?void 0:a.validate()),u?await W({shell:h.content,title:p?p.title:"",new_title:h.name}):await X({shell:h.content,title:h.name}),null==v||v(),e()}}),(e,a)=>{const l=Z,r=Q,d=le;return n(),s("div",ne,[t(d,{ref_key:"formRef",ref:_,model:o(h),rules:x},{default:i(()=>[t(r,{label:e.$t("Docker.Compose.form.index_3"),path:"name"},{default:i(()=>[t(l,{class:"w-280px!",value:o(h).name,"onUpdate:value":a[0]||(a[0]=e=>o(h).name=e),placeholder:e.$t("Term.idnex_1")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(r,{label:e.$t("Docker.LocalImage.build_5"),path:"content"},{default:i(()=>[t(l,{class:"w-280px!",type:"textarea",rows:6,value:o(h).content,"onUpdate:value":a[1]||(a[1]=e=>o(h).content=e),placeholder:e.$t("Term.index_2")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])])}}}),oe=e({__name:"index",setup(e,{expose:l}){const{t:c}=a(),{keys:m,table:p,columns:v}=U([{key:"title",title:c("Term.index_4"),ellipsis:{tooltip:{width:"trigger"}},render:e=>t("span",{class:"cursor-pointer w-100%",onClick:()=>{_(e.shell)}},[e.title])},F({width:130,options:e=>[{label:c("Public.Btn.Copy"),onClick:()=>{_(e.shell)}},{label:c("Public.Btn.Edit"),onClick:()=>{y(e)}},{label:c("Public.Btn.Del"),onClick:()=>{R({title:c("Term.index_20"),content:c("Term.index_21",[e.title]),onConfirm:async({hide:a})=>{await Y({title:e.title}),f(),a()}})}}]})]),_=e=>{$(e)},{loading:h,setLoading:x}=D(),f=async()=>{try{x(!0);const{message:e}=await G();I(e)&&(p.data=e)}finally{m.value=[],x(!1)}},k=B(c("Term.index_3"),{isEdit:!1,getList:f}),w=()=>{k.data.isEdit=!1,k.title=c("Term.index_3"),k.show=!0},y=e=>{k.data.row=e,k.data.isEdit=!0,k.title=c("Term.index_5"),k.show=!0};return f(),l({init:f}),(e,a)=>{const l=N,c=P,_=z,x=te;return n(),s("div",null,[t(_,null,{toolsLeft:i(()=>[t(l,{type:"primary",onClick:w},{default:i(()=>[d(u(e.$t("Term.index_3")),1)]),_:1})]),table:i(()=>[t(c,{"checked-row-keys":o(m),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>r(m)?m.value=e:null),loading:o(h),"max-height":"calc(100vh - 250px)",data:o(p).data,columns:o(v)},null,8,["checked-row-keys","loading","data","columns"])]),_:1}),t(x,{show:o(k).show,"onUpdate:show":a[1]||(a[1]=e=>o(k).show=e),title:o(k).title,data:o(k).data,width:480,footer:!0,component:ie},null,8,["show","title","data"])])}}}),re=e({__name:"index",setup(e){const{t:l}=a(),i=c("server"),d=[{key:"server",label:l("Term.index_23"),component:se},{key:"command",label:l("Term.index_24"),component:oe}];return(e,a)=>{const l=q;return n(),s("div",null,[t(l,{class:"w-300px!",value:o(i),"onUpdate:value":a[0]||(a[0]=e=>r(i)?i.value=e:null),options:d},null,8,["value"])])}}}),de=["onClick","onContextmenu"],ue=["title"],ce=["onClick"],me=S(e({__name:"menu",setup(e){const l=E(),{isFull:r}=p(l),{activeTerminalId:m,terminals:g,setActiveTerminal:b,onServerList:C}=J(),{t:T}=a(),j=c(0),I=c(0),S=c({id:"",host:"",port:0,ps:"",state:!1}),U=c(!1),F=["Copy session","Close session","Close to right","Close other"],R=()=>{const e={title:T("Term.index_19"),data:{isEdit:!1}};A(e)},P=e=>{var a;const t=m.value===e,l=g.value.findIndex(a=>a.id===e);if(g.value=g.value.filter(a=>a.id!==e),t&&g.value.length>0){const e=l>0?l-1:0;m.value=(null==(a=g.value[e])?void 0:a.id)||"aaaaaaaaa"}else 0===g.value.length&&(m.value="aaaaaaaaa")};return document.addEventListener("click",()=>{U.value=!1}),(e,a)=>{const l=L,c=ee;return n(),v(c,{class:"head gap-0! xterm-head"},{default:i(()=>[(n(!0),s(x,null,f(o(g),e=>(n(),s("div",{key:e.id,class:w(["item",{"item-active":o(m)===e.id}]),onClick:a=>o(b)(e.id),onContextmenu:k(a=>{return t=a,l=e,S.value=l,j.value=t.clientX,I.value=t.clientY,void(U.value=!0);var t,l},["prevent"])},[_("div",{class:"text",title:e.ps},[_("span",{class:w(["icon",{"icon-active":!e.state}])},null,2),d(u(e.ps?e.ps:e.host),1)],8,ue),t(l,{name:"base-close",class:"close-terminal",size:16,onClick:k(a=>P(e.id),["stop"])},null,8,["onClick"])],42,de))),128)),_("div",{class:"add-terminal",onClick:R},[t(l,{name:"base-add",size:24})]),_("div",{class:"absolute right-0px add-terminal",onClick:a[0]||(a[0]=e=>r.value=!o(r))},[t(l,{name:"base-full",size:24})]),o(U)?(n(),s("div",{key:0,class:"context-menu",style:y({top:o(I)+"px",left:o(j)+"px"})},[_("ul",null,[(n(),s(x,null,f(F,(e,a)=>_("li",{key:a,onClick:a=>(e=>{if(!S.value)return;let a;switch(e){case"Copy session":C(S.value);break;case"Close session":P(S.value.id);break;case"Close to right":a=g.value.findIndex(e=>e.id===S.value.id),-1!==a&&(g.value.splice(a+1),setTimeout(()=>{var e;b((null==(e=g.value[a])?void 0:e.id)||"aaaaaaaaa")},20));break;case"Close other":g.value=g.value.filter(e=>e.id===S.value.id),setTimeout(()=>{b(S.value.id)},20)}U.value=!1})(e)},u(e),9,ce)),64))])],4)):h("",!0)]),_:1})}}}),[["__scopeId","data-v-48cd70b1"]]),pe={class:"terminal bg-#333333"},ve=S(e({__name:"index",setup(e){const a=E(),{server:r,isShow:d}=p(a),{activeTerminalId:u,terminals:c,setActiveTerminal:m,onServerList:h}=J(),k=(e,a)=>{c.value=c.value.map(t=>t.id===e?{...t,state:a}:t)};return l(()=>r.value,e=>{null!==e&&h(e)},{deep:!0}),(e,a)=>{const l=ee;return n(),v(l,{vertical:"",class:"gap-0!"},{default:i(()=>[t(me),_("div",pe,[(n(),v(g,null,[(n(!0),s(x,null,f(o(c),e=>b((n(),v(M,{key:e.id,data:e,active:o(u)===e.id,onUpdateFull:o(m),onUpdateState:k},null,8,["data","active","onUpdateFull"])),[[C,e.id===o(u)]])),128))],1024)),_("div",{class:w(["terminal-contract-tool",{active:!o(d)}]),onClick:a[0]||(a[0]=e=>d.value=!o(d))},null,2)])]),_:1})}}}),[["__scopeId","data-v-d780d510"]]),_e={class:"p-16px box"},he=S(e({__name:"index",setup(e){const a=E(),{isShow:r,isFull:d}=p(a),u=c(null);l(()=>d.value,e=>{var a;e?(r.value=!1,null==(a=u.value)||a.requestFullscreen()):document.exitFullscreen().catch(e=>{console.log(e.message)})});const m=()=>{document.fullscreenElement?d.value=!0:d.value=!1};return T(()=>{document.addEventListener("fullscreenchange",m)}),j(()=>{document.removeEventListener("fullscreenchange",m)}),(e,a)=>{const l=ee,d=ae;return n(),s("div",_e,[t(d,{class:"p-16px h-100%"},{default:i(()=>[_("div",{class:"h-100%",ref_key:"contentRef",ref:u},[t(l,{class:"flex-nowrap! h-100%"},{default:i(()=>[t(ve,{class:"flex-1 overflow-hidden"}),b(t(re,null,null,512),[[C,o(r)]])]),_:1})],512)]),_:1})])}}}),[["__scopeId","data-v-57762b9d"]]);export{he as default};
