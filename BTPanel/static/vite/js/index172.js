import{_ as e}from"./index109.js?v=1767769852656";import{_ as a}from"./index104.js?v=1767769852656";import{_ as l}from"./index.vue_vue_type_script_setup_true_lang.js?v=1767769852656";import{k as s,P as o,e as n,r as c,c as t,R as d,V as m,W as r,S as u,a3 as i,U as p,aj as _,j as g,a4 as v,ak as x}from"./vue.js?v=1767769852656";import{bt as f,h as k,m as b,bG as D,x as y,gh as h}from"./page_layout.js?v=1767769852656";import{C as I}from"./public.js?v=1767769852656";import{dR as L,dV as j,av as w,au as C,aC as $}from"./naive.js?v=1767769852656";import"./__commonjsHelpers__.js?v=1767769852656";import"./common.js?v=1767769852656";const R={class:"pt-4px"},U={class:"w-440px"},E={class:"w-440px"},M={class:"px-2px py-4px"},V={class:"h-420px"},G=s({__name:"index",setup(e){const{t:s}=o(),x=f(),h=n({name:null,image:""}),G={name:{trigger:"change",validator:()=>null!==h.name||new Error(s("Docker.LocalImage.pull.index_8"))},image:{trigger:["input","blur"],validator:()=>""!==h.image||new Error(s("Docker.LocalImage.pull.index_9"))}},H=c(null),K=c(s("Docker.LocalImage.pull.index_10")),P=c(!1),S=c([]),W=async()=>{var e;await(null==(e=H.value)?void 0:e.validate()),K.value="",q.value=!0,A(),J()},q=c(!1),z=t(()=>q.value),{open:A,send:B,close:F}=I("/ws_model",{immediate:!1,onMessage:(e,a)=>{const{data:l}=a;if(k(l)&&(K.value+=a.data,l.includes("successful")||l.includes("failed"))){q.value=!1;const e={status:l.includes("successful"),msg:l.includes("successful")?s("Docker.Container.create.command_7"):s("Docker.Container.create.command_6")};e.status?(b.success(e.msg),x.setRefresh(!0)):b.error(e.msg),F()}}}),J=()=>{B({model_index:"btdocker",mod_name:"image",def_name:"pull_from_some_registry",ws_callback:111,name:h.name,image:h.image})};return(async()=>{try{P.value=!0;const{message:e}=await D();y(e)&&e.length>0&&(S.value=e.map(e=>({label:e.name,value:e.name})),h.name=e[0].name)}finally{P.value=!1}})(),(e,s)=>{const o=j,n=L,c=C,t=$,x=w,f=l,k=a;return m(),d("div",R,[r(f,{ref_key:"formRef",ref:H,model:p(h),rules:G},{default:i(()=>[r(n,{label:e.$t("Docker.LocalImage.pull.index_3"),path:"name"},{default:i(()=>[u("div",U,[r(o,{value:p(h).name,"onUpdate:value":s[0]||(s[0]=e=>p(h).name=e),loading:p(P),disabled:p(z),options:p(S)},null,8,["value","loading","disabled","options"])])]),_:1},8,["label"]),r(n,{label:e.$t("Docker.LocalImage.pull.index_4"),path:"image"},{default:i(()=>[u("div",E,[r(x,null,{default:i(()=>[r(c,{value:p(h).image,"onUpdate:value":s[1]||(s[1]=e=>p(h).image=e),disabled:p(z),placeholder:e.$t("Docker.LocalImage.pull.index_5"),onKeyup:_(W,["enter"])},null,8,["value","disabled","placeholder"]),r(t,{type:"primary",disabled:p(z),onClick:W},{default:i(()=>[g(v(e.$t("Docker.LocalImage.pull.index_6")),1)]),_:1},8,["disabled"])]),_:1})])]),_:1},8,["label"])]),_:1},8,["model"]),u("div",M,v(e.$t("Docker.LocalImage.pull.index_7")),1),u("div",V,[r(k,{log:p(K)},null,8,["log"])])])}}}),H={class:"pt-4px"},K={class:"px-2px py-4px"},P={class:"h-456px"},S=s({__name:"index",setup(e){const{t:l}=o(),s=f(),_=n({cmd:""}),x=c(l("Docker.LocalImage.pull.index_10")),D=c(!1),y=t(()=>D.value),L=async()=>{if(""!==_.cmd.trim())try{D.value=!0,x.value=l("Docker.Container.create.command_8"),await h({cmd:_.cmd}),j(),E()}catch(e){D.value=!1,console.error(e)}else b.error(l("Docker.LocalImage.pull.index_13"))},{open:j,send:R,close:U}=I("/ws_model",{immediate:!1,onMessage:(e,a)=>{const{data:o}=a;if(k(o)&&(x.value+=a.data,o.includes("bt_successful")||o.includes("bt_failed"))){D.value=!1;const e={status:o.includes("bt_successful"),msg:o.includes("bt_successful")?l("Docker.Container.create.command_7"):l("Docker.Container.create.command_6")};e.status?(b.success(e.msg),s.setRefresh(!0)):b.error(e.msg),U()}}}),E=()=>{R({model_index:"btdocker",mod_name:"image",def_name:"get_cmd_log",ws_callback:111,name:"",image:""})};return(e,l)=>{const s=C,o=$,n=w,c=a;return m(),d("div",H,[r(n,{class:"mb-16px"},{default:i(()=>[r(s,{value:p(_).cmd,"onUpdate:value":l[0]||(l[0]=e=>p(_).cmd=e),disabled:p(y),placeholder:e.$t("Docker.LocalImage.pull.index_11")},null,8,["value","disabled","placeholder"]),r(o,{type:"primary",disabled:p(y),onClick:L},{default:i(()=>[g(v(e.$t("Docker.LocalImage.pull.index_12")),1)]),_:1},8,["disabled"])]),_:1}),u("div",K,v(e.$t("Docker.LocalImage.pull.index_7")),1),u("div",P,[r(c,{log:p(x)},null,8,["log"])])])}}}),W={class:"p-16px"},q=s({__name:"index",setup(a){const{t:l}=o(),s=c("normal"),n=[{key:"normal",label:l("Docker.LocalImage.pull.index_1"),component:G},{key:"command",label:l("Docker.LocalImage.pull.index_2"),component:S}];return(a,l)=>{const o=e;return m(),d("div",W,[r(o,{value:p(s),"onUpdate:value":l[0]||(l[0]=e=>x(s)?s.value=e:null),options:n},null,8,["value"])])}}});export{q as default};
