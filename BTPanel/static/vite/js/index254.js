const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index271.js?v=1763625242172","js/index107.js?v=1763625242172","js/vue.js?v=1763625242172","js/__commonjsHelpers__.js?v=1763625242172","js/naive.js?v=1763625242172","js/common.js?v=1763625242172","js/page_layout.js?v=1763625242172","js/public.js?v=1763625242172","css/public.css?v=1763625242172","css/page_layout.css?v=1763625242172","css/index21.css?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang5.js?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang6.js?v=1763625242172","css/index15.css?v=1763625242172","js/index87.js?v=1763625242172","js/index132.js?v=1763625242172","css/index23.css?v=1763625242172","js/index.js?v=1763625242172","css/index110.css?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang7.js?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang12.js?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang8.js?v=1763625242172","js/index130.js?v=1763625242172","js/php.js?v=1763625242172","js/soft.js?v=1763625242172","js/site.js?v=1763625242172","css/index22.css?v=1763625242172","js/site4.js?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang15.js?v=1763625242172","js/index245.js?v=1763625242172","css/index59.css?v=1763625242172","js/index99.js?v=1763625242172","css/index14.css?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang.js?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang10.js?v=1763625242172","js/index98.js?v=1763625242172","css/index13.css?v=1763625242172","js/index100.js?v=1763625242172","js/theme-monokai.js?v=1763625242172","js/file.js?v=1763625242172","css/index16.css?v=1763625242172","js/refersh.js?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang17.js?v=1763625242172","js/index104.js?v=1763625242172","css/index19.css?v=1763625242172","js/ssl.js?v=1763625242172","js/cert.js?v=1763625242172","js/ssl-lets-progress.js?v=1763625242172","css/ssl-lets-progress.css?v=1763625242172","js/utils3.js?v=1763625242172","js/index217.js?v=1763625242172","js/paypal-js.js?v=1763625242172","css/index48.css?v=1763625242172","js/upload.js?v=1763625242172","css/index60.css?v=1763625242172","js/index272.js?v=1763625242172"])))=>i.map(i=>d[i]);
import{bf as e,i as t,c as a,bj as l,p as s,m as i,x as n,bX as o,a as u,_ as r}from"./page_layout.js?v=1763625242172";import{_ as d}from"./index.js?v=1763625242172";import{u as p}from"./useModal2.js?v=1763625242172";import{d as c,c as _,h as m,f as h,a as f,_ as v,v as w,e as x,F as g,q as y}from"./public.js?v=1763625242172";import{Y as b,aG as j}from"./site.js?v=1763625242172";import{i as k,j as P,k as C,u as O,s as R,l as W,n as D,p as z}from"./index87.js?v=1763625242172";import{_ as q}from"./index107.js?v=1763625242172";import{p as M,i as U,k as F,X as $,R as A,S as B,V as L,U as E,a2 as T,a3 as H,q as S,P as V,r as I,aj as K,ak as N,j as X,a4 as G,t as J,an as Y,e as Q,_ as Z}from"./vue.js?v=1763625242172";import{dj as ee,dl as te,dd as ae,au as le,aC as se,dk as ie,bJ as ne}from"./naive.js?v=1763625242172";import{_ as oe}from"./form.vue_vue_type_script_setup_true_lang2.js?v=1763625242172";import"./common.js?v=1763625242172";import"./__commonjsHelpers__.js?v=1763625242172";import"./index132.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang12.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1763625242172";import"./index130.js?v=1763625242172";import"./php.js?v=1763625242172";import"./soft.js?v=1763625242172";import"./site4.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang15.js?v=1763625242172";import"./index245.js?v=1763625242172";import"./index99.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang10.js?v=1763625242172";import"./index98.js?v=1763625242172";import"./index100.js?v=1763625242172";import"./theme-monokai.js?v=1763625242172";import"./file.js?v=1763625242172";import"./refersh.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang17.js?v=1763625242172";import"./index104.js?v=1763625242172";import"./ssl.js?v=1763625242172";import"./cert.js?v=1763625242172";import"./ssl-lets-progress.js?v=1763625242172";import"./utils3.js?v=1763625242172";import"./index217.js?v=1763625242172";import"./paypal-js.js?v=1763625242172";import"./upload.js?v=1763625242172";const ue=Symbol("server-list");function re(){return U(ue)}const de=a=>e.post("/tamper_core/add_black_exts.json",a,{requestOptions:{loading:t.global.t("WP.api.tamper_2"),isOriginalResult:!0,prefix:""}}),pe=a=>e.post("/tamper_core/remove_black_exts.json",a,{requestOptions:{loading:t.global.t("WP.api.tamper_3"),isOriginalResult:!0,prefix:""}}),ce=F({__name:"index",setup(s,{expose:i}){const{site:n,setPid:o}=re(),{loading:u,setLoading:r}=c(),{table:d,columns:p}=_([{key:"name",title:"Name"},{key:"status",title:"Status",align:"right",render:l=>$(ee,{value:l.status,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async s=>{const{message:i}=await(n={key:l.key,value:s,path_id:l.id},e.post("/tamper_core/modify_path_config.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_1"),isOriginalResult:!0,prefix:""}}));var n;a(i)&&i.status&&(l.status=s)}},null)}]),h=[{title:"Create file",name:"create"},{title:"Modify file",name:"modify"},{title:"Delete file",name:"unlink"},{title:"Create directory",name:"mkdir"},{title:"Delete directory",name:"rmdir"},{title:"Rename file",name:"rename"},{title:"Create soft link",name:"link"},{title:"Modify permissions",name:"chmod"},{title:"Modify owner",name:"chown"}],f=async()=>{try{r(!0);const{message:t}=await k({path:n.path});a(t)&&!te(t)?(o(t.pid),e=t,d.data=h.map((t=>{const a="is_".concat(t.name),s=e[a];return{key:a,id:e.pid,name:"Disabled ".concat(t.title),status:l(s)?s:0}}))):d.data=[]}finally{r(!1)}var e};return f(),i({init:f}),(e,t)=>{const a=m;return A(),B("div",null,[$(a,{loading:L(u),"loading-num":9,"max-height":340,data:L(d).data,columns:L(p)},null,8,["loading","data","columns"]),t[0]||(t[0]=E("div",{class:"mt-16px text-#777"}," Tip: Current config intercepts the above rules by default, please set and config the rules according the current project requirements. ",-1))])}}});const _e=s({},[["render",function(e,t){const a=ae;return A(),T(a,{size:"small",bordered:!1},{default:H((()=>[S(e.$slots,"default",{},void 0,!0)])),_:3})}],["__scopeId","data-v-c6193199"]]),me={class:"flex mb-12px"},he={class:"w-240px mr-12px"},fe=F({__name:"index",setup(e,{expose:t}){const{t:l}=V(),{site:s,setPid:o}=re(),u=I("");let r=-1,d="";const p=async()=>{if(""===u.value.trim())return void i.error("Please enter suffix");const{message:e}=await de({path_id:r,path:d,exts:u.value});a(e)&&(e.status?(i.success(e.msg),u.value="",j()):i.error(e.msg))},{table:w,columns:x}=_([{key:"exts",title:"Suffix"},h({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async e=>{f({title:"Delete protected file suffix [".concat(e.exts,"]"),content:"Delete protected file suffix, the file whose file name ends with this suffix will lose protection. want to continue?",onConfirm:async()=>{const{message:t}=await pe({path_id:e.id,path:d,exts:e.exts});a(t)&&(t.status?(i.success(t.msg),j()):i.error(t.msg))}})},{loading:y,setLoading:b}=c(),j=async()=>{try{b(!0);const{message:t}=await k({path:s.path});a(t)&&(o(t.pid),r=(e=t).pid,d=e.path,n(e.black_exts)?w.data=e.black_exts.filter((e=>"/"!=e[0]&&-1==e.indexOf("./"))).map((t=>({id:e.pid,exts:t}))):w.data=[])}finally{b(!1)}var e};return j(),t({init:j}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return A(),B("div",null,[E("div",me,[E("div",he,[$(a,{value:L(u),"onUpdate:value":t[0]||(t[0]=e=>K(u)?u.value=e:null),placeholder:"Suffix",onKeyup:N(p,["enter"])},null,8,["value"])]),$(l,{type:"primary",onClick:p},{default:H((()=>[X(G(e.$t("Public.Btn.Add")),1)])),_:1})]),$(s,{loading:L(y),"loading-num":6,"max-height":230,data:L(w).data,columns:L(x)},null,8,["loading","data","columns"]),$(n,{class:"mt-16px"},{default:H((()=>[t[25]||(t[25]=E("li",null," The so-called file suffix refers the string at the end of the file name, not necessarily the extension ",-1)),E("li",null,[t[5]||(t[5]=X(" As: ")),$(i,null,{default:H((()=>t[1]||(t[1]=[X(".php")]))),_:1,__:[1]}),t[6]||(t[6]=X(", ")),$(i,null,{default:H((()=>t[2]||(t[2]=[X(".html")]))),_:1,__:[2]}),t[7]||(t[7]=X(", ")),$(i,null,{default:H((()=>t[3]||(t[3]=[X(".js?v=1763625242172")]))),_:1,__:[3]}),t[8]||(t[8]=X(", ")),$(i,null,{default:H((()=>t[4]||(t[4]=[X("index.php")]))),_:1,__:[4]}),t[9]||(t[9]=X(" etc. "))]),t[26]||(t[26]=E("div",null,"Example:",-1)),E("li",null,[$(i,null,{default:H((()=>t[10]||(t[10]=[X(".php")]))),_:1,__:[10]}),t[14]||(t[14]=X(" Match: ")),$(i,null,{default:H((()=>t[11]||(t[11]=[X("./1.php")]))),_:1,__:[11]}),t[15]||(t[15]=X()),$(i,null,{default:H((()=>t[12]||(t[12]=[X("./test/2.php")]))),_:1,__:[12]}),t[16]||(t[16]=X(" Mismatch: ")),$(i,null,{default:H((()=>t[13]||(t[13]=[X("./1.php/1.txt")]))),_:1,__:[13]})]),E("li",null,[$(i,null,{default:H((()=>t[17]||(t[17]=[X("index.php")]))),_:1,__:[17]}),t[22]||(t[22]=X(" Match: ")),$(i,null,{default:H((()=>t[18]||(t[18]=[X("./index.php")]))),_:1,__:[18]}),t[23]||(t[23]=X()),$(i,null,{default:H((()=>t[19]||(t[19]=[X("./test/index.php")]))),_:1,__:[19]}),$(i,{class:"ml-0.5em"},{default:H((()=>t[20]||(t[20]=[X("./abc_index.php")]))),_:1,__:[20]}),t[24]||(t[24]=X(" Mismatch: ")),$(i,null,{default:H((()=>t[21]||(t[21]=[X("./index.php.tar.gz")]))),_:1,__:[21]})])])),_:1,__:[25,26]})])}}}),ve={class:"flex mb-12px"},we={class:"w-240px mr-12px"},xe=F({__name:"index",setup(e,{expose:t}){const{t:l}=V(),{site:s,setPid:o}=re(),u=I("");let r=-1,d="";const p=async()=>{if(""===u.value.trim())return void i.error("Please enter the full path or relative path of the file");const{message:e}=await de({path_id:r,path:d,exts:u.value});a(e)&&(e.status?(i.success(e.msg),u.value="",j()):i.error(e.msg))},{table:w,columns:x}=_([{key:"exts",title:"Full file path"},h({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async e=>{f({title:"Delete protected files [".concat(e.exts,"]"),content:"After deleting a protected file, the file will be unprotected, should I continue the operation?",onConfirm:async()=>{const{message:t}=await pe({path_id:e.id,path:d,exts:e.exts});a(t)&&(t.status?(i.success(t.msg),j()):i.error(t.msg))}})},{loading:y,setLoading:b}=c(),j=async()=>{try{b(!0);const{message:t}=await k({path:s.path});a(t)&&(o(t.pid),r=(e=t).pid,d=e.path,n(e.black_exts)?w.data=e.black_exts.filter((e=>"/"==e[0]||"."==e[0]&&"/"==e[1])).map((t=>({id:e.pid,exts:t}))):w.data=[])}finally{b(!1)}var e};return j(),t({init:j}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return A(),B("div",null,[E("div",ve,[E("div",we,[$(a,{value:L(u),"onUpdate:value":t[0]||(t[0]=e=>K(u)?u.value=e:null),placeholder:"Full path Or Relative path",onKeyup:N(p,["enter"])},null,8,["value"])]),$(l,{type:"primary",onClick:p},{default:H((()=>[X(G(e.$t("Public.Btn.Add")),1)])),_:1})]),$(s,{loading:L(y),"loading-num":5,"max-height":200,data:L(w).data,columns:L(x)},null,8,["loading","data","columns"]),$(n,{class:"mt-16px"},{default:H((()=>[t[15]||(t[15]=E("li",{class:"font-bold text-#333"},"The following 4 methods are supported",-1)),E("li",null,[t[2]||(t[2]=X("1. Complete file path, such as: ")),$(i,null,{default:H((()=>t[1]||(t[1]=[X("/www/wwwroot/test/123.log")]))),_:1,__:[1]})]),E("li",null,[t[5]||(t[5]=X(" 2. Relative path to the site, such as: Full path ")),$(i,null,{default:H((()=>t[3]||(t[3]=[X("/www/wwwroot/test/app/123.log")]))),_:1,__:[3]}),t[6]||(t[6]=X(" Relative path ")),$(i,null,{default:H((()=>t[4]||(t[4]=[X("./app/123.log")]))),_:1,__:[4]})]),E("li",null,[t[9]||(t[9]=X(" 3. All files in the specified directory, such as: ")),$(i,null,{default:H((()=>t[7]||(t[7]=[X("/www/wwwroot/test/app/*")]))),_:1,__:[7]}),t[10]||(t[10]=X(" Relative path ")),$(i,null,{default:H((()=>t[8]||(t[8]=[X("./app/*")]))),_:1,__:[8]})]),E("li",null,[t[13]||(t[13]=X(" 4. the specified directory under the specified file type, such as: ")),$(i,null,{default:H((()=>t[11]||(t[11]=[X("/www/wwwroot/test/app/*.log")]))),_:1,__:[11]}),t[14]||(t[14]=X(" Relative path ")),$(i,null,{default:H((()=>t[12]||(t[12]=[X("./app/*.log")]))),_:1,__:[12]})]),t[16]||(t[16]=E("li",{class:"text-error"}," Note: files already included in the protected file suffix do not need to be set. ",-1))])),_:1,__:[15,16]})])}}}),ge={class:"flex mb-12px"},ye={class:"w-240px mr-12px"},be=F({__name:"index",setup(l,{expose:s}){const{t:o}=V(),{site:u,setPid:r}=re(),d=I("");let p=-1,x="";const g=async()=>{if(""===d.value.trim())return void i.error("Please enter directory name");const{message:l}=await(s={path_id:p,path:x,dirnames:d.value},e.post("/tamper_core/add_white_dirs.json",s,{requestOptions:{loading:t.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;a(l)&&(l.status?(i.success(l.msg),d.value="",O()):i.error(l.msg))},{table:y,columns:b}=_([{key:"dir",title:"Directory",ellipsis:{tooltip:!0}},w({title:"Remark",onBlur:async(l,s)=>{const{message:n}=await(o={path_id:s.id,dir_name:s.dir,ps:l},e.post("/tamper_core/set_white_dir_with_ps.json",o,{requestOptions:{loading:t.global.t("WP.api.tamper_5"),isOriginalResult:!0,prefix:""}}));var o;a(n)&&(n.status?s.ps=l:i.error(n.msg))}}),h({width:80,options:e=>[{label:o("Public.Btn.Del"),onClick:()=>{j(e)}}]})]),j=async l=>{f({title:"Delete directory whitelist",content:l.tip_msg?l.tip_msg:"Delete [".concat(l.dir,"] later, All files in the directory will be protected, continue?"),onConfirm:async()=>{const{message:s}=await(n={path_id:l.id,path:x,dirname:l.dir},e.post("/tamper_core/remove_white_dirs.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var n;a(s)&&(s.status?(i.success(s.msg),O()):i.error(s.msg))}})},{loading:P,setLoading:C}=c(),O=async()=>{try{C(!0);const{message:t}=await k({path:u.path});a(t)&&(r(t.pid),p=(e=t).pid,x=e.path,n(e.white_dirs)?y.data=e.white_dirs.map((t=>({id:e.pid,ps:t.ps||"",tip_msg:t.tip_msg||"",...t}))):y.data=[])}finally{C(!1)}var e};return O(),s({init:O}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return A(),B("div",null,[E("div",ge,[E("div",ye,[$(a,{value:L(d),"onUpdate:value":t[0]||(t[0]=e=>K(d)?d.value=e:null),placeholder:"Directory name",onKeyup:N(g,["enter"])},null,8,["value"])]),$(l,{type:"primary",onClick:g},{default:H((()=>[X(G(e.$t("Public.Btn.Add")),1)])),_:1})]),$(s,{loading:L(P),"loading-num":5,"max-height":188,data:L(y).data,columns:L(b)},null,8,["loading","data","columns"]),$(n,{class:"mt-16px"},{default:H((()=>[E("li",null,[t[4]||(t[4]=X(" Full path or directory name or parts path are allowed such as: ")),$(i,null,{default:H((()=>t[1]||(t[1]=[X("/www/abc/cache/test/")]))),_:1,__:[1]}),t[5]||(t[5]=X(", ")),$(i,null,{default:H((()=>t[2]||(t[2]=[X("test")]))),_:1,__:[2]}),t[6]||(t[6]=X(", ")),$(i,null,{default:H((()=>t[3]||(t[3]=[X("cache/test/")]))),_:1,__:[3]})]),E("li",null,[t[10]||(t[10]=X(" The first character of the Full path must be ")),$(i,null,{default:H((()=>t[7]||(t[7]=[X("/")]))),_:1,__:[7]}),t[11]||(t[11]=X(", as: ")),$(i,null,{default:H((()=>t[8]||(t[8]=[X("cache/test/")]))),_:1,__:[8]}),t[12]||(t[12]=X(" or ")),$(i,null,{default:H((()=>t[9]||(t[9]=[X("test")]))),_:1,__:[9]})]),E("li",null,[t[15]||(t[15]=X(" art of directory name or path cannot begin with ")),$(i,null,{default:H((()=>t[13]||(t[13]=[X("/")]))),_:1,__:[13]}),t[16]||(t[16]=X(", as: ")),$(i,null,{default:H((()=>t[14]||(t[14]=[X("/www/abc/cache/test/")]))),_:1,__:[14]})]),t[39]||(t[39]=E("div",null,"Example:",-1)),E("li",null,[$(i,null,{default:H((()=>t[17]||(t[17]=[X("/www/abc/")]))),_:1,__:[17]}),t[21]||(t[21]=X(" Match: ")),$(i,null,{default:H((()=>t[18]||(t[18]=[X("/www/abc/*")]))),_:1,__:[18]}),t[22]||(t[22]=X(" Mismatch: ")),$(i,null,{default:H((()=>t[19]||(t[19]=[X("/www/abc")]))),_:1,__:[19]}),$(i,{class:"ml-0.5em"},{default:H((()=>t[20]||(t[20]=[X("/www/abc123")]))),_:1,__:[20]})]),E("li",null,[$(i,null,{default:H((()=>t[23]||(t[23]=[X("test")]))),_:1,__:[23]}),t[27]||(t[27]=X(" Match: ")),$(i,null,{default:H((()=>t[24]||(t[24]=[X("/www/test/1.txt")]))),_:1,__:[24]}),t[28]||(t[28]=X()),$(i,null,{default:H((()=>t[25]||(t[25]=[X("/www/test_abc")]))),_:1,__:[25]}),t[29]||(t[29]=X(" Mismatch: ")),$(i,null,{default:H((()=>t[26]||(t[26]=[X("/www/1.php")]))),_:1,__:[26]})]),E("li",null,[$(i,null,{default:H((()=>t[30]||(t[30]=[X("cache/test/")]))),_:1,__:[30]}),t[35]||(t[35]=X(" Match: ")),$(i,null,{default:H((()=>t[31]||(t[31]=[X("/www/cache/test/1.txt")]))),_:1,__:[31]}),t[36]||(t[36]=X()),$(i,null,{default:H((()=>t[32]||(t[32]=[X("/cache/test/")]))),_:1,__:[32]}),t[37]||(t[37]=X(" Mismatch: ")),$(i,null,{default:H((()=>t[33]||(t[33]=[X("/www/cache/test")]))),_:1,__:[33]}),t[38]||(t[38]=X()),$(i,null,{default:H((()=>t[34]||(t[34]=[X("/cache/")]))),_:1,__:[34]})])])),_:1,__:[39]})])}}}),je={class:"flex mb-12px"},ke={class:"w-240px mr-12px"},Pe=F({__name:"index",setup(l,{expose:s}){const{t:o}=V(),{site:u,setPid:r}=re(),d=I("");let p=-1,w="";const x=async()=>{if(""===d.value.trim())return void i.error("Please enter file name");const{message:l}=await(s={path_id:p,path:w,filename:d.value},e.post("/tamper_core/add_white_files.json",s,{requestOptions:{loading:t.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;a(l)&&(l.status?(i.success(l.msg),d.value="",C()):i.error(l.msg))},{table:g,columns:y}=_([{key:"filename",title:"File name"},h({width:100,options:e=>[{label:o("Public.Btn.Del"),onClick:()=>{b(e)}}]})]),b=async l=>{f({title:"Delete file whitelist [".concat(l.filename,"]"),content:"After Delete whitelist, the file will be protected. want to continue?",onConfirm:async()=>{const{message:s}=await(n={path_id:l.id,path:w,filename:l.filename},e.post("/tamper_core/remove_white_files.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var n;a(s)&&(s.status?(i.success(s.msg),C()):i.error(s.msg))}})},{loading:j,setLoading:P}=c(),C=async()=>{try{P(!0);const{message:t}=await k({path:u.path});a(t)&&(r(t.pid),p=(e=t).pid,w=e.path,n(e.white_files)?g.data=e.white_files.map((t=>({id:e.pid,filename:t}))):g.data=[])}finally{P(!1)}var e};return C(),s({init:C}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return A(),B("div",null,[E("div",je,[E("div",ke,[$(a,{value:L(d),"onUpdate:value":t[0]||(t[0]=e=>K(d)?d.value=e:null),placeholder:"File name",onKeyup:N(x,["enter"])},null,8,["value"])]),$(l,{type:"primary",onClick:x},{default:H((()=>[X(G(e.$t("Public.Btn.Add")),1)])),_:1})]),$(s,{loading:L(j),"loading-num":6,"max-height":230,data:L(g).data,columns:L(y)},null,8,["loading","data","columns"]),$(n,{class:"mt-16px"},{default:H((()=>[E("li",null,[t[3]||(t[3]=X(" Full path or single filename are allowed such as: ")),$(i,null,{default:H((()=>t[1]||(t[1]=[X("/test/index.php")]))),_:1,__:[1]}),t[4]||(t[4]=X(", ")),$(i,null,{default:H((()=>t[2]||(t[2]=[X("index.php")]))),_:1,__:[2]})]),t[17]||(t[17]=E("li",null,"Note: Only be an absolute path or file name, relative paths are not supported",-1)),t[18]||(t[18]=E("div",null,"Example:",-1)),E("li",null,[$(i,null,{default:H((()=>t[5]||(t[5]=[X("index.php")]))),_:1,__:[5]}),t[10]||(t[10]=X(" Match: ")),$(i,null,{default:H((()=>t[6]||(t[6]=[X("./index.php")]))),_:1,__:[6]}),t[11]||(t[11]=X()),$(i,null,{default:H((()=>t[7]||(t[7]=[X("./test/index.php")]))),_:1,__:[7]}),t[12]||(t[12]=X(" Mismatch: ")),$(i,null,{default:H((()=>t[8]||(t[8]=[X("./abc_index.php")]))),_:1,__:[8]}),t[13]||(t[13]=X()),$(i,null,{default:H((()=>t[9]||(t[9]=[X("./index.php/1.txt")]))),_:1,__:[9]})]),E("li",null,[$(i,null,{default:H((()=>t[14]||(t[14]=[X("/test/index.php")]))),_:1,__:[14]}),t[16]||(t[16]=X(" match only: ")),$(i,null,{default:H((()=>t[15]||(t[15]=[X("/test/index.php")]))),_:1,__:[15]})])])),_:1,__:[17,18]})])}}}),Ce={class:"p-20px"},Oe={class:"flex items-center text-12px text-#666"},Re={key:0,class:"ml-12px"},We={class:"h-500px"},De=F({__name:"index",props:{open:{type:Boolean,default:!1},site:{}},emits:["changeOpen"],setup(e,{emit:t}){const a=e,l=t,s=J(a,"site");let i=-1;const n=I(a.open),o=I(),u=async e=>{e?await P({paths:[{path:s.value.path,ps:s.value.ps}]}):await C({path_id:i}),n.value=e,l("changeOpen",e),o.value.init()},r=I("basic"),d=[{key:"basic",label:"Basic Setting",component:ce},{key:"suffix",label:"Protected file suffix",component:fe},{key:"protected file",label:"Protected File",component:xe},{key:"directory whitelist",label:"Directory whitelist",component:be},{key:"file whitelist",label:"File whitelist",component:Pe}];var p;return p={site:s.value,setPid:e=>{i=e}},M(ue,p),(e,t)=>{const a=ee,l=ie,s=q;return A(),B("div",Ce,[$(l,{class:"mb-16px",type:L(n)?"success":"error","show-icon":!1,bordered:!1},{default:H((()=>[E("div",Oe,[t[1]||(t[1]=E("span",{class:"mr-12px"},"Protection switch",-1)),$(a,{value:L(n),"onUpdate:value":u},null,8,["value"]),L(n)?Y("",!0):(A(),B("span",Re," Protection directory closed, be security risks, Recommended open protection immediately "))])])),_:1},8,["type"]),E("div",We,[$(s,{ref_key:"tabsRef",ref:o,value:L(r),"onUpdate:value":t[0]||(t[0]=e=>K(r)?r.value=e:null),options:d},null,8,["value"])])])}}}),ze=F({__name:"index",props:{site:{}},emits:["changeHotlink"],setup(e,{emit:t}){const a=t,l=J(e,"site"),s=e=>{a("changeHotlink",e)};return(e,t)=>(A(),B("div",null,[$(oe,{class:"p-20px",site:L(l),onChangeHotlink:s},null,8,["site"])]))}}),qe={class:"p-20px"},Me={class:"tools-card"},Ue={class:"tools-img"},Fe={class:"tools-name"},$e={class:"tools-desc"},Ae={class:"ml-0.5em"},Be={class:"tools-card"},Le={class:"tools-img"},Ee={class:"tools-name"},Te={class:"tools-desc"},He={class:"ml-0.5em"},Se={class:"tools-card"},Ve={class:"tools-img"},Ie={class:"tools-name"},Ke={class:"tools-card flex-col!"},Ne={class:"flex items-center! w-full pb-10px"},Xe={class:"tools-name"},Ge={class:"tools-card flex-col!"},Je={class:"flex items-center! w-full pb-10px"},Ye={class:"tools-name min-w-auto!"},Qe=s(F({__name:"index",props:{site:{}},setup(e){const t=Z((()=>u((()=>import("./index271.js?v=1763625242172")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54])))),l=Z((()=>u((()=>import("./index272.js?v=1763625242172")),__vite__mapDeps([55,7,6,2,3,4,5,9,8,14,15,16,17,18,11,12,13,19,20,21,22,23,24,25,26,27,28,29,30,31,32,1,10,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54])))),{t:s}=V(),i=J(e,"site"),n=O(),c=Q({status:!1,number:0,pid:-1}),_=I(!1),m=I(!1),h=async e=>{try{_.value=!0;const t=s(e?"WP.index_46":"WP.index_47");f({title:s("WP.index_48"),content:t,onConfirm:async()=>{await R({path:i.value.path}),m.value=e}})}finally{_.value=!1}},v=x(s("WP.index_43")),w=async()=>{v.data.row=i.value,v.show=!0},q=x(),M=async()=>{q.title="".concat(s("WP.index_32")," [").concat(i.value.name,"]"),q.data.site=i.value,q.show=!0},U=I(!1),F=async e=>{try{U.value=!0,await g({source:200}),await y("tamper_core"),e?await P({paths:[{path:i.value.path,ps:i.value.ps}]}):await C({path_id:c.pid}),pe()}finally{U.value=!1}},T=x("File Protection [".concat(i.value.name,"]"),{site:i.value,open:!1,onChangeOpen:e=>{c.status=e}}),S=async()=>{await g({source:200}),await y("tamper_core"),T.data.open=c.status,T.show=!0},K=Q({status:!1,number:0}),N=I(!1),Y=async e=>{try{N.value=!0,await g({source:201}),await y("btwaf"),e?await W({site_name:i.value.name}):await D({site_name:i.value.name}),pe()}finally{n.setRefresh(!0),N.value=!1}},te=async()=>{await g({source:201}),await y("btwaf"),p({row:{siteName:i.value.name},onRefresh:()=>{pe(),n.setRefresh(!0)}})},le=I(!1),ie=I(!1),oe=async e=>{try{ie.value=!0;const{message:t}=await b({id:i.value.id,name:i.value.name},!1);if(a(t)){const a={id:i.value.id,name:i.value.name,fix:t.fix,domains:t.domains,return_rule:t.return_rule,status:e,http_status:"true"===t.http_status};await j(a,!1),le.value=e}}finally{ie.value=!1}},ue=x("Hotlink Protection [".concat(i.value.name,"]"),{site:i.value,onChangeHotlink:e=>{le.value=e}}),re=()=>{ue.show=!0},de=e=>{U.value=e,N.value=e,ie.value=e,_.value=e},pe=async()=>{try{de(!0);const{message:e}=await z({id:i.value.id,path:i.value.path,site_name:i.value.name});if(a(e)&&(c.status=1===e.file_status,c.number=e.file_count,K.status=1===e.firewall_status,K.number=e.firewall_count,le.value=1===e.hotlink_status,m.value=1===e.virus_scanning,1===e.file_status)){const{message:e}=await k({path:i.value.path});a(e)&&(c.pid=e.pid)}}finally{de(!1)}};return pe(),(e,a)=>{const s=ne,i=ee,n=r,u=se,p=ae,f=d;return A(),B("div",qe,[E("div",Me,[E("div",Ue,[$(s,{lazy:!0,"preview-disabled":!0,width:"24",src:"".concat(L(o),"images/soft-ico/ico-tamper_core.png")},null,8,["src"])]),E("div",Fe,G(e.$t("WP.Label.index_5")),1),$(i,{value:L(c).status,loading:L(U),"onUpdate:value":F},null,8,["value","loading"]),$(u,{quaternary:"",size:"small",onClick:S},{default:H((()=>[$(n,{name:"setting",size:"18"})])),_:1}),E("div",$e,[$(p,{type:"error",size:"small",bordered:!1},{default:H((()=>[X(G(L(c).number),1)])),_:1}),E("span",Ae,G(e.$t("WP.Config.index_6")),1)])]),E("div",Be,[E("div",Le,[$(s,{lazy:!0,"preview-disabled":!0,width:"26",src:"".concat(L(o),"images/soft-ico/ico-btwaf.png")},null,8,["src"])]),E("div",Ee,G(e.$t("WP.Label.index_6")),1),$(i,{value:L(K).status,loading:L(N),"onUpdate:value":Y},null,8,["value","loading"]),$(u,{quaternary:"",size:"small",onClick:te},{default:H((()=>[$(n,{name:"setting",size:"18"})])),_:1}),E("div",Te,[$(p,{type:"error",size:"small",bordered:!1},{default:H((()=>[X(G(L(K).number),1)])),_:1}),E("span",He,G(e.$t("WP.Config.index_7")),1)])]),E("div",Se,[E("div",Ve,[$(n,{name:"soft-hotlink",size:"24"})]),E("div",Ie,G(e.$t("WP.Label.index_7")),1),$(i,{value:L(le),loading:L(ie),"onUpdate:value":oe},null,8,["value","loading"]),$(u,{quaternary:"",size:"small",onClick:re},{default:H((()=>[$(n,{name:"setting",size:"18"})])),_:1})]),E("div",Ke,[E("div",Ne,[a[4]||(a[4]=E("div",{class:"tools-img"},[E("i",{class:"i-healthicons:health-vulnerability-through-social-determinants-outline-24px text-26px text-primary!"})],-1)),E("div",Xe,G(e.$t("WP.index_43")),1),$(i,{value:L(m),loading:L(_),"onUpdate:value":h},null,8,["value","loading"]),$(u,{quaternary:"",size:"small",onClick:w},{default:H((()=>[$(n,{name:"setting",size:"18"})])),_:1})]),a[5]||(a[5]=E("div",{class:"w-full color-#999"},"Check plugins and themes for security risks",-1))]),E("div",Ge,[E("div",Je,[a[6]||(a[6]=E("div",{class:"tools-img"},[E("i",{class:"i-material-symbols:library-add-check-outline text-26px text-#20a53a!"})],-1)),E("div",Ye,G(e.$t("WP.TableRow.index_4")),1),$(u,{quaternary:"",size:"small",onClick:M},{default:H((()=>[$(n,{name:"setting",size:"18"})])),_:1})]),a[7]||(a[7]=E("div",{class:"w-full color-#999"}," Check the integrity of the core files of this WP version to ensure they are not infected with malicious viruses! ",-1))]),$(f,{show:L(T).show,"onUpdate:show":a[0]||(a[0]=e=>L(T).show=e),title:L(T).title,data:L(T).data,width:800,component:De},null,8,["show","title","data"]),$(f,{show:L(ue).show,"onUpdate:show":a[1]||(a[1]=e=>L(ue).show=e),title:L(ue).title,data:L(ue).data,component:ze},null,8,["show","title","data"]),$(f,{show:L(v).show,"onUpdate:show":a[2]||(a[2]=e=>L(v).show=e),title:L(v).title,data:L(v).data,width:800,"min-height":500,component:L(t)},null,8,["show","title","data","component"]),$(f,{show:L(q).show,"onUpdate:show":a[3]||(a[3]=e=>L(q).show=e),title:L(q).title,data:L(q).data,width:600,"min-height":190,component:L(l)},null,8,["show","title","data","component"])])}}}),[["__scopeId","data-v-c7bf07c5"]]);export{Qe as default};
