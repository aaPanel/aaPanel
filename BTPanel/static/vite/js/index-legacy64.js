System.register(["./vue-legacy.js?v=1769066082311","./page_layout-legacy.js?v=1769066082311","./naive-legacy.js?v=1769066082311","./public-legacy.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy16.js?v=1769066082311","./__commonjsHelpers__-legacy.js?v=1769066082311","./common-legacy.js?v=1769066082311","./echarts-legacy.js?v=1769066082311"],function(e,t){"use strict";var a,i,r,n,s,o,c,l,u,d,p,f,y,m,h,v,g,S,x,b,_,w,k,M,C,I,j,T,P,E,O,R,z,L,A,$,N,B,D,F,H,q,W,U,Z,V,X,K,Y,J,G,Q,ee;return{setters:[e=>{a=e.Z,i=e.a0,r=e.r,n=e.c,s=e.o,o=e.b,c=e.k,l=e.P,u=e.R,d=e.V,p=e.S,f=e.W,y=e.F,m=e.O,h=e.H,v=e.a4,g=e.U,S=e.a2,x=e.a3,b=e.l,_=e.an,w=e.j,k=e.v,M=e.X,C=e.aG,I=e.y,j=e.s,T=e.I},e=>{P=e.aE,E=e.i,O=e.d,R=e.q,z=e.p,L=e.f,A=e.x,$=e.m,N=e.ap,B=e.aA,D=e.ca,F=e.bs,H=e.br},e=>{q=e.dn,W=e.aC,U=e.bJ,Z=e.dT,V=e.dZ,X=e.de,K=e.dd,Y=e.G},e=>{J=e.C,G=e.a,Q=e.h},e=>{ee=e._},null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".site-security-info .overview-title[data-v-41148346]{display:flex;align-items:center;justify-content:center;gap:10px;font-size:18px;font-weight:700;color:var(--color-text-base)}.site-security-info .overview-icon[data-v-41148346]{color:var(--color-text-base)}.site-security-info .feature-item[data-v-41148346]{display:flex;align-items:flex-start;gap:14px;min-width:0}.site-security-info .feature-icon[data-v-41148346]{flex:0 0 auto;font-size:38px;color:var(--color-primary)}.site-security-info .feature-title[data-v-41148346]{font-size:14px;font-weight:700;color:var(--color-text-base);line-height:1.4}.site-security-info .feature-desc[data-v-41148346]{margin-top:6px;font-size:12px;color:var(--color-text-3);line-height:1.4}.n-button[data-v-bb415a5d]{height:40px;padding:0 36px}.metric-item[data-v-0379de28]{position:relative;padding:24px;line-height:1}.metric-item .metric-label[data-v-0379de28]{margin-bottom:14px;font-weight:700;font-size:16px;color:var(--color-text-4)}.metric-item .metric-value[data-v-0379de28]{margin-bottom:14px;font-weight:700;font-size:20px}.metric-item .metric-value .metric-unit[data-v-0379de28]{font-size:14px}.metric-item .metric-desc[data-v-0379de28]{color:var(--color-text-3)}.metric-item .metric-icon[data-v-0379de28]{position:absolute;top:8px;right:12px;font-size:60px;color:#e9e9e9}.risk-list[data-v-59b580c0]{display:flex;flex-direction:column;gap:16px}.risk-card[data-v-59b580c0]{padding:16px;box-shadow:none}.risk-card__header[data-v-59b580c0]{display:flex;align-items:center;gap:12px}.risk-card__title[data-v-59b580c0]{line-height:1}.risk-card__title.is-low[data-v-59b580c0]{color:var(--color-warning)}.risk-card__title.is-warning[data-v-59b580c0]{color:#fc6d26}.risk-card__title.is-danger[data-v-59b580c0]{color:var(--color-error)}.risk-card__body[data-v-59b580c0]{margin-top:14px;padding:16px;background:var(--color-bg-4);border-radius:2px}.risk-row[data-v-59b580c0]{display:flex;gap:4px;line-height:1}.risk-row__label[data-v-59b580c0]{font-size:12px;font-weight:700;min-width:70px;text-align:right;white-space:nowrap;color:var(--color-text-base)}.risk-row__value[data-v-59b580c0]{font-size:12px;color:var(--color-text-3)}.risk-divider[data-v-59b580c0]{height:1px;margin:8px 0;background-color:var(--color-border)}.risk-empty[data-v-59b580c0]{display:flex;align-items:center;justify-content:center;padding-top:30px;padding-bottom:30px}.security-collapse[data-v-d4aef7d6]{--n-item-margin: 20px 0 0;--n-title-padding: 0;--n-arrow-color: var(--color-text-4)}.security-collapse[data-v-d4aef7d6] .n-collapse-item,.security-collapse[data-v-d4aef7d6] .n-collapse-item .n-collapse-item__header{border:none}.security-collapse[data-v-d4aef7d6] .n-collapse-item .n-collapse-item__header.n-collapse-item__header--active .n-collapse-item__header-main{border-bottom-left-radius:0;border-bottom-right-radius:0}.security-collapse[data-v-d4aef7d6] .n-collapse-item .n-collapse-item__header .n-collapse-item__header-main{width:100%;height:46px;padding:0 20px;background-color:var(--color-bg-4);border-radius:4px}.security-collapse[data-v-d4aef7d6] .n-collapse-item .n-collapse-item__header .n-collapse-item__header-main .n-collapse-item-arrow{margin-left:0}.security-collapse[data-v-d4aef7d6] .n-collapse-item .n-collapse-item__content-wrapper .n-collapse-item__content-inner{padding:10px 20px 20px;background-color:var(--color-bg-4);border-bottom-left-radius:4px;border-bottom-right-radius:4px}.security-collapse__header[data-v-d4aef7d6]{display:flex;align-items:center;width:100%}.security-collapse__left[data-v-d4aef7d6]{display:flex;align-items:center;gap:10px;width:60%;min-width:0}.security-collapse__left .security-collapse__icon[data-v-d4aef7d6]{flex:0 0 auto;font-size:20px;color:var(--color-text-3)}.security-collapse__left .security-collapse__title[data-v-d4aef7d6]{line-height:1;font-size:14px;font-weight:700;color:var(--color-text-base)}.security-collapse__status[data-v-d4aef7d6]{flex:1;font-size:14px}.security-collapse__expand[data-v-d4aef7d6]{margin-right:2px;color:var(--color-text-4)}.site-security-page[data-v-74f36d2b]{display:flex;flex-direction:column;gap:10px;max-width:1370px}\n/*$vite$:1*/",document.head.appendChild(t);const te=a("site-security-store",()=>{const e=r(!1),t=r(""),a=r({score:0,risk_count:{warning:0,low:0,middle:0,high:0}}),i=r([]),s=r(0),o=r({xss:0,sql_injection:0,file_traversal:0,php_execution:0,sensitive_files:0}),c=r({}),l=r({}),u=r({status:"init",msg:"",bar:0,type:""}),d=n(()=>"scanning"===u.value.status);return{isNone:e,scanInfo:u,scanTime:t,isScanning:d,scoreInfo:a,ipTop:i,duration:s,totalAttack:o,details:c,detailsLoading:l,getResult:async()=>{const{message:r}=await P.post("/project/webbasicscanning/get_scan_result");if(O(r)){if(q(r))return void(e.value=!0);e.value=!1,t.value=r.scan_time,a.value={score:r.score,risk_count:r.risk_count},i.value=r.ip_top,s.value=r.duration,o.value=r.total_attack,c.value=r.details,Object.keys(r.details).forEach(e=>{l.value[e]=!1})}else e.value=!0},startScan:()=>{e.value=!1,u.value.status="scanning",u.value.msg="",u.value.bar=0,u.value.type="",Object.keys(l.value).forEach(e=>{l.value[e]=!0}),Object.keys(c.value).forEach(e=>{c.value[e]=[]})},endScan:()=>{u.value.status="init",u.value.msg="",u.value.bar=0,u.value.type="",Object.keys(l.value).forEach(e=>{l.value[e]=!1})},setScanInfo:(e,t)=>{u.value.msg=e,u.value.bar=t},setScanType:e=>{u.value.type=e,l.value[e]=!1},setScanResult:(e,t)=>{c.value[e].push(...t)}}}),ae=()=>{const e=te();return{store:e,...i(e)}};var ie={};!function e(t,a,i,r){var n=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),s="function"==typeof Path2D&&"function"==typeof DOMMatrix,o=function(){if(!t.OffscreenCanvas)return!1;try{var e=new OffscreenCanvas(1,1),a=e.getContext("2d");a.fillRect(0,0,1,1);var i=e.transferToImageBitmap();a.createPattern(i,"no-repeat")}catch(r){return!1}return!0}();function c(){}function l(e){var i=a.exports.Promise,r=void 0!==i?i:t.Promise;return"function"==typeof r?new r(e):(e(c,c),null)}var u,d,p,f,y,m,h,v,g,S,x,b=(u=o,d=new Map,{transform:function(e){if(u)return e;if(d.has(e))return d.get(e);var t=new OffscreenCanvas(e.width,e.height);return t.getContext("2d").drawImage(e,0,0),d.set(e,t),t},clear:function(){d.clear()}}),_=(y=Math.floor(1e3/60),m={},h=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(p=function(e){var t=Math.random();return m[t]=requestAnimationFrame(function a(i){h===i||h+y-1<i?(h=i,delete m[t],e()):m[t]=requestAnimationFrame(a)}),t},f=function(e){m[e]&&cancelAnimationFrame(m[e])}):(p=function(e){return setTimeout(e,y)},f=function(e){return clearTimeout(e)}),{frame:p,cancel:f}),w=(S={},function(){if(v)return v;if(!i&&n){var t=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{v=new Worker(URL.createObjectURL(new Blob([t])))}catch(a){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("ðŸŽŠ Could not load worker",a),null}!function(e){function t(t,a){e.postMessage({options:t||{},callback:a})}e.init=function(t){var a=t.transferControlToOffscreen();e.postMessage({canvas:a},[a])},e.fire=function(a,i,r){if(g)return t(a,null),g;var n=Math.random().toString(36).slice(2);return g=l(function(i){function s(t){t.data.callback===n&&(delete S[n],e.removeEventListener("message",s),g=null,b.clear(),r(),i())}e.addEventListener("message",s),t(a,n),S[n]=s.bind(null,{data:{callback:n}})})},e.reset=function(){for(var t in e.postMessage({reset:!0}),S)S[t](),delete S[t]}}(v)}return v}),k={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function M(e,t,a){return function(e,t){return t?t(e):e}(e&&null!=e[t]?e[t]:k[t],a)}function C(e){return e<0?0:Math.floor(e)}function I(e,t){return Math.floor(Math.random()*(t-e))+e}function j(e){return parseInt(e,16)}function T(e){return e.map(P)}function P(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:j(t.substring(0,2)),g:j(t.substring(2,4)),b:j(t.substring(4,6))}}function E(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function O(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function R(e){var t=e.angle*(Math.PI/180),a=e.spread*(Math.PI/180);return{x:e.x,y:e.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*e.startVelocity+Math.random()*e.startVelocity,angle2D:-t+(.5*a-Math.random()*a),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:e.color,shape:e.shape,tick:0,totalTicks:e.ticks,decay:e.decay,drift:e.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*e.gravity,ovalScalar:.6,scalar:e.scalar,flat:e.flat}}function z(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var a=t.tick++/t.totalTicks,i=t.x+t.random*t.tiltCos,r=t.y+t.random*t.tiltSin,n=t.wobbleX+t.random*t.tiltCos,o=t.wobbleY+t.random*t.tiltSin;if(e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-a)+")",e.beginPath(),s&&"path"===t.shape.type&&"string"==typeof t.shape.path&&Array.isArray(t.shape.matrix))e.fill(function(e,t,a,i,r,n,s){var o=new Path2D(e),c=new Path2D;c.addPath(o,new DOMMatrix(t));var l=new Path2D;return l.addPath(c,new DOMMatrix([Math.cos(s)*r,Math.sin(s)*r,-Math.sin(s)*n,Math.cos(s)*n,a,i])),l}(t.shape.path,t.shape.matrix,t.x,t.y,.1*Math.abs(n-i),.1*Math.abs(o-r),Math.PI/10*t.wobble));else if("bitmap"===t.shape.type){var c=Math.PI/10*t.wobble,l=.1*Math.abs(n-i),u=.1*Math.abs(o-r),d=t.shape.bitmap.width*t.scalar,p=t.shape.bitmap.height*t.scalar,f=new DOMMatrix([Math.cos(c)*l,Math.sin(c)*l,-Math.sin(c)*u,Math.cos(c)*u,t.x,t.y]);f.multiplySelf(new DOMMatrix(t.shape.matrix));var y=e.createPattern(b.transform(t.shape.bitmap),"no-repeat");y.setTransform(f),e.globalAlpha=1-a,e.fillStyle=y,e.fillRect(t.x-d/2,t.y-p/2,d,p),e.globalAlpha=1}else if("circle"===t.shape)e.ellipse?e.ellipse(t.x,t.y,Math.abs(n-i)*t.ovalScalar,Math.abs(o-r)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):function(e,t,a,i,r,n,s,o,c){e.save(),e.translate(t,a),e.rotate(n),e.scale(i,r),e.arc(0,0,1,s,o,c),e.restore()}(e,t.x,t.y,Math.abs(n-i)*t.ovalScalar,Math.abs(o-r)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if("star"===t.shape)for(var m=Math.PI/2*3,h=4*t.scalar,v=8*t.scalar,g=t.x,S=t.y,x=5,_=Math.PI/x;x--;)g=t.x+Math.cos(m)*v,S=t.y+Math.sin(m)*v,e.lineTo(g,S),m+=_,g=t.x+Math.cos(m)*h,S=t.y+Math.sin(m)*h,e.lineTo(g,S),m+=_;else e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(r)),e.lineTo(Math.floor(n),Math.floor(o)),e.lineTo(Math.floor(i),Math.floor(t.wobbleY));return e.closePath(),e.fill(),t.tick<t.totalTicks}function L(e,a){var s,o=!e,c=!!M(a||{},"resize"),u=!1,d=M(a,"disableForReducedMotion",Boolean),p=n&&M(a||{},"useWorker")?w():null,f=o?E:O,y=!(!e||!p||!e.__confetti_initialized),m="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function h(t,a,n){for(var o=M(t,"particleCount",C),c=M(t,"angle",Number),u=M(t,"spread",Number),d=M(t,"startVelocity",Number),p=M(t,"decay",Number),y=M(t,"gravity",Number),m=M(t,"drift",Number),h=M(t,"colors",T),v=M(t,"ticks",Number),g=M(t,"shapes"),S=M(t,"scalar"),x=!!M(t,"flat"),w=function(e){var t=M(e,"origin",Object);return t.x=M(t,"x",Number),t.y=M(t,"y",Number),t}(t),k=o,j=[],P=e.width*w.x,E=e.height*w.y;k--;)j.push(R({x:P,y:E,angle:c,spread:u,startVelocity:d,color:h[k%h.length],shape:g[I(0,g.length)],ticks:v,decay:p,gravity:y,drift:m,scalar:S,flat:x}));return s?s.addFettis(j):(s=function(e,t,a,n,s){var o,c,u=t.slice(),d=e.getContext("2d"),p=l(function(t){function l(){o=c=null,d.clearRect(0,0,n.width,n.height),b.clear(),s(),t()}o=_.frame(function t(){!i||n.width===r.width&&n.height===r.height||(n.width=e.width=r.width,n.height=e.height=r.height),n.width||n.height||(a(e),n.width=e.width,n.height=e.height),d.clearRect(0,0,n.width,n.height),(u=u.filter(function(e){return z(d,e)})).length?o=_.frame(t):l()}),c=l});return{addFettis:function(e){return u=u.concat(e),p},canvas:e,promise:p,reset:function(){o&&_.cancel(o),c&&c()}}}(e,j,f,a,n),s.promise)}function v(a){var i=d||M(a,"disableForReducedMotion",Boolean),r=M(a,"zIndex",Number);if(i&&m)return l(function(e){e()});o&&s?e=s.canvas:o&&!e&&(e=function(e){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=e,t}(r),document.body.appendChild(e)),c&&!y&&f(e);var n={width:e.width,height:e.height};function v(){if(p){var t={getBoundingClientRect:function(){if(!o)return e.getBoundingClientRect()}};return f(t),void p.postMessage({resize:{width:t.width,height:t.height}})}n.width=n.height=null}function g(){s=null,c&&(u=!1,t.removeEventListener("resize",v)),o&&e&&(document.body.contains(e)&&document.body.removeChild(e),e=null,y=!1)}return p&&!y&&p.init(e),y=!0,p&&(e.__confetti_initialized=!0),c&&!u&&(u=!0,t.addEventListener("resize",v,!1)),p?p.fire(a,n,g):h(a,n,g)}return v.reset=function(){p&&p.reset(),s&&s.reset()},v}function A(){return x||(x=L(null,{useWorker:!0,resize:!0})),x}a.exports=function(){return A().apply(this,arguments)},a.exports.reset=function(){A().reset()},a.exports.create=L,a.exports.shapeFromPath=function(e){if(!s)throw new Error("path confetti are not supported in this browser");var t,a;"string"==typeof e?t=e:(t=e.path,a=e.matrix);var i=new Path2D(t),r=document.createElement("canvas").getContext("2d");if(!a){for(var n,o,c=1e3,l=c,u=c,d=0,p=0,f=0;f<c;f+=2)for(var y=0;y<c;y+=2)r.isPointInPath(i,f,y,"nonzero")&&(l=Math.min(l,f),u=Math.min(u,y),d=Math.max(d,f),p=Math.max(p,y));n=d-l,o=p-u;var m=Math.min(10/n,10/o);a=[m,0,0,m,-Math.round(n/2+l)*m,-Math.round(o/2+u)*m]}return{type:"path",path:t,matrix:a}},a.exports.shapeFromText=function(e){var t,a=1,i="#000000",r='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"==typeof e?t=e:(t=e.text,a="scalar"in e?e.scalar:a,r="fontFamily"in e?e.fontFamily:r,i="color"in e?e.color:i);var n=10*a,s=n+"px "+r,o=new OffscreenCanvas(n,n),c=o.getContext("2d");c.font=s;var l=c.measureText(t),u=Math.ceil(l.actualBoundingBoxRight+l.actualBoundingBoxLeft),d=Math.ceil(l.actualBoundingBoxAscent+l.actualBoundingBoxDescent),p=l.actualBoundingBoxLeft+2,f=l.actualBoundingBoxAscent+2;u+=4,d+=4,(c=(o=new OffscreenCanvas(u,d)).getContext("2d")).font=s,c.fillStyle=i,c.fillText(t,p,f);var y=1/a;return{type:"bitmap",bitmap:o.transferToImageBitmap(),matrix:[y,0,0,y,-u*y/2,-d*y/2]}}}(function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:this||{}}(),ie,!1);const re=ie.exports;ie.exports.create;const ne={class:"site-security-info"},se={class:"my-24px"},oe={class:"flex items-center justify-evenly py-20px"},ce={class:"min-w-0"},le={class:"feature-title"},ue={class:"feature-desc"},de={class:"my-24px"},pe={class:"overview-title"},fe=z(c({__name:"info",setup(e){const{t:t}=l(),a=n(()=>[{key:"scan",icon:"i-security:feature-tips",title:t("Security.SiteSecurity.Info.features.scan.title"),desc:t("Security.SiteSecurity.Info.features.scan.desc")},{key:"trojan",icon:"i-security:feature-trojan",title:t("Security.SiteSecurity.Info.features.trojan.title"),desc:t("Security.SiteSecurity.Info.features.trojan.desc")},{key:"log",icon:"i-security:feature-record",title:t("Security.SiteSecurity.Info.features.log.title"),desc:t("Security.SiteSecurity.Info.features.log.desc")}]);return(e,t)=>{const i=R;return d(),u("div",ne,[p("div",se,[f(i)]),p("div",oe,[(d(!0),u(y,null,m(g(a),e=>(d(),u("div",{key:e.key,class:"feature-item"},[p("i",{class:h(["feature-icon",e.icon])},null,2),p("div",ce,[p("div",le,v(e.title),1),p("div",ue,v(e.desc),1)])]))),128))]),p("div",de,[f(i)]),p("div",pe,[t[0]||(t[0]=p("i",{class:"overview-icon i-security:overview"},null,-1)),p("span",null,v(e.$t("Security.SiteSecurity.Info.overviewTitle")),1)]),t[1]||(t[1]=p("div",{class:"flex justify-center mt-24px"},[p("img",{class:"w-900px",src:"/static/vite/images/site-security-bg.png"})],-1))])}}}),[["__scopeId","data-v-41148346"]]),ye={key:0,class:"flex flex-col justify-center items-center w-full h-50px"},me={class:"flex items-center justify-between w-full"},he={class:"flex gap-20px items-center text-14px font-bold"},ve={class:"text-default"},ge={class:"right"},Se={class:"w-full mt-12px"},xe={class:"flex items-center gap-20px justify-between"},be={class:"text-20px font-bold leading-36px"},_e={class:"mt-14px text-14px text-default leading-20px"},we=z(c({__name:"index",setup(e){const{store:t,isNone:a,scoreInfo:i,scanInfo:r,isScanning:n,scanTime:c}=ae(),{t:m}=l(),{trigger:h}=function(){const e=e=>e?e.then(()=>null):Promise.resolve(null);let t=t=>e(re(t));return s(()=>{"undefined"!=typeof window&&(t=t=>e(re(t)))}),o(()=>{}),{trigger:e=>{const a={particleCount:500,spread:80,startVelocity:120,gravity:1,ticks:300,angle:90,origin:{x:.5,y:1},...e||{}};return t(a)},stream:(e=2e3,a)=>new Promise(i=>{const r=Date.now()+e,n=()=>{t({particleCount:8,angle:90,spread:70,origin:{x:.5,y:1},...a?a():{}}),Date.now()<r?requestAnimationFrame(n):i()};n()})}}(),{open:M,send:C,close:I}=J("/ws_project",{immediate:!1,onMessage:(e,a)=>{if(L(a.data)){const e=JSON.parse(a.data);Object.hasOwnProperty.call(e,"end")&&(t.setScanInfo(e.info,e.bar),e.type&&t.setScanType(e.type),A(e.results)&&e.results.length&&t.setScanResult(e.type,e.results),e.end&&(I(),t.endScan(),j()))}}}),j=async()=>{await t.getResult(),a.value?$.error(m("Security.SiteSecurity.Header.noPhpSite"),{close:!0}):i.value.score>=90&&h()},T=()=>{I(),t.endScan(),a.value=!0},P=()=>{t.startScan(),M(),C({model_index:"safe",mod_name:"webbasicscanning",def_name:"ScanAllSite",ws_callback:"123"})};return(e,t)=>{const i=W,s=U,o=Z;return d(),S(o,{class:"p-16px"},{default:x(()=>[g(a)?(d(),u(y,{key:1},[b(p("div",xe,[p("div",null,[p("div",be,v(e.$t("Security.SiteSecurity.Header.title")),1),p("div",_e,v(e.$t("Security.SiteSecurity.Header.desc")),1)]),f(i,{type:"primary",onClick:P},{default:x(()=>[w(v(e.$t("Security.SiteSecurity.Header.scanNow")),1)]),_:1})],512),[[k,g(a)]]),f(fe)],64)):(d(),u("div",ye,[p("div",me,[p("div",he,[p("div",null,v(g(n)?e.$t("Security.SiteSecurity.Header.scanning"):e.$t("Security.SiteSecurity.Header.lastScanTime")),1),p("span",ve,v(g(n)?g(r).msg:g(c)||"--"),1)]),p("div",ge,[g(n)?(d(),S(i,{key:0,type:"warning",ghost:"",onClick:T},{default:x(()=>[w(v(e.$t("Security.SiteSecurity.Header.cancelScan")),1)]),_:1})):_("",!0),g(n)?_("",!0):(d(),S(i,{key:1,type:"primary",onClick:P},{default:x(()=>[w(v(e.$t("Security.SiteSecurity.Header.scanNow")),1)]),_:1}))])]),b(p("div",Se,[f(s,{status:"success",processing:"",percentage:g(r).bar,"show-indicator":!1},null,8,["percentage"])],512),[[k,g(n)]])]))]),_:1})}}}),[["__scopeId","data-v-bb415a5d"]]),ke={class:"mb-10px text-16px font-700"},Me=c({__name:"score",setup(e){const{t:t}=l(),{scanInfo:a,scoreInfo:i}=ae(),r=N(),n=M("--color-text-1"),s=M("--color-text-3"),o=[{value:0,key:"high",name:t("Security.SiteSecurity.RiskLevel.high"),color:r.value.errorColor},{value:0,key:"middle",name:t("Security.SiteSecurity.RiskLevel.middle"),color:"#ffb84d"},{value:0,key:"low",name:t("Security.SiteSecurity.RiskLevel.low"),color:"#F7E459"},{value:0,key:"none",name:"",color:r.value.primaryColor}],c=C({tooltip:{show:!1},legend:m(),series:y(),graphic:u(i.value.score)});function u(e,a){return[{type:"group",left:"center",top:"40%",children:[{type:"text",left:"center",style:{text:`${e}`,fontSize:44,fontWeight:700,fill:n.value}},{type:"text",left:"center",top:58,style:{text:a||t("Security.SiteSecurity.Summary.scoreLabel"),fontSize:12,fill:s.value}}]}]}function y(){const e=o.filter(e=>e.value>0);return[{type:"pie",radius:["110%","124%"],center:["50%","70%"],startAngle:180,endAngle:0,clockwise:!0,avoidLabelOverlap:!0,label:{show:!1},labelLine:{show:!1},legendHoverLink:!1,padAngle:e.length>1?2:0,itemStyle:{borderRadius:999},data:[...e.map(e=>({value:e.value,name:e.name,itemStyle:{color:e.color}}))]}]}function m(){const e=new Map,t={};return o.forEach((a,i)=>{if("none"===a.key)return;const r=`k${i}`;e.set(a.name,r),t[r]={color:a.color,fontWeight:500}}),{bottom:0,left:"center",itemWidth:12,itemHeight:12,icon:"rect",selectedMode:!1,data:o.filter(e=>e.value>0).map(e=>e.name),formatter:t=>{const a=o.find(e=>e.name===t),i=e.get(t)??"",r=`${t}: ${a?.value??0}`;return i?`{${i}|${r}}`:r},textStyle:{fontSize:14,rich:t}}}const h=e=>{o.forEach(t=>{t.value=e[t.key]??0});const t=o.filter(e=>"none"!==e.key).reduce((e,t)=>e+t.value,0),a=o.find(e=>"none"===e.key);a.value=0!==t?0:1};return I(()=>{var e;"scanning"===a.value.status?(h({}),c.legend=m(),c.series=y(),c.graphic=u("...",t("Security.SiteSecurity.Header.scanning"))):(e=i.value,h(e.risk_count),c.legend=m(),c.series=y(),c.graphic=u(e.score))}),(e,t)=>{const a=Z;return d(),S(a,{class:"p-24px h-full"},{default:x(()=>[p("div",ke,v(e.$t("Security.SiteSecurity.Summary.scoreTitle")),1),f(ee,{height:"220px",option:g(c)},null,8,["option"])]),_:1})}}}),Ce={class:"mb-10px text-16px font-700"},Ie=c({__name:"top",setup(e){const{store:t,isScanning:a,ipTop:i}=ae(),{t:n}=l(),s=r([{key:"ip",title:n("Security.SiteSecurity.Top.columns.ip"),render:e=>f(W,{text:!0,type:1===e.deny_status?"default":"primary",class:1===e.deny_status?"text-font3 line-through":"",onClick:()=>{1===e.deny_status?c(e.ip):o(e.ip)}},{default:()=>[e.ip]})},{key:"count",title:n("Security.SiteSecurity.Top.columns.count")}]),o=e=>{G({title:n("Security.SiteSecurity.Top.banTitle",[e]),content:n("Security.SiteSecurity.Top.banContent"),onConfirm:async()=>{const{message:a}=await(i={address:e,types:"drop",domain:"",choose:"address",brief:n("Security.SiteSecurity.Top.banBrief")},P.post("/safe/syslog/create_ip_rules",{data:JSON.stringify(i)},{requestOptions:{loading:E.global.t("Component.Pay.index_12"),successMessage:!1}}));var i;A(a)&&a.length>0&&(a[0].status?($.success(a[0].msg),t.getResult()):$.error(a[0].msg))}})},c=e=>{G({title:n("Security.SiteSecurity.Top.unbanTitle",[e]),content:n("Security.SiteSecurity.Top.unbanContent"),onConfirm:async()=>{const{message:a}=await(i={address:e},P.post("/safe/syslog/remove_ip_rules",{data:JSON.stringify(i)},{requestOptions:{loading:E.global.t("Component.Pay.index_12"),successMessage:!1}}));var i;A(a)&&a.length>0&&$.success(a[0].msg),t.getResult()}})};return(e,t)=>{const r=Q,n=Z;return d(),S(n,{class:"p-24px h-300px"},{default:x(()=>[p("div",Ce,v(e.$t("Security.SiteSecurity.Top.title")),1),f(r,{"max-height":176,loading:g(a),data:g(i),columns:g(s)},null,8,["loading","data","columns"])]),_:1})}}}),je=c({__name:"index",setup:e=>(e,t)=>{const a=V,i=B;return d(),S(i,{"x-gap":10,cols:3},{default:x(()=>[f(a,{span:1},{default:x(()=>[f(Me)]),_:1}),f(a,{span:2},{default:x(()=>[f(Ie)]),_:1})]),_:1})}}),Te={class:"metric-label"},Pe={class:"metric-value"},Ee={class:"metric-unit"},Oe={class:"metric-desc"},Re={class:"metric-icon"},ze=z({__name:"item",props:{label:{type:String},value:{type:[String,Number]},desc:{type:String},unit:{type:String},icon:{type:String}},setup(e){const{isScanning:t}=ae();return(a,i)=>{const r=Z;return d(),S(r,{class:"metric-item"},{default:x(()=>[p("div",Te,v(e.label),1),p("div",Pe,[g(t)?(d(),u(y,{key:0},[w(v(a.$t("Security.SiteSecurity.Header.scanning"))+"...",1)],64)):(d(),u(y,{key:1},[w(v(e.value)+" ",1),p("span",Ee,v(e.unit),1)],64))]),p("div",Oe,v(e.desc),1),p("div",Re,[p("i",{class:h(e.icon)},null,2)])]),_:1})}}},[["__scopeId","data-v-0379de28"]]),Le=c({__name:"index",setup(e){const{duration:t,totalAttack:a}=ae(),{t:i}=l(),r=n(()=>[{key:"duration",label:i("Security.SiteSecurity.Metric.duration"),value:t.value,unit:i("Security.SiteSecurity.Metric.seconds"),icon:"i-security:time",desc:i("Security.SiteSecurity.Metric.durationDesc")},{key:"xss",label:"XSS",value:a.value.xss,icon:"i-security:xss",desc:i("Security.SiteSecurity.Metric.xssDesc")},{key:"sql",label:"SQL",value:a.value.sql_injection,icon:"i-security:sql",desc:i("Security.SiteSecurity.Metric.sqlDesc")},{key:"scan",label:i("Security.SiteSecurity.Metric.maliciousScan"),value:a.value.file_traversal,icon:"i-security:malicious-scan",desc:i("Security.SiteSecurity.Metric.maliciousScanDesc")},{key:"php",label:i("Security.SiteSecurity.Metric.phpAttack"),value:a.value.php_execution,icon:"i-security:php",desc:i("Security.SiteSecurity.Metric.phpAttackDesc")}]);return(e,t)=>{const a=V,i=B;return d(),S(i,{cols:g(r).length,"x-gap":10},{default:x(()=>[(d(!0),u(y,null,m(g(r),e=>(d(),S(a,{key:e.key},{default:x(()=>[f(ze,j({ref_for:!0},e),null,16)]),_:2},1024))),128))]),_:1},8,["cols"])}}}),Ae={class:"risk-list"},$e={class:"risk-card__header"},Ne={class:"risk-card__body"},Be={class:"risk-row"},De={class:"risk-row__label"},Fe={class:"risk-row__value"},He={class:"risk-row"},qe={class:"risk-row__label"},We={class:"risk-row__value"},Ue={key:1,class:"risk-empty"},Ze=z(c({__name:"risk",props:{data:{type:Array,default:()=>[]}},setup(e){const{t:t}=l(),a={0:{textKey:"Security.SiteSecurity.RiskLevel.warning",color:"#fc6d26"},1:{textKey:"Security.SiteSecurity.RiskLevel.low",color:"#d4bb00"},2:{textKey:"Security.SiteSecurity.RiskLevel.middle",color:"#E97B00"},3:{textKey:"Security.SiteSecurity.RiskLevel.high",color:"#CC1515"}},i=e=>({color:D(a[e].color,.1),textColor:a[e].color});return(r,n)=>{const s=X,o=K,c=Z,l=Y;return d(),u("div",Ae,[e.data.length>0?(d(!0),u(y,{key:0},m(e.data,e=>(d(),S(c,{key:e.name,class:"risk-card"},{default:x(()=>[p("div",$e,[f(s,{size:"small",bordered:!1,color:i(e.dangerous)},{default:x(()=>{return[w(v((i=e.dangerous,t(a[i].textKey))),1)];var i}),_:2},1032,["color"]),f(o,{class:"risk-card__title"},{default:x(()=>[p("span",{style:T({color:i(e.dangerous).textColor})},v(e.name),5)]),_:2},1024)]),p("div",Ne,[p("div",Be,[p("span",De,v(r.$t("Security.SiteSecurity.Risk.detailLabel")),1),p("span",Fe,v(e.info),1)]),n[0]||(n[0]=p("div",{class:"risk-divider"},null,-1)),p("div",He,[p("span",qe,v(r.$t("Security.SiteSecurity.Risk.repairLabel")),1),p("span",We,v(e.repair),1)])])]),_:2},1024))),128)):(d(),u("div",Ue,[f(l,{size:"large"})]))])}}}),[["__scopeId","data-v-59b580c0"]]),Ve={class:"mb-20px text-16px font-bold"},Xe={class:"security-collapse__header"},Ke={class:"security-collapse__left"},Ye={class:"security-collapse__title"},Je={key:0,class:"security-collapse__status text-default"},Ge={key:1,class:"security-collapse__status text-default"},Qe={class:"security-collapse__expand"},et=z(c({__name:"index",setup(e){const{scanInfo:t,details:a,detailsLoading:i}=ae(),{t:r}=l(),s=n(()=>{const e=[{key:"webscan",title:r("Security.SiteSecurity.Project.items.webscan"),icon:"i-security:webscan",riskCount:0,list:[]},{key:"fileleak",title:r("Security.SiteSecurity.Project.items.fileleak"),icon:"i-security:filescan",riskCount:0,list:[]},{key:"webshell",title:r("Security.SiteSecurity.Project.items.webshell"),icon:"i-security:webhorse",riskCount:0,list:[]},{key:"backup",title:r("Security.SiteSecurity.Project.items.backup"),icon:"i-security:backup",riskCount:0,list:[]},{key:"weakpass",title:r("Security.SiteSecurity.Project.items.weakpass"),icon:"i-security:backend",riskCount:0,list:[]},{key:"weblog",title:r("Security.SiteSecurity.Project.items.weblog"),icon:"i-security:ftps",riskCount:0,list:[]}];return Object.entries(a.value).forEach(([t,a])=>{const i=e.find(e=>e.key===t);i&&(i.riskCount=a.length,i.list=a)}),e});return(e,a)=>{const r=H,n=F,o=Z;return d(),S(o,{class:"p-24px"},{default:x(()=>[p("div",Ve,v(e.$t("Security.SiteSecurity.Project.title")),1),f(n,{"arrow-placement":"right","display-directive":"show",class:"security-collapse"},{default:x(()=>[(d(!0),u(y,null,m(g(s),a=>(d(),S(r,{key:a.key,name:a.key},{header:x(()=>[p("div",Xe,[p("div",Ke,[p("i",{class:h(["security-collapse__icon",a.icon])},null,2),p("span",Ye,v(a.title),1)]),g(i)[a.key]&&g(t).type!==a.key?(d(),u("span",Je,v(e.$t("Security.SiteSecurity.Project.waiting")),1)):g(i)[a.key]||g(t).type!==a.key?(d(),u("span",{key:2,class:h(["security-collapse__status",a.riskCount>0?"text-error":"text-primary"])},v(a.riskCount>0?e.$t("Security.SiteSecurity.Project.foundRisk",[a.riskCount]):e.$t("Security.SiteSecurity.Project.noRisk")),3)):(d(),u("span",Ge,v(e.$t("Security.SiteSecurity.Header.scanning"))+"... ",1)),p("span",Qe,v(e.$t("Public.Btn.Details")),1)])]),default:x(()=>[f(Ze,{data:a.list},null,8,["data"])]),_:2},1032,["name"]))),128))]),_:1})]),_:1})}}}),[["__scopeId","data-v-d4aef7d6"]]),tt={class:"site-security-page"};e("default",z(c({__name:"index",setup(e){const{store:t,isNone:a}=ae();return t.getResult(),(e,t)=>(d(),u("div",tt,[f(we),g(a)?_("",!0):(d(),u(y,{key:0},[f(je),f(Le),f(et)],64))]))}}),[["__scopeId","data-v-74f36d2b"]]))}}});
