System.register(["./public-legacy.js?v=1752142539265","./index-legacy102.js?v=1752142539265","./index-legacy.js?v=1752142539265","./vue-legacy.js?v=1752142539265","./page_layout-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1752142539265","./naive-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1752142539265","./common-legacy.js?v=1752142539265","./__commonjsHelpers__-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1752142539265"],(function(e,t){"use strict";var a,s,n,i,l,o,c,u,r,d,p,y,_,g,m,x,v,h,w,f,k,b,S,I,A,$,j,C,O,P,U,z,q,R,M,T,L,F,K,W,H,X,D,E,B,Q,V,G,J,N,Y,Z,ee,te,ae,se,ne,ie;return{setters:[e=>{a=e.b,s=e.c,n=e.f,i=e.e,l=e.K,o=e.h,c=e._,u=e.d,r=e.a,d=e.r},e=>{p=e._},e=>{y=e._},e=>{_=e.k,g=e.P,m=e.r,x=e.n,v=e.e,h=e.U,w=e.X,f=e.Q,k=e.a2,b=e.V,S=e.a3,I=e.W,A=e.ah,$=e.$,j=e.w,C=e.F,O=e.j,P=e.a1,U=e.l,z=e.O,q=e.H,R=e.v,M=e.c},e=>{T=e.v,L=e.i,F=e.X,K=e.w,W=e.cz,H=e.m,X=e.d,D=e.x,E=e._,B=e.e,Q=e.u,V=e.p},e=>{G=e._},e=>{J=e.bX,N=e.cD,Y=e.cz,Z=e.aq,ee=e.ay,te=e.cA,ae=e.bA,se=e.c1},e=>{ne=e._},e=>{ie=e._},null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".ul-style[data-v-f9cef105]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-f9cef105]{display:flex;align-items:center}.item[data-v-f9cef105]{border-left:3px solid #def2e2}.item li[data-v-f9cef105]{width:180px;margin-left:-3px;font-size:14px;line-height:36px;padding:0 20px;cursor:pointer}.item .active[data-v-f9cef105]{border-left:3px solid #20a53a;color:#20a53a;font-weight:700;font-size:16px}\n/*$vite$:1*/",document.head.appendChild(t);const{t:le}=L.global,oe=e=>T.post("/plugin?action=a&name=bt_security&s=start_user_security",e,{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}),ce=e=>T.post("/plugin?action=a&name=bt_security&s=stop_user_security",e,{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),ue=e=>T.post("/plugin?action=a&name=bt_security&s=start_user_log",e,{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}),re=e=>T.post("/plugin?action=a&name=bt_security&s=stop_user_log",e,{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),de=e=>T.post("/plugin?action=a&name=bt_security&s=get_logs_list",e,{requestOptions:{loading:le("Site.Api.Index_10"),successMessage:!1}}),pe=e=>T.post("/plugin?action=a&name=bt_security&s=del_porcess_log",e,{requestOptions:{loading:le("Security.Api.Index_3"),successMessage:!0}}),ye=e=>T.post("/plugin?action=a&name=bt_security&s=add_porcess_log",e,{requestOptions:{loading:le("Security.Api.Index_4"),successMessage:!0}}),_e={class:"p-20px"},ge=_({__name:"log",props:{data:{}},setup(e,{expose:t}){const{t:i}=g(),l=e,{date:o,name:c}=l.data,u=m([]),{keys:r,table:d,columns:p}=a([{key:"log",title:i("Ftp.Analysis.Index_27"),render:()=>c},{key:"cwd",title:i("Security.Anti.Index_46")},{key:"cmd",title:i("Security.Anti.Index_47")},{key:"filename",title:i("Security.Anti.Index_48")},{key:"cwd",title:i("Config.Safe.index_152"),render:e=>F(e.timestamp)}]);x((()=>{u.value=o.map((e=>({label:e,value:e})))}));const y=v({p:1,num:999,day:o[0]}),{loading:_,setLoading:$}=s(),j=async()=>{try{$(!0);const{message:t}=await(e={...y,user:c},T.post("/plugin?action=a&name=bt_security&s=get_user_log",e));K(t)&&(d.data=t,d.total=t.length)}finally{r.value=[],$(!1)}var e};return j(),t({init:j}),(e,t)=>{const a=N,s=J,i=n,l=G;return w(),h("div",_e,[f(s,{class:"flex-nowrap! items-center mb-10px"},{default:k((()=>[b("span",null,S(e.$t("Security.Anti.Index_45")),1),f(a,{class:"w-150px",value:I(y).day,"onUpdate:value":[t[0]||(t[0]=e=>I(y).day=e),j],options:I(u)},null,8,["value","options"])])),_:1}),f(l,null,{table:k((()=>[f(i,{"checked-row-keys":I(r),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>A(r)?r.value=e:null),loading:I(_),data:I(d).data,"max-height":350,columns:I(p)},null,8,["checked-row-keys","loading","data","columns"])])),_:1})])}}}),me=_({__name:"index",setup(e,{expose:t}){const{t:u}=g(),r=W(),{antiForm:d}=$(r),p=i(),{keys:_,table:m,columns:x}=a([{key:"user",title:u("Ftp.Analysis.Index_27")},{key:"total",title:u("Security.Anti.Index_7")},{key:"today",title:u("Public.Search.Today")},l({key:"protection",title:u("Security.Tabs.Index_8"),minWidth:60,onClick:async(e,t)=>{e?await oe({user:t.user}):await ce({user:t.user})}}),l({key:"log",title:u("Security.Anti.Index_8"),minWidth:60,onClick:async(e,t)=>{e?await ue({uid:t.uid}):await re({uid:t.uid})}}),{key:"remark",title:u("Site.Proxy.index_3")},o({width:130,title:u("Public.Table.Operation"),options:e=>[{label:u("Site.Proxy.index_51"),onClick:async()=>{const{message:t}=await de({user:e.user});!K(t)||t.length?(p.title=`[${e.user}] - ${u("Site.Proxy.index_51")}`,p.data.date=t,p.data.name=e.user,p.show=!0):H.error(u("Security.Anti.Index_44"))}}]})]);j((()=>r.isRefresh),(e=>{e&&(r.setRefresh(!1),P())}));const{loading:v,setLoading:O}=s(),P=async()=>{try{O(!0);const{message:e}=await T.post("/plugin?action=a&name=bt_security&s=get_total_all");X(e)&&(d.value.switch=e.open,d.value.times=e.totla_times,d.value.days=e.totla_days,m.data=e.system_user.map((e=>({user:e[0],total:e[4].totla,today:e[4].day_totla,protection:e[3],log:e[5],remark:e[6],uid:e[1]}))))}finally{_.value=[],O(!1)}};return P(),t({init:P}),(e,t)=>{const a=n,s=c,i=y;return w(),h(C,null,[f(a,{"checked-row-keys":I(_),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>A(_)?_.value=e:null),"row-key":"user","max-height":750,loading:I(v),data:I(m).data,columns:I(x)},null,8,["checked-row-keys","loading","data","columns"]),f(s,{class:"mt-16px"},{default:k((()=>[b("li",null,S(e.$t("Security.Anti.Index_4")),1),b("li",null,S(e.$t("Security.Anti.Index_5")),1),b("li",null,S(e.$t("Security.Anti.Index_6")),1)])),_:1}),f(i,{show:I(p).show,"onUpdate:show":t[1]||(t[1]=e=>I(p).show=e),title:I(p).title,data:I(p).data,width:750,"min-height":268,footer:!1,component:ge},null,8,["show","title","data"])],64)}}}),xe={class:"p-20px"},ve={class:"w-280px"},he={class:"color-#ff3333"},we=_({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=g(),s=e,{getList:n}=s.data,i=m(null),l=v({name:""}),o={name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{await(i.value?.validate()),await ye({cmd:l.name}),n?.(),e()}}),(e,t)=>{const a=Z,s=Y,n=ne,u=c;return w(),h("div",xe,[f(n,{ref_key:"formRef",ref:i,model:I(l),rules:o},{default:k((()=>[f(s,{label:e.$t("Home.index_24"),path:"name"},{default:k((()=>[b("div",ve,[f(a,{type:"text",value:I(l).name,"onUpdate:value":t[0]||(t[0]=e=>I(l).name=e),placeholder:"e.g:/bin/bash"},null,8,["value"])])])),_:1},8,["label"])])),_:1},8,["model"]),f(u,{class:"mt-4px"},{default:k((()=>[b("li",he,S(e.$t("Security.Anti.Index_9")),1)])),_:1})])}}}),fe=_({__name:"index",setup(e,{expose:t}){const{t:l}=g(),{loading:c,setLoading:r}=s(),{keys:d,table:p,columns:_}=a([{key:"whitelist",title:l("Security.Anti.Index_11")},o({width:130,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{u({title:`${l("Security.Anti.Index_12")} [${e.whitelist}]`,content:l("Security.Anti.Index_13"),onConfirm:async({hide:t})=>{await pe({cmd:e.whitelist}),m(),t()}})}}]})]),m=async()=>{try{r(!0);const{message:e}=await T.post("/plugin?action=a&name=bt_security&s=porcess_set_up_log");K(e)&&(p.data=e.map((e=>({whitelist:e}))))}finally{d.value=[],r(!1)}};m(),t({init:m});const x=()=>{v.show=!0},v=i(l("Security.Anti.Index_10"),{getList:m});return(e,t)=>{const a=ee,s=n,i=G,l=y;return w(),h("div",null,[f(i,null,{toolsLeft:k((()=>[f(a,{type:"primary",onClick:x},{default:k((()=>[O(S(e.$t("Security.Anti.Index_10")),1)])),_:1})])),table:k((()=>[f(s,{"checked-row-keys":I(d),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>A(d)?d.value=e:null),"row-key":"whitelist",loading:I(c),"max-height":440,data:I(p).data,columns:I(_)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),f(l,{show:I(v).show,"onUpdate:show":t[1]||(t[1]=e=>I(v).show=e),title:I(v).title,data:I(v).data,width:480,footer:!0,component:we},null,8,["show","title","data"])])}}}),ke=_({__name:"index",setup(e,{expose:t}){const{t:i}=g(),{keys:l,table:o,columns:c}=a([{key:"log",title:i("Public.Table.Operation")},{key:"addtime",align:"right",title:i("Site.Cert.index_68")}]),u=v({p:1,limit:10}),{loading:r,setLoading:d}=s(),p=async()=>{try{d(!0);const{message:t}=await(e=u,T.post("/plugin?action=a&name=bt_security&s=get_log",e));X(t)&&(o.data=t.data,o.total=D(t.page))}finally{l.value=[],d(!1)}var e};return p(),t({init:p}),(e,t)=>{const a=n,s=ie,i=G;return w(),P(i,{feedback:!0},{table:k((()=>[f(a,{"checked-row-keys":I(l),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>A(l)?l.value=e:null),"row-key":"log",loading:I(r),data:I(o).data,columns:I(c)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:k((()=>[f(s,{page:I(u).p,"onUpdate:page":t[1]||(t[1]=e=>I(u).p=e),"page-size":I(u).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>I(u).limit=e),"item-count":I(o).total,"store-key":"security-anti",onRefresh:p},null,8,["page","page-size","item-count"])])),_:1})}}}),be=_({__name:"index",setup(e){const{t:t}=g(),a=m("overview"),s=[{key:"overview",label:t("Security.Tabs.Index_5"),component:me},{key:"whitelist",label:t("Security.Tabs.Index_6"),component:fe},{key:"operation",label:t("Security.Tabs.Index_7"),component:ke}];return(e,t)=>{const n=p;return w(),P(n,{value:I(a),"onUpdate:value":t[0]||(t[0]=e=>A(a)?a.value=e:null),options:s},null,8,["value"])}}}),Se={class:"pt-40px pb-40px"},Ie={class:"mb-16px"},Ae={class:"ul-style"},$e={class:"text-center my-24px"},je={class:"flex justify-center"},Ce={class:"item"},Oe=["onClick"],Pe=B(_({__name:"conversion",setup(e){const t=m(0),a=["Overview","Process whitelist","Operation logs"],s=()=>{r({source:105})};return(e,n)=>{const i=E,l=ee,o=ae,c=te;return w(),P(c,null,{default:k((()=>[b("div",Se,[n[3]||(n[3]=b("div",{class:"mb-24px text-center text-22px font-bold"},"Anti Intrusion prevention features",-1)),b("div",Ie,[b("ul",Ae,[b("li",null,[f(i,{name:"security-lixian",size:"22"}),n[0]||(n[0]=b("span",{class:"ml-4px"},"Prevents the program from hanging",-1))]),b("li",null,[f(i,{name:"security-sanfang",size:"20"}),n[1]||(n[1]=b("span",{class:"ml-4px"},"Stop the mining virus",-1))]),b("li",null,[f(i,{name:"security-webshell",size:"26"}),n[2]||(n[2]=b("span",null,"Prevent Privilege Escalation Attacks",-1))])])]),b("div",$e,[f(l,{type:"primary",class:"h-36px text-14px",onClick:s},{default:k((()=>[O(S(e.$t("WP.Transition.index_7")),1)])),_:1})]),b("div",je,[b("div",Ce,[b("ul",null,[(w(),h(C,null,z(a,((e,a)=>b("li",{class:q({active:I(t)==a}),key:a,onClick:e=>t.value=a},S(e),11,Oe))),64))])]),U(f(o,{width:"100%",src:I("/static/vite/images/overview2.png")},null,8,["src"]),[[R,0==I(t)]]),U(f(o,{width:"100%",src:I("/static/vite/images/whitelist.png")},null,8,["src"]),[[R,1==I(t)]]),U(f(o,{width:"100%",src:I("/static/vite/images/logs.png")},null,8,["src"]),[[R,2==I(t)]])])])])),_:1})}}}),[["__scopeId","data-v-f9cef105"]]),Ue={key:0};e("default",_({__name:"index",setup(e){const t=Q(),{isPro:a}=$(t),s=W(),{antiForm:n}=$(s),i=m(n.value.switch),l=M((()=>n.value.switch));j(l,(e=>{i.value=e}));const o=M((()=>n.value.times)),c=M((()=>n.value.days)),u=async e=>{e?await T.post("/plugin?action=a&name=bt_security&s=start_bt_security",{},{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}):await T.post("/plugin?action=a&name=bt_security&s=stop_bt_security",{},{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await d("bt_security")})(),(e,t)=>{const s=se,n=V,l=J,r=te;return I(a)?(w(),h("div",Ue,[f(r,{class:"my-15px"},{default:k((()=>[f(l,{class:"p-15px items-center"},{default:k((()=>[b("span",null,S(e.$t("Security.Anti.Index_1")),1),f(s,{value:I(i),"onUpdate:value":[t[0]||(t[0]=e=>A(i)?i.value=e:null),u],"rubber-band":!1,size:"small"},null,8,["value"]),f(n,{vertical:""}),b("span",null,S(e.$t("Security.Anti.Index_2"))+": "+S(I(o)),1),f(n,{vertical:""}),b("span",null,S(e.$t("Security.Anti.Index_3"))+": "+S(I(c)),1)])),_:1})])),_:1}),f(r,{class:"p-15px"},{default:k((()=>[f(be)])),_:1})])):(w(),P(Pe,{key:1}))}}}))}}}));
