import{_ as e,p as t,u as a,gG as o,m as s,eM as l,X as i,gH as n,x as r}from"./page_layout.js?v=1763625242172";import{X as c}from"./public.js?v=1763625242172";import{L as d}from"./leader-line-vue.js?v=1763625242172";import{k as p,R as m,S as v,F as u,O as f,U as y,V as h,a2 as g,X as x,an as A,H as S,P as b,t as I,r as w,c as k,o as C,n as E,b as H,a4 as U,a3 as B,j as L,aj as V,x as _,am as N,a5 as P}from"./vue.js?v=1763625242172";import{dV as R,_ as M,dU as D,d8 as Q,dT as q,aC as T}from"./naive.js?v=1763625242172";import"./common.js?v=1763625242172";import"./__commonjsHelpers__.js?v=1763625242172";const j=(e=[{startId:"server",endId:"database",color:"var(--color-border)",size:2,path:"grid",startSocket:"right",endSocket:"right"},{startId:"nginx",endId:"php",color:"var(--color-border)",size:2,path:"grid",startSocket:"right",endSocket:"left"},{startId:"nginx",endId:"server",color:"var(--color-border)",size:2,path:"grid",startSocket:"right",endSocket:"left"},{startId:"nginx",endId:"database",color:"var(--color-border)",size:2,path:"grid",startSocket:"right",endSocket:"left"}])=>{const t=[];return e.forEach((e=>{const a=(e=>{const t=document.getElementById(e.startId),a=document.getElementById(e.endId);if(!t||!a)throw new Error("Invalid start or end element ID");return d.setLine(t,a,{color:e.color||"var(--color-border)",size:e.size||2,path:e.path||"grid",startSocket:e.startSocket||"right",endSocket:e.endSocket||"left"})})(e);a&&t.push(a)})),t},W={key:0,class:"flex-center w-32px"},F=["src"],z=t(p({__name:"SoftwareGroup",props:{items:{},form:{},showCheckbox:{type:Boolean},showRadio:{type:Boolean},containerClass:{}},emits:["updateSelect","updateRadio"],setup:t=>(t,a)=>{const o=e,s=R,l=M,i=D;return m(),v("ul",{class:S(["soft-list",t.containerClass])},[(m(!0),v(u,null,f(t.items,(e=>(m(),v("li",{key:e.type},["mail"===e.icon||"dns"===e.icon?(m(),v("div",W,[y("img",{class:"w-20px",src:"mail"===e.icon?h("/static/vite/images/mail-server.png"):h("data:image/png;base64,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"),alt:""},null,8,F)])):(m(),g(o,{key:1,name:"soft-".concat(e.icon),size:"32"},null,8,["name"])),x(s,{value:t.form[e.type].value,"onUpdate:value":[a=>t.form[e.type].value=a,a=>t.$emit("updateSelect",e.type,a)],class:"flex-1 mx-5px",options:e.options,"consistent-menu-width":!1},null,8,["value","onUpdate:value","options"]),t.showCheckbox?(m(),g(l,{key:2,class:"mr-10px",checked:t.form[e.type].checked,"onUpdate:checked":a=>t.form[e.type].checked=a},null,8,["checked","onUpdate:checked"])):A("",!0),t.showRadio?(m(),g(i,{key:3,class:"mr-10px",checked:t.form[e.type].checked,"onUpdate:checked":[a=>t.form[e.type].checked=a,a=>t.$emit("updateRadio",a,e.type)]},null,8,["checked","onUpdate:checked"])):A("",!0)])))),128))],2)}}),[["__scopeId","data-v-30465cc8"]]),Y={class:"recommend-item"},X={class:"recommend-title"},J={key:0,class:"flex items-center border-view p-16px w-540px"},O={class:"border-view mr-80px",id:"nginx"},Z={class:"border-view",id:"server"},K={class:"border-view my-10px",id:"database"},G={class:"border-view",id:"php"},$={class:"border-view mt-10px"},ee={class:"border-view"},te={class:"border-view mt-40px"},ae={class:"flex items-center my-20px"},oe={class:"mr-10px"},se={class:"w-280px"},le={class:"w-280px"},ie={class:"flex justify-center"},ne=t(p({__name:"item",props:{data:{},memTotal:{default:0},activeMode:{default:"multi"}},emits:["close","update-active"],setup(e,{emit:t}){const n=e,r=t,{t:c}=b(),d=a(),p=I((()=>n.data)),f=I((()=>n.memTotal)),g=w([]),A=w((()=>{const{soft:e}=p.value,t={};return e.forEach((e=>{t[e.type]={value:e.value,checked:"single"!==e.select||"Nginx"===e.type},"DNS-Server"!==e.type&&"Mail-Server"!==e.type||(t[e.type].checked=!1)})),t})()),_=w(1),N=k((()=>{var e;return(null==(e=p.value.soft)?void 0:e.filter((e=>"Nginx"===e.type)))||[]})),P=k((()=>{var e;return(null==(e=p.value.soft)?void 0:e.filter((e=>"Apache"===e.type||"Openlitespeed"===e.type)))||[]})),R=k((()=>{var e;return(null==(e=p.value.soft)?void 0:e.filter((e=>"MySQL"===e.type||"PHP"===e.type)))||[]})),M=k((()=>{var e;return(null==(e=p.value.soft)?void 0:e.filter((e=>"phpMyAdmin"===e.type)))||[]})),W=k((()=>{var e;return(null==(e=p.value.soft)?void 0:e.filter((e=>"DNS-Server"===e.type||"Mail-Server"===e.type||"Pure-Ftpd"===e.type)))||[]})),F=k((()=>{var e;return(null==(e=p.value.soft)?void 0:e.filter((e=>"single"===e.select)))||[]})),ne=k((()=>{var e;return(null==(e=p.value.soft)?void 0:e.filter((e=>"single"!==e.select)))||[]})),re=new Map([["5.1",{max:256,rec:512}],["5.5",{max:600,rec:1024}],["5.6",{max:800,rec:1024}],["5.7",{max:1500,rec:2048}],["8.0",{max:5e3,rec:6144}],["AliSQL",{max:800,rec:1024}],["mariadb_10.0",{max:800,rec:1024}],["mariadb_10.1",{max:1500,rec:2048}]]),ce=new Map([["5.2","4.0"],["5.3","4.0"],["5.4","4.4"],["5.5","4.4"]]),de=(e,t)=>{e=e.toLowerCase();const a=me[e];null==a||a(t)},pe=(e,t)=>{e&&Object.keys(A.value).forEach((e=>{const a=p.value.soft.find((t=>t.type===e));a&&"single"===a.select&&e!==t&&(A.value[e].checked=!1)}))},me={mysql:e=>{const t=re.get(e),a=(null==t?void 0:t.max)||0,o=(null==t?void 0:t.rec)||0;if(f.value<a){const t=c("Home.Install.index_10",[o/1024,e]);s.error(t)}},apache:e=>{"2.2"==e?s.info(c("Home.Install.index_11",["2.2","php5_module"])):s.info(c("Home.Install.index_11",["2.4","php-fpm"]))},php:e=>{if("lnmp"===p.value.type){const t=ce.get(e)||"4.9";A.value.phpMyAdmin.value=t}if("lamp"===p.value.type){const t=e;"2.2"==A.value.Apache.value?"5.2"!=t&&"5.3"!=t&&"5.4"!=t&&(s.error(c("Home.Install.index_12",["2.2",t])),A.value.PHP.value="5.4"):"5.2"==t&&(s.error(c("Home.Install.index_12",["2.4",t])),A.value.PHP.value="5.4")}}},ve=async e=>{o({type:e});const t="multi"===e||null,a=s.loading(c("Home.Install.index_13"));try{const e=(()=>{const e=[];return Object.entries(A.value).forEach((([t,a])=>{if(a.checked){let o=t.toLowerCase();"pure-ftpd"===o&&(o="pureftpd"),"php"===o&&(o="php-"+a.value),"dns-server"===o&&(o="dns_manager"),"mail-server"===o&&(o="mail_sys"),e.push({sName:o,version:"".concat(a.value),type:_.value,id:"lnmp"===p.value.type?50:41})}})),e})();for(let a=0;a<e.length;a++)await l({...e[a],Skip:t});s.success(c("Home.Install.index_14")),d.getConfigSimple(),r("close"),i()}finally{a.close()}};return C((async()=>{await E(),setTimeout((()=>{g.value=j()}),500)})),H((()=>{(e=>{e.forEach((e=>{e&&"function"==typeof e.remove&&e.remove()}))})(g.value)})),(e,t)=>{const a=D,o=Q,s=q,l=T;return m(),v("div",Y,[y("div",X,U(h(p).title),1),y("div",{class:S(["content",{active:e.activeMode===h(p).mode}]),onClick:t[2]||(t[2]=e=>{return t=h(p).mode,void(n.activeMode!==t&&r("update-active",t));var t})},["multi"===h(p).mode?(m(),v("div",J,[y("div",O,[x(z,{items:h(N),form:h(A),onUpdateSelect:de},null,8,["items","form"])]),y("div",null,[y("div",Z,[x(z,{items:h(P),form:h(A),onUpdateSelect:de},null,8,["items","form"])]),y("div",K,[x(z,{items:h(R),form:h(A),onUpdateSelect:de},null,8,["items","form"])]),y("div",G,[x(z,{items:h(M),form:h(A),onUpdateSelect:de},null,8,["items","form"])]),y("div",$,[x(z,{items:h(W),form:h(A),"show-checkbox":!0,onUpdateSelect:de},null,8,["items","form"])])])])):(m(),v(u,{key:1},[y("div",ee,[x(z,{items:h(F),form:h(A),"show-radio":!0,onUpdateSelect:de,onUpdateRadio:pe},null,8,["items","form"])]),y("div",te,[x(z,{items:h(ne),form:h(A),"show-checkbox":!0,onUpdateSelect:de},null,8,["items","form"])])],64)),y("div",ae,[y("span",oe,U(e.$t("Home.Install.index_4")),1),x(s,{value:h(_),"onUpdate:value":t[0]||(t[0]=e=>V(_)?_.value=e:null)},{default:B((()=>[x(o,{trigger:"hover"},{trigger:B((()=>[x(a,{value:1},{default:B((()=>[L(U(e.$t("Home.Install.index_5")),1)])),_:1})])),default:B((()=>[y("div",se,U(e.$t("Home.Install.index_6")),1)])),_:1}),x(o,{trigger:"hover"},{trigger:B((()=>[x(a,{value:0},{default:B((()=>[L(U(e.$t("Home.Install.index_7")),1)])),_:1})])),default:B((()=>[y("div",le,U(e.$t("Home.Install.index_8")),1)])),_:1})])),_:1},8,["value"])]),y("div",ie,[x(l,{type:"primary",onClick:t[1]||(t[1]=e=>ve(h(p).mode))},{default:B((()=>[L(U(e.$t("Home.Install.index_9")),1)])),_:1})])],2)])}}}),[["__scopeId","data-v-fc7446b1"]]),re={class:"p-20px"},ce={class:"recommend-list"},de=t(p({__name:"index",props:{memTotal:{}},emits:["close"],setup(e,{expose:t,emit:a}){const o=e,s=a,{memTotal:l}=o,i=_([]),d=w("multi"),p=e=>{d.value=e},x=[{type:"lnmp",mode:"multi",title:"Multi-WebServer Hosting",soft:[{type:"Nginx",icon:"nginx",value:void 0,options:[]},{type:"Apache",icon:"apache",value:void 0,options:[]},{type:"PHP",icon:"php",value:void 0,options:[]},{type:"Openlitespeed",icon:"openlitespeed",value:void 0,options:[]},{type:"MySQL",icon:"mysql",value:void 0,options:[]},{type:"Pure-Ftpd",icon:"pure-ftpd",value:void 0,options:[]},{type:"phpMyAdmin",icon:"phpmyadmin",value:void 0,options:[]},{type:"DNS-Server",icon:"dns",value:void 0,options:[]},{type:"Mail-Server",icon:"mail",value:void 0,options:[]}]},{type:"lamp",mode:"single",title:"Single WebServer model",soft:[{type:"Nginx",icon:"nginx",value:void 0,options:[],select:"single"},{type:"Apache",icon:"apache",value:void 0,options:[],select:"single"},{type:"MySQL",icon:"mysql",value:void 0,options:[]},{type:"Pure-Ftpd",icon:"pure-ftpd",value:void 0,options:[]},{type:"PHP",icon:"php",value:void 0,options:[]},{type:"Openlitespeed",icon:"openlitespeed",value:void 0,options:[],select:"single"},{type:"phpMyAdmin",icon:"phpmyadmin",value:void 0,options:[]},{type:"DNS-Server",icon:"dns",value:void 0,options:[]},{type:"Mail-Server",icon:"mail",value:void 0,options:[]}]}];N();const S=()=>{s("close")};return(async()=>{const{message:e}=await n();r(e)&&e.forEach((e=>{const{name:t}=e;if("Tomcat"===t)return;let a;const o=[];e.versions.forEach((({version:e},s)=>{(!a&&("PHP"===t&&0===s)||"MySQL"===t&&0===s||"phpMyAdmin"===t&&0===s)&&(a=e),o.push({label:"".concat(t," ").concat(e),value:e})})),!a&&o.length>0&&(a=o[0].value),x.forEach((e=>{for(let s=0;s<e.soft.length;s++)if(e.soft[s].type===t){e.soft[s].value=a,e.soft[s].options=o;break}})),i.value=x}))})(),t({onClose:()=>{c()}}),(e,t)=>(P("i18n-t"),m(),v("div",re,[A("",!0),y("div",ce,[(m(!0),v(u,null,f(h(i),(e=>(m(),g(ne,{key:e.type,data:e,"mem-total":h(l),"active-mode":h(d),onUpdateActive:p,onClose:S},null,8,["data","mem-total","active-mode"])))),128))])]))}}),[["__scopeId","data-v-aa0864d2"]]);export{de as default};
