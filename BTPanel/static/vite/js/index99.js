import{S as a,P as t,e,r as i,Q as c,$ as n}from"./vue.js?v=1752142539265";import{b as l,u as s}from"./accountState.js?v=1752142539265";import{c as o,d as r,h as m}from"./public.js?v=1752142539265";import{$ as _,d,m as u,a0 as g,a1 as k,a2 as p,n as h,X as y}from"./page_layout.js?v=1752142539265";import{a as f}from"./quota.js?v=1752142539265";import{u as b}from"./disk.js?v=1752142539265";const v=a("packageStore",(()=>{const a=x(),{t:e}=t(),i=async()=>{try{n(!0);const{message:t}=await _(a.search);d(t)&&(a.table.data=t.list,a.table.total=t.page.count)}finally{n(!1)}},{loading:c,setLoading:n}=o();function l(){const{package_name:t,disk_space_quota:e,monthly_bandwidth_limit:i,max_site_limit:c,max_database:n,php_start_children:l,php_max_children:s,remark:o}=a.formData;return{package_name:t,disk_space_quota:e.unlimited?0:String(1024*Number(e.value)*1024),monthly_bandwidth_limit:i.unlimited?0:String(1024*Number(i.value)*1024),max_site_limit:c.unlimited?0:c.value,max_database:n.unlimited?0:n.value,max_email_account:0,php_start_children:l,php_max_children:s,remark:o}}return{init:i,loading:c,setLoading:n,removePackage:async a=>{r({title:e("Account.Package.package-988835-0",[a.package_name]),content:e("Account.Package.package-988835-1"),onConfirm:async()=>{1!==a.status?(await g({package_id:a.package_id}),i()):u.error(e("Account.Package.package-988835-2"))}})},create_package:async function(){a.isEdit=!1,a.addVisible=!0,a.formData_reset()},editPackage:async function(t){!function(t){const{package_name:e,disk_space_quota:i,monthly_bandwidth_limit:c,max_site_limit:n,max_database:l,php_start_children:s,php_max_children:o,remark:r}=t;a.formData.package_name=e,a.formData.disk_space_quota=0==i?{value:"",unlimited:!0}:{value:i/1024/1024,unlimited:!1},a.formData.monthly_bandwidth_limit=0==c?{value:"",unlimited:!0}:{value:c/1024/1024,unlimited:!1},a.formData.max_site_limit=0==n?{value:"",unlimited:!0}:{value:n,unlimited:!1},a.formData.max_database=0==l?{value:"",unlimited:!0}:{value:l,unlimited:!1},a.formData.php_start_children=s,a.formData.php_max_children=o,a.formData.remark=r}(t),a.current_account_id=t.package_id,a.isEdit=!0,a.addVisible=!0},packageInfoConfirm:async function(){var t;try{await(null==(t=a.packageFormRef)?void 0:t.validate()),a.isEdit?(await k({package_id:a.current_account_id,...l()}),a.formData_reset(),i()):(await p(l()),a.formData_reset(),i())}catch(e){return Promise.reject(e)}}}})),x=a("packageStateStore",(()=>{const a=v(),{t:n}=t(),s=e({data:[],total:0,loading:!1}),o=i([{title:n("Account.Package.packageState-592272-0"),key:"package_name",width:150},{title:n("Account.Package.packageState-592272-1"),key:"php_start_children",width:80,render:a=>c("div",null,[0===a.max_site_limit?c("img",{class:"icon",title:"",src:f},null):a.max_site_limit])},{title:n("Account.Account.accountState-721844-3"),key:"disk_space_quota",render:a=>c("div",null,[0===a.disk_space_quota?c("img",{class:"icon",title:"",src:f},null):h(a.disk_space_quota,!0,0)])},{title:n("Account.Package.packageState-592272-2"),key:"monthly_bandwidth_limit",render:a=>c("div",null,[0===a.monthly_bandwidth_limit?c("img",{class:"icon",title:"",src:f},null):h(a.monthly_bandwidth_limit,!0,0)])},{title:n("Account.Account.accountState-721844-14"),key:"remark",render:a=>a.remark?a.remark:"--"},{title:n("Account.Package.packageState-592272-7"),key:"create_time",render:a=>y(a.create_time)},m({title:n("Public.Table.Action"),align:"right",width:200,options:t=>[{label:n("Account.Package.packageState-592272-8"),onClick:async()=>a.editPackage(t)},{label:n("Account.Package.packageState-592272-9"),onClick:async()=>{a.removePackage(t)}}]})]),r=i([]),_=e({p:1,rows:10,search_value:""}),d=i(!1),u=i(!1),[g,k]=l();const p=i(0),b=i(0),x=i(null),w=i();return{search:_,table:s,columns:o,keys:r,addVisible:d,formData:k,PackageInfoForm:()=>g,formData_reset:function(){k.package_name="",k.disk_space_quota={value:0,unlimited:!0},k.monthly_bandwidth_limit={value:0,unlimited:!0},k.max_site_limit={value:0,unlimited:!0},k.max_database={value:0,unlimited:!0},k.php_start_children=1,k.php_max_children=3,k.remark=""},packageFormRef:w,isEdit:u,disk_space_quota_cache:p,monthly_bandwidth_limit_cache:b,current_account_id:x}})),w=a("logsStateStore",(()=>{const{t:a}=t(),n=e({data:[],total:0,loading:!1}),l=i([{title:a("Account.Logs.logsState-131428-0"),key:"log_type",width:150},{title:a("Account.Logs.logsState-131428-1"),key:"log_level",width:100},{title:a("Account.Logs.logsState-131428-2"),key:"status",width:100,render:t=>t.log_status?c("span",{class:"text-primary"},[a("Account.Logs.logsState-456809-0")]):c("span",{class:"text-error"},[a("Account.Logs.logsState-456809-1")])},{title:a("Account.Logs.logsState-131428-3"),key:"log_body",render:t=>c("div",{class:"flex"},[t.username?c("div",{class:"text-[#909399]"},[a("Account.Account.account_533924-0")+" ["+t.username+"]--\x3e"]):"",c("div",null,[t.log_body])])},{key:"log_time",align:"right",title:a("Logs.Panel.index_7"),render:a=>y(a.log_time)}]),s=i([]);return{search:e({p:1,rows:10,search:""}),table:n,columns:l,keys:s}})),S=a("account-store",(()=>{const a=s(),t=n(a),e=x(),c=n(e),l=b(),o=w(),r=n(o);return{install:i(!1),account:{...t},w_package:{...c},disk:{...l},logs:{...r}}}));export{S as a,v as b,w as c,x as u};
