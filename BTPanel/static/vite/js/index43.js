import{c5 as e,l as a,bZ as t,x as s,p as l,d as n,y as i,aK as o,o as r,m as c}from"./page_layout.js?v=1764830988434";import{d as u,c as d,h as p,_ as m,a as _,u as g}from"./public.js?v=1764830988434";import{_ as f}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1764830988434";import{k as x,r as y,e as v,R as b,V as h,W as w,S as k,U as C,a3 as N,a2 as S,an as L,F as j,O as P,l as $,v as R,H as U,a4 as W,N as T,P as q,w as I,ak as B,j as H,c as z}from"./vue.js?v=1764830988434";import{c as F,e as K,f as A,h as D,s as O,i as V}from"./logs.js?v=1764830988434";import{_ as Z}from"./index107.js?v=1764830988434";import{_ as E}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1764830988434";import{_ as G}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1764830988434";import{aC as J,bH as M,dS as Q}from"./naive.js?v=1764830988434";import{_ as X}from"./index102.js?v=1764830988434";import{_ as Y}from"./index.js?v=1764830988434";import{a as ee}from"./site.js?v=1764830988434";import{_ as ae}from"./logs.vue_vue_type_script_setup_true_lang.js?v=1764830988434";import"./common.js?v=1764830988434";import"./__commonjsHelpers__.js?v=1764830988434";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1764830988434";const te={class:"flex flex-col w-240px"},se={class:"item flex-1 mt-10px overflow-hidden"},le=["onClick"],ne=l(x({__name:"index",setup(l){const n=e(),i=y(""),o=v({search:""}),r=y([]),{loading:c,setLoading:d}=u(),p=async()=>{try{d(!0);const{message:e}=await F(T(o));s(e)&&(n.setWebsite(e[0].name),i.value=e[0].name,r.value=e)}finally{d(!1)}};return p(),(e,s)=>{const l=f,u=a,d=t;return h(),b("div",te,[w(l,{value:C(o).search,"onUpdate:value":s[0]||(s[0]=e=>C(o).search=e),placeholder:e.$t("Logs.Panel.index_4"),onSearch:p},null,8,["value","placeholder"]),k("div",se,[w(d,{class:"h-full"},{default:N(()=>[C(c)?(h(),S(u,{key:0,height:"36px",text:"",repeat:6})):L("",!0),(h(!0),b(j,null,P(C(r),e=>$((h(),b("div",{class:U(["list",{"list-active":C(i)==e.name}]),key:e.name,onClick:a=>{return t=e.name,n.setWebsite(t),void(i.value=t);var t}},W(e.name),11,le)),[[R,!C(c)]])),128))]),_:1})])])}}}),[["__scopeId","data-v-5e09d3e2"]]),ie=x({__name:"index",setup(a,{expose:t}){const s=e(),{t:l}=q(),{keys:o,table:r,columns:c}=d([{key:"username",title:l("Ftp.Analysis.Index_27")},{key:"type",title:l("Logs.Panel.index_6")},{key:"log",title:l("Public.Btn.Details")},{key:"addtime",align:"right",title:l("Logs.Panel.index_7")}]),m=v({search:s.websiteName,p:1,limit:10,stype:"Site manager"}),{loading:_,setLoading:g}=u(),f=async()=>{try{g(!0);const{message:e}=await K(m);n(e)&&(r.data=e.data,r.total=i(e.page))}finally{o.value=[],g(!1)}};I(()=>s.websiteName,e=>{e&&(m.p=1,m.search=e,f())});const x=()=>{s.websiteName&&f()};return x(),t({getList:x}),(e,a)=>{const t=J,s=p,l=G,n=E;return h(),S(n,{feedback:!1},{toolsLeft:N(()=>[w(t,{type:"primary",onClick:x},{default:N(()=>[H(W(e.$t("Public.Btn.Refresh")),1)]),_:1})]),table:N(()=>[w(s,{"checked-row-keys":C(o),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>B(o)?o.value=e:null),"row-key":"name",loading:C(_),data:C(r).data,columns:C(c)},null,8,["checked-row-keys","loading","data","columns"])]),pageRight:N(()=>[w(l,{page:C(m).p,"onUpdate:page":a[1]||(a[1]=e=>C(m).p=e),"page-size":C(m).limit,"onUpdate:pageSize":a[2]||(a[2]=e=>C(m).limit=e),"item-count":C(r).total,onRefresh:x},null,8,["page","page-size","item-count"])]),_:1})}}}),oe={class:"flex flex-col h-full gap-8px"},re={class:"flex-1 overflow-hidden"},ce=x({__name:"index",setup(a,{expose:t}){const s=e(),{loading:l,setLoading:i}=u(),o=y("None"),r=async()=>{i(!0);try{const{message:e}=await A({siteName:s.websiteName});n(e)&&(o.value=e.result?e.result.slice(-4e4):"None")}catch(e){o.value="None"}finally{i(!1)}};I(()=>s.websiteName,e=>{e&&r()});const c=()=>{s.websiteName&&r()};return c(),t({getList:c}),(e,a)=>{const t=J,s=X;return h(),b("div",oe,[w(t,{class:"self-start",type:"primary",onClick:c},{default:N(()=>[H(W(e.$t("Public.Btn.Refresh")),1)]),_:1}),k("div",re,[w(s,{loading:C(l),log:C(o)},null,8,["loading","log"])])])}}}),ue={class:"flex flex-col h-full gap-8px"},de={class:"flex-1 overflow-hidden"},pe=x({__name:"index",setup(a,{expose:t}){const s=e(),{loading:l,setLoading:i}=u(),o=y("None"),r=async()=>{i(!0);try{const{message:e}=await D({siteName:s.websiteName});n(e)&&(o.value=e.result?e.result.slice(-4e4):"None")}catch(e){o.value="None"}finally{i(!1)}};I(()=>s.websiteName,e=>{e&&r()});const c=()=>{s.websiteName&&r()};return c(),t({getList:c}),(e,a)=>{const t=J,s=X;return h(),b("div",ue,[w(t,{class:"self-start",type:"primary",onClick:c},{default:N(()=>[H(W(e.$t("Public.Btn.Refresh")),1)]),_:1}),k("div",de,[w(s,{loading:C(l),log:C(o)},null,8,["loading","log"])])])}}}),me={class:"text-error"},_e={class:"w-400px p-20px"},ge={class:"mb-16px"},fe=l(x({__name:"index",setup(a,{expose:t}){const s=e(),l=o(),{t:i}=q(),f=y(!1),x=y(0),{keys:v,table:S,columns:L}=d([{key:"start_time",title:i("Logs.Panel.index_13")},{key:"time",title:i("Public.Unit.Time"),render:e=>Number(e.time).toFixed(2)+" Sec"},{key:"xss",title:i("Site.TableRow.index_4"),render:e=>e.xss>0?w(r,{onClick:()=>{R("xss")}},{default:()=>[e.xss]}):e.xss},{key:"sql",title:i("Site.TableRow.index_5"),render:e=>e.sql>0?w(r,{onClick:()=>{R("sql")}},{default:()=>[e.sql]}):e.sql},{key:"san",title:i("Site.TableRow.index_6"),render:e=>e.san>0?w(r,{class:"button-color",onClick:()=>{R("san")}},{default:()=>[e.san]}):e.san},{key:"php",title:i("Logs.Panel.index_14"),render:e=>e.php>0?w(r,{onClick:()=>{R("php")}},{default:()=>[e.php]}):e.php},{key:"ip",title:i("Logs.Website.index_5"),render:e=>e.ip>0?w(r,{onClick:()=>{R("ip")}},{default:()=>[e.ip]}):e.ip},{key:"url",title:i("Logs.Website.index_1"),render:e=>e.url>0?w(r,{onClick:()=>{R("url")}},{default:()=>[e.url]}):e.url},{key:"log",title:i("Security.Anti.Index_7"),render:e=>e.xss+e.sql+e.san+e.php+e.ip+e.url}]),P=()=>{_({title:i("Site.Config.index_104"),content:i("Logs.Website.index_3",[s.websiteName]),onConfirm:async({hide:e})=>{try{await O({siteName:U.value}),f.value=!0,$()}finally{e()}}})},$=(e=0)=>{let a=setTimeout(async()=>{const{message:e}=await ee({path:U.value});n(e)&&(x.value=e.result,x.value>=100?(c.success(i("Site.Config.index_107")),f.value=!1,x.value=0,K(),clearTimeout(a)):$(1e3))},e)},R=e=>{g({title:"[".concat(e,"] ").concat(i("Site.Config.index_103")),data:{type:e,path:U.value},component:ae})},U=z(()=>{let e="";switch(l.webserver){case"nginx":e=".log";break;case"apache":e="-access_log";break;default:e="_ols.access_log"}return"/www/wwwlogs/".concat(s.websiteName).concat(e)}),{loading:T,setLoading:F}=u(),K=async()=>{try{F(!0);const{message:e}=await V({siteName:U.value});n(e)&&(S.data=e.is_status?[e]:[])}finally{v.value=[],F(!1)}};return I(()=>s.websiteName,e=>{e&&K()}),K(),t({init:K}),(e,a)=>{const t=J,s=p,l=E,n=m,i=M,o=Y;return h(),b(j,null,[w(l,{feedback:!1},{toolsLeft:N(()=>[w(t,{type:"primary",onClick:P},{default:N(()=>[H(W(e.$t("Site.Config.index_104")),1)]),_:1})]),table:N(()=>[w(s,{"checked-row-keys":C(v),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>B(v)?v.value=e:null),"row-key":"name","max-height":1e3,loading:C(T),data:C(S).data,columns:C(L)},null,8,["checked-row-keys","loading","data","columns"])]),_:1}),w(n,{class:"mt-16px"},{default:N(()=>[k("li",null,[H(W(e.$t("Site.Config.index_108"))+" ",1),k("span",me,W(e.$t("Site.Config.index_109")),1)]),k("li",null,W(e.$t("Site.Config.index_110")),1),k("li",null,W(e.$t("Site.Config.index_111")),1),k("li",null,W(e.$t("Site.Config.index_112")),1),k("li",null,[w(r,{href:"https://www.aapanel.com/forum/d/3351-nginx-waf-instructions",target:"_blank"},{default:N(()=>[H(W(e.$t("Site.Config.index_113")),1)]),_:1}),H(" "+W(e.$t("Site.Config.index_114")),1)])]),_:1}),w(o,{show:C(f),"onUpdate:show":a[1]||(a[1]=e=>B(f)?f.value=e:null)},{default:N(()=>[k("div",_e,[k("div",ge,W(e.$t("Site.Config.index_115")),1),w(i,{type:"line",status:"success",height:24,percentage:C(x),"border-radius":4,"indicator-placement":"inside"},null,8,["percentage"])])]),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-5bc24312"]]),xe=x({__name:"index",setup(e){const{t:a}=q(),t=y("operation"),s=[{key:"operation",label:a("Security.Tabs.Index_7"),component:ie},{key:"access",label:a("Logs.Website.index_2"),component:ce},{key:"error",label:a("Logs.Website.index_4"),component:pe},{key:"security",label:a("Site.Config.index_102"),component:fe}];return(e,a)=>{const l=Z;return h(),S(l,{class:"h-full",value:C(t),"onUpdate:value":a[0]||(a[0]=e=>B(t)?t.value=e:null),options:s},null,8,["value"])}}}),ye={class:"website-box"},ve=l(x({__name:"index",setup(e){const a=o();return(async()=>{await a.getPHPConfig()})(),(e,a)=>{const t=Q;return h(),S(t,{class:"p-16px"},{default:N(()=>[k("div",ye,[w(ne),w(xe)])]),_:1})}}}),[["__scopeId","data-v-0a3ec0ba"]]);export{ve as default};
