System.register(["./ssh-legacy.js?v=1769066082311","./page_layout-legacy.js?v=1769066082311","./vue-legacy.js?v=1769066082311","./naive-legacy.js?v=1769066082311","./public-legacy.js?v=1769066082311","./index-legacy112.js?v=1769066082311"],function(e,t){"use strict";var s,a,l,n,o,i,r,c,d,u,p,f,y,g,_,m,x,b,h,v,S,w,$,k,C,P,L,H,I,T,z,j,R,B,A,U,E,O,F,q,M,N,D,K,V,G,W,Z,J,Y,Q,X,ee,te,se,ae,le,ne,oe,ie,re,ce,de,ue,pe,fe,ye,ge,_e,me,xe,be,he,ve;return{setters:[e=>{s=e.k,a=e.j,l=e.h,n=e.e,o=e.b,i=e.c,r=e.r,c=e.i},e=>{d=e.d,u=e.p,p=e.aE,f=e.i,y=e.m,g=e.M,_=e.q,m=e._,x=e.aH,b=e.cK,h=e.a,v=e.cL,S=e.aa,w=e.l,$=e.aA,k=e.x},e=>{C=e.k,P=e.P,L=e.am,H=e.e,I=e.c,T=e.a2,z=e.V,j=e.a3,R=e.W,B=e.S,A=e.a4,U=e.U,E=e.R,O=e.O,F=e.H,q=e.I,M=e.F,N=e.Z,D=e.x,K=e.r,V=e.l,G=e.q,W=e.v,Z=e.a0,J=e.o,Y=e.n,Q=e.a5,X=e.an,ee=e.j,te=e._},e=>{se=e.dT,ae=e.db,le=e.de,ne=e.av,oe=e.dg,ie=e.d_,re=e.aC,ce=e.dk,de=e.dW,ue=e.dU,pe=e.dV,fe=e.dZ,ye=e.dl},e=>{ge=e.u,_e=e.m,me=e.c,xe=e.a,be=e.h},e=>{he=e.f,ve=e.g}],execute:function(){var Se=document.createElement("style");Se.textContent=".stat-box[data-v-ebe32ed6]{cursor:pointer}.stat-box.primary[data-v-ebe32ed6]{background-color:rgba(24,160,88,.1);border:1px solid rgba(24,160,88,.2)}.stat-box.error[data-v-ebe32ed6]{background-color:rgba(208,48,80,.1);border:1px solid rgba(208,48,80,.2)}.stat-box[data-v-33de2b22]{align-items:center;border-radius:8px;padding:16px;border:1px solid var(--color-border)}.flash-border .stat-box[data-v-33de2b22]{animation:flash-green-33de2b22 .8s ease-in-out 3}@keyframes flash-green-33de2b22{0%,to{border-color:var(--color-border)}50%{border-color:#18a058;box-shadow:0 0 10px rgba(24,160,88,.3)}}.stat-box[data-v-c9229bb2]{margin-top:16px;width:100%;align-items:center;border-radius:8px;padding:16px;border:1px solid var(--color-border)}.stat-box[data-v-ea1dc392]{flex:1 1 0%;align-items:center;border-radius:8px;padding:20px;border:1px solid var(--color-border);background-color:var(--color-bg-1)}\n/*$vite$:1*/",document.head.appendChild(Se);const we={class:"text-primary font-bold text-3xl"},$e={class:"text-error font-bold text-3xl"},ke={key:1,class:"w-full h-full bg-[var(--security-server-safe-progress)]"},Ce={class:"text-primary"},Pe={class:"text-error"},Le=C({__name:"ssh-login",setup(e){const{t:t}=P(),a=L(),l=H({success:0,error:0,today_success:0,today_error:0,yesterday_success:0,yesterday_error:0,seven_success:0,seven_error:0}),n=I(()=>[{label:t("Public.Search.Today"),success:l.today_success,error:l.today_error},{label:t("Public.Search.Yesterday"),success:l.yesterday_success,error:l.yesterday_error},{label:`7 ${t("Crontab.arrange.index_41")}`,success:l.seven_success,error:l.seven_error}]),o=(e,t)=>0===t?"0%":e/t*100+"%",i=()=>{a.push({path:"/security/ssh",query:{menu:"logs"}})};return(async()=>{const{message:e}=await s();d(e)&&(l.success=e.success,l.today_success=e.today_success,l.error=e.error,l.today_error=e.today_error,l.yesterday_success=e.yesterday_success,l.yesterday_error=e.yesterday_error,l.seven_success=e.sevenday_success,l.seven_error=e.sevenday_error)})(),(e,t)=>{const s=ae,a=se;return z(),T(a,{class:"p-16px",bordered:!1},{default:j(()=>[R(s,{class:"items-center",size:32},{default:j(()=>[R(s,null,{default:j(()=>[R(s,{class:"stat-box primary p-16px items-center flex-col! rounded-8px min-w-160px",onClick:i},{default:j(()=>[B("span",we,A(U(l).success),1),B("span",null,A(e.$t("SSH login successful")),1)]),_:1}),R(s,{class:"stat-box error p-16px items-center flex-col! rounded-8px min-w-160px",onClick:i},{default:j(()=>[B("span",$e,A(U(l).error),1),B("span",null,A(e.$t("SSH login failed")),1)]),_:1})]),_:1}),R(s,{class:"flex-1 flex-col!",size:12},{default:j(()=>[(z(!0),E(M,null,O(U(n),(e,t)=>(z(),T(s,{key:t,class:"items-center flex-nowrap!"},{default:j(()=>[B("div",{class:F(["text-14px min-w-80px",{"text-2xl font-bold":!t}])},A(e.label),3),R(s,{size:0,class:"flex-1 rounded-8px overflow-hidden",style:q({height:t?"8px":"12px"})},{default:j(()=>[e.success+e.error>0?(z(),E(M,{key:0},[B("div",{class:"h-full bg-primary",style:q({width:o(e.success,e.success+e.error)})},null,4),B("div",{class:"h-full bg-error",style:q({width:o(e.error,e.success+e.error)})},null,4)],64)):(z(),E("div",ke))]),_:2},1032,["style"]),R(s,null,{default:j(()=>[B("span",Ce,A(e.success),1),B("span",Pe,A(e.error),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}}),He=u(Le,[["__scopeId","data-v-ebe32ed6"]]),{t:Ie}=f.global,Te=e("a",()=>p.post("/ssh_security?action=get_sshd_anti_logs")),ze=e=>p.post("/safe/serversafe/repair_security",{data:JSON.stringify(e)},{requestOptions:{loading:Ie("Component.Pay.index_12"),successMessage:!0}}),je=e("s",e=>p.post("/ssh_security?action=set_anti_conf",e,{requestOptions:{loading:Ie("Component.Pay.index_12"),successMessage:!0}})),{t:Re}=(e("g",()=>p.post("/ssh_security?action=get_anti_conf")),e("d",e=>p.post("/ssh_security?action=del_ban_ip",e,{requestOptions:{loading:Ie("Component.Pay.index_12"),successMessage:!0}})),f.global),Be=N("service",()=>{const e=H({sshPort:22,complexityLevel:3,minPasswordLength:15,sshAlert:!1,sshProtection:!1,panelAlert:!1,panelOtp:!1,panelSsl:!0,noLoginCode:404,rootLoginType:"without-password",sshKey:!0}),t=H({score:0,total_score:100,score_text:"-",loading:!1}),s=H([{label:Re("Total banned IP"),value:"-"},{label:Re("Total failed connection"),value:"-"},{label:Re("Current banned IP"),value:"-"},{label:Re("Current failed connection"),value:"-"}]),n=D([]),o=H({install:!0}),i=K([]),r=K([]);return{safeConfig:e,panelLogin:i,sshLogin:r,info:t,sshBruteForce:o,safeItems:n,protectionInfo:s,getSafeConfig:async()=>{try{t.loading=!0;const{message:a}=await p.post("/safe/serversafe/get_security_info");if(d(a)&&(t.score=a.score,t.total_score=a.total_score,t.score_text=a.score_text,n.value=a.security_data,e.sshPort=a.security_data.find(e=>1===e.id)?.value,e.complexityLevel=a.security_data.find(e=>2===e.id)?.value,e.minPasswordLength=a.security_data.find(e=>3===e.id)?.value,e.sshAlert=!!a.security_data.find(e=>4===e.id)?.status,e.sshProtection=!!a.security_data.find(e=>6===e.id)?.value,e.panelAlert=!!a.security_data.find(e=>7===e.id)?.status,e.panelOtp=a.security_data.find(e=>8===e.id)?.value,e.panelSsl=a.security_data.find(e=>10===e.id)?.value,e.noLoginCode=a.security_data.find(e=>9===e.id)?.value,e.rootLoginType=a.security_data.find(e=>5===e.id)?.value,t.loading=!1,e.sshProtection)){const{message:e}=await Te();d(e)&&(s[0].value=e.total_banned,s[1].value=e.total_failed,s[2].value=e.currently_banned,s[3].value=e.currently_failed)}}finally{t.loading=!1}},getPanelLogin:async()=>{const{message:e}=await(t={limit:5,p:1},p.post("/logs/panel/get_panel_login_log",t));var t;d(e)&&(i.value=e.data)},getSshLogin:async()=>{const{message:e}=await l({limit:5,p:1,search:"",select:""});d(e)&&(r.value=e.data)},getBruteForceInfo:async()=>{const{message:t}=await a();d(t)&&(o.install=1===t.fail2ban.installed,e.sshKey="yes"===t.config.pubkey)}}}),{t:Ae}=f.global,Ue=[{label:"403 - Access Denied",value:403},{label:"404 - Page Not Found",value:404},{label:"416 - Invalid Request",value:416},{label:"408 - Client Timeout",value:408},{label:"400 - Client Request Error",value:400},{label:"401 - Unauthorized Access",value:401}],Ee=e=>{if(!e||"string"!=typeof e)return"-";const t=e.toLowerCase();return t.includes("edg/")?"Edge":t.includes("opr/")||t.includes("opera")?"Opera":!t.includes("chrome")||t.includes("edg/")||t.includes("opr/")?t.includes("firefox")?"Firefox":t.includes("safari")&&!t.includes("chrome")?"Safari":t.includes("msie")||t.includes("trident/")?"IE":"Unknown":"Chrome"},Oe=e=>e<=50?"text-error":e>50&&e<80?"text-warning":"text-primary",Fe=async()=>{const{safeConfig:e}=Be();if(!e.sshKey)return void y.error(Ae("Security.SSH.Basic.index_25"));const{close:t}=y.loading(Ae("Security.SSH.Basic.index_26"));try{await n(),window.open(`${g()}/ssh_security?action=download_key`)}finally{t()}},qe={class:"p-16px"},Me={class:"stat-box"},Ne={class:"flex justify-between"},De={class:"text-2xl font-bold"},Ke={class:"color-desc"},Ve=u(C({__name:"config-card",props:{title:{type:String,default:""},titleTips:{type:String,default:""},tips:{type:String,default:""}},setup:e=>(t,s)=>{const a=ae,l=_;return z(),E("div",qe,[B("div",Me,[B("div",Ne,[R(a,{class:"flex-col!"},{default:j(()=>[B("span",De,A(e.title),1),B("span",Ke,A(e.titleTips),1)]),_:1}),R(a,{class:"flex-nowrap! items-center"},{default:j(()=>[G(t.$slots,"default",{},void 0,!0)]),_:3})]),R(l,{class:"my-10px!"}),V(B("span",null,A(e.tips),513),[[W,e.tips]]),G(t.$slots,"content",{},void 0,!0)])])}}),[["__scopeId","data-v-33de2b22"]]),Ge={class:"safety-config-page pb-20px"},We={class:"text-primary font-bold"},Ze={class:"text-primary"},Je={class:"whitespace-nowrap"},Ye={class:"mb-10px"},Qe=C({__name:"config-safe",props:{target:{type:Number,default:0}},setup(e){const t=Be(),{safeConfig:s}=Z(t),a=e,l=()=>{t.getSafeConfig()},n=()=>{s.value.sshPort=Math.floor(64536*Math.random())+1e3},r=async()=>{await o({port:s.value.sshPort}),l()},c=async()=>{await ze({name:"Password Complexity Policy",args:{minclass:s.value.complexityLevel}}),l()},d=async()=>{await ze({name:"Password Length Limit",args:{len:s.value.minPasswordLength}}),l()},u=async e=>{lt(e,l)},p=async()=>{await b({status_code:s.value.noLoginCode}),l()},f=async()=>{await i({p_type:s.value.rootLoginType}),l()};return J(()=>{a.target&&Y(()=>{const e=document.getElementById(a.target.toString());e&&e.scrollIntoView({behavior:"smooth",block:"center"})})}),(t,a)=>{const o=le,i=oe,y=m,g=ie,_=ne,b=re,h=Q("i18n-t"),v=x,S=ae,w=ce,$=de,k=pe,C=ue;return z(),E("div",Ge,[R(Ve,{id:"1",title:t.$t("SSH port change"),"title-tips":t.$t("Recommended: Use a non-22 port"),tips:t.$t("Modify the default SSH port to avoid malicious scanning"),class:F({"flash-border":1===e.target})},{default:j(()=>[R(o,{type:"warning",size:"small"},{default:j(()=>[ee(A(t.$t("Important")),1)]),_:1}),R(_,{class:"w-200px"},{default:j(()=>[R(i,{value:U(s).sshPort,"onUpdate:value":a[0]||(a[0]=e=>U(s).sshPort=e),"show-button":!1},null,8,["value"]),R(g,{onClick:n},{default:j(()=>[R(y,{name:"base-refresh"})]),_:1})]),_:1}),R(b,{type:"primary",size:"small",onClick:r},{default:j(()=>[ee(A(t.$t("Public.Btn.Apply")),1)]),_:1})]),_:1},8,["title","title-tips","tips","class"]),R(Ve,{id:"2",title:t.$t("Password complexity"),"title-tips":t.$t("Recommended: Use a level greater than 3"),class:F({"flash-border":2===e.target})},{content:j(()=>[B("div",null,[R(h,{keypath:"Enable password complexity checks, the current complexity level will contain numbers, uppercase letters, lowercase letters, and special characters {a} types of characters"},{a:j(()=>[B("span",We,A(U(s).complexityLevel),1)]),_:1})]),R(S,{class:"items-center mt-10px"},{default:j(()=>[B("span",null,A(t.$t("Complexity level"))+":",1),R(v,{value:U(s).complexityLevel,"onUpdate:value":a[1]||(a[1]=e=>U(s).complexityLevel=e),min:1,max:4,step:1,class:"w-300px",onDragend:c},null,8,["value"]),B("span",Ze,A(U(s).complexityLevel)+"/4",1)]),_:1})]),_:1},8,["title","title-tips","class"]),R(Ve,{id:"3",title:t.$t("Password length limit"),"title-tips":t.$t("Recommended: Use a password length of 9-20 characters"),tips:t.$t("Set the minimum password length requirement"),class:F({"flash-border":3===e.target})},{default:j(()=>[B("span",Je,A(t.$t("Minimum length"))+":",1),R(i,{"show-button":!1,value:U(s).minPasswordLength,"onUpdate:value":a[2]||(a[2]=e=>U(s).minPasswordLength=e),min:6,max:64,class:"w-100px",size:"small"},null,8,["value"]),R(b,{type:"primary",size:"small",onClick:d},{default:j(()=>[ee(A(t.$t("Public.Btn.Apply")),1)]),_:1})]),_:1},8,["title","title-tips","tips","class"]),R(Ve,{id:4,title:t.$t("SSH login alert"),"title-tips":t.$t("Recommended: Enable SSH login alerts"),tips:t.$t("Send alert notifications when SSH logs in"),class:F({"flash-border":4===e.target})},{default:j(()=>[B("span",{class:F(U(s).sshAlert?"text-primary":"text-error")},A(U(s).sshAlert?t.$t("Configured"):t.$t("Not configured")),3),R(b,{type:"primary",size:"small",onClick:a[3]||(a[3]=e=>U(at)(l,6))},{default:j(()=>[ee(A(t.$t("Configure alert")),1)]),_:1})]),_:1},8,["title","title-tips","tips","class"]),R(Ve,{id:"6",title:t.$t("SSH Brute Force Protection"),"title-tips":t.$t("Recommended: Enable SSH Brute Force Protection"),tips:t.$t("Deployed in the background after activation to prevent brute-force attacks"),class:F({"flash-border":6===e.target})},{default:j(()=>[R(w,{value:U(s).sshProtection,"onUpdate:value":a[4]||(a[4]=e=>U(nt)(l))},null,8,["value"])]),_:1},8,["title","title-tips","tips","class"]),R(Ve,{id:"7",title:t.$t("Panel login alert"),"title-tips":t.$t("Recommended: Enable panel login alerts"),tips:t.$t("Send alert notifications when the panel logs in"),class:F({"flash-border":7===e.target})},{default:j(()=>[B("span",{class:F(U(s).panelAlert?"text-primary":"text-error")},A(U(s).panelAlert?t.$t("Configured"):t.$t("Not configured")),3),R(b,{type:"primary",size:"small",onClick:a[5]||(a[5]=e=>U(at)(l,7))},{default:j(()=>[ee(A(t.$t("Configure alert")),1)]),_:1})]),_:1},8,["title","title-tips","tips","class"]),R(Ve,{id:"8",title:t.$t("Panel Google Authenticator login"),"title-tips":t.$t("Recommended: Enable Google Authenticator login"),tips:t.$t("Enable Google Authenticator login to enhance security"),class:F({"flash-border":8===e.target})},{default:j(()=>[R(w,{value:U(s).panelOtp,"onUpdate:value":u},null,8,["value"])]),_:1},8,["title","title-tips","tips","class"]),R(Ve,{id:"9",title:t.$t("Not logged in response status code"),"title-tips":t.$t("Recommended: Set 404 as the response code"),tips:t.$t("The security entry was incorrect and returned certain status"),class:F({"flash-border":9===e.target})},{default:j(()=>[R($,{"consistent-menu-width":!1,value:U(s).noLoginCode,"onUpdate:value":a[6]||(a[6]=e=>U(s).noLoginCode=e),options:U(Ue),class:"w-200px",size:"small"},null,8,["value","options"]),R(b,{type:"primary",size:"small",onClick:p},{default:j(()=>[ee(A(t.$t("Public.Btn.Apply")),1)]),_:1})]),_:1},8,["title","title-tips","tips","class"]),R(Ve,{id:"10",title:t.$t("Panel SSL"),"title-tips":t.$t("Recommended: Enable panel HTTPS"),tips:t.$t("Enable HTTPS access (the panel will restart when set)"),class:F({"flash-border":10===e.target})},{default:j(()=>[R(w,{value:U(s).panelSsl,"onUpdate:value":U(ot)},null,8,["value","onUpdate:value"])]),_:1},8,["title","title-tips","tips","class"]),R(Ve,{id:"5",title:t.$t("Root password login settings"),"title-tips":t.$t("Recommended: Use only key login"),class:F({"flash-border":5===e.target})},{content:j(()=>[B("div",Ye,A(t.$t("Recommended to only allow key login")),1),R(C,{value:U(s).rootLoginType,"onUpdate:value":a[7]||(a[7]=e=>U(s).rootLoginType=e)},{default:j(()=>[R(k,{value:"without-password"},{default:j(()=>[ee(A(t.$t("Only key login")),1)]),_:1}),R(k,{value:"forced-commands-only"},{default:j(()=>[ee(A(t.$t("Only command execution")),1)]),_:1}),R(k,{value:"yes"},{default:j(()=>[ee(A(t.$t("Password and key login + key")),1)]),_:1}),R(k,{value:"no"},{default:j(()=>[ee(A(t.$t("Prohibited login")),1)]),_:1})]),_:1},8,["value"])]),default:j(()=>[R(b,{type:"primary",size:"small",onClick:f},{default:j(()=>[ee(A(t.$t("Public.Btn.Apply")),1)]),_:1})]),_:1},8,["title","title-tips","class"]),"without-password"===U(s).rootLoginType||"yes"===U(s).rootLoginType?(z(),T(Ve,{key:0,title:t.$t("Root key settings"),tips:t.$t("Enable aaPanel key, view and download")},{default:j(()=>[R(b,{type:"primary",size:"small",onClick:U(it)},{default:j(()=>[ee(A(t.$t("View key")),1)]),_:1},8,["onClick"]),R(b,{size:"small",onClick:U(Fe)},{default:j(()=>[ee(A(t.$t("Download key")),1)]),_:1},8,["onClick"])]),_:1},8,["title","tips"])):X("",!0)])}}}),{t:Xe}=f.global,et=()=>{ge({title:Xe("SSH protection configuration"),width:"400px",minHeight:"200px",footer:!0,component:te(()=>h(()=>t.import("./ssh-protection-config-legacy.js?v=1769066082311"),void 0))})},tt=()=>{ge({title:Xe("SSH protection log"),width:"600px",minHeight:"300px",component:te(()=>h(()=>t.import("./ssh-protection-log-legacy.js?v=1769066082311"),void 0))})},st=e=>{ge({title:Xe("Security configuration"),width:"800px",height:"800px",component:Qe,data:{target:e}})},at=(e,s)=>{ge({title:Xe("Configuration alarm task"),width:"860px",minHeight:"340px",footer:!0,data:{isEdit:!1,onRefresh:e,alert_type:s},component:te(()=>h(()=>t.import("./form-legacy2.js?v=1769066082311"),void 0))})},lt=async(e,s)=>{const a=Be(),{safeConfig:l}=Z(a);e?l.value.panelOtp?ge({title:Xe("Config.Safe.index_62"),width:600,component:te(()=>h(()=>t.import("./config-legacy2.js?v=1769066082311"),void 0))}):ge({title:Xe("Config.Safe.index_63"),width:670,footer:!0,data:{onRefresh:s},component:te(()=>h(()=>t.import("./confirm-legacy.js?v=1769066082311"),void 0))}):(await v({act:0},!0),s())},nt=async e=>{const t=Be(),{safeConfig:s,sshBruteForce:a}=Z(t);a.value.install?(await je({act:!s.value.sshProtection}),e()):_e("fail2ban",()=>{t.getBruteForceInfo()})},ot=e=>{e?he():ve()},it=()=>{const{safeConfig:e}=Be();e.sshKey?ge({title:Xe("Security.SSH.Basic.index_2"),width:"400px",minHeight:"322px",component:te(()=>h(()=>t.import("./view-legacy.js?v=1769066082311"),void 0))}):y.error(Xe("Security.SSH.Basic.index_24"))},rt={class:"text-2xl font-bold"},ct={class:"font-bold text-3xl"},dt={class:"text-2xl font-bold"},ut=["textContent"],pt=C({__name:"ssh-protection",setup(e){const t=Be(),{sshBruteForce:s,safeConfig:a,protectionInfo:l}=Z(t),n=async()=>{_e("fail2ban",()=>{t.getBruteForceInfo()})},o=async e=>{await je({act:e}),await t.getBruteForceInfo(),t.getSafeConfig()};return(e,t)=>{const i=ce,r=re,c=ae,d=m,u=se;return z(),T(u,{class:"p-16px"},{default:j(()=>[U(s).install?(z(),E(M,{key:0},[R(c,{class:"justify-between!"},{default:j(()=>[R(c,{class:"items-center"},{default:j(()=>[B("span",rt,A(e.$t("SSH protection")),1),R(i,{value:U(a).sshProtection,"onUpdate:value":o},null,8,["value"]),R(r,{type:"primary",size:"small",onClick:U(et)},{default:j(()=>[ee(A(e.$t("Security.Tabs.Index_1")),1)]),_:1},8,["onClick"])]),_:1}),R(r,{type:"primary",text:"",onClick:U(tt)},{default:j(()=>[ee(A(e.$t("Public.Btn.Details")),1)]),_:1},8,["onClick"])]),_:1}),R(c,{class:"flex-nowrap!"},{default:j(()=>[(z(!0),E(M,null,O(U(l),(e,t)=>(z(),T(c,{class:"stat-box flex-col!",key:t},{default:j(()=>[B("span",ct,A(e.value),1),B("span",null,A(e.label),1)]),_:2},1024))),128))]),_:1})],64)):(z(),T(c,{key:1,class:"justify-between! items-center h-full"},{default:j(()=>[R(c,{class:"items-center"},{default:j(()=>[R(d,{name:"base-info",size:36,color:"#f2711c"}),R(c,{class:"flex-col!"},{default:j(()=>[B("span",dt,A(e.$t("SSH protection function is not installed")),1),B("span",{textContent:A(e.$t("After installing the SSH protection function, you can effectively prevent malicious login attempts"))},null,8,ut)]),_:1})]),_:1}),R(r,{type:"primary",onClick:n},{default:j(()=>[ee(A(e.$t("Public.Btn.Install")),1)]),_:1})]),_:1}))]),_:1})}}}),ft=u(pt,[["__scopeId","data-v-c9229bb2"]]),yt={class:"text-2xl font-bold"},gt={class:"flex justify-between w-full"},_t={class:"font-bold"},mt={class:"flex justify-between w-full"},xt={class:"font-bold"},bt=u(C({__name:"ssh-login-table",setup(e){const t=Be(),{panelLogin:s,sshLogin:a}=Z(t),l=I(()=>{const e=s.value?.[0]||{};return{remote_addr:e.remote_addr||"-",remote_port:e.remote_port||0,login_time:e.login_time||0,login_type:e.login_type||0}}),n=I(()=>{const e=a.value?.[0]||{};return{address:e.address||"-",status:e.status||0,time:e.time||0,port:e.port||0}});return(e,t)=>{const s=ae,a=se;return z(),T(a,{class:"p-16px"},{default:j(()=>[B("span",yt,A(e.$t("Last login information")),1),R(s,{class:"mt-16px",size:16},{default:j(()=>[R(s,{size:16,class:"stat-box"},{default:j(()=>[B("div",gt,[B("span",_t,A(e.$t("SSH login")),1),B("span",{class:F(U(n).status?"text-primary":"text-error")},A(U(n).status?e.$t("Site.PHP.index_35"):e.$t("Security.SSH.Logs.index_3")),3)]),R(s,{class:"flex-col!"},{default:j(()=>[B("span",null,"IP: "+A(U(n).address),1),B("span",null,A(e.$t("Config.Safe.index_152"))+": "+A(U(S)(U(n).time)||"-"),1),B("span",null,A(e.$t("Site.TableRow.index_16"))+": "+A(U(n).port),1)]),_:1})]),_:1}),R(s,{size:12,class:"stat-box"},{default:j(()=>[B("div",mt,[B("span",xt,A(e.$t("Panel login")),1),B("span",{class:F(U(l).login_type?"text-primary":"text-error")},A(U(l).login_type?e.$t("Site.PHP.index_35"):e.$t("Security.SSH.Logs.index_3")),3)]),R(s,{class:"flex-col!"},{default:j(()=>[B("span",null,"IP: "+A(U(l).remote_addr),1),B("span",null,A(e.$t("Config.Safe.index_152"))+": "+A(U(S)(U(l).login_time)||"-"),1),B("span",null,A(e.$t("Site.TableRow.index_16"))+": "+A(U(l).remote_port),1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-ea1dc392"]]),ht=C({__name:"index",setup:e=>(e,t)=>{const s=ae;return z(),T(s,{class:"flex-nowrap!"},{default:j(()=>[R(s,{class:"flex-1"},{default:j(()=>[R(He),R(ft)]),_:1}),R(bt,{class:"flex-1"})]),_:1})}}),vt={class:"flex justify-between items-center mb-16px"},St={class:"text-2xl font-bold"},wt={class:"w-full"},$t={class:"w-full"},kt=C({__name:"index",setup(e){const t=Be(),{info:s,safeItems:a}=Z(t);return(e,t)=>{const l=ae,n=re,o=w,i=fe,r=m,c=ye,d=$,u=se;return z(),T(u,{class:"p-16px"},{default:j(()=>[B("div",vt,[R(l,{class:"items-center!"},{default:j(()=>[B("span",St,[ee(A(e.$t("Safety rating"))+": ",1),B("text",{class:F(U(Oe)(U(s).score))},A(U(s).score)+" / "+A(U(s).total_score),3)]),B("span",null,A(U(s).score_text),1)]),_:1}),R(n,{type:"primary",size:"small",onClick:t[0]||(t[0]=e=>U(st)())},{default:j(()=>[t[1]||(t[1]=B("i",{class:"i-material-symbols:settings-outline text-16px mr-3px"},null,-1)),B("span",null,A(e.$t("Security configuration")),1)]),_:1,__:[1]})]),R(d,{cols:"1 s:2 m:3 l:3 xl:5",responsive:"screen","x-gap":12,"y-gap":12},{default:j(()=>[U(s).loading?(z(),E(M,{key:0},O(10,e=>R(i,{key:e},{default:j(()=>[R(o,{height:"100px",sharp:!1})]),_:2},1024)),64)):(z(!0),E(M,{key:1},O(U(a),(e,t)=>(z(),T(i,{key:t},{default:j(()=>[R(c,{class:"cursor-pointer p-10px min-h-100px",title:e.name,type:e.status?"success":"error",onClick:t=>U(st)(e.id),"show-icon":!1},{default:j(()=>[e.status?(z(),T(l,{key:0,class:"flex-nowrap!",size:4},{default:j(()=>[R(r,{name:"base-success",size:"17",color:"#20a53a"}),B("span",wt,A(e.desc),1)]),_:2},1024)):(z(),T(l,{key:1,class:"flex-nowrap!",size:4},{default:j(()=>[R(r,{name:"base-error",size:"17",color:"#E85445"}),B("span",$t,A(e.desc),1)]),_:2},1024))]),_:2},1032,["title","type","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})}}}),Ct={class:"text-2xl font-bold"},Pt=C({__name:"login-ssh",setup(e){const{t:t}=P(),s=L(),a=Be(),{sshLogin:l}=Z(a),{columns:n}=me([{title:"IP",key:"address",render:e=>R("a",{class:"bt-link",href:"javascript:;",onClick:()=>{d(e)}},[e.address])},{title:t("Security.History.Index_11"),key:"time"},{title:t("Site.TableRow.index_16"),key:"port"},{title:t("Public.Table.Status"),key:"status",render:e=>R("span",{class:1===e.status?"text-primary":"text-error"},[ee(" "),1===e.status?t("Site.PHP.index_35"):t("Security.SSH.Logs.index_3"),ee(" ")])},{title:t("Site.Lable.index_25"),key:"user"}]),o=I(()=>l.value),i=()=>{s.push({path:"/security/ssh",query:{menu:"logs"}})},d=e=>{xe({title:t("Security.SSH.Logs.index_10"),content:e.deny_status?t("Security.SSH.Logs.index_13"):t("Security.SSH.Logs.index_11"),onConfirm:async()=>{if(e.deny_status){const{message:t}=await r({address:e.address});k(t)&&t.length>0&&y.success(t[0].msg)}else{const{message:s}=await c({address:e.address,types:"drop",brief:t("Security.SSH.Logs.index_12"),domain:"",choose:"address"});k(s)&&s.length>0&&y.success(s[0].msg)}a.getSshLogin()}})};return(e,t)=>{const s=re,a=ae,l=be,r=se;return z(),T(r,{class:"p-16px"},{default:j(()=>[R(a,{class:"mb-10px justify-between!"},{default:j(()=>[B("span",Ct,"SSH "+A(e.$t("last 5 login records")),1),R(s,{type:"primary",text:"",onClick:i},{default:j(()=>[ee(A(e.$t("View more")),1)]),_:1})]),_:1}),R(l,{data:U(o),columns:U(n)},null,8,["data","columns"])]),_:1})}}}),Lt={class:"text-2xl font-bold"},Ht=C({__name:"login-aapanel",setup(e){const{t:t}=P(),s=Be(),{panelLogin:a}=Z(s),{columns:l}=me([{title:"IP",key:"remote_addr"},{title:t("Security.History.Index_11"),key:"login_time",render:e=>R("span",null,[S(e.login_time)])},{title:t("Site.TableRow.index_16"),key:"remote_port"},{title:t("Public.Table.Status"),key:"login_type",render:e=>R("span",{class:1===e.login_type?"text-primary":"text-error"},[1===e.login_type?t("Site.PHP.index_35"):t("Security.SSH.Logs.index_3")])},{title:t("Waf.Site.Config.index_46"),key:"user_agent",render:e=>R("span",null,[Ee(e.user_agent)])}]),n=I(()=>a.value);return(e,t)=>{const s=ae,a=be,o=se;return z(),T(o,{class:"p-16px"},{default:j(()=>[R(s,{class:"mb-10px"},{default:j(()=>[B("span",Lt,"aaPanel "+A(e.$t("last 5 login records")),1)]),_:1}),R(a,{data:U(n),columns:U(l)},null,8,["data","columns"])]),_:1})}}}),It=C({__name:"index",setup:e=>(e,t)=>{const s=ae;return z(),T(s,{class:"flex-nowrap!"},{default:j(()=>[R(Pt),R(Ht)]),_:1})}}),Tt=C({__name:"index",setup(e){const t=Be();return t.getSafeConfig(),t.getPanelLogin(),t.getSshLogin(),t.getBruteForceInfo(),(e,t)=>{const s=ae;return z(),T(s,{class:"flex-col!"},{default:j(()=>[R(ht),R(kt),R(It)]),_:1})}}}),zt=Object.freeze(Object.defineProperty({__proto__:null,default:Tt},Symbol.toStringTag,{value:"Module"}));e("i",zt)}}});
