System.register(["./public-legacy.js?v=1763625242172","./index-legacy107.js?v=1763625242172","./index-legacy.js?v=1763625242172","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1763625242172","./vue-legacy.js?v=1763625242172","./page_layout-legacy.js?v=1763625242172","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1763625242172","./index.vue_vue_type_script_setup_true_lang-legacy10.js?v=1763625242172","./naive-legacy.js?v=1763625242172","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1763625242172","./common-legacy.js?v=1763625242172","./__commonjsHelpers__-legacy.js?v=1763625242172","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1763625242172","./index-legacy98.js?v=1763625242172"],(function(e,t){"use strict";var a,n,l,i,s,o,d,u,c,r,p,_,y,m,g,x,h,f,v,w,S,b,k,I,A,$,C,U,H,j,R,q,L,O,P,T,z,M,D,K,B,V,E,F,J,N,W,X,G,Q,Y,Z,ee,te,ae,ne,le,ie;return{setters:[e=>{a=e.c,n=e.f,l=e.d,i=e.e,s=e.h,o=e._,d=e.I,u=e.b,c=e.q},e=>{r=e._},e=>{p=e._},e=>{_=e._},e=>{y=e.k,m=e.P,g=e.r,x=e.e,h=e.R,f=e.S,v=e.X,w=e.a3,S=e.V,b=e.j,k=e.a4,I=e.aj,A=e.U,$=e.N,C=e.a0,U=e.w,H=e.F,j=e.a2,R=e.O,q=e.H,L=e.l,O=e.v,P=e.c},e=>{T=e.i,z=e.bf,M=e.c,D=e.q,K=e.p,B=e.x,V=e.cL,E=e.m,F=e.y,J=e._,N=e.u},e=>{W=e._},e=>{X=e._},e=>{G=e.dP,Q=e.dV,Y=e.au,Z=e.aC,ee=e.df,te=e.d9,ae=e.bJ,ne=e.dS,le=e.dj},e=>{ie=e._},null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".form[data-v-201446e2] .n-form-item{margin-right:5px!important}.form[data-v-201446e2] .n-form-item-label{width:auto!important;padding:5px!important}.ul-style[data-v-f55518e2]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-f55518e2]{display:flex;align-items:center}.item[data-v-f55518e2]{border-left:3px solid #def2e2}.item li[data-v-f55518e2]{width:180px;margin-left:-3px;font-size:14px;line-height:36px;padding:0 20px;cursor:pointer}.item .active[data-v-f55518e2]{border-left:3px solid #20a53a;color:#20a53a;font-weight:700;font-size:16px}\n",document.head.appendChild(t);const{t:se}=T.global,oe=e=>z.post("/plugin?name=syssafe&action=a&s=set_safe_status",e,{requestOptions:{loading:se("Security.Api.Index_5"),successMessage:!0}}),de=e=>z.post("/plugin?name=syssafe&action=a&s=remove_safe_path",e,{requestOptions:{loading:se("Security.Api.Index_3"),successMessage:!0}}),ue=e=>z.post("/plugin?name=syssafe&action=a&s=add_safe_path",e,{requestOptions:{loading:se("Security.Api.Index_4"),successMessage:!0}}),ce=e=>z.post("/plugin?name=syssafe&action=a&s=add_ssh_limit",e,{requestOptions:{loading:se("Security.Api.Index_4"),successMessage:!0}}),re=e=>z.post("/plugin?name=syssafe&action=a&s=remove_ssh_limit",e,{requestOptions:{loading:se("Security.Api.Index_3"),successMessage:!0}}),pe=e=>z.post("/plugin?name=syssafe&action=a&s=save_ssh_config",e,{requestOptions:{loading:se("Security.Api.Index_6"),successMessage:!0}}),_e=e=>z.post("/plugin?name=syssafe&action=a&s=remove_process_white",e,{requestOptions:{loading:se("Security.Api.Index_3"),successMessage:!0}}),ye=e=>z.post("/plugin?name=syssafe&action=a&s=add_process_white",e,{requestOptions:{loading:se("Security.Api.Index_4"),successMessage:!0}}),me={class:"p-20px"},ge=y({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=m(),n=[{label:a("Security.Anti.Index_28"),value:"i"},{label:a("Security.Anti.Index_29"),value:"a"}],l=e,{getList:i}=l.data,{row:s}=l.data,o=g(null),d=x({path:"",chattr:"i",d_mode:""}),u={path:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]},d_mode:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{await(o.value?.validate()),await ue({...d,s_key:s.key}),i?.(),e()}}),(e,t)=>{const a=X,l=G,i=Q,s=Y,c=W;return h(),f("div",me,[v(c,{ref_key:"formRef",ref:o,model:S(d),rules:u},{default:w((()=>[v(l,{label:e.$t("Site.DelSite.index_2"),path:"path"},{default:w((()=>[v(a,{class:"w-280px",value:S(d).path,"onUpdate:value":t[0]||(t[0]=e=>S(d).path=e),placeholder:e.$t("Security.Anti.Index_26")},null,8,["value","placeholder"])])),_:1},8,["label"]),v(l,{label:e.$t("Security.Hardening.Index_8")},{default:w((()=>[v(i,{class:"w-280px",value:S(d).chattr,"onUpdate:value":t[1]||(t[1]=e=>S(d).chattr=e),options:n},null,8,["value"])])),_:1},8,["label"]),v(l,{label:e.$t("Security.Hardening.Index_9"),path:"d_mode"},{default:w((()=>[v(s,{class:"w-280px!",value:S(d).d_mode,"onUpdate:value":t[2]||(t[2]=e=>S(d).d_mode=e),type:"text",placeholder:e.$t("Security.Anti.Index_27")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),xe={class:"p-20px"},he=y({__name:"index",props:{data:{}},setup(e){const{t:t}=m(),d=e,{data:u}=d,{keys:c,table:r,columns:y}=a([{key:"path",title:t("Site.DelSite.index_2")},{key:"chattr",title:t("Security.Hardening.Index_8"),render:e=>"i"==e.chattr?t("Security.Anti.Index_28"):t("Security.Anti.Index_29")},{key:"s_mode",title:t("Security.Hardening.Index_9"),render:e=>e.s_mode!==e.d_mode?`${e.s_mode} >> ${e.d_mode}`:e.d_mode},{key:"state",title:t("Config.Safe.index_156"),render:e=>v("span",{style:{color:e.state?"#20a53a":"#ff0029"}},[e.state?t("Security.Anti.Index_35"):t("Security.Anti.Index_36")])},n({width:130,title:t("Public.Table.Operation"),options:e=>[{label:t("Public.Btn.Del"),onClick:async()=>{await de({s_key:u.key,path:e.path}),await C()}}]})]),g=async()=>{U.data.row=u,U.show=!0},{loading:x,setLoading:$}=l(),C=async()=>{try{$(!0);const{message:e}=await(e=>z.post("/plugin?name=syssafe&action=a&s=get_safe_config",e))({s_key:u.key});M(e)&&(r.data=e.paths)}finally{c.value=[],$(!1)}};C();const U=i(t("Security.Anti.Index_30"),{getList:C});return(e,t)=>{const a=Z,n=s,l=o,i=_,d=p;return h(),f("div",xe,[v(i,null,{toolsLeft:w((()=>[v(a,{type:"primary",onClick:g},{default:w((()=>[b(k(e.$t("Security.Anti.Index_30")),1)])),_:1})])),table:w((()=>[v(n,{"checked-row-keys":S(c),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>I(c)?c.value=e:null),loading:S(x),"loading-num":3,"max-height":340,data:S(r).data,columns:S(y)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:w((()=>[v(l,null,{default:w((()=>[A("li",null,k(e.$t("Security.Anti.Index_31")),1),A("li",null,k(e.$t("Security.Anti.Index_32")),1),A("li",null,k(e.$t("Security.Anti.Index_33")),1),A("li",null,k(e.$t("Security.Anti.Index_34")),1)])),_:1})])),_:1}),v(d,{show:S(U).show,"onUpdate:show":t[1]||(t[1]=e=>S(U).show=e),title:S(U).title,data:S(U).data,width:500,footer:!0,component:ge},null,8,["show","title","data"])])}}}),fe={class:"p-20px"},ve={class:"leading-32px"},we=y({__name:"index",setup(e){const{t:t}=m(),a=g(null),n=x({cycle:120,limit_count:3,limit:3600}),l={cycle:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit_count:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]}},i=async()=>{await(a.value?.validate()),await pe($(n))};return(async()=>{const{message:e}=await z.post("/plugin?name=syssafe&action=a&s=get_ssh_config");M(e)&&(n.cycle=e.cycle,n.limit=e.limit,n.limit_count=e.limit_count)})(),(e,t)=>{const s=ee,d=G,u=Z,c=W,r=D,p=o;return h(),f("div",fe,[v(c,{ref_key:"formRef",ref:a,model:S(n),rules:l,inline:"","label-width":"auto",class:"form"},{default:w((()=>[v(d,{label:e.$t("Security.Anti.Index_37"),path:"cycle"},{default:w((()=>[v(s,{"show-button":!1,value:S(n).cycle,"onUpdate:value":t[0]||(t[0]=e=>S(n).cycle=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),v(d,{label:e.$t("Security.Anti.Index_38"),path:"limit_count"},{default:w((()=>[v(s,{"show-button":!1,value:S(n).limit_count,"onUpdate:value":t[1]||(t[1]=e=>S(n).limit_count=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),v(d,{label:e.$t("Security.Anti.Index_39"),path:"limit"},{default:w((()=>[v(s,{"show-button":!1,value:S(n).limit,"onUpdate:value":t[2]||(t[2]=e=>S(n).limit=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),A("span",ve,k(e.$t("Security.Anti.Index_40")),1),v(u,{type:"primary",class:"ml-auto",onClick:i},{default:w((()=>[b(k(e.$t("Site.Cert.index_60")),1)])),_:1})])),_:1},8,["model"]),v(r,{class:"mb-15px!"}),v(p,null,{default:w((()=>[A("li",null,k(e.$t("Security.Anti.Index_41")),1),A("li",null,k(e.$t("Security.Anti.Index_42")),1),A("li",null,k(e.$t("Security.Anti.Index_43")),1)])),_:1})])}}}),Se=K(we,[["__scopeId","data-v-201446e2"]]),be={class:"p-20px"},ke=y({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=m(),n=e,{getList:l}=n.data,i=g(null),s=x({process_name:""}),o={process_name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{await(i.value?.validate()),await ye($(s)),l?.(),e()}}),(e,t)=>{const a=Y,n=G,l=W;return h(),f("div",be,[v(l,{ref_key:"formRef",ref:i,model:S(s),rules:o},{default:w((()=>[v(n,{label:e.$t("Home.index_24"),path:"process_name"},{default:w((()=>[v(a,{class:"w-280px!",value:S(s).process_name,"onUpdate:value":t[0]||(t[0]=e=>S(s).process_name=e),type:"text",placeholder:e.$t("Security.Anti.Index_22")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),Ie={class:"p-20px"},Ae=y({__name:"index",setup(e){const{t:t}=m(),{keys:d,table:u,columns:c}=a([{key:"name",title:t("Home.index_24")},n({width:130,title:t("Public.Table.Operation"),options:e=>[{label:t("Public.Btn.Del"),onClick:async()=>{await _e({process_name:e.name}),await x()}}]})]),r=async()=>{$.show=!0},{loading:y,setLoading:g}=l(),x=async()=>{try{g(!0);const{message:e}=await z.post("/plugin?name=syssafe&action=a&s=get_process_white");B(e)&&(u.data=e.map((e=>({name:e}))))}finally{d.value=[],g(!1)}};x();const $=i(t("Security.Anti.Index_23"),{getList:x});return(e,t)=>{const a=Z,n=s,l=o,i=_,m=p;return h(),f("div",Ie,[v(i,null,{toolsLeft:w((()=>[v(a,{type:"primary",onClick:r},{default:w((()=>[b(k(e.$t("Security.Anti.Index_23")),1)])),_:1})])),table:w((()=>[v(n,{"checked-row-keys":S(d),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>I(d)?d.value=e:null),loading:S(y),"loading-num":3,"max-height":340,data:S(u).data,columns:S(c)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:w((()=>[v(l,null,{default:w((()=>[A("li",null,k(e.$t("Security.Anti.Index_24")),1),A("li",null,k(e.$t("Security.Anti.Index_25")),1)])),_:1})])),_:1}),v(m,{show:S($).show,"onUpdate:show":t[1]||(t[1]=e=>S($).show=e),title:S($).title,data:S($).data,width:500,footer:!0,component:ke},null,8,["show","title","data"])])}}}),$e={class:"color-#ff3333"},Ce=y({__name:"index",setup(e,{expose:t}){const{t:u}=m(),c=V(),{systemHardening:r}=C(c),y=i(),g=i(),x=i(),{keys:b,table:$,columns:j}=a([{key:"name",width:"10%",title:u("Site.TableRow.index_2")},{key:"ps",title:u("Security.Hardening.Index_5"),ellipsis:{tooltip:{width:"trigger"}}},d({key:"open",title:u("Site.TableRow.index_14"),onClick:async(e,t)=>{if(!r.value)return E.error(u("Security.Hardening.Index_6")),void L();await oe({s_key:t.key})}}),n({width:130,title:u("Site.TableRow.index_30"),options:e=>[{label:u("Site.TableOP.index_3"),onClick:()=>"ssh"===e.key?(g.title=`${u("Security.Hardening.Index_7")} [${e.name}]`,void(g.show=!0)):"process"===e.key?(x.title=`${u("Security.Hardening.Index_7")} [${e.name}]`,void(x.show=!0)):(y.title=`${u("Security.Hardening.Index_7")} [${e.name}]`,y.data=e,void(y.show=!0))}]})]);U((()=>c.isRefresh),(e=>{e&&(c.setRefresh(!1),L())}));const{loading:R,setLoading:q}=l(),L=async()=>{try{q(!0);const{message:e}=await z.post("/plugin?name=syssafe&action=a&s=get_safe_status");M(e)&&(r.value=e.open,$.data=e.list)}finally{b.value=[],q(!1)}};return L(),t({init:L}),(e,t)=>{const a=s,n=_,l=o,i=p;return h(),f(H,null,[v(n,{feedback:!0},{table:w((()=>[v(a,{"checked-row-keys":S(b),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>I(b)?b.value=e:null),"row-key":"title",loading:S(R),data:S($).data,columns:S(j)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),v(l,{class:"mt-16px"},{default:w((()=>[A("li",null,k(e.$t("Security.Hardening.Index_1")),1),A("li",null,k(e.$t("Security.Hardening.Index_2")),1),A("li",null,k(e.$t("Security.Hardening.Index_3")),1),A("li",$e,k(e.$t("Security.Hardening.Index_4")),1)])),_:1}),v(i,{show:S(y).show,"onUpdate:show":t[1]||(t[1]=e=>S(y).show=e),title:S(y).title,data:S(y).data,width:700,"min-height":500,footer:!1,component:he},null,8,["show","title","data"]),v(i,{show:S(g).show,"onUpdate:show":t[2]||(t[2]=e=>S(g).show=e),title:S(g).title,data:S(g).data,width:800,footer:!1,component:Se},null,8,["show","title","data"]),v(i,{show:S(x).show,"onUpdate:show":t[3]||(t[3]=e=>S(x).show=e),title:S(x).title,data:S(x).data,width:700,"min-height":580,footer:!1,component:Ae},null,8,["show","title","data"])],64)}}}),Ue=y({__name:"index",setup(e,{expose:t}){const{t:i}=m(),{loading:d,setLoading:u}=l(),c=g(""),r=/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/,{keys:p,table:y,columns:x}=a([{key:"address",title:i("Security.Anti.Index_15"),width:"70%"},{key:"end",title:i("Security.History.Index_12"),render:e=>0==e.end?i("Security.Anti.Index_18"):e.end},n({width:130,title:i("Site.TableRow.index_30"),options:e=>[{label:i("Security.Anti.Index_19"),onClick:async()=>{await re({ip:e.address}),C()}}]})]),$=async()=>{r.test(c.value)?(await ce({ip:c.value}),C(),c.value=""):E.error(i("Security.Anti.Index_20"))},C=async()=>{try{u(!0);const{message:e}=await z.post("/plugin?name=syssafe&action=a&s=get_ssh_limit_info");B(e)&&(y.data=e)}finally{p.value=[],u(!1)}};return C(),t({init:C}),(e,t)=>{const a=Y,n=Z,l=te,i=s,u=_,r=o;return h(),f("div",null,[v(u,null,{toolsLeft:w((()=>[v(l,{class:"flex-nowrap!"},{default:w((()=>[v(a,{value:S(c),"onUpdate:value":t[0]||(t[0]=e=>I(c)?c.value=e:null),type:"text",placeholder:e.$t("Security.Anti.Index_15"),class:"w-280px!"},null,8,["value","placeholder"]),v(n,{type:"primary",onClick:$},{default:w((()=>[b(k(e.$t("Public.Btn.Add")),1)])),_:1})])),_:1})])),table:w((()=>[v(i,{"checked-row-keys":S(p),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>I(p)?p.value=e:null),"row-key":"address",loading:S(d),"max-height":440,data:S(y).data,columns:S(x)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),v(r,{class:"mt-16px"},{default:w((()=>[A("li",null,k(e.$t("Security.Anti.Index_16")),1),A("li",null,k(e.$t("Security.Anti.Index_17")),1)])),_:1})])}}}),He=y({__name:"index",setup(e,{expose:t}){const{t:n}=m(),{keys:i,table:o,columns:d}=a([{key:"addtime",title:n("Site.Cert.index_68"),width:"20%"},{key:"log",title:n("Security.Anti.Index_21")}]),u=x({p:1,limit:10,search:"System hardening"}),{loading:c,setLoading:r}=l(),p=async()=>{try{r(!0);const{message:t}=await(e=$(u),z.post("/data?action=getData",{...e,table:"logs",order:"id desc"}));M(t)&&(o.data=t.data,o.total=F(t.page))}finally{i.value=[],r(!1)}var e};return p(),t({init:p}),(e,t)=>{const a=s,n=ie,l=_;return h(),j(l,{feedback:!0},{table:w((()=>[v(a,{"checked-row-keys":S(i),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>I(i)?i.value=e:null),"row-key":"addtime",loading:S(c),data:S(o).data,columns:S(d)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:w((()=>[v(n,{page:S(u).p,"onUpdate:page":t[1]||(t[1]=e=>S(u).p=e),"page-size":S(u).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>S(u).limit=e),"item-count":S(o).total,"store-key":"security-log",onRefresh:p},null,8,["page","page-size","item-count"])])),_:1})}}}),je=y({__name:"index",setup(e){const{t:t}=m(),a=g("protection"),n=[{key:"protection",label:t("Security.Tabs.Index_8"),component:Ce},{key:"block",label:t("Security.Tabs.Index_9"),component:Ue},{key:"operation",label:t("Security.Tabs.Index_10"),component:He}];return(e,t)=>{const l=r;return h(),j(l,{value:S(a),"onUpdate:value":t[0]||(t[0]=e=>I(a)?a.value=e:null),options:n},null,8,["value"])}}}),Re={class:"pt-40px pb-40px"},qe={class:"mb-16px"},Le={class:"ul-style"},Oe={class:"text-center my-24px"},Pe={class:"flex justify-center"},Te={class:"item"},ze=["onClick"],Me=K(y({__name:"conversion",setup(e){const t=g(0),a=["Protection","Block IP","Operation logs"],n=()=>{u({source:102})};return(e,l)=>{const i=J,s=Z,o=ae,d=ne;return h(),j(d,null,{default:w((()=>[A("div",Re,[l[2]||(l[2]=A("div",{class:"mb-24px text-center text-22px font-bold"}," System Hardening prevention features ",-1)),A("div",qe,[A("ul",Le,[A("li",null,[v(i,{name:"security-system",size:"18"}),l[0]||(l[0]=A("span",{class:"ml-8px"},"Prevents the system from being implanted with a Trojan",-1))]),A("li",null,[v(i,{name:"security-surety",size:"30"}),l[1]||(l[1]=A("span",null,"Harden the system security configuration",-1))])])]),A("div",Oe,[v(s,{type:"primary",class:"h-36px text-14px",onClick:n},{default:w((()=>[b(k(e.$t("WP.Transition.index_7")),1)])),_:1})]),A("div",Pe,[A("div",Te,[A("ul",null,[(h(),f(H,null,R(a,((e,a)=>A("li",{class:q({active:S(t)==a}),key:a,onClick:e=>t.value=a},k(e),11,ze))),64))])]),L(v(o,{width:"100%",src:S("/static/vite/images/protection.png")},null,8,["src"]),[[O,0==S(t)]]),L(v(o,{width:"100%",src:S("/static/vite/images/block.png")},null,8,["src"]),[[O,1==S(t)]]),L(v(o,{width:"100%",src:S("/static/vite/images/log.png")},null,8,["src"]),[[O,2==S(t)]])])])])),_:1})}}}),[["__scopeId","data-v-f55518e2"]]),De={key:0};e("default",y({__name:"index",setup(e){const t=N(),{isPro:a}=C(t),n=V(),{systemHardening:l}=C(n),i=g(l.value),s=P((()=>l.value));U(s,(e=>{i.value=e}));const o=async()=>{await z.post("/plugin?name=syssafe&action=a&s=set_open",{},{requestOptions:{loading:se("Security.Api.Index_5"),successMessage:!0}}),await n.setRefresh(!0)};return(async()=>{a.value&&await c("syssafe")})(),(e,t)=>{const n=le,l=te,s=ne;return S(a)?(h(),f("div",De,[v(s,{class:"my-15px"},{default:w((()=>[v(l,{class:"p-15px items-center"},{default:w((()=>[A("span",null,k(e.$t("Security.Anti.Index_14")),1),v(n,{value:S(i),"onUpdate:value":[t[0]||(t[0]=e=>I(i)?i.value=e:null),o],"rubber-band":!1,size:"small"},null,8,["value"])])),_:1})])),_:1}),v(s,{class:"p-15px"},{default:w((()=>[v(je)])),_:1})])):(h(),j(Me,{key:1}))}}}))}}}));
