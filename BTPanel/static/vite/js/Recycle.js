import{_ as e}from"./index.js?v=1769066082311";import{_ as l}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1769066082311";import{f as a,a as t,Z as i,h as c}from"./public.js?v=1769066082311";import{_ as s}from"./index223.js?v=1769066082311";import{n,aa as o,aE as r,d as m,x as f,p as d}from"./page_layout.js?v=1769066082311";import{F as u,w as p}from"./CalcSize.vue_vue_type_script_setup_true_lang.js?v=1769066082311";import{dd as y,dk as v,aC as b,dR as _}from"./naive.js?v=1769066082311";import{k as g,P as k,i as w,r as h,W as x,c as R,a2 as j,V as C,a3 as $,S as z,a4 as D,ak as U,U as P,j as T}from"./vue.js?v=1769066082311";import"./common.js?v=1769066082311";import"./__commonjsHelpers__.js?v=1769066082311";import"./soft2.js?v=1769066082311";import"./soft.js?v=1769066082311";import"./site.js?v=1769066082311";const B={class:"recycle-wrapper"},F={class:"recycle-top"},q={class:"flex gap-20px"},M={class:"config-item"},O={class:"config-item"},N={class:"config-item"},S={class:"recycle-main"},G={class:"tabs"},K={class:"tab-content"},E={class:"mt-10px"},H=d(g({__name:"Recycle",setup(d,{expose:g}){const{t:H}=k(),I=w("fileStore"),J=h(!1);g({open(){J.value=!0,le()},close(){J.value=!1}});const V=h("all"),W=h(!1),Z=h([]),A=h([]),L=h([]),Q=h(!1),X=h(!1),Y=h([{type:"selection",width:40},{key:"name",title:()=>H("file.fileName"),render:e=>x("div",{class:"flex items-center gap-4px"},[x(u,{ext:e.ext},null),x("div",{class:"flex-1 w-0"},[x(y,null,{default:()=>[e.name]})])])},{key:"dname",title:()=>H("file.recycle.originalDirectory"),ellipsis:{tooltip:!0}},{key:"size",title:()=>H("file.size"),width:180,render:e=>n(e.size)},{title:()=>H("file.recycle.removalTime"),key:"time",width:200,render:e=>o(e.time)},a({width:200,options:e=>[{label:H("file.recycle.recover"),onClick:()=>{me(e)}},{label:H("file.recycle.deletePermanently"),onClick:()=>{fe(e)}}]})]),ee=[{key:"restore",label:H("file.recycle.batchRestore"),type:"confirm",confirm:{title:H("file.recycle.batchRestore"),desc:H("file.recycle.batchRestoreConfirm"),api:e=>r.post("/files?action=Re_Recycle_bin",{path:e.rname}),done:()=>{le(),p(I)},columns:[{key:"name",title:()=>H("file.fileName")}]}},{key:"delete",label:H("file.recycle.batchDeletePermanently"),type:"confirm",confirm:{title:H("file.recycle.batchDeletePermanently"),desc:H("file.recycle.batchDeleteConfirm"),api:e=>r.post("/files?action=Del_Recycle_bin",{path:e.rname}),done:()=>{le()},columns:[{key:"name",title:()=>H("file.fileName")}]}}];async function le(){try{Z.value=[],W.value=!0;const{message:e}=await r.post("/files?action=Get_Recycle_bin");m(e)&&(L.value=f(e.dirs)?e.dirs.map(e=>({...e,type:"dir",ext:"folder"})):[],A.value=f(e.files)?e.files.map(e=>({...e,type:"file",ext:e.name.split(".").pop()||""})):[],Q.value=e.status,X.value=e.status_db)}finally{W.value=!1}}const ae=["jpg","jpeg","png","bmp","gif","tiff","ico","JPG","webp"],te=["zip","rar","gz","war","tgz"],ie=["mp4","mp3","mpeg","mpg","mov","avi","webm","mkv","mkv","mp3","rmvb","wma","wmv"],ce=["iso","xlsx","xls","doc","docx","tiff","exe","so","7z","bz","dmg","apk","pptx","ppt","xlsb","pdf"],se=R(()=>{let e=[];switch(V.value){case"all":e=[...L.value,...A.value];break;case"folder":e=[...L.value];break;case"file":e=[...A.value];break;case"image":e=A.value.filter(e=>ae.some(l=>e.name.includes(".".concat(l))));break;case"document":e=A.value.filter(e=>{const l=ae.some(l=>e.name.includes(".".concat(l))),a=te.some(l=>e.name.includes(".".concat(l))),t=ie.some(l=>e.name.includes(".".concat(l))),i=ce.some(l=>e.name.includes(".".concat(l)));return l||a||t||i});break;case"database":e=[...L.value,...A.value].filter(e=>e.name.includes("BTDB_"));break;default:e=[]}return e.sort((e,l)=>l.time-e.time),e}),ne=()=>{le()},oe=async e=>{const l={};"file"!==e&&(l[e]=1),await r.post("/files?action=Recycle_bin",l,{requestOptions:{loading:H("file.recycle.switching"),successMessage:!0}}),le()},re=()=>{i({text:H("file.recycle.emptyTitle"),title:H("file.recycle.emptyTitle"),content:H("file.recycle.emptyConfirm"),onConfirm:async()=>{await r.post("/files?action=Close_Recycle_bin","",{requestOptions:{loading:H("file.recycle.emptying"),successMessage:!0}}),le()}})},me=e=>{t({title:H("file.recycle.restoreFileTitle",{name:e.name}),content:H("file.recycle.restoreFileConfirm"),onConfirm:async()=>{await r.post("/files?action=Re_Recycle_bin",{path:e.rname},{requestOptions:{loading:H("file.recycle.restoring"),successMessage:!0}}),le(),p(I)}})},fe=e=>{i({text:H("file.delete"),title:H("file.recycle.deleteFileTitle",{name:e.name}),content:H("file.recycle.deleteFileConfirm"),onConfirm:async()=>{await r.post("/files?action=Del_Recycle_bin",{path:e.rname},{requestOptions:{loading:H("file.recycle.deleting"),successMessage:!0}}),le()}})};return(a,t)=>{const i=v,n=b,o=_,r=s,m=c,f=l,d=e;return C(),j(d,{show:P(J),"onUpdate:show":t[7]||(t[7]=e=>U(J)?J.value=e:null),title:a.$t("file.recycle.title"),width:"80%"},{default:$(()=>[z("div",B,[z("div",F,[z("div",q,[z("div",M,[z("div",null,D(a.$t("file.recycle.fileRecycleBin")),1),x(i,{value:P(Q),"onUpdate:value":[t[0]||(t[0]=e=>U(Q)?Q.value=e:null),t[1]||(t[1]=()=>oe("file"))]},null,8,["value"])]),z("div",O,[z("div",null,D(a.$t("file.recycle.databaseRecycleBin")),1),x(i,{value:P(X),"onUpdate:value":[t[2]||(t[2]=e=>U(X)?X.value=e:null),t[3]||(t[3]=()=>oe("db"))]},null,8,["value"])]),z("div",N,D(a.$t("file.recycle.warning")),1)]),x(n,{onClick:re},{default:$(()=>[T(D(a.$t("file.recycle.emptyRecycleBin")),1)]),_:1})]),z("div",S,[z("div",G,[x(r,{value:P(V),"onUpdate:value":[t[4]||(t[4]=e=>U(V)?V.value=e:null),ne],panePadding:"0"},{default:$(()=>[x(o,{name:"all",tab:a.$t("file.recycle.all")},null,8,["tab"]),x(o,{name:"folder",tab:a.$t("file.recycle.folder")},null,8,["tab"]),x(o,{name:"file",tab:a.$t("file.recycle.file")},null,8,["tab"]),x(o,{name:"image",tab:a.$t("file.recycle.image")},null,8,["tab"]),x(o,{name:"document",tab:a.$t("file.recycle.document")},null,8,["tab"]),x(o,{name:"database",tab:a.$t("file.recycle.database")},null,8,["tab"])]),_:1},8,["value"])]),z("div",K,[x(m,{"checked-row-keys":P(Z),"onUpdate:checkedRowKeys":t[5]||(t[5]=e=>U(Z)?Z.value=e:null),loading:P(W),"max-height":450,"row-key":"rname",columns:P(Y),data:P(se)},null,8,["checked-row-keys","loading","columns","data"]),z("div",E,[x(f,{"checked-row-keys":P(Z),"onUpdate:checkedRowKeys":t[6]||(t[6]=e=>U(Z)?Z.value=e:null),"row-key":"rname","select-width":240,data:P(se),options:ee},null,8,["checked-row-keys","data"])])])])])]),_:1},8,["show","title"])}}}),[["__scopeId","data-v-2e0c3f71"]]);export{H as default};
