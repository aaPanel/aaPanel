import{b as e,h as t,c as a,e as s,f as n,_ as l,J as i,a as o,r as u}from"./public.js?v=1753954525509";import{_ as c}from"./index102.js?v=1753954525509";import{_ as d}from"./index.js?v=1753954525509";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1753954525509";import{k as p,P as _,r as y,e as m,U as g,V as x,Q as h,a2 as f,X as v,j as w,a3 as k,ah as S,W as b,N as I,$ as A,w as $,F as C,a1 as U,O as H,H as j,l as q,v as R,c as L}from"./vue.js?v=1753954525509";import{i as O,v as P,c as T,p as M,e as z,w as D,cq as K,m as B,x as W,_ as F,u as G}from"./page_layout.js?v=1753954525509";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang.js?v=1753954525509";import{_ as N}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1753954525509";import{cA as Q,cG as V,aq as X,ay as Y,c1 as E,bY as Z,bC as ee,cD as te,c5 as ae}from"./naive.js?v=1753954525509";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1753954525509";import"./common.js?v=1753954525509";import"./__commonjsHelpers__.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1753954525509";import"./index96.js?v=1753954525509";const{t:ne}=O.global,le={class:"p-20px"},ie=p({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=_(),s=[{label:a("Security.Anti.Index_28"),value:"i"},{label:a("Security.Anti.Index_29"),value:"a"}],n=e,{getList:l}=n.data,{row:i}=n.data,o=y(null),u=m({path:"",chattr:"i",d_mode:""}),c={path:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]},d_mode:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=o.value)?void 0:t.validate()),await(a={...u,s_key:i.key},P.post("/plugin?name=syssafe&action=a&s=add_safe_path",a,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),null==l||l(),e()}}),(e,t)=>{const a=N,n=Q,l=V,i=X,d=J;return g(),x("div",le,[h(d,{ref_key:"formRef",ref:o,model:v(u),rules:c},{default:f((()=>[h(n,{label:e.$t("Site.DelSite.index_2"),path:"path"},{default:f((()=>[h(a,{class:"w-280px",value:v(u).path,"onUpdate:value":t[0]||(t[0]=e=>v(u).path=e),placeholder:e.$t("Security.Anti.Index_26")},null,8,["value","placeholder"])])),_:1},8,["label"]),h(n,{label:e.$t("Security.Hardening.Index_8")},{default:f((()=>[h(l,{class:"w-280px",value:v(u).chattr,"onUpdate:value":t[1]||(t[1]=e=>v(u).chattr=e),options:s},null,8,["value"])])),_:1},8,["label"]),h(n,{label:e.$t("Security.Hardening.Index_9"),path:"d_mode"},{default:f((()=>[h(i,{class:"w-280px!",value:v(u).d_mode,"onUpdate:value":t[2]||(t[2]=e=>v(u).d_mode=e),type:"text",placeholder:e.$t("Security.Anti.Index_27")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),oe={class:"p-20px"},ue=p({__name:"index",props:{data:{}},setup(i){const{t:o}=_(),u=i,{data:c}=u,{keys:p,table:y,columns:m}=e([{key:"path",title:o("Site.DelSite.index_2")},{key:"chattr",title:o("Security.Hardening.Index_8"),render:e=>"i"==e.chattr?o("Security.Anti.Index_28"):o("Security.Anti.Index_29")},{key:"s_mode",title:o("Security.Hardening.Index_9"),render:e=>e.s_mode!==e.d_mode?"".concat(e.s_mode," >> ").concat(e.d_mode):e.d_mode},{key:"state",title:o("Config.Safe.index_156"),render:e=>h("span",{style:{color:e.state?"#20a53a":"#ff0029"}},[e.state?o("Security.Anti.Index_35"):o("Security.Anti.Index_36")])},t({width:130,title:o("Public.Table.Operation"),options:e=>[{label:o("Public.Btn.Del"),onClick:async()=>{await(e=>P.post("/plugin?name=syssafe&action=a&s=remove_safe_path",e,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}}))({s_key:c.key,path:e.path}),await C()}}]})]),I=async()=>{U.data.row=c,U.show=!0},{loading:A,setLoading:$}=a(),C=async()=>{try{$(!0);const{message:e}=await(e=>P.post("/plugin?name=syssafe&action=a&s=get_safe_config",e))({s_key:c.key});T(e)&&(y.data=e.paths)}finally{p.value=[],$(!1)}};C();const U=s(o("Security.Anti.Index_30"),{getList:C});return(e,t)=>{const a=Y,s=n,i=l,o=r,u=d;return g(),x("div",oe,[h(o,null,{toolsLeft:f((()=>[h(a,{type:"primary",onClick:I},{default:f((()=>[w(k(e.$t("Security.Anti.Index_30")),1)])),_:1})])),table:f((()=>[h(s,{"checked-row-keys":v(p),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(p)?p.value=e:null),loading:v(A),"loading-num":3,"max-height":340,data:v(y).data,columns:v(m)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:f((()=>[h(i,null,{default:f((()=>[b("li",null,k(e.$t("Security.Anti.Index_31")),1),b("li",null,k(e.$t("Security.Anti.Index_32")),1),b("li",null,k(e.$t("Security.Anti.Index_33")),1),b("li",null,k(e.$t("Security.Anti.Index_34")),1)])),_:1})])),_:1}),h(u,{show:v(U).show,"onUpdate:show":t[1]||(t[1]=e=>v(U).show=e),title:v(U).title,data:v(U).data,width:500,footer:!0,component:ie},null,8,["show","title","data"])])}}}),ce={class:"p-20px"},de={class:"leading-32px"},re=z(p({__name:"index",setup(e){const{t:t}=_(),a=y(null),s=m({cycle:120,limit_count:3,limit:3600}),n={cycle:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit_count:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]}},i=async()=>{var e,t;await(null==(e=a.value)?void 0:e.validate()),await(t=I(s),P.post("/plugin?name=syssafe&action=a&s=save_ssh_config",t,{requestOptions:{loading:ne("Security.Api.Index_6"),successMessage:!0}}))};return(async()=>{const{message:e}=await P.post("/plugin?name=syssafe&action=a&s=get_ssh_config");T(e)&&(s.cycle=e.cycle,s.limit=e.limit,s.limit_count=e.limit_count)})(),(e,t)=>{const o=E,u=Q,c=Y,d=J,r=M,p=l;return g(),x("div",ce,[h(d,{ref_key:"formRef",ref:a,model:v(s),rules:n,inline:"","label-width":"auto",class:"form"},{default:f((()=>[h(u,{label:e.$t("Security.Anti.Index_37"),path:"cycle"},{default:f((()=>[h(o,{"show-button":!1,value:v(s).cycle,"onUpdate:value":t[0]||(t[0]=e=>v(s).cycle=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),h(u,{label:e.$t("Security.Anti.Index_38"),path:"limit_count"},{default:f((()=>[h(o,{"show-button":!1,value:v(s).limit_count,"onUpdate:value":t[1]||(t[1]=e=>v(s).limit_count=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),h(u,{label:e.$t("Security.Anti.Index_39"),path:"limit"},{default:f((()=>[h(o,{"show-button":!1,value:v(s).limit,"onUpdate:value":t[2]||(t[2]=e=>v(s).limit=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),b("span",de,k(e.$t("Security.Anti.Index_40")),1),h(c,{type:"primary",class:"ml-auto",onClick:i},{default:f((()=>[w(k(e.$t("Site.Cert.index_60")),1)])),_:1})])),_:1},8,["model"]),h(r,{class:"mb-15px!"}),h(p,null,{default:f((()=>[b("li",null,k(e.$t("Security.Anti.Index_41")),1),b("li",null,k(e.$t("Security.Anti.Index_42")),1),b("li",null,k(e.$t("Security.Anti.Index_43")),1)])),_:1})])}}}),[["__scopeId","data-v-201446e2"]]),pe={class:"p-20px"},_e=p({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=_(),s=e,{getList:n}=s.data,l=y(null),i=m({process_name:""}),o={process_name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=l.value)?void 0:t.validate()),await(a=I(i),P.post("/plugin?name=syssafe&action=a&s=add_process_white",a,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),null==n||n(),e()}}),(e,t)=>{const a=X,s=Q,n=J;return g(),x("div",pe,[h(n,{ref_key:"formRef",ref:l,model:v(i),rules:o},{default:f((()=>[h(s,{label:e.$t("Home.index_24"),path:"process_name"},{default:f((()=>[h(a,{class:"w-280px!",value:v(i).process_name,"onUpdate:value":t[0]||(t[0]=e=>v(i).process_name=e),type:"text",placeholder:e.$t("Security.Anti.Index_22")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),ye={class:"p-20px"},me=p({__name:"index",setup(i){const{t:o}=_(),{keys:u,table:c,columns:p}=e([{key:"name",title:o("Home.index_24")},t({width:130,title:o("Public.Table.Operation"),options:e=>[{label:o("Public.Btn.Del"),onClick:async()=>{var t;await(t={process_name:e.name},P.post("/plugin?name=syssafe&action=a&s=remove_process_white",t,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}})),await A()}}]})]),y=async()=>{$.show=!0},{loading:m,setLoading:I}=a(),A=async()=>{try{I(!0);const{message:e}=await P.post("/plugin?name=syssafe&action=a&s=get_process_white");D(e)&&(c.data=e.map((e=>({name:e}))))}finally{u.value=[],I(!1)}};A();const $=s(o("Security.Anti.Index_23"),{getList:A});return(e,t)=>{const a=Y,s=n,i=l,o=r,_=d;return g(),x("div",ye,[h(o,null,{toolsLeft:f((()=>[h(a,{type:"primary",onClick:y},{default:f((()=>[w(k(e.$t("Security.Anti.Index_23")),1)])),_:1})])),table:f((()=>[h(s,{"checked-row-keys":v(u),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(u)?u.value=e:null),loading:v(m),"loading-num":3,"max-height":340,data:v(c).data,columns:v(p)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:f((()=>[h(i,null,{default:f((()=>[b("li",null,k(e.$t("Security.Anti.Index_24")),1),b("li",null,k(e.$t("Security.Anti.Index_25")),1)])),_:1})])),_:1}),h(_,{show:v($).show,"onUpdate:show":t[1]||(t[1]=e=>v($).show=e),title:v($).title,data:v($).data,width:500,footer:!0,component:_e},null,8,["show","title","data"])])}}}),ge={class:"color-#ff3333"},xe=p({__name:"index",setup(o,{expose:u}){const{t:c}=_(),p=K(),{systemHardening:y}=A(p),m=s(),w=s(),I=s(),{keys:U,table:H,columns:j}=e([{key:"name",width:"10%",title:c("Site.TableRow.index_2")},{key:"ps",title:c("Security.Hardening.Index_5"),ellipsis:{tooltip:{width:"trigger"}}},i({key:"open",title:c("Site.TableRow.index_14"),onClick:async(e,t)=>{if(!y.value)return B.error(c("Security.Hardening.Index_6")),void L();var a;await(a={s_key:t.key},P.post("/plugin?name=syssafe&action=a&s=set_safe_status",a,{requestOptions:{loading:ne("Security.Api.Index_5"),successMessage:!0}}))}}),t({width:130,title:c("Site.TableRow.index_30"),options:e=>[{label:c("Site.TableOP.index_3"),onClick:()=>"ssh"===e.key?(w.title="".concat(c("Security.Hardening.Index_7")," [").concat(e.name,"]"),void(w.show=!0)):"process"===e.key?(I.title="".concat(c("Security.Hardening.Index_7")," [").concat(e.name,"]"),void(I.show=!0)):(m.title="".concat(c("Security.Hardening.Index_7")," [").concat(e.name,"]"),m.data=e,void(m.show=!0))}]})]);$((()=>p.isRefresh),(e=>{e&&(p.setRefresh(!1),L())}));const{loading:q,setLoading:R}=a(),L=async()=>{try{R(!0);const{message:e}=await P.post("/plugin?name=syssafe&action=a&s=get_safe_status");T(e)&&(y.value=e.open,H.data=e.list)}finally{U.value=[],R(!1)}};return L(),u({init:L}),(e,t)=>{const a=n,s=r,i=l,o=d;return g(),x(C,null,[h(s,{feedback:!0},{table:f((()=>[h(a,{"checked-row-keys":v(U),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(U)?U.value=e:null),"row-key":"title",loading:v(q),data:v(H).data,columns:v(j)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),h(i,{class:"mt-16px"},{default:f((()=>[b("li",null,k(e.$t("Security.Hardening.Index_1")),1),b("li",null,k(e.$t("Security.Hardening.Index_2")),1),b("li",null,k(e.$t("Security.Hardening.Index_3")),1),b("li",ge,k(e.$t("Security.Hardening.Index_4")),1)])),_:1}),h(o,{show:v(m).show,"onUpdate:show":t[1]||(t[1]=e=>v(m).show=e),title:v(m).title,data:v(m).data,width:700,"min-height":500,footer:!1,component:ue},null,8,["show","title","data"]),h(o,{show:v(w).show,"onUpdate:show":t[2]||(t[2]=e=>v(w).show=e),title:v(w).title,data:v(w).data,width:800,footer:!1,component:re},null,8,["show","title","data"]),h(o,{show:v(I).show,"onUpdate:show":t[3]||(t[3]=e=>v(I).show=e),title:v(I).title,data:v(I).data,width:700,"min-height":580,footer:!1,component:me},null,8,["show","title","data"])],64)}}}),he=p({__name:"index",setup(s,{expose:i}){const{t:o}=_(),{loading:u,setLoading:c}=a(),d=y(""),p=/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/,{keys:m,table:I,columns:A}=e([{key:"address",title:o("Security.Anti.Index_15"),width:"70%"},{key:"end",title:o("Security.History.Index_12"),render:e=>0==e.end?o("Security.Anti.Index_18"):e.end},t({width:130,title:o("Site.TableRow.index_30"),options:e=>[{label:o("Security.Anti.Index_19"),onClick:async()=>{var t;await(t={ip:e.address},P.post("/plugin?name=syssafe&action=a&s=remove_ssh_limit",t,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}})),C()}}]})]),$=async()=>{var e;p.test(d.value)?(await(e={ip:d.value},P.post("/plugin?name=syssafe&action=a&s=add_ssh_limit",e,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),C(),d.value=""):B.error(o("Security.Anti.Index_20"))},C=async()=>{try{c(!0);const{message:e}=await P.post("/plugin?name=syssafe&action=a&s=get_ssh_limit_info");D(e)&&(I.data=e)}finally{m.value=[],c(!1)}};return C(),i({init:C}),(e,t)=>{const a=X,s=Y,i=Z,o=n,c=r,p=l;return g(),x("div",null,[h(c,null,{toolsLeft:f((()=>[h(i,{class:"flex-nowrap!"},{default:f((()=>[h(a,{value:v(d),"onUpdate:value":t[0]||(t[0]=e=>S(d)?d.value=e:null),type:"text",placeholder:e.$t("Security.Anti.Index_15"),class:"w-280px!"},null,8,["value","placeholder"]),h(s,{type:"primary",onClick:$},{default:f((()=>[w(k(e.$t("Public.Btn.Add")),1)])),_:1})])),_:1})])),table:f((()=>[h(o,{"checked-row-keys":v(m),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>S(m)?m.value=e:null),"row-key":"address",loading:v(u),"max-height":440,data:v(I).data,columns:v(A)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),h(p,{class:"mt-16px"},{default:f((()=>[b("li",null,k(e.$t("Security.Anti.Index_16")),1),b("li",null,k(e.$t("Security.Anti.Index_17")),1)])),_:1})])}}}),fe=p({__name:"index",setup(t,{expose:s}){const{t:l}=_(),{keys:i,table:o,columns:u}=e([{key:"addtime",title:l("Site.Cert.index_68"),width:"20%"},{key:"log",title:l("Security.Anti.Index_21")}]),c=m({p:1,limit:10,search:"System hardening"}),{loading:d,setLoading:p}=a(),y=async()=>{try{p(!0);const{message:t}=await(e=I(c),P.post("/data?action=getData",{...e,table:"logs",order:"id desc"}));T(t)&&(o.data=t.data,o.total=W(t.page))}finally{i.value=[],p(!1)}var e};return y(),s({init:y}),(e,t)=>{const a=n,s=se,l=r;return g(),U(l,{feedback:!0},{table:f((()=>[h(a,{"checked-row-keys":v(i),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(i)?i.value=e:null),"row-key":"addtime",loading:v(d),data:v(o).data,columns:v(u)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:f((()=>[h(s,{page:v(c).p,"onUpdate:page":t[1]||(t[1]=e=>v(c).p=e),"page-size":v(c).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>v(c).limit=e),"item-count":v(o).total,"store-key":"security-log",onRefresh:y},null,8,["page","page-size","item-count"])])),_:1})}}}),ve=p({__name:"index",setup(e){const{t:t}=_(),a=y("protection"),s=[{key:"protection",label:t("Security.Tabs.Index_8"),component:xe},{key:"block",label:t("Security.Tabs.Index_9"),component:he},{key:"operation",label:t("Security.Tabs.Index_10"),component:fe}];return(e,t)=>{const n=c;return g(),U(n,{value:v(a),"onUpdate:value":t[0]||(t[0]=e=>S(a)?a.value=e:null),options:s},null,8,["value"])}}}),we={class:"pt-40px pb-40px"},ke={class:"mb-16px"},Se={class:"ul-style"},be={class:"text-center my-24px"},Ie={class:"flex justify-center"},Ae={class:"item"},$e=["onClick"],Ce=z(p({__name:"conversion",setup(e){const t=y(0),a=["Protection","Block IP","Operation logs"],s=()=>{o({source:102})};return(e,n)=>{const l=F,i=Y,o=ee,u=te;return g(),U(u,null,{default:f((()=>[b("div",we,[n[2]||(n[2]=b("div",{class:"mb-24px text-center text-22px font-bold"}," System Hardening prevention features ",-1)),b("div",ke,[b("ul",Se,[b("li",null,[h(l,{name:"security-system",size:"18"}),n[0]||(n[0]=b("span",{class:"ml-8px"},"Prevents the system from being implanted with a Trojan",-1))]),b("li",null,[h(l,{name:"security-surety",size:"30"}),n[1]||(n[1]=b("span",null,"Harden the system security configuration",-1))])])]),b("div",be,[h(i,{type:"primary",class:"h-36px text-14px",onClick:s},{default:f((()=>[w(k(e.$t("WP.Transition.index_7")),1)])),_:1})]),b("div",Ie,[b("div",Ae,[b("ul",null,[(g(),x(C,null,H(a,((e,a)=>b("li",{class:j({active:v(t)==a}),key:a,onClick:e=>t.value=a},k(e),11,$e))),64))])]),q(h(o,{width:"100%",src:v("/static/vite/images/protection.png")},null,8,["src"]),[[R,0==v(t)]]),q(h(o,{width:"100%",src:v("/static/vite/images/block.png")},null,8,["src"]),[[R,1==v(t)]]),q(h(o,{width:"100%",src:v("/static/vite/images/log.png")},null,8,["src"]),[[R,2==v(t)]])])])])),_:1})}}}),[["__scopeId","data-v-f55518e2"]]),Ue={key:0},He=p({__name:"index",setup(e){const t=G(),{isPro:a}=A(t),s=K(),{systemHardening:n}=A(s),l=y(n.value),i=L((()=>n.value));$(i,(e=>{l.value=e}));const o=async()=>{await P.post("/plugin?name=syssafe&action=a&s=set_open",{},{requestOptions:{loading:ne("Security.Api.Index_5"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await u("syssafe")})(),(e,t)=>{const s=ae,n=Z,i=te;return v(a)?(g(),x("div",Ue,[h(i,{class:"my-15px"},{default:f((()=>[h(n,{class:"p-15px items-center"},{default:f((()=>[b("span",null,k(e.$t("Security.Anti.Index_14")),1),h(s,{value:v(l),"onUpdate:value":[t[0]||(t[0]=e=>S(l)?l.value=e:null),o],"rubber-band":!1,size:"small"},null,8,["value"])])),_:1})])),_:1}),h(i,{class:"p-15px"},{default:f((()=>[h(ve)])),_:1})])):(g(),U(Ce,{key:1}))}}});export{He as default};
