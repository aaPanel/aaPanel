const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/open.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang.js?v=1769066082311","js/vue.js?v=1769066082311","js/__commonjsHelpers__.js?v=1769066082311","js/naive.js?v=1769066082311","js/common.js?v=1769066082311","js/ssh.js?v=1769066082311","js/page_layout.js?v=1769066082311","js/public.js?v=1769066082311","css/public.css?v=1769066082311","css/page_layout.css?v=1769066082311","js/view.js?v=1769066082311","js/index104.js?v=1769066082311","css/index16.css?v=1769066082311","js/index224.js?v=1769066082311","js/index223.js?v=1769066082311","css/index45.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang5.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang6.js?v=1769066082311","css/index17.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang7.js?v=1769066082311"])))=>i.map(i=>d[i]);
import{_ as e}from"./index114.js?v=1769066082311";import{d as s,q as a,o as t,a as i,bi as l,m as n,M as c,p as o,u,x as r,l as d}from"./page_layout.js?v=1769066082311";import{k as p,P as _,r as S,c as y,am as x,R as m,V as v,W as f,a3 as g,S as h,ak as w,U as H,a4 as b,j as k,a2 as L,_ as $,a0 as B,e as j,o as C,N as U,l as P,v as R,F as T,n as A}from"./vue.js?v=1769066082311";import{e as z,d as E,a as O,b as V,c as D,h as I}from"./public.js?v=1769066082311";import{g as F,s as W,a as q,b as N,c as M,d as G,e as J,f as K,h as Q,r as X,i as Y,j as Z,k as ee,l as se}from"./ssh.js?v=1769066082311";import{_ as ae}from"./index.js?v=1769066082311";import{_ as te}from"./index.vue_vue_type_script_setup_true_lang.js?v=1769066082311";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang2.js?v=1769066082311";import{g as le}from"./config.js?v=1769066082311";import{dS as ne,dk as ce,dg as oe,aC as ue,dW as re,bL as de,dU as pe,e2 as _e,db as Se,dT as ye}from"./naive.js?v=1769066082311";import{_ as xe}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1769066082311";import{_ as me}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1769066082311";import{_ as ve}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1769066082311";import"./common.js?v=1769066082311";import"./__commonjsHelpers__.js?v=1769066082311";import"./index103.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1769066082311";const fe={class:"px-16px pt-4px pb-16px"},ge={class:"mx-20px"},he={class:"w-200px mr-6px"},we={class:"ml-10px text-desc"},He={class:"my-24px"},be={class:"w-360px"},ke={class:"flex w-260px"},Le={class:"flex-1 mr-6px"},$e={class:"ml-10px text-desc"},Be={class:"ml-10px text-desc"},je={class:"my-24px"},Ce={class:"ml-10px text-desc"},Ue={class:"mt-20px text-desc"},Pe=p({__name:"index",setup(e,{expose:o}){const u=$(()=>i(()=>import("./open.js?v=1769066082311"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),r=$(()=>i(()=>import("./view.js?v=1769066082311"),__vite__mapDeps([11,12,2,3,4,5,7,8,9,10,13,6]))),d=$(()=>i(()=>import("./index224.js?v=1769066082311"),__vite__mapDeps([14,15,2,3,4,5,7,8,9,10,16,17,18,19,20,6]))),{t:p}=_(),B=S(!1),j=async e=>{await W({status:e})},C=S(!1),U=z(p("Security.SSH.Basic.index_19"),{onRefresh:()=>{ve()}}),P=()=>{C.value=!1},R=async e=>{e?U.show=!0:(await q(),ve())},T=S(22),A=async()=>{l(T.value)?await N({port:T.value}):n.error(p("Security.SSH.Basic.index_20"),{close:!0})},V=S(null),D=S([]),I=async e=>{await M({p_type:e})},Q=S(""),X=()=>{""!==Q.value.trim()?O({title:p("Security.SSH.Basic.index_22"),content:p("Security.SSH.Basic.index_23"),onConfirm:async()=>{await G({username:"root",password:Q.value})}}):n.error(p("Security.SSH.Basic.index_21"))},Y=z(p("Security.SSH.Basic.index_2")),Z=()=>{C.value?Y.show=!0:n.error(p("Security.SSH.Basic.index_24"))},ee=async()=>{if(!C.value)return void n.error(p("Security.SSH.Basic.index_25"));const{close:e}=n.loading(p("Security.SSH.Basic.index_26"));try{await J(),window.open("".concat(c(),"/ssh_security?action=download_key"))}finally{e()}},se=S(""),de=S({}),pe=y(()=>void 0===Object.keys(de.value).find(e=>e===se.value)),_e=y(()=>{const e=de.value[se.value];return e?e.title:""}),Se=z(p("Security.SSH.Basic.index_13"),{onSetName:e=>{se.value=e}}),ye=()=>{Se.data.config=de.value,Se.show=!0},xe=x(),me=()=>{xe.push("/security/system-hardening")},ve=async()=>{const{message:e}=await F();s(e)&&(B.value="yes"===e.password,C.value="yes"===e.pubkey,T.value=e.port,V.value=e.root_login_type,s(e.root_login_types)&&(D.value=Object.entries(e.root_login_types).map(([e,s])=>({label:s,value:e}))))},Pe=async()=>{const{message:e}=await K();s(e)&&(se.value=e.result)},Re=async()=>{const{message:e}=await le();s(e)&&(de.value=e)},{setLoading:Te}=E(!0);return(async()=>{try{Te(!0),await Promise.all([ve(),Pe(),Re()])}finally{Te(!1)}})(),o({init:()=>{Pe(),ve()}}),(e,s)=>{const i=ce,l=ne,n=oe,c=ue,o=a,p=re,_=ie,S=t,y=te,x=ae;return v(),m("div",fe,[f(y,{"label-width":"140px"},{default:g(()=>[f(l,{label:e.$t("Security.SSH.Basic.index_1")},{default:g(()=>[f(i,{value:H(B),"onUpdate:value":[s[0]||(s[0]=e=>w(B)?B.value=e:null),j],size:"small"},null,8,["value"]),h("span",ge,b(e.$t("Security.SSH.Basic.index_2")),1),f(i,{value:H(C),"onUpdate:value":[s[1]||(s[1]=e=>w(C)?C.value=e:null),R],size:"small"},null,8,["value"])]),_:1},8,["label"]),f(l,{label:e.$t("Security.SSH.Basic.index_3"),"show-feedback":!1},{default:g(()=>[h("div",he,[f(n,{value:H(T),"onUpdate:value":s[2]||(s[2]=e=>w(T)?T.value=e:null),min:1,max:65535,"show-button":!1},null,8,["value"])]),f(c,{type:"primary",onClick:A},{default:g(()=>[k(b(e.$t("Public.Btn.Save")),1)]),_:1}),h("div",we,b(e.$t("Security.SSH.Basic.index_4")),1)]),_:1},8,["label"]),h("div",He,[f(o)]),f(l,{label:e.$t("Security.SSH.Basic.index_5")},{default:g(()=>[h("div",be,[f(p,{value:H(V),"onUpdate:value":[s[3]||(s[3]=e=>w(V)?V.value=e:null),I],options:H(D)},null,8,["value","options"])])]),_:1},8,["label"]),f(l,{label:e.$t("Security.SSH.Basic.index_6")},{default:g(()=>[h("div",ke,[h("div",Le,[f(_,{value:H(Q),"onUpdate:value":s[4]||(s[4]=e=>w(Q)?Q.value=e:null),default:!1},null,8,["value"])]),f(c,{type:"primary",onClick:X},{default:g(()=>[k(b(e.$t("Public.Btn.Reset")),1)]),_:1})]),h("div",$e,b(e.$t("Security.SSH.Basic.index_8")),1)]),_:1},8,["label"]),f(l,{label:e.$t("Security.SSH.Basic.index_9"),"show-feedback":!1},{default:g(()=>[f(c,{type:"primary",class:"btn-xs",onClick:Z},{default:g(()=>[k(b(e.$t("Security.SSH.Basic.index_10")),1)]),_:1}),f(c,{class:"btn-xs ml-10px",onClick:ee},{default:g(()=>[k(b(e.$t("Public.Btn.Download")),1)]),_:1}),h("div",Be,b(e.$t("Security.SSH.Basic.index_12")),1)]),_:1},8,["label"]),h("div",je,[f(o)]),f(l,{label:e.$t("Security.SSH.Basic.index_13"),"show-feedback":!1},{default:g(()=>[H(pe)?(v(),L(S,{key:0,type:"warning",onClick:ye},{default:g(()=>[k(b(e.$t("Security.SSH.Basic.index_14")),1)]),_:1})):(v(),L(S,{key:1,onClick:ye},{default:g(()=>[k(b(e.$t("Security.SSH.Basic.index_15",[H(_e)])),1)]),_:1})),f(c,{type:"primary",class:"btn-xs ml-10px",onClick:ye},{default:g(()=>[k(b(e.$t("Public.Btn.Set")),1)]),_:1}),h("div",Ce,b(e.$t("Security.SSH.Basic.index_12")),1)]),_:1},8,["label"]),h("div",Ue,[k(b(e.$t("Security.SSH.Basic.index_17"))+" ",1),f(S,{onClick:me},{default:g(()=>[k(">>"+b(e.$t("Security.SSH.Basic.index_18")),1)]),_:1})])]),_:1}),f(x,{show:H(U).show,"onUpdate:show":s[5]||(s[5]=e=>H(U).show=e),title:H(U).title,data:H(U).data,width:400,"min-height":124,footer:!0,component:H(u),onPublicClose:P},null,8,["show","title","data","component"]),f(x,{show:H(Y).show,"onUpdate:show":s[6]||(s[6]=e=>H(Y).show=e),title:H(Y).title,width:400,"min-height":322,component:H(r)},null,8,["show","title","component"]),f(x,{show:H(Se).show,"onUpdate:show":s[7]||(s[7]=e=>H(Se).show=e),title:H(Se).title,data:H(Se).data,width:1e3,height:600,component:H(d)},null,8,["show","title","data","component"])])}}}),Re={class:"pt-40px pb-40px"},Te={class:"mb-24px text-center text-22px font-bold"},Ae={class:"mb-16px"},ze={class:"ul-style"},Ee={class:"ml-4px"},Oe={class:"text-center my-24px"},Ve={class:"flex justify-center"},De={class:"w-76%"},Ie=o(p({__name:"free",setup(e){const s=()=>{V({source:100})};return(e,a)=>{const t=ue,i=de;return v(),m("div",Re,[h("div",Te,b(e.$t("Security.SSH.Logs.free_1")),1),h("div",Ae,[h("ul",ze,[h("li",null,[h("span",Ee,b(e.$t("Security.SSH.Logs.free_2")),1)])])]),h("div",Oe,[f(t,{type:"primary",class:"h-36px text-14px",onClick:s},{default:g(()=>[k(b(e.$t("WP.Transition.index_7")),1)]),_:1})]),h("div",Ve,[h("div",De,[f(i,{class:"flex justify-center w-full",src:H("/static/vite/images/ssh-logs.png")},null,8,["src"])])])])}}}),[["__scopeId","data-v-c0b88226"]]),Fe=p({__name:"index",setup(e,{expose:a}){const{t:t}=_(),i=u(),{isPro:l}=B(i),{table:c,columns:o,setLoading:d}=D([{key:"address",title:t("Security.SSH.Logs.index_5"),render:e=>f("a",{class:"bt-link",href:"javascript:;",onClick:()=>{p(e)}},[e.address,k(":"),f("span",{class:"text-#666 cursor-default"},[e.port])])},{key:"area",title:t("Security.SSH.Logs.index_6"),render:e=>e.area.info||"--"},{key:"user",title:t("Security.SSH.Logs.index_7")},{key:"status",title:t("Security.SSH.Logs.index_8"),render:e=>f("span",{class:e.status?"text-primary":"text-error"},[e.status?t("Security.SSH.Logs.index_14"):t("Security.SSH.Logs.index_15")])},{key:"time",title:t("Security.SSH.Logs.index_9")}]),p=e=>{O({title:t("Security.SSH.Logs.index_10"),content:e.deny_status?t("Security.SSH.Logs.index_13"):t("Security.SSH.Logs.index_11"),onConfirm:async()=>{if(e.deny_status){const{message:s}=await X({address:e.address});r(s)&&s.length>0&&n.success(s[0].msg)}else{const{message:s}=await Y({address:e.address,types:"drop",brief:t("Security.SSH.Logs.index_12"),domain:"",choose:"address"});r(s)&&s.length>0&&n.success(s[0].msg)}x()}})},S=j({p:1,limit:20,select:"ALL",search:"",historyType:"ALL"}),y=()=>{l.value&&(S.p=1,x())},x=async()=>{try{d(!0);const{message:e}=await Q(U(S));s(e)&&(c.data=r(e.data)?e.data:[],c.total=e.total)}finally{d(!1)}};return C(()=>{y()}),a({init:e=>{S.select=e||"ALL",y()}}),(e,s)=>{const a=ue,t=_e,i=pe,n=ve,u=I,r=me,d=xe;return H(l)?(v(),L(d,{key:0},{toolsLeft:g(()=>[f(a,{type:"primary",onClick:y},{default:g(()=>[k(b(e.$t("Public.Btn.Refresh")),1)]),_:1})]),toolsRight:g(()=>[f(i,{value:H(S).select,"onUpdate:value":[s[0]||(s[0]=e=>H(S).select=e),y]},{default:g(()=>[f(t,{value:"ALL"},{default:g(()=>[k(b(e.$t("Security.SSH.Logs.index_1")),1)]),_:1}),f(t,{value:"Accepted"},{default:g(()=>[k(b(e.$t("Security.SSH.Logs.index_2")),1)]),_:1}),f(t,{value:"Failed"},{default:g(()=>[k(b(e.$t("Security.SSH.Logs.index_3")),1)]),_:1})]),_:1},8,["value"]),f(n,{value:H(S).search,"onUpdate:value":s[1]||(s[1]=e=>H(S).search=e),width:"320",placeholder:e.$t("Security.SSH.Logs.index_4"),onSearch:y},null,8,["value","placeholder"])]),table:g(()=>[f(u,{loading:H(c).loading,data:H(c).data,columns:H(o)},null,8,["loading","data","columns"])]),pageRight:g(()=>[f(r,{page:H(S).p,"onUpdate:page":s[2]||(s[2]=e=>H(S).p=e),"page-size":H(S).limit,"onUpdate:pageSize":s[3]||(s[3]=e=>H(S).limit=e),"store-key":"security-ssh-logs","item-count":H(c).total,onRefresh:x},null,8,["page","page-size","item-count"])]),_:1})):(v(),L(Ie,{key:1}))}}}),We={class:"mr-10px"},qe={class:"mx-20px"},Ne=p({__name:"index",setup(i){const l=x(),{t:n}=_(),c=j({status:!1,success:0,successToday:0,error:0,errorToday:0}),o=S(),u=S("basic"),r=[{key:"basic",label:n("Security.SSH.index_5"),component:Pe},{key:"logs",label:n("Security.SSH.index_6"),data:{type:"ALL"},component:Fe}],p=e=>{o.value.setValue("logs"),A(()=>{const s=o.value.getCompRef("logs");s&&s.init(e)})},y=async()=>{const{message:e}=await Z();s(e)&&(c.status=e.status)},L=async()=>{const{message:e}=await ee();s(e)&&(c.success=e.success,c.successToday=e.today_success,c.error=e.error,c.errorToday=e.today_error)},$=e=>{O({title:n("Security.SSH.index_7"),content:n(e?"Security.SSH.index_8":"Security.SSH.index_9"),onConfirm:async()=>{await se({status:e?0:1}),y(),L()}})},B=l.currentRoute.value.query;B.menu&&(u.value=B.menu);const{loading:C,setLoading:U}=E();return U(!0),Promise.all([y(),L()]).finally(()=>{U(!1)}),(s,i)=>{const l=d,n=ce,_=a,S=t,y=Se,x=ye,L=e;return v(),m(T,null,[f(x,{class:"mb-16px p-16px"},{default:g(()=>[P(f(l,{width:600,height:20,sharp:!1,size:"medium"},null,512),[[R,H(C)]]),P(f(y,{class:"items-center",size:0},{default:g(()=>[h("div",We,b(s.$t("Security.SSH.index_1")),1),f(n,{value:H(c).status,"onUpdate:value":$},null,8,["value"]),h("div",qe,[f(_,{class:"mx-0! text-20px",vertical:""})]),h("div",null,[h("span",null,b(s.$t("Security.SSH.index_2")),1),f(S,{onClick:i[0]||(i[0]=e=>p("Accepted"))},{default:g(()=>[k(b(s.$t("Security.SSH.index_3",[H(c).success,H(c).successToday])),1)]),_:1}),i[3]||(i[3]=h("span",{class:"mx-10px"},"/",-1)),f(S,{type:"error",onClick:i[1]||(i[1]=e=>p("Failed"))},{default:g(()=>[k(b(s.$t("Security.SSH.index_4",[H(c).error,H(c).errorToday])),1)]),_:1})])]),_:1},512),[[R,!H(C)]])]),_:1}),f(x,{class:"p-16px"},{default:g(()=>[f(L,{ref_key:"tabsRef",ref:o,value:H(u),"onUpdate:value":i[2]||(i[2]=e=>w(u)?u.value=e:null),options:r},null,8,["value"])]),_:1})],64)}}});export{Ne as default};
