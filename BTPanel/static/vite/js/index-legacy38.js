System.register(["./page_layout-legacy.js?v=1769066082311","./vue-legacy.js?v=1769066082311","./CalcSize.vue_vue_type_script_setup_true_lang-legacy.js?v=1769066082311","./index-legacy.js?v=1769066082311","./common-legacy.js?v=1769066082311","./public-legacy.js?v=1769066082311","./naive-legacy.js?v=1769066082311","./soft-legacy2.js?v=1769066082311","./soft-legacy.js?v=1769066082311","./file-legacy2.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1769066082311"],function(e,t){"use strict";var a,i,l,n,o,r,s,c,d,u,p,f,v,m,h,b,g,y,w,x,k,_,C,z,P,S,j,R,F,O,D,M,$,L,T,U,E,I,N,B,G,W,K,V,A,q,H,Y,X,J,Q,Z,ee,te,ae,ie,le,ne,oe,re,se,ce,de,ue,pe,fe,ve,me,he,be,ge,ye,we,xe,ke,_e,Ce,ze,Pe,Se,je,Re,Fe,Oe,De,Me,$e,Le,Te,Ue,Ee,Ie,Ne,Be,Ge,We,Ke,Ve,Ae,qe,He,Ye,Xe,Je,Qe,Ze,et,tt,at,it,lt,nt,ot,rt,st,ct,dt,ut,pt,ft,vt,mt;return{setters:[e=>{a=e.c0,i=e.p,l=e.i,n=e.a,o=e.m,r=e._,s=e.d,c=e.aE,d=e.h,u=e.n,p=e.aa,f=e.T,v=e.q,m=e.u,h=e.c1,b=e.c2,g=e.c3},e=>{y=e.k,w=e.i,x=e.r,k=e.c,_=e.a2,C=e.V,z=e.a3,P=e.S,S=e.U,j=e.W,R=e.I,F=e.R,O=e.F,D=e.O,M=e.H,$=e.j,L=e.a4,T=e.ak,U=e.x,E=e._,I=e.P,N=e.f,B=e.ad,G=e.ae,W=e.o,K=e.an,V=e.av,A=e.G,q=e.l,H=e.v,Y=e.aj,X=e.n,J=e.au,Q=e.w,Z=e.u,ee=e.b,te=e.$,ae=e.h,ie=e.a7,le=e.p,ne=e.a0,oe=e.aB,re=e.a6},e=>{se=e.F,ce=e.i,de=e.a,ue=e.d,pe=e.c,fe=e.h,ve=e.b,me=e.e,he=e.f,be=e.g,ge=e.o,ye=e.j,we=e.k,xe=e.l,ke=e.m,_e=e.n,Ce=e.p,ze=e.q,Pe=e.r,Se=e.s,je=e.t,Re=e.v,Fe=e.u,Oe=e.w,De=e.x,Me=e.y,$e=e.z,Le=e.A,Te=e.B,Ue=e.C,Ee=e.D,Ie=e.E,Ne=e.G,Be=e.H,Ge=e.I,We=e.J,Ke=e.K,Ve=e._,Ae=e.L,qe=e.M,He=e.N,Ye=e.O,Xe=e.P,Je=e.Q},e=>{Qe=e._},null,e=>{Ze=e.a},e=>{et=e.dd,tt=e.dm,at=e.aC,it=e.dj,lt=e.aX,nt=e.au,ot=e.av,rt=e._,st=e.dh,ct=e.di,dt=e.df,ut=e.dT},e=>{pt=e.c},e=>{ft=e.a},e=>{vt=e.i},e=>{mt=e._}],execute:function(){var ht=document.createElement("style");function bt(e){e.card_hover=!0}function gt(e){e.card_hover=!1}ht.textContent='@charset "UTF-8";.modal-footer-btns[data-v-6be9ab69]{display:flex;align-items:center;flex-direction:row;justify-content:end;gap:10px;padding:10px}.single-line-ellipsis[data-v-6be9ab69]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.video-container[data-v-6be9ab69]{display:grid;grid-template-columns:1fr 300px}.video-container .video-list[data-v-6be9ab69]{display:flex;align-items:center;flex-direction:column;justify-content:start;align-items:flex-start;padding:10px;box-sizing:border-box;background:var(--color-modal);width:100%;height:100%}.video-container .video-list .video-item[data-v-6be9ab69]{display:flex;align-items:center;flex-direction:row;justify-content:start;cursor:pointer;width:100%;padding:10px 10px 10px 0;border-radius:4px}.video-container .video-list .video-item[data-v-6be9ab69]:hover,.video-container .video-list .video-item.active[data-v-6be9ab69]{background:#5c5c5c;color:var(--color-text-1)}.modal-footer-btns[data-v-90e8c7cf]{display:flex;align-items:center;flex-direction:row;justify-content:end;gap:10px;padding:10px}.single-line-ellipsis[data-v-90e8c7cf]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.upload-area[data-v-90e8c7cf]{width:100%;height:100vh;background:rgba(225,255,255,.3);display:flex;align-items:center;flex-direction:row;justify-content:center}.upload-area .tip[data-v-90e8c7cf]{font-size:50px;color:#fff}.modal-footer-btns[data-v-7045f818]{display:flex;align-items:center;flex-direction:row;justify-content:end;gap:10px;padding:10px}.single-line-ellipsis[data-v-7045f818]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.img-wrapper[data-v-7045f818]{width:100%;height:100vh;position:relative}.img-wrapper img[data-v-7045f818]{width:60%;position:absolute;left:50%;top:50%;transition:all .2s ease-in-out;transform:translate(-50%,-50%)}.img-wrapper .tools[data-v-7045f818]{width:300px;padding:20px;display:flex;align-items:center;flex-direction:row;justify-content:space-between;position:absolute;left:50%;margin-left:-150px;bottom:130px;background:rgba(99,96,98,.6);border-radius:50px}.img-wrapper .close-icon[data-v-7045f818]{position:absolute;right:20px;top:20px}.modal-footer-btns[data-v-c747adc9]{display:flex;align-items:center;flex-direction:row;justify-content:end;gap:10px;padding:10px}.single-line-ellipsis[data-v-c747adc9]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.button-group[data-v-c747adc9]{display:flex;align-items:center;flex-direction:row;justify-content:space-between;flex-wrap:wrap}.button-group .group-left[data-v-c747adc9]{display:flex;align-items:center;flex-direction:row;justify-content:start;gap:8px}.button-group .group-left .divider[data-v-c747adc9]{height:24px;width:1px;background:var(--color-border)}.button-group .group-right[data-v-c747adc9]{display:flex;align-items:center;flex-direction:row;justify-content:start;gap:8px}.button-group .group-right .view-change[data-v-c747adc9]{display:flex;align-items:center;flex-direction:row;gap:0;color:var(--color-text-2)}.button-group .group-right .view-change .card[data-v-c747adc9],.button-group .group-right .view-change .list[data-v-c747adc9]{width:32px;height:32px;border:1px solid var(--color-border);cursor:pointer;display:flex;align-items:center;flex-direction:row;justify-content:center}.button-group .group-right .view-change .active[data-v-c747adc9]{box-shadow:inset 0 3px 5px rgba(0,0,0,.125);background:#e6e6e6;color:var(--color-text-3)}.button-group .group-right .view-change .card[data-v-c747adc9]{border-right:none;border-radius:4px 0 0 4px}.button-group .group-right .view-change .list[data-v-c747adc9]{border-radius:0 4px 4px 0}.button-group[data-v-c747adc9] .n-button .n-button__content~.n-button__icon{margin-left:0}.button-group .btn-behavior[data-v-c747adc9] .n-icon-slot{transition:.2s all ease-in-out;transform-origin:center center;transform:translateY(0);top:0}.button-group .btn-behavior[data-v-c747adc9]:hover .n-icon-slot{transform:rotate(90deg)}.path-list[data-v-ca757f3c]{flex:1;display:flex;border-top:1px solid var(--color-border);border-bottom:1px solid var(--color-border);overflow:hidden;cursor:text}.path-list .path-item[data-v-ca757f3c]{display:flex;align-items:center;height:100%;white-space:nowrap;cursor:pointer;transition:background-color .3s cubic-bezier(.4,0,.2,1);flex-shrink:0}.path-list .path-item .path-dir[data-v-ca757f3c]{display:flex;align-items:center;height:100%;padding:0 6px;color:var(--color-text-2)}.path-list .path-item .path-arrow[data-v-ca757f3c]{display:flex;align-items:center;height:100%;padding:0 2px;border-left:1px solid transparent;border-right:1px solid transparent;font-size:14px;transition:border-color .3s cubic-bezier(.4,0,.2,1)}.path-list .path-item .path-arrow.reversal .svg-icon[data-v-ca757f3c]{transform:rotate(180deg)}.path-list .path-item[data-v-ca757f3c]:hover{background-color:var(--file-choose-hover-color)}.path-list .path-item:hover .path-arrow[data-v-ca757f3c]{border-left-color:var(--file-choose-hover-border-color);border-right-color:var(--file-choose-hover-border-color)}.modal-footer-btns[data-v-7bef8870]{display:flex;align-items:center;flex-direction:row;justify-content:end;gap:10px;padding:10px}.single-line-ellipsis[data-v-7bef8870]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.filter-tools[data-v-7bef8870]{display:flex;align-items:center;flex-direction:row;justify-content:space-between;gap:10px}.filter-tools .dir-address[data-v-7bef8870]{min-width:150px;max-width:600px}.filter-tools .dir-search[data-v-7bef8870]{min-width:120px;max-width:300px}.filter-tools .dir-search .__input-1cpbmap-m[data-v-7bef8870]{--n-border: 1px solid #2e9a8c;border-right:none}.modal-footer-btns[data-v-8101ae96]{display:flex;align-items:center;flex-direction:row;justify-content:end;gap:10px;padding:10px}.single-line-ellipsis[data-v-8101ae96]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.operation-wrapper[data-v-8101ae96]{display:flex;align-items:center;flex-direction:row;justify-content:end;display:inline-flex;gap:8px}.operation-wrapper span[data-v-8101ae96]{color:#36ad6a}.n-data-table[data-v-14098e72]{--n-merged-td-color-hover: var(--color-table-td-hover)}.n-data-table[data-v-14098e72] .active-row{background-color:var(--n-merged-td-color-hover)}.n-data-table[data-v-14098e72] .active-row>.n-data-table-td{background-color:var(--n-merged-td-color-hover)}.n-data-table[data-v-14098e72] .n-data-table-td{height:42px}.file-nm[data-v-14098e72]{cursor:pointer}.modal-footer-btns[data-v-ae5d241c]{display:flex;align-items:center;flex-direction:row;justify-content:end;gap:10px;padding:10px}.single-line-ellipsis[data-v-ae5d241c]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.card-list[data-v-ae5d241c]{display:flex;align-content:flex-start;justify-content:flex-start;flex-wrap:wrap;gap:10px;height:100%}.card-list .file-item[data-v-ae5d241c]{width:100px;height:100px;display:flex;align-items:center;flex-direction:column;justify-content:center;gap:10px;padding:10px;margin:5px;cursor:pointer;transition:.2s all;border-radius:3px}.card-list .file-item span[data-v-ae5d241c]{text-align:center;display:block;width:100%}.card-list .file-item[data-v-ae5d241c]:hover{box-shadow:0 0 5px rgba(0,0,0,.2)}.card-list .file-item.active[data-v-ae5d241c]{background:var(--file-card-hover-color)}.modal-footer-btns[data-v-dbb99f65]{display:flex;align-items:center;flex-direction:row;justify-content:end;gap:10px;padding:10px}.single-line-ellipsis[data-v-dbb99f65]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.tabs[data-v-dbb99f65]{box-sizing:border-box;padding:16px 16px 0;overflow:hidden;width:100%}.tabs .tabs-scroll[data-v-dbb99f65]{width:100%;overflow:hidden;position:relative}.tabs .tabs-scroll.has-scroll[data-v-dbb99f65]{padding:0 40px;box-sizing:border-box}.tabs .tabs-scroll .left[data-v-dbb99f65],.tabs .tabs-scroll .right[data-v-dbb99f65]{height:28px;display:flex;align-items:center;flex-direction:row;justify-content:center;cursor:pointer;width:40px;background-color:var(--color-bg-3);position:absolute;top:1px}.tabs .tabs-scroll .left[data-v-dbb99f65]{left:0;box-shadow:2px 0 15px rgba(0,0,0,.6)}.tabs .tabs-scroll .right[data-v-dbb99f65]{right:0;box-shadow:-2px 0 15px rgba(0,0,0,.6)}.tabs .tabs-scroll .scroll-container[data-v-dbb99f65]{width:100%;overflow:hidden}.tabs .tabs-scroll .scroll-container .tabs-wrapper[data-v-dbb99f65]{height:100%;display:flex;align-items:center;flex-direction:row;justify-content:start;display:inline-flex}.tabs .tabs-scroll .scroll-container .tabs-wrapper .tab-item[data-v-dbb99f65]{width:150px;height:30px;padding:0 10px;background-color:var(--color-bg-3);box-sizing:border-box;border:1px solid var(--color-border);border-right:none;cursor:pointer;display:flex;flex-direction:row;justify-content:space-between;align-items:center;gap:5px}.tabs .tabs-scroll .scroll-container .tabs-wrapper .tab-item.active[data-v-dbb99f65]{background:var(--color-bg-2)}.tabs .tabs-scroll .scroll-container .tabs-wrapper .tab-item .tab-tit[data-v-dbb99f65]{display:block;max-width:80px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.tabs .tabs-scroll .scroll-container .tabs-wrapper .add[data-v-dbb99f65]{width:auto;border-right:1px solid var(--color-border)}\n/*$vite$:1*/',document.head.appendChild(ht);const yt={class:"video-container"},wt=["src"],xt={class:"video-list"},kt=["onClick"],_t=i(y({__name:"VideoPlayer",setup(e){const t=w("fileStore"),{videoWaitPreview:i,previewVideoShow:l,currentPreviewVideo:n}=t,o=x(),r=x(0),s=k(()=>`/download?filename=${n.value.path}`);function c(){r.value=o.value.offsetHeight}return(e,t)=>{const d=a,u=Qe;return C(),_(u,{show:S(l),"onUpdate:show":t[0]||(t[0]=e=>T(l)?l.value=e:null),width:"70%",title:e.$t("file.videoPlayerModal.title"),onAfterEnter:c},{default:z(()=>[P("div",yt,[P("video",{src:S(s),controls:"true",preload:"auto",width:"100%",ref_key:"videoRef",ref:o},null,8,wt),P("div",xt,[j(d,{style:R({height:S(r)+"px"})},{default:z(()=>[(C(!0),F(O,null,D(S(i),e=>(C(),F("div",{class:M(["video-item",{active:e.path==S(n).path}]),key:e.path,onClick:t=>n.value=e},[j(se,{ext:"mp4"}),j(S(et),null,{default:z(()=>[$(L(e.name),1)]),_:2},1024)],10,kt))),128))]),_:1},8,["style"])])])]),_:1},8,["show","title"])}}}),[["__scopeId","data-v-6be9ab69"]]),Ct=x([]),zt=x(!1),Pt=x(null),St=x(1),{t:jt}=l.global,Rt={class:"drag-upload"},Ft={class:"upload-area"},Ot={class:"tip"},Dt=y({__name:"DragUpload",setup(e,{expose:t}){const{t:a}=I(),i=w("fileStore"),{uploadFileList:l,uploadShow:n,uploadComplete:r,startUpload:s}=i,c=x(!1),d=x(0);function u(e){const t=e.dataTransfer;return!!t&&t.types.some(e=>"Files"===e||"application/x-moz-file"===e)}function p(e){e.preventDefault(),u(e)&&(d.value++,c.value=!0)}function f(e){e.preventDefault(),u(e)&&(d.value--,d.value<=0&&(c.value=!1,d.value=0))}function v(e){e.preventDefault(),u(e)&&(e.dataTransfer.dropEffect="copy")}async function m(e){const t=[];for(let a=0;a<e.length;a++){const i=e[a].webkitGetAsEntry();i&&t.push(i)}await h(t)&&o.error(a("file.uploadModal.fileAlreadyExists"),{close:!0})}async function h(e,t=""){r.value&&(l.value=[],s.value=!1,r.value=!1);let a=!1;for(const i of e)if(i.isDirectory){const e=i.createReader(),l=await new Promise(t=>{e.readEntries(t)});await h(l,t?`${t}/${i.name}`:i.name)&&(a=!0)}else if(i.isFile){if(-1!=l.value.findIndex(e=>g(`${e.relativePath}/${e.file.name}`)==g(i.fullPath))){a=!0;continue}const e=await new Promise(e=>{i.file(e)});l.value.push({file:e,status:0,progress:0,relativePath:t?`${t}`:""})}return a}async function b(e){e.preventDefault(),u(e)&&(d.value=0,c.value=!1,e.dataTransfer?.items&&(await m(e.dataTransfer.items),ue(i,"UploadFile"),n.value=!0))}function g(e){return e.startsWith("/")?e.slice(1):e}function y(){document.ondragenter=p,document.ondragleave=f,document.ondragover=v,document.ondrop=b}return ue(i,"UploadFile"),t({listenDragEvent:y}),N(()=>{y()}),(e,t)=>{const a=tt;return C(),F("div",Rt,[j(a,{show:S(c),"onUpdate:show":t[0]||(t[0]=e=>T(c)?c.value=e:null)},{default:z(()=>[P("div",Ft,[P("span",Ot,L(e.$t("file.uploadModal.dragFilesHere")),1)])]),_:1},8,["show"])])}}}),Mt=i(Dt,[["__scopeId","data-v-90e8c7cf"]]),$t={class:"img-wrapper"},Lt=["src"],Tt=i(y({__name:"ImagePreview",setup(e){const t=w("fileStore"),{imgWaitPreview:a,currentPreviewImg:i,previewShow:l}=t,n=x(.5),o=k(()=>`/download?filename=${a.value[r.value]}`),r=x(0);function s(){r.value=a.value.findIndex(e=>e===i.value)}function c(){r.value>0&&r.value--}function d(){r.value<a.value.length-1&&r.value++}function u(){n.value>2||(n.value+=.1)}function p(){n.value<.2||(n.value-=.1)}function f(){l.value=!1}function v(e){n.value-e.deltaY/1e3<.2||n.value-e.deltaY/1e3>2||(n.value-=e.deltaY/1e3)}return(e,t)=>{const a=tt;return C(),_(a,{show:S(l),"onUpdate:show":t[0]||(t[0]=e=>T(l)?l.value=e:null),"close-on-esc":!1,"mask-closable":!1,"on-after-enter":s},{default:z(()=>[P("div",$t,[P("img",{src:S(o),style:R({transform:`translate(-50%, -50%) scale(${S(n)})`}),onWheel:v},null,44,Lt),P("div",{class:"tools"},[P("i",{class:"i-ic:outline-arrow-circle-left text-16 text-[#fff] cursor-pointer",onClick:c}),P("i",{class:"i-ic:baseline-zoom-in text-16 text-[#fff] cursor-pointer",onClick:u}),P("i",{class:"i-ic:baseline-zoom-out text-16 text-[#fff] cursor-pointer",onClick:p}),P("i",{class:"i-ic:outline-arrow-circle-right text-16 text-[#fff] cursor-pointer",onClick:d})]),P("i",{class:"i-iconoir:xmark-circle text-16 text-[#fff] cursor-pointer close-icon",onClick:f})])]),_:1},8,["show"])}}}),[["__scopeId","data-v-7045f818"]]),Ut={key:0,class:"group-left"},Et={key:1,class:"group-left"},It={class:"group-right"},Nt={class:"view-change"},Bt=y({__name:"ButtonGroup",props:{filesView:{type:String,default:"list"},filesViewModifiers:{}},emits:B(["viewChange"],["update:filesView"]),setup(e,{emit:t}){const a=t,{t:i}=I(),l=w("fileStore"),{favoriteOptions:n,choosedKeys:o,waitForPaste:c,optionToolsRef:d,isMiniScreen:u}=l,p=G(e,"filesView"),f=k(()=>[{label:i("file.buttonGroup.createOptions.newDirectory"),key:"dir",icon:()=>j(r,{name:"file-dir",size:"16"},null)},{label:i("file.buttonGroup.createOptions.newFile"),key:"file",icon:()=>j(r,{name:"base-file",size:"16"},null)},{label:i("file.buttonGroup.createOptions.softLink"),key:"softlink",icon:()=>j(r,{name:"file-soft-link",size:"15"},null)}]),v=k(()=>[{label:i("file.buttonGroup.miniScreenOptions.upload"),key:"Upload",icon:()=>j(r,{name:"file-upload",size:"14"},null)},{label:i("file.buttonGroup.miniScreenOptions.remoteDownload"),key:"Remote Download",icon:()=>j(r,{name:"file-download",size:"16"},null)},{label:i("file.buttonGroup.miniScreenOptions.new"),key:"create",icon:()=>j(r,{name:"base-dir",size:"14",class:"mr-5px"},null),children:[{label:i("file.buttonGroup.createOptions.newDirectory"),key:"dir",icon:()=>j(r,{name:"file-dir",size:"16"},null)},{label:i("file.buttonGroup.createOptions.newFile"),key:"file",icon:()=>j(r,{name:"base-file",size:"16"},null)},{label:i("file.buttonGroup.createOptions.softLink"),key:"softlink",icon:()=>j(r,{name:"file-soft-link",size:"15"},null)}]},{label:i("file.buttonGroup.miniScreenOptions.searchFileContent"),key:"Search File Content",icon:()=>j(r,{name:"search",size:"14"},null)},{label:i("file.buttonGroup.miniScreenOptions.favorite"),key:"Favorite",icon:()=>j(r,{name:"file-favorite",size:"14",class:"mr-5px"},null),children:h.value},{label:i("file.buttonGroup.miniScreenOptions.shareList"),key:"Share List",icon:()=>j(r,{name:"file-share",size:"14"},null)},{label:i("file.buttonGroup.miniScreenOptions.terminal"),key:"Terminal",icon:()=>j(r,{name:"file-terminal",size:"14"},null)},{label:i("file.buttonGroup.miniScreenOptions.rootDirectory"),key:"Root Directory",icon:()=>j(r,{name:"file-disk",size:"14"},null)},{label:i("file.buttonGroup.miniScreenOptions.fileProtection"),key:"File/Dir protection",icon:()=>j(r,{name:"file-protect",size:"14"},null)}]);function m(e,t){switch(e){case"Upload":fe(l);break;case"Remote Download":ve(l);break;case"dir":me(l,"dir");break;case"file":me(l,"file");break;case"softlink":me(l,"softlink");break;case"Search File Content":he(l);break;case"Share List":ye(l);break;case"Terminal":we(l);break;case"Root Directory":xe(l);break;case"File/Dir protection":b();break;default:!function(e,t){be(l,e,t.meta)}(e,t)}}const h=k(()=>n.value.map(e=>({key:e.key,icon:()=>{return j(r,{name:(t=e.icon,"dir"==t?"file-dir":"settings"==t?"flow-action":"file-record"),size:"16"},null);var t},label:()=>j("div",{class:"flex"},[j("div",{class:"max-w-300px"},[j(et,null,{default:()=>[e.label]})])]),meta:{type:e.icon,name:e.label}}))),b=async()=>{const e=await pt("tamper_core",75);s(e)&&ft(e)};function g(){ue(l,"Permission",e=>e.value.open())}function y(){je(l)}function x(e){Re(l,e),a("viewChange",e)}return W(()=>{pe(l),window.addEventListener("resize",()=>pe(l))}),(e,t)=>{const a=r,i=at,n=it,s=lt;return C(),F("div",{class:"button-group",ref_key:"optionToolsRef",ref:d},[!S(u)&&S(o).length<=1?(C(),F("div",Ut,[j(i,{onClick:t[0]||(t[0]=e=>S(fe)(S(l)))},{icon:z(()=>[j(a,{name:"file-upload",size:"14"})]),default:z(()=>[$(" "+L(e.$t("file.upload")),1)]),_:1}),j(i,{onClick:t[1]||(t[1]=e=>S(ve)(S(l)))},{icon:z(()=>[j(a,{name:"file-download",size:"16"})]),default:z(()=>[$(" "+L(e.$t("file.remoteDownload")),1)]),_:1}),j(n,{trigger:"hover",options:S(f),placement:"bottom-start","on-select":e=>S(me)(S(l),e)},{default:z(()=>[j(i,{"icon-placement":"right",class:"btn-behavior"},{default:z(()=>[j(a,{name:"base-dir",size:"14",class:"mr-5px"}),$(" "+L(e.$t("file.create"))+" ",1),j(a,{name:"base-arrow-right",size:"14"})]),_:1})]),_:1},8,["options","on-select"]),j(i,{onClick:t[2]||(t[2]=e=>S(he)(S(l)))},{icon:z(()=>[j(a,{name:"search",size:"14"})]),default:z(()=>[$(" "+L(e.$t("file.searchContent")),1)]),_:1}),j(n,{placement:"bottom-start",scrollable:!0,style:{maxHeight:"480px"},options:S(h),onSelect:t[4]||(t[4]=(e,t)=>S(be)(S(l),e,t.meta))},{default:z(()=>[j(i,{"icon-placement":"right",class:"btn-behavior",onClick:t[3]||(t[3]=e=>S(ge)(S(l)))},{default:z(()=>[j(a,{name:"file-favorite",size:"14",class:"mr-5px"}),$(" "+L(e.$t("file.favorite"))+" ",1),j(a,{name:"base-arrow-right",size:"14"})]),_:1})]),_:1},8,["options"]),j(i,{onClick:t[5]||(t[5]=e=>S(ye)(S(l)))},{icon:z(()=>[j(a,{name:"file-share",size:"14"})]),default:z(()=>[$(" "+L(e.$t("file.shareList")),1)]),_:1}),j(i,{onClick:t[6]||(t[6]=e=>S(we)(S(l)))},{icon:z(()=>[j(a,{name:"file-terminal",size:"14"})]),default:z(()=>[$(" "+L(e.$t("file.terminal")),1)]),_:1}),t[16]||(t[16]=P("div",{class:"divider"},null,-1)),j(i,{onClick:t[7]||(t[7]=e=>S(xe)(S(l)))},{icon:z(()=>[j(a,{name:"file-disk",size:"14"})]),default:z(()=>[$(" "+L(e.$t("file.rootDirectory")),1)]),_:1}),t[17]||(t[17]=P("div",{class:"divider"},null,-1)),j(i,{onClick:b},{icon:z(()=>[j(a,{name:"file-protect",size:"14"})]),default:z(()=>[$(" "+L(e.$t("file.protection")),1)]),_:1})])):S(u)||S(o).length>1?(C(),F("div",Et,[j(n,{placement:"bottom-start",scrollable:!0,"menu-props":()=>({style:"max-height: 480px"}),options:S(v),"on-select":m},{default:z(()=>[j(i,{"icon-placement":"right",class:"btn-behavior"},{default:z(()=>[j(a,{name:"base-dir",size:"14",class:"mr-5px"}),$(" "+L(e.$t("file.buttonGroup.fileOperations"))+" ",1),j(a,{name:"base-arrow-right",size:"14"})]),_:1})]),_:1},8,["options"])])):K("",!0),P("div",It,[S(o).length>1?(C(),_(s,{key:0},{default:z(()=>[j(i,{onClick:t[8]||(t[8]=e=>S(ke)(S(l)))},{icon:z(()=>[j(a,{name:"common-copy",size:"16"})]),default:z(()=>[$(" "+L(e.$t("file.copy")),1)]),_:1}),j(i,{onClick:t[9]||(t[9]=e=>S(_e)(S(l)))},{icon:z(()=>[j(a,{name:"file-cut",size:"16"})]),default:z(()=>[$(" "+L(e.$t("file.cut")),1)]),_:1}),j(i,{onClick:t[10]||(t[10]=e=>S(Ce)(S(l)))},{icon:z(()=>[j(a,{name:"file-compression",size:"16"})]),default:z(()=>[$(" "+L(e.$t("file.compress")),1)]),_:1}),j(i,{onClick:g},{icon:z(()=>[j(a,{name:"file-dir-permission",size:"16"})]),default:z(()=>[$(" "+L(e.$t("file.buttonGroup.permissions")),1)]),_:1}),j(i,{onClick:y},{icon:z(()=>[j(a,{name:"file-recycling-bin",size:"16"})]),default:z(()=>[$(" "+L(e.$t("file.delete")),1)]),_:1})]),_:1})):K("",!0),S(c)?(C(),_(i,{key:1,onClick:t[11]||(t[11]=()=>S(ze)(S(l)))},{icon:z(()=>[j(a,{name:"file-paste",size:"20"})]),default:z(()=>[$(" "+L(e.$t("file.paste")),1)]),_:1})):K("",!0),j(i,{onClick:t[12]||(t[12]=e=>S(Pe)(S(l)))},{default:z(()=>[$(L(e.$t("file.backup")),1)]),_:1}),j(i,{onClick:t[13]||(t[13]=e=>S(Se)(S(l)))},{icon:z(()=>[j(a,{name:"file-recycling-bin",size:"14"})]),default:z(()=>[$(" "+L(e.$t("file.recycleBin")),1)]),_:1}),P("div",Nt,[P("div",{class:M(["card",{active:"card"==p.value}]),onClick:t[14]||(t[14]=e=>x("card"))},[j(a,{name:"file-card-view",size:"14"})],2),P("div",{class:M(["list",{active:"list"==p.value}]),onClick:t[15]||(t[15]=e=>x("list"))},[j(a,{name:"file-list-view",size:"16"})],2)])])],512)}}}),Gt=i(Bt,[["__scopeId","data-v-c747adc9"]]),Wt={class:"path-dir"},Kt={class:"path-arrow reversal"},Vt={class:"path-dir"},At={class:"path-arrow"},qt=["onClick"],Ht={class:"path-dir"},Yt={class:"path-arrow"},Xt=y({__name:"ChoosePath",props:{currentPath:{type:String,default:"/"}},emits:["pathChange"],setup(e,{expose:t,emit:a}){const i=e,l=a,{t:n}=I(),o=w("fileStore"),d=x(""),u=V("pathListRef"),p=x(0),f=k(()=>i.currentPath.split("/").filter(e=>""!==e).map((e,t)=>({name:e,originalIndex:t}))),v=k(()=>{if(!p.value||0===f.value.length)return f.value;let e=p.value-80;const t=[...f.value].reverse(),a=[];for(const i of t){const t=Math.min(8*i.name.length,150)+20+12;if(!(e>=t))break;a.unshift(i),e-=t}return a}),m=k(()=>v.value.length<f.value.length),h=k(()=>{const e=f.value.length-v.value.length;return f.value.slice(0,e)}),b=k(()=>{const e=h.value.map(e=>({key:e.originalIndex,label:e.name,icon:()=>j(r,{name:"file-dir",size:"16"},null)}));return e.unshift({key:"/",label:n("file.rootDirectory"),icon:()=>j(r,{name:"file-dir",size:"16"},null)}),e}),g=e=>{B(e)},y=x(!0),R=V("inputRef");let M=null;function U(){u.value&&(p.value=u.value.offsetWidth)}function E(e){y.value=e,y.value?(d.value="",X(()=>{U()})):d.value=i.currentPath}W(()=>{u.value&&(U(),M=new ResizeObserver(()=>{U()}),M.observe(u.value))}),A(()=>{M&&M.disconnect()});const N=()=>{E(!1),X(()=>{R.value?.focus()})};function B(e,t){const a=i.currentPath.split("/").filter(e=>""!==e);let n="";"number"==typeof e&&(a.splice(e+1),n="/"+a.join("/")),"/"==e&&(n="/"),l("pathChange",n),t?.stopPropagation()}async function G(){if(d.value==i.currentPath||""==d.value)R.value?.blur(),E(!0);else if(vt(d.value))try{const{message:e}=await c.post("/files?action=test_path",{path:d.value});if(s(e)&&e.exists)l("pathChange",e.path),E(!0);else{let e=d.value;Ze({title:n("file.pathNotExists"),content:n("file.pathNotExistsConfirm",{path:e}),onPublicClose:()=>E(!1),onConfirm:async()=>{await Fe(e),l("pathChange",e)},onCancel(){R.value?.blur(),E(!0)}})}}catch(e){console.warn(e)}else E(!1)}function K(){const e=i.currentPath.split("/").filter(e=>""!==e);if(0!=e.length){e.pop();let t="/"+e.join("/");l("pathChange",t)}}function J(){Oe(o)}return t({handleEnterDown:G}),(e,t)=>{const a=at,i=it,l=et,n=nt,o=ot;return C(),_(o,null,{default:z(()=>[j(a,{onClick:K},{default:z(()=>[j(r,{name:"file-back",size:"16"})]),_:1}),S(y)?(C(),F("div",{key:0,ref_key:"pathListRef",ref:u,class:"path-list",onClick:N},[j(i,{trigger:"click",placement:"bottom-start",options:S(b),onSelect:g},{default:z(()=>[q(P("div",{class:"path-item",onClick:t[0]||(t[0]=e=>e.stopPropagation())},[P("div",Wt,[j(r,{name:"file-dir",size:"16"})]),P("div",Kt,[j(r,{name:"base-arrow-right"})])],512),[[H,S(m)]])]),_:1},8,["options"]),q(P("div",{class:"path-item",onClick:t[1]||(t[1]=e=>B("/",e))},[P("div",Vt,L(e.$t("file.rootDirectory")),1),P("div",At,[j(r,{name:"base-arrow-right"})])],512),[[H,!S(m)]]),(C(!0),F(O,null,D(S(v),(e,t)=>(C(),F("div",{class:"path-item",key:`${e}_${t}`,onClick:t=>B(e.originalIndex,t)},[P("div",Ht,[j(l,{class:"max-w-150px!"},{default:z(()=>[$(L(e.name),1)]),_:2},1024)]),P("div",Yt,[j(r,{name:"base-arrow-right"})])],8,qt))),128))],512)):(C(),_(n,{key:1,ref_key:"inputRef",ref:R,value:S(d),"onUpdate:value":t[2]||(t[2]=e=>T(d)?d.value=e:null),class:"flex-1",placeholder:" ",onFocus:t[3]||(t[3]=e=>E(!1)),onBlur:t[4]||(t[4]=e=>E(!0)),onKeydown:Y(G,["enter"])},null,8,["value"])),j(a,{onClick:J},{default:z(()=>[j(r,{name:"base-refresh",size:"16"})]),_:1})]),_:1})}}}),Jt=e("C",i(Xt,[["__scopeId","data-v-ca757f3c"]])),Qt={class:"filter-tools"},Zt=i(y({__name:"SearchTools",setup(e){const t=w("fileStore"),{currentPath:a}=t,i=x(""),l=x(void 0),{choosePathRef:n}=t;async function o(){const e={search:i.value};t.page.value=1,l.value&&(e.all="True"),Oe(t,e)}function s(e){a.value=e,t.page.value=1,Oe(t)}return(e,t)=>{const c=rt,d=nt,u=r,p=at,f=ot;return C(),F("div",Qt,[j(Jt,{ref_key:"choosePathRef",ref:n,class:"w-50%","current-path":S(a),onPathChange:s},null,8,["current-path"]),j(f,{class:"dir-search"},{default:z(()=>[j(d,{placeholder:e.$t("file.search"),status:"success",value:S(i),"onUpdate:value":t[1]||(t[1]=e=>T(i)?i.value=e:null),onKeyup:Y(o,["enter"])},{suffix:z(()=>[j(c,{checked:S(l),"onUpdate:checked":t[0]||(t[0]=e=>T(l)?l.value=e:null)},{default:z(()=>[$(L(e.$t("file.includeSubdir")),1)]),_:1},8,["checked"])]),_:1},8,["placeholder","value"]),j(p,{type:"primary",onClick:o},{icon:z(()=>[j(u,{name:"search",size:"16"})]),_:1})]),_:1})])}}}),[["__scopeId","data-v-7bef8870"]]),ea=y({__name:"ContextMenu",setup(e,{expose:t}){const{t:a}=I(),{addTab:i}=w("file-provide"),l=w("fileStore"),{waitForPaste:n}=l,o=x(!1),s=x("empty"),c=x(0),d=x(1),u=k(()=>{switch(s.value){case"single":return Me(l,f);case"multiple":return De(f.value,["copy","cut","permission","compression","del"]);default:return n.value?De(f.value,["refresh","upload","create","terminal","paste"]):De(f.value,["refresh","upload","create","terminal"])}});function p(e){"openNewWindow"===e&&function(){const{choosedKeys:e,fileList:t}=l,a=Le(t.value,e.value)[0];a&&i(a.path,a.nm)}(),$e(e,l),o.value=!1}const f=x({edit:{label:a("Public.Btn.Edit"),key:"edit",icon:()=>j(r,{name:"common-copy",size:"14"},null)},copy:{label:a("Public.Btn.Copy"),key:"copy",icon:()=>j(r,{name:"common-copy",size:"14"},null)},copyPath:{label:"Copy Path",key:"copyPath",icon:()=>j(r,{name:"common-copy",size:"14"},null)},cut:{label:a("file.fileOperation.cut"),key:"cut",icon:()=>j(r,{name:"file-cut",size:"16"},null)},permission:{label:a("file.fileOperation.permission"),key:"permission",icon:()=>j(r,{name:"file-dir-permission",size:"14"},null)},compression:{label:a("file.contextMenu.createCompression"),key:"compression",icon:()=>j(r,{name:"file-compression",size:"16"},null)},decompress:{label:a("file.fileOperation.decompress"),key:"decompress",icon:()=>j(r,{name:"file-compression",size:"16"},null)},conversion:{label:a("file.contextMenu.formatConversion"),key:"conversion",icon:()=>j(r,{name:"file-conversion",size:"16"},null)},del:{label:a("Public.Btn.Delete"),key:"del",icon:()=>j(r,{name:"file-recycling-bin",size:"16"},null)},refresh:{label:a("Public.Btn.Refresh"),key:"refresh",icon:()=>j(r,{name:"base-refresh",size:"14"},null)},upload:{label:a("Public.Btn.Upload"),key:"upload",icon:()=>j(r,{name:"file-upload",size:"16"},null)},create:{label:a("file.contextMenu.newFolderFile"),key:"create",icon:()=>j(r,{name:"base-dir",size:"14"},null),children:[{label:a("file.contextMenu.newFolder"),key:"createDir",icon:()=>j(r,{name:"base-dir",size:"14"},null)},{label:a("file.contextMenu.newFile"),key:"createFile",icon:()=>j(r,{name:"base-file",size:"14"},null)}]},download:{label:a("Public.Btn.Download"),key:"download",icon:()=>j(r,{name:"file-download",size:"16"},null)},terminal:{label:a("file.contextMenu.terminal"),key:"terminal",icon:()=>j(r,{name:"file-terminal",size:"16"},null)},paste:{label:a("file.contextMenu.paste"),key:"paste",icon:()=>j(r,{name:"file-paste",size:"16"},null)},open:{label:a("file.fileOperation.open"),key:"open",icon:()=>j(r,{name:"file-open",size:"16"},null)},openNewWindow:{label:a("file.contextMenu.openInNewWindow"),key:"openNewWindow",icon:()=>j(r,{name:"file-new-window",size:"14"},null)},share:{label:a("file.contextMenu.externalShare"),key:"share",icon:()=>j(r,{name:"file-share",size:"16"},null)},unShare:{label:a("file.contextMenu.cancelShare"),key:"unShare",icon:()=>j(r,{name:"file-share",size:"16"},null)},favorite:{label:a("file.contextMenu.addToFavorites"),key:"favorite",icon:()=>j(r,{name:"file-favorite",size:"14"},null)},unfavorite:{label:a("file.contextMenu.removeFromFavorites"),key:"unfavorite",icon:()=>j(r,{name:"file-favorite",size:"14"},null)},rename:{label:a("file.fileOperation.rename"),key:"rename",icon:()=>j(r,{name:"file-rename",size:"16"},null)},attrs:{label:a("file.contextMenu.properties"),key:"attrs",icon:()=>j(r,{name:"file-attrs",size:"16"},null)},"new-window":{label:a("file.contextMenu.openInNewWindow"),key:"new-window",icon:()=>j(r,{name:"file-new-window",size:"14"},null)},top:{label:a("file.contextMenu.pinToTop"),key:"top",icon:()=>j(r,{name:"file-top",size:"18"},null)},"file-sync":{label:a("file.contextMenu.fileSync"),key:"file-sync",icon:()=>j(r,{name:"common-copy",size:"16"},null)},scan:{label:a("file.contextMenu.malwareScan"),key:"scan",icon:()=>j(r,{name:"file-scan",size:"16"},null)},duplicate:{label:a("file.contextMenu.createCopy"),key:"duplicate",icon:()=>j(r,{name:"common-copy",size:"16"},null)},preview:{label:a("Public.Btn.Preview"),key:"preview",icon:()=>j(r,{name:"drag-preview",size:"14"},null)},playVideo:{label:a("Public.Btn.Play"),key:"playVideo",icon:()=>j(r,{name:"file-play-video",size:"16"},null)}});function v(){o.value=!1}return t({filesOperation:function(e,t){e.preventDefault(),o.value=!1,s.value=t,X().then(()=>{o.value=!0,c.value=e.clientX,d.value=e.clientY})}}),(e,t)=>{const a=it;return C(),_(a,{placement:"bottom-start",trigger:"manual",x:S(c),y:S(d),options:S(u),show:S(o),"on-clickoutside":v,onSelect:p},null,8,["x","y","options","show"])}}}),ta={key:0,class:"operation-wrapper"},aa={class:"mr-4px"},ia={class:"mr-4px"},la=y({__name:"FileOperation",props:{file:{}},setup(e){const t=e,a=x(),i=w("fileStore"),{isMiniScreen:l}=i,{t:n}=I(),o=x([{label:n("Public.Btn.Download"),value:"download",handle:()=>$e("download",i)},{label:n("Public.Btn.Copy"),value:"copy",handle:()=>$e("copy",i)},{label:n("file.fileOperation.cut"),value:"cut",handle:()=>$e("cut",i)},{label:n("file.fileOperation.rename"),value:"rename",handle:()=>$e("rename",i)},{label:n("file.fileOperation.PMSN"),value:"permission",handle:()=>$e("permission",i)},{label:n("file.fileOperation.compress"),value:"compress",handle:()=>$e("compression",i)},{label:n("Public.Btn.Delete"),value:"delete",handle:()=>$e("del",i)}]);k(()=>o.value.map(e=>({label:e.label,key:e.value,handle:e.handle})));const s=k(()=>{if(ce(t.file))return[{label:n("Public.Btn.Preview"),value:"preview",handle:()=>Te(i,t.file.path)},...o.value];if("dir"===t.file.type){const e=[...o.value],t=e.findIndex(e=>"download"==e.value);return e.splice(t,1),[{label:n("file.fileOperation.open"),value:"open",handle:()=>$e("open",i)},...e]}if(Ue(t.file))return[{label:n("Public.Btn.Edit"),value:"edit",handle:()=>$e("edit",i)},...o.value];if(Ee(t.file.ext)){const e=[...o.value];return e.splice(-2,0,{label:n("file.fileOperation.decompress"),value:"decompress",handle:()=>$e("decompress",i)}),e}return o.value});function c(e){!function(e,t){const{choosedKeys:i}=t;let l="empty";e.target.closest("tr")&&(l=i.value.length>1?"multiple":1==i.value.length?"single":"empty"),X(()=>a.value.filesOperation(e,l))}(e,i)}return(e,t)=>{const i=at,n=r;return C(),F(O,null,[S(l)?(C(),_(i,{key:1,text:"","icon-placement":"right",onClick:c},{default:z(()=>[P("span",ia,L(e.$t("Public.Table.Action")),1),j(n,{name:"down",size:"14"})]),_:1})):(C(),F("div",ta,[(C(!0),F(O,null,D(S(s),e=>(C(),_(i,{key:e.value,text:"",type:"primary",onClick:J(e.handle,["stop"])},{default:z(()=>[$(L(e.label),1)]),_:2},1032,["onClick"]))),128)),j(i,{text:"","icon-placement":"right",onClick:c},{default:z(()=>[P("span",aa,L(e.$t("Public.Btn.More")),1),j(n,{name:"down",size:"14"})]),_:1})])),j(ea,{ref_key:"fileOperationContextRef",ref:a},null,512)],64)}}}),na=i(la,[["__scopeId","data-v-8101ae96"]]),oa=y({__name:"FileTable",setup(e){const t=w("fileStore"),{sort:a,reverse:i,tableRef:l,fileList:n,choosedKeys:o,tableLoading:s,contextRef:c,currentFile:f,dataTableRef:v}=t,m=x({}),h=e=>e.nm,b=e=>({"data-key":e.nm,onContextmenu(e){e.preventDefault(),Be(e,t)},onDblclick(){Ne(t,e)},onMouseenter(){e.operation_show=!0},onMouseleave(){e.operation_show=!1}}),g=e=>o.value.includes(e.nm)?`active-row normal-tr-${e.nm}`:`normal-tr-${e.nm}`,{t:y}=I(),k=x([{type:"selection",width:40,className:"file-checkbox",cellProps:()=>({style:{cursor:"pointer"}})},{title:()=>y("file.fileName"),key:"name",width:"22%",minWidth:164,sorter:!0,sortOrder:!1,render:e=>e.isCreate?j("div",{class:"flex justify-between items-center gap-2.5 w-100%"},[j("div",{class:"flex justify-start items-center"},[j(se,{ext:e.ext},null),j(nt,{"input-props":{autocomplete:"on",name:"filename"},value:e.editName,"onUpdate:value":t=>e.editName=t,autofocus:!0,id:"createInput",onKeydown:e=>{"Enter"===e.key&&(e.preventDefault(),Ge(t))},onBlur:()=>{Ge(t)}},null)])]):j("div",{class:"flex cursor-pointer",onClick:()=>We(t,e)},[j("div",{class:"flex-1 flex items-center w-0 gap-4px"},[j("div",{class:"flex-1 w-0 flex items-center"},[j("div",{class:"flex items-center"},[j(se,{ext:e.ext},null)]),j("div",{class:"min-w-0"},[j(et,null,{default:()=>[j("span",{class:"hover:text-primary cursor-pointer"},[e.lnk?e.nm+e.lnk:e.nm])]})])]),j("div",{class:"flex items-center gap-4px"},[e.isShare?j(r,{name:"file-share",size:"16"},null):null,e.isFavorite?j(r,{name:"file-favorite",size:"16"},null):null])])])},{title:()=>y("file.protected"),key:"protection",width:"8%",minWidth:114,render:e=>j("div",{class:"flex justify-start gap-4px items-center cursor-pointer",onClick:()=>Ke(t,e)},[j("span",{class:1===e.protected?"text-primary":""},[1==e.protected?y("file.protectedStatus"):y("file.unprotectedStatus")]),j(r,{size:"14",name:1==e.protected?"file-lock":"file-unlock",class:1===e.protected?"text-primary":"text-weak"},null)])},{title:"PMSN/Owner",key:"accept",width:"8%",minWidth:108,sorter:!0,sortOrder:!1,render:e=>`${e.acc} / ${e.user}`},{title:()=>y("file.size"),key:"size",width:"7%",minWidth:90,sorter:!0,sortOrder:!1,render(e){if("dir"===e.type)return j(Ve,{path:e.path},null);{let a;return j(at,{type:"primary",text:!0},"function"==typeof(t=a=u(e.sz))||"[object Object]"===Object.prototype.toString.call(t)&&!Z(t)?a:{default:()=>[a]})}var t}},{title:()=>y("file.modifyTime"),key:"mtime",width:"10%",minWidth:140,sorter:!0,sortOrder:!1,render:e=>p(e.mt)},{title:()=>y("file.remarks"),key:"rmk",minWidth:164,render:e=>j("div",{class:"min-w-134px min-h-26px",onMouseenter:()=>{return(t=e).remarks_hover=!0,void(t.editRemarks=t.rmk);var t},onMouseleave:()=>{var t;(t=e).isEditRemarks||(t.remarks_hover=!1)}},[e.remarks_hover?j(nt,{value:e.editRemarks,"onUpdate:value":t=>e.editRemarks=t,size:"small",onClick:t=>{t.preventDefault(),e.isEditRemarks=!0,m.value=e,f.value=e,f.value.editRemarks=e.rmk,f.value.isEditRemarks=!0},onBlur:()=>{Ge(t)},onKeydown:e=>{"Enter"===e.key&&(e.preventDefault(),Ge(t))}},null):j("span",{title:e.rmk},[e.rmk])])},{title:()=>y("file.operation"),key:"operation",width:"22%",maxWidth:340,align:"right",render(e){if(e.operation_show||o.value.includes(e.nm))return j(na,{file:e},null)}}]),_=e=>{k.value.forEach(t=>{const a=t;a.key===e.columnKey?a.sortOrder=e.order:a.sortOrder=!1}),d(e.order)?(i.value="ascend"===e.order?"False":"True",a.value=`${e.columnKey}`):(a.value="",i.value="False"),Oe(t)};function z(e){o.value=e}return Q(o,()=>pe(t)),W(()=>{Ie(t),l.value.oncontextmenu=e=>{e.preventDefault(),e.target.closest("tr")||(o.value.length,c.value.filesOperation(e))}}),(e,t)=>{const a=st;return C(),F(O,null,[P("div",{ref_key:"tableRef",ref:l,class:"h-full relative"},[j(a,{class:"h-full",ref_key:"dataTableRef",ref:v,"flex-height":"",columns:S(k),"row-key":h,data:S(n),"row-class-name":g,"on-update:checked-row-keys":z,"row-props":b,"checked-row-keys":S(o),loading:S(s),"scrollbar-props":{trigger:"none"},"onUpdate:sorter":_},null,8,["columns","data","checked-row-keys","loading"])],512),j(ea,{ref_key:"contextRef",ref:c},null,512)],64)}}}),ra=i(oa,[["__scopeId","data-v-14098e72"]]),sa={class:"h-full overflow-auto"},ca=["onMouseenter","onMouseleave","onClick","data-key","onContextmenu","onDblclick"],da={class:"single-line-ellipsis"},ua=["onMouseenter","onMouseleave","onClick","data-key","onContextmenu"],pa=i(y({__name:"CardList",setup(e){const t=w("fileStore"),{normalCardList:a,cardRectArr:i,fileList:l,choosedKeys:n,tableLoading:o,currentFile:r}=t,s=x(),c=x(),d=x();Q(r,e=>{e?.isCreate&&X(()=>{const e=c.value.querySelector("input");e&&(e.focus(),e.select())})});const u=k(()=>l.value.map(e=>(n.value.includes(e.nm)?e.card_choosed=!0:e.card_choosed=!1,e)));async function p(e){e.isRenameForCard||(n.value=[e.nm],"dir"===e.type&&await qe(t))}function v(e){const t=[];for(let a=0;a<i.value.length;a++){const[[l,n]]=Object.entries(i.value[a]);Ye(e,n.getClientRects()[0])&&t.push(l)}n.value=t}function m(e,l){!function(){a.value=document.querySelectorAll(".file-item");const e=[];for(let t=0;t<a.value.length;t++){const i=a.value[t].dataset.key;e.push({[i]:a.value[t]})}i.value=e}(),"INPUT"==e.target.nodeName?l.m_flag.value=!1:(l.m_flag.value=!0,Ge(t))}function h(e){if(e.target.closest("div.file-item")){const t=e.target.closest("div.file-item").dataset.key;if(n.value.includes(t))return;n.value=[t]}else n.value=[]}function b(e,t){n.value.length>1?s.value.filesOperation(e,"multiple"):(1==n.value.length||(n.value=[t.nm]),s.value.filesOperation(e,"single"))}return W(()=>{d.value=Ae(c,v,m),c.value.oncontextmenu=e=>{e.preventDefault(),e.target.closest("div.file-item")||(n.value.length,s.value.filesOperation(e))}}),ee(()=>{c.value.oncontextmenu=null}),(e,a)=>{const i=ct,l=nt,r=f;return C(),F("div",sa,[j(r,{show:S(o),class:"h-full"},{default:z(()=>[P("div",{class:"card-list",ref_key:"cardListRef",ref:c,onContextmenu:h},[(C(!0),F(O,null,D(S(u),e=>(C(),F(O,{key:e.nm},[e.isRenameForCard||e.isCreate?e.isRenameForCard||e.isCreate?(C(),F("div",{key:1,class:M(["file-item",{active:e.card_hover||e.card_choosed}]),onMouseenter:t=>S(bt)(e),onMouseleave:t=>S(gt)(e),onClick:t=>p(e),"data-key":e.nm,onContextmenu:t=>b(t,e)},[j(se,{ext:e.ext,size:"large"},null,8,["ext"]),j(l,{value:e.editName,"onUpdate:value":t=>e.editName=t,size:"small",autofocus:"",autoselect:"",onClick:J(()=>!1,["stop"]),onKeydown:a[0]||(a[0]=Y(()=>S(Ge)(S(t)),["enter"]))},null,8,["value","onUpdate:value"])],42,ua)):K("",!0):(C(),_(i,{key:0,trigger:"hover",placement:"bottom"},{trigger:z(()=>[P("div",{class:M(["file-item",{active:e.card_hover||e.card_choosed}]),onMouseenter:t=>S(bt)(e),onMouseleave:t=>S(gt)(e),onClick:t=>p(e),"data-key":e.nm,onContextmenu:t=>b(t,e),onDblclick:a=>function(e){e.isRenameForCard||"dir"!==e.type&&(n.value=[e.nm],He(t))}(e)},[j(se,{ext:e.ext,size:"large"},null,8,["ext"]),P("span",da,L(e.nm),1)],42,ca)]),default:z(()=>[$(" "+L(e.nm),1)]),_:2},1024))],64))),128))],544)]),_:1},8,["show"]),j(ea,{ref_key:"contextRef",ref:s},null,512)])}}}),[["__scopeId","data-v-ae5d241c"]]),fa={class:"flex items-center justify-between"},va={class:"flex justify-start items-center whitespace-pre"},ma={key:1,class:"i-svg-spinners:90-ring-with-bg text-7 text-primary"},ha=y({__name:"FileTableFooter",setup(e){const{t:t}=I(),a=w("fileStore"),{dirNums:i,fileNums:l,page:n,size:o,total:r,currentPath:s,currentDirSize:d}=a,u=x(!1),p=[100,500,1e3,1500,2e3];async function f(){try{u.value=!0;const e=await c.post("/files?action=GetDirSize",{path:s.value},{requestOptions:{isOriginalResult:!0}});d.value=e.message}catch(e){console.warn(e)}finally{u.value=!1}}return(e,s)=>{const c=at,v=mt;return C(),F("div",fa,[P("div",va,[$(L(S(t)("file.tableFooter.summary",{dirNum:S(i),fileNum:S(l)}))+" ",1),S(u)?(C(),F("i",ma)):(C(),F(O,{key:0},[-1===S(d)?(C(),_(c,{key:0,type:"primary",text:"",onClick:f},{default:z(()=>[$(L(S(t)("file.tableFooter.calculate")),1)]),_:1})):(C(),_(c,{key:1,text:"",type:"primary"},{default:z(()=>[$(L(S(d)),1)]),_:1}))],64))]),j(v,{page:S(n),"onUpdate:page":s[0]||(s[0]=e=>T(n)?n.value=e:null),"page-size":S(o),"onUpdate:pageSize":s[1]||(s[1]=e=>T(o)?o.value=e:null),"item-count":S(r),"page-sizes":p,onRefresh:s[2]||(s[2]=()=>S(Oe)(S(a)))},null,8,["page","page-size","item-count"])])}}}),ba={class:"flex flex-col gap-16px h-full p-16px overflow-hidden"},ga=y({__name:"main",props:{path:{default:"/"},view:{default:"list"}},emits:["currentPathChange","viewChange","rendered"],setup(e,{emit:a}){const i=e,l=x(),o=function(){const e=x(),a=x("list"),i=x("/www"),l=x([]),o=x(!1),r=x([]),s=x([]),c=x([]),d=x(),u=x(),p=x(),f=x([]),v=x([]),m=x({url:"http://",path:i.value,filename:""}),h=x({reference:"",per:0,speed:"0",used:"0",except:"--",total:0}),b=x(!1),g=x([]),y=x({text:"",exts:"html,php",path:i.value,is_subdir:0,mode:0,isword:0,iscase:1,noword:0}),w=x({}),_=x({files:0,times:0}),C=x([]),z=x([{label:jt("file.favoriteListModal.management"),key:"management",icon:"settings"}]),P=x([]),S=x([]),j=x({back_sub_dir:1,path:"",remark:""}),R=St,F=Ct,O=zt,D=Pt,M={PasteConfirm:()=>E(()=>n(()=>t.import("./PasteConfirm-legacy.js?v=1769066082311"),void 0)),PasteSingleConfirm:()=>E(()=>n(()=>t.import("./PasteSingleConfirm-legacy.js?v=1769066082311"),void 0)),UploadFile:()=>E(()=>n(()=>t.import("./UploadFile-legacy.js?v=1769066082311"),void 0)),RemoteDownload:()=>E(()=>n(()=>t.import("./RemoteDownload-legacy.js?v=1769066082311"),void 0)),SearchFileContent:()=>E(()=>n(()=>t.import("./SearchFileContent-legacy.js?v=1769066082311"),void 0)),FavoriteList:()=>E(()=>n(()=>t.import("./FavoriteList-legacy.js?v=1769066082311"),void 0)),ShareList:()=>E(()=>n(()=>t.import("./ShareList-legacy.js?v=1769066082311"),void 0)),Backup:()=>E(()=>n(()=>t.import("./Backup-legacy.js?v=1769066082311"),void 0)),Recycle:()=>E(()=>n(()=>t.import("./Recycle-legacy.js?v=1769066082311"),void 0)),Terminal:()=>E(()=>n(()=>t.import("./Terminal-legacy.js?v=1769066082311"),void 0)),Softlink:()=>E(()=>n(()=>t.import("./SoftLink-legacy.js?v=1769066082311"),void 0)),Share:()=>E(()=>n(()=>t.import("./Share-legacy.js?v=1769066082311"),void 0)),Permission:()=>E(()=>n(()=>t.import("./Permission-legacy.js?v=1769066082311"),void 0)),Properties:()=>E(()=>n(()=>t.import("./Properties-legacy.js?v=1769066082311"),void 0)),Del:()=>E(()=>n(()=>t.import("./Del-legacy.js?v=1769066082311"),void 0)),Compression:()=>E(()=>n(()=>t.import("./Compression-legacy.js?v=1769066082311"),void 0)),Decompress:()=>E(()=>n(()=>t.import("./Decompress-legacy.js?v=1769066082311"),void 0)),AceEditor:()=>E(()=>n(()=>t.import("./index-legacy191.js?v=1769066082311"),void 0))},$=U(null),L=x(),T=x(!1),I=x(!1),N=x([]),B=x(!1),G=x(!1),W=x(!1),K=x(!1),V=x(),A=x(!1),q=k(()=>l.value.filter(e=>ce(e)).map(e=>e.path)),H=k(()=>l.value.filter(e=>de(e.ext)).map(e=>({path:e.path,name:e.nm}))),Y=x(""),X=x({path:"",name:""}),J=x(!1),Q=x(!1),Z=x(1),ee=x(0),te=x(0),ae=x(1),ie=x(100),le=x(""),ne=x("False"),oe=x(0),re=x(null),se=x(),ue=x([]),pe=x(1),fe=x(0),ve=x(-1),me=x();return{mainRef:e,filesView:a,currentPath:i,fileList:l,tableLoading:o,normalTrList:r,trRectArr:s,choosedKeys:c,tableRef:d,dataTableRef:u,contextRef:p,normalCardList:f,cardRectArr:v,downloadFileFormData:m,downloadProgressData:h,downloadProgressShow:b,resourceManagerWindow:g,searchFileContentFormData:y,resetSearchFileContentFormData:function(){y.value={text:"",exts:"html,php",path:i.value,is_subdir:0,mode:0,isword:0,iscase:1,noword:0}},searchRes:w,searchStatistics:_,favoriteList:C,favoriteOptions:z,resetFavoriteOptions:function(){z.value=[{label:jt("file.favoriteListModal.management"),key:"management",icon:"settings"}]},shareList:P,backupList:S,backupForm:j,fileOperationFlag:R,fileCopyCache:F,waitForPaste:O,copiedFile:D,dynamicCmptObj:M,dynamicCmpt:$,dynamicCmptRef:L,fileRecycle:T,menuShow:I,uploadFileList:N,uploadShow:B,uploadComplete:G,startUpload:W,fileConflictShow:K,optionToolsRef:V,isMiniScreen:A,imgWaitPreview:q,videoWaitPreview:H,currentPreviewImg:Y,currentPreviewVideo:X,previewShow:J,previewVideoShow:Q,operationType:Z,dirNums:ee,fileNums:te,page:ae,size:ie,sort:le,reverse:ne,total:oe,currentFile:re,choosePathRef:se,diskMountPoint:ue,shareListPage:pe,shareListTotal:fe,currentDirSize:ve,dragUploadRef:me}}(),r=te();le("fileStore",o);const{dynamicCmpt:s,dynamicCmptRef:c,currentPath:d,filesView:u,choosedKeys:p,mainRef:f,currentFile:m,dragUploadRef:h}=o;d.value=i.path,u.value=i.view;const b=a;function g(e){b("viewChange",{view:e,currentPath:d.value})}return Q(d,e=>{sessionStorage.setItem("currentPath",e),b("currentPathChange",e)}),N(()=>{Oe(o),document.onkeydown=async e=>{const t=e.target;if("INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&"/files"==r.path&&!(m.value?.isCreate||m.value?.isEditRemarks||m.value?.isRename||document.querySelector(".aceEditors"))){if(e.ctrlKey&&"c"===e.key){if(0==p.value.length)return;await ke(o)}if(e.ctrlKey&&"v"===e.key&&ze(o),e.ctrlKey&&"x"===e.key){if(0==p.value.length)return;_e(o)}}}}),ae(()=>{Oe(o)}),Xe(o),W(()=>b("rendered",d.value)),(e,t)=>{const a=v;return C(),F("div",{ref_key:"mainRef",ref:f,class:"flex-1 overflow-hidden"},[P("div",ba,[P("div",null,[j(Zt)]),j(a),P("div",null,[j(Gt,{"files-view":S(u),"onUpdate:filesView":t[0]||(t[0]=e=>T(u)?u.value=e:null),onViewChange:g},null,8,["files-view"])]),P("div",{ref_key:"listRef",ref:l,class:"flex-1 overflow-hidden",tabindex:"0"},["list"==S(u)?(C(),_(ra,{key:0})):"card"==S(u)?(C(),_(pa,{key:1})):K("",!0)],512),j(ha)]),(C(),_(ie(S(s)),{ref_key:"dynamicCmptRef",ref:c},null,512)),j(Mt,{ref_key:"dragUploadRef",ref:h},null,512),j(Tt),j(_t)],512)}}}),ya={class:"tabs"},wa=["onClick"],xa={class:"flex justify-start gap-5"},ka={class:"tab-tit"},_a={class:"tab-tit"},Ca=y({__name:"index",setup(e){const t=x(null),{mainHeight:a}=ne(m()),i=k(()=>a.value-16-16),l=x(),n=x(),s=x(),c=x(!1),d={id:"tab-0",title:"www",path:"/www",view:"list"},u=oe("file-tabs",[dt(d)]),p=oe("file-tabs-active","tab-0"),f=oe("file-tabs-view","list");Q(p,e=>{const t=u.value.find(t=>t.id==e);t&&(f.value=t.view)},{immediate:!0});const v=k(()=>{const e=u.value.find(e=>e.id==p.value);return e?e.path:"tab-0"});function y(e="",t=""){if(u.value.length>=14)return void o.warning("Only 14 tags can be opened at most");const a=`tab-${(new Date).getTime()}`,i=dt(d);i.id=a,e&&(i.path=e),t&&(i.title=t),u.value.push(i),p.value=a}function w(e){const t=e.split("/").slice(-1)[0];u.value.forEach(a=>{a.id==p.value&&(a.path=e,a.title=""==t?"/":t)})}function $({view:e,path:t}){f.value=e,u.value.forEach(a=>{a.id==p.value&&(a.path=t,a.view=e)})}function T(e){"left"==e?s.value.scrollLeft-=100:"right"==e&&(s.value.scrollLeft+=100)}return le("file-provide",{addTab:y}),W(()=>{s.value.addEventListener("mousewheel",e=>{e.preventDefault(),s.value.scrollLeft+=e.deltaY})}),function(){const e=b("Path");if(e){const t=`tab-${(new Date).getTime()}`;u.value.push({id:t,title:e,path:e,view:"list"});const a=u.value.find(t=>t.path==e);a&&(p.value=a.id)}g("Path")}(),W(async()=>{await h("/static/ace/styles/icons.css?v=1769066082311",t.value),Je()}),(e,a)=>{const o=r,d=ct,m=ut;return C(),F("div",{ref_key:"fileRef",ref:t,id:"file-main",class:"p-16px"},[j(m,{style:R({height:S(i)+"px"}),"content-style":{display:"flex",flexDirection:"column",overflow:"hidden"}},{default:z(()=>[P("div",ya,[P("div",{class:M(["tabs-scroll",{"has-scroll":S(c)}]),ref_key:"tabScrollRef",ref:l},[S(c)?(C(),F("div",{key:0,class:"left",onClick:a[0]||(a[0]=e=>T("left"))},a[3]||(a[3]=[P("i",{class:"i-tdesign:caret-left text-7"},null,-1)]))):K("",!0),S(c)?(C(),F("div",{key:1,class:"right",onClick:a[1]||(a[1]=e=>T("right"))},a[4]||(a[4]=[P("i",{class:"i-tdesign:caret-right text-7"},null,-1)]))):K("",!0),P("div",{class:"scroll-container",ref_key:"tabScrollContainerRef",ref:s},[P("div",{class:"tabs-wrapper",ref_key:"tabWrapperRef",ref:n},[(C(!0),F(O,null,D(S(u),e=>(C(),_(d,{placement:"bottom",key:e.id},{trigger:z(()=>[P("div",{class:M(["tab-item",{active:e.id==S(p)}]),onClick:t=>{return a=e.id,void(p.value=a);var a}},[P("div",xa,[j(o,{name:"file-dir",size:"18"}),P("span",ka,L(e.title),1)]),e.id==S(p)&&S(u).length>1?(C(),_(o,{key:0,name:"base-error",size:"18",color:"#bbb",onClick:t=>function(e){if(1==u.value.length)return void(p.value=u.value[0].id);const t=u.value.findIndex(t=>t.id==e);u.value.splice(t,1),setTimeout(()=>p.value=u.value[u.value.length-1].id,50)}(e.id)},null,8,["onClick"])):K("",!0)],10,wa)]),default:z(()=>[P("span",_a,L(e.title),1)]),_:2},1024))),128)),P("div",{class:"tab-item add",onClick:a[2]||(a[2]=e=>y())},[j(o,{name:"base-add",size:"18",color:"#ccc"})])],512)],512)],2)]),(C(),_(re,null,[(C(),_(ie(ga),{key:S(p),onCurrentPathChange:w,path:S(v),view:S(f),onViewChange:$},null,40,["path","view"]))],1024))]),_:1},8,["style"])],512)}}}),za=i(Ca,[["__scopeId","data-v-dbb99f65"]]),Pa=Object.freeze(Object.defineProperty({__proto__:null,default:za},Symbol.toStringTag,{value:"Module"}));e("i",Pa)}}});
