const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/form8.js?v=1764233927359","js/public.js?v=1764233927359","js/page_layout.js?v=1764233927359","js/vue.js?v=1764233927359","js/__commonjsHelpers__.js?v=1764233927359","js/naive.js?v=1764233927359","js/common.js?v=1764233927359","css/page_layout.css?v=1764233927359","css/public.css?v=1764233927359","js/index.vue_vue_type_script_setup_true_lang.js?v=1764233927359","js/ssl-log.js?v=1764233927359","js/index104.js?v=1764233927359","css/index19.css?v=1764233927359","js/domain-form.js?v=1764233927359","js/utils3.js?v=1764233927359"])))=>i.map(i=>d[i]);
import{_ as e}from"./index107.js?v=1764233927359";import{r as a,h as t,a as l,m as n,b as s,c as i,d as o,l as r,e as d,f as u,g as m,i as c,u as p,j as _}from"./utils3.js?v=1764233927359";import{k as h,P as v,e as f,r as y,W as g,b as w,R as k,V as b,a3 as x,S,U as D,j as C,a4 as P,_ as R,G as L,ad as U,ae as j,a2 as E,s as z,u as T,ak as $,an as N,F as O,O as A,a0 as I,o as M,N as V}from"./vue.js?v=1764233927359";import{d7 as B,d8 as F,d as q,_ as H,a as W,d9 as K,da as Y,m as G,db as J,dc as Q,dd as X,p as Z,u as ee,o as ae,de as te,df as le,T as ne,dg as se,dh as ie,di as oe,dj as re,dk as de,dl as ue,dm as me,dn as ce}from"./page_layout.js?v=1764233927359";import{_ as pe}from"./index.js?v=1764233927359";import{_ as _e}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1764233927359";import{_ as he}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1764233927359";import{e as ve,c as fe,f as ye,a as ge,h as we,m as ke,_ as be,d as xe}from"./public.js?v=1764233927359";import{o as Se,c as De,a as Ce,u as Pe,b as Re,d as Le,e as Ue,f as je}from"./utils4.js?v=1764233927359";import{dj as Ee,dk as ze,aC as Te,dV as $e,da as Ne,dd as Oe,dh as Ae,dR as Ie,au as Me,df as Ve,d8 as Be,dS as Fe}from"./naive.js?v=1764233927359";import{_ as qe}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1764233927359";import{_ as He}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1764233927359";import{_ as We}from"./index.vue_vue_type_script_setup_true_lang.js?v=1764233927359";import{T as Ke}from"./transition.js?v=1764233927359";import"./__commonjsHelpers__.js?v=1764233927359";import"./common.js?v=1764233927359";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1764233927359";import"./soft.js?v=1764233927359";import"./site.js?v=1764233927359";const Ye={class:"flex items-center"},Ge=h({__name:"index",setup(e){const s=R(()=>W(()=>import("./form8.js?v=1764233927359"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),i=R(()=>W(()=>import("./ssl-log.js?v=1764233927359"),__vite__mapDeps([10,11,2,3,4,5,6,1,8,7,12]))),{t:o}=v(),r=f({p:1,limit:10}),d=ve("",{isEdit:!1,onRefresh:()=>{U()}}),u=ve(o("SSL.Domain.index_5")),m=()=>{d.data.isEdit=!1,d.title=o("SSL.Domain.index_4"),d.show=!0},c=y(!1),{table:p,columns:_}=fe([{key:"alias",title:o("Config.Panel.index_36"),render:e=>e.alias?g("span",{class:"bt-link",onClick:()=>{t.value=e.id,l.value=e.name,n.value="manage"}},[e.alias]):"--"},{key:"api_user",title:o("Home.index_2"),render:e=>e.api_user?e.api_user:"--"},a(e=>{u.data.path=e,u.show=!0}),{key:"status",title:o("Public.Table.Status"),render:e=>g(Ee,{uncheckedValue:0,checkedValue:1,value:e.status,"onUpdate:value":[a=>e.status=a,async a=>{try{await K({id:e.id,status:a})}catch(t){e.status=1===a?0:1}}]},null)},{key:"permission",title:o("Database.index_21"),align:"center",render:e=>e.permission?e.permission:"--"},{key:"domains",title:o("Layout.Sider.domain_1"),align:"center",render:e=>e.domains.length},ye({width:250,options:e=>[{label:o("SSL.Domain.index_7"),onClick:()=>{t.value=e.id,l.value=e.name,n.value="manage"}},{label:o("Public.Btn.Edit"),onClick:()=>{"aaPanelDns"!==e.name?h(e):Se()}},{label:o("Public.Btn.Del"),show:"aaPanelDns"!==e.name,onClick:()=>{ge({title:o("SSL.Domain.index_8"),content:o("SSL.Domain.index_9"),onConfirm:async()=>{await B({id:e.id}),U()}})}}]})]),h=e=>{d.data.isEdit=!0,d.data.row=e,d.title=o("SSL.Domain.index_10"),d.show=!0};let L=null;const U=async()=>{try{c.value||(p.loading=!0);const{message:e}=await F(r);q(e)&&(c.value=e.data.some(e=>e.task.some(e=>100!==e.task_status)),c.value?j():L&&clearTimeout(L),p.data=e.data,p.total=e.total)}finally{p.loading=!1}},j=async()=>{L=window.setTimeout(()=>{U()},5e3)};return U(),w(()=>{L&&clearTimeout(L)}),(e,a)=>{const t=H,l=ze,n=Te,o=we,c=he,h=_e,v=pe;return b(),k("div",null,[g(l,{"show-icon":!1,class:"mb-10px"},{default:x(()=>[S("div",Ye,[g(t,{name:"base-info",size:17,class:"mr-8px"}),a[4]||(a[4]=S("span",{class:"leading-17px"},"aaPanel Domain Name Management Center, allowing you to unify accounts across multiple domain providers without switching DNS platforms",-1))])]),_:1}),g(h,{feedback:!0},{toolsLeft:x(()=>[g(n,{type:"primary",onClick:m},{default:x(()=>[C(P(e.$t("SSL.Domain.index_4")),1)]),_:1})]),table:x(()=>[g(o,{loading:D(p).loading,data:D(p).data,columns:D(_)},null,8,["loading","data","columns"])]),pageRight:x(()=>[g(c,{page:D(r).p,"onUpdate:page":a[0]||(a[0]=e=>D(r).p=e),"page-size":D(r).limit,"onUpdate:pageSize":a[1]||(a[1]=e=>D(r).limit=e),"store-key":"ssl-host-page","item-count":D(p).total,onRefresh:U},null,8,["page","page-size","item-count"])]),_:1}),g(v,{show:D(d).show,"onUpdate:show":a[2]||(a[2]=e=>D(d).show=e),title:D(d).title,data:D(d).data,width:540,"min-height":300,footer:!0,component:D(s)},null,8,["show","title","data","component"]),g(v,{show:D(u).show,"onUpdate:show":a[3]||(a[3]=e=>D(u).show=e),title:D(u).title,data:D(u).data,width:700,height:450,footer:!1,component:D(i)},null,8,["show","title","data","component"])])}}});function Je(){const e=y(!1);let a=null;const t=()=>{a&&(clearInterval(a),a=null)},l=()=>{t(),a=setInterval(async()=>{await Ce(),De.value&&(t(),e.value=!1,G.success("DNS check completed."))},1e3)};return L(()=>{t()}),{canRefreshDns:De,refreshLoading:e,startDnsPolling:l,stopPolling:t,onRefreshDns:async()=>{t(),e.value=!0,await Y({act:"start"}),l()}}}const Qe=h({__name:"host-select",props:{value:{},valueModifiers:{}},emits:U(["change"],["update:value"]),setup(e,{emit:a}){const{t:t}=v(),l=j(e,"value"),n=a,o=(e,a)=>{n("change",e,a.label)},r=e=>{if(e.disabled){let a;return g(Ne,{class:"items-center"},{default:()=>{return[g("span",null,[e.label]),g(Te,{type:"primary",size:"tiny",onClick:()=>{ke(e.alias)}},(l=a=t("Public.Btn.Install"),"function"==typeof l||"[object Object]"===Object.prototype.toString.call(l)&&!T(l)?a:{default:()=>[a]}))];var l}})}return e.label+" ("+e.alias+")"};return(e,a)=>{const t=$e;return b(),E(t,z({loading:D(i),class:"w-300px"},e.$attrs,{filterable:"",value:l.value,"onUpdate:value":[a[0]||(a[0]=e=>l.value=e),o],options:D(s),"consistent-menu-width":!1,"render-label":r}),null,16,["loading","value","options"])}}}),Xe=h({__name:"domain-select",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const a=j(e,"value"),{t:t}=v(),l=e=>g(Ne,{class:"items-center justify-between!"},{default:()=>[g("span",{class:"w-225px truncate"},[t("Mail.Mass.index_45"),C("ï¼š"),e.label]),e.ssl_info&&-1!==e.ssl_info?g(Oe,{type:e.ssl_info>30?"success":e.ssl_info>0?"warning":"error",class:"px-10px"},{default:()=>[e.ssl_info?e.ssl_info+" "+t("Crontab.arrange.index_41"):t("Config.Safe.index_166")]}):""]});return(e,t)=>{const n=$e;return b(),E(n,z(e.$attrs,{class:"w-350px",size:"large",filterable:"",value:a.value,"onUpdate:value":t[0]||(t[0]=e=>a.value=e),options:D(o),"consistent-menu-width":!1,loading:D(r),disabled:!D(o).length,"render-label":l}),null,16,["value","options","loading","disabled"])}}}),Ze=Z(h({__name:"domain",emits:["change"],setup(e,{emit:a}){const n=R(()=>W(()=>import("./domain-form.js?v=1764233927359"),__vite__mapDeps([13,9,3,4,5,6,2,1,8,7,14]))),s=a,{t:i}=v(),o=f({p:1,limit:10,domain:d,search:""}),r=ve("",{isEdit:!1,onRefresh:()=>{M()}}),p=()=>{r.data.isEdit=!1,r.title=i("SSL.Domain.index_17"),r.show=!0},_=()=>{s("change"),m.value=!1},h=()=>{o.p=1,M()},y=async()=>{M()},w=async(e,a)=>{l.value=a,t.value=e,d.value="",o.p=1,await c(),M()},{table:L,columns:U}=fe([{key:"record",title:i("SSL.Domain.index_11"),width:"20%"},{key:"record_type",title:i("Ftp.Table.index_3"),width:"10%"},{key:"record_value",title:i("SSL.Domain.index_13"),width:"20%",ellipsis:{tooltip:!0}},{key:"ttl",title:"TTL",width:100,render:e=>1===e.ttl?i("Mail.Mass.index_34"):e.ttl},{key:"priority",title:"Priority",width:100,render:e=>-1===e.priority?"--":e.priority},{key:"proxy",title:i("SSL.Domain.index_16"),render:e=>-1===e.proxy?"--":g(Ee,{"checked-value":1,"unchecked-value":0,value:e.proxy,"onUpdate:value":[a=>e.proxy=a,async a=>{const l={id:e.id,pid:t.value,domain:d.value,record:e.record,record_type:e.record_type,record_value:e.record_value,ttl:e.ttl,priority:e.priority,proxy:a,ps:e.ps};try{await X(l)}catch(n){e.proxy=1===a?0:1}}]},null)},{key:"ps",title:i("Public.Table.Ps")},ye({width:150,options:e=>[{label:i("Public.Btn.Edit"),onClick:()=>{I(e)}},{label:i("Public.Btn.Del"),onClick:()=>{ge({title:i("SSL.Domain.index_19"),content:i("SSL.Domain.index_20"),onConfirm:async()=>{await J({id:e.id}),M(),s("change")}})}}]})]),j=()=>{window.open("https://www.aaPanel.com/docs/Function/Tutorial/build_dns_server.html")},{canRefreshDns:z,refreshLoading:T,startDnsPolling:O,onRefreshDns:A}=Je(),I=e=>{r.data.isEdit=!0,r.data.row=e,r.title=i("SSL.Domain.index_21"),r.show=!0},M=async()=>{try{if(""===d.value)return void(L.data=[]);L.loading=!0;const{message:e}=await Q({...o,search_pid:t.value});q(e)&&(L.data=e.data,L.total=e.total)}finally{L.loading=!1}};return(async()=>{await c(),await M(),u.value&&(await Ce(),z.value||(T.value=!0,O()))})(),(e,a)=>{const l=H,s=Te,i=Ae,d=Ne,m=ze,c=He,v=we,f=he,R=_e,O=pe;return b(),k("div",null,[g(d,{class:"select-box"},{default:x(()=>[g(Qe,{value:D(t),"onUpdate:value":a[0]||(a[0]=e=>$(t)?t.value=e:null),onChange:w},null,8,["value"]),g(d,null,{default:x(()=>[g(Xe,{value:D(o).domain,"onUpdate:value":[a[1]||(a[1]=e=>D(o).domain=e),h]},null,8,["value"]),g(i,{trigger:"hover"},{trigger:x(()=>[g(s,{onClick:y,class:"h-40px w-40px"},{default:x(()=>[g(l,{name:"base-refresh"})]),_:1})]),default:x(()=>[S("span",null,P(e.$t("SSL.Domain.index_22")),1)]),_:1})]),_:1})]),_:1}),g(R,null,{toolsLeft:x(()=>[g(s,{type:"primary",onClick:p},{default:x(()=>[C(P(e.$t("SSL.Domain.index_17")),1)]),_:1}),g(s,{onClick:_},{default:x(()=>[C(P(e.$t("SSL.Domain.index_18")),1)]),_:1}),D(u)?(b(),E(m,{key:0,type:"warning"},{default:x(()=>[g(d,{class:"items-center"},{default:x(()=>[S("span",null,P(D(u)),1),g(s,{type:"primary",size:"small",onClick:j},{default:x(()=>a[6]||(a[6]=[C("View tutorial",-1)])),_:1,__:[6]}),g(s,{loading:D(T),type:"primary",ghost:"",size:"small",onClick:D(A),disabled:!D(z)},{default:x(()=>[C(P(e.$t("Public.Btn.Refresh")),1)]),_:1},8,["loading","onClick","disabled"])]),_:1})]),_:1})):N("",!0)]),toolsRight:x(()=>[g(c,{value:D(o).search,"onUpdate:value":a[2]||(a[2]=e=>D(o).search=e),onSearch:h},null,8,["value"])]),table:x(()=>[g(v,{loading:D(L).loading,data:D(L).data,columns:D(U),"store-key":"ssl-domain-page"},null,8,["loading","data","columns"])]),pageRight:x(()=>[g(f,{page:D(o).p,"onUpdate:page":a[3]||(a[3]=e=>D(o).p=e),"page-size":D(o).limit,"onUpdate:pageSize":a[4]||(a[4]=e=>D(o).limit=e),"item-count":D(L).total,onRefresh:M},null,8,["page","page-size","item-count"])]),_:1}),g(O,{show:D(r).show,"onUpdate:show":a[5]||(a[5]=e=>D(r).show=e),title:D(r).title,data:D(r).data,width:540,"min-height":300,footer:!0,component:D(n)},null,8,["show","title","data","component"])])}}}),[["__scopeId","data-v-8dac0587"]]),ea={class:"p-20px"},aa=h({__name:"add-form",props:{onRefresh:{}},setup(e,{expose:a}){const{t:t}=v(),l=ee(),n=e,{onRefresh:s}=n,i=y(!1),o=y(null),r=f({domain_name:"",domain_ip:"",soa:"",nameserver1:"",nameserver2:""}),d={domain_name:{required:!0,trigger:["blur","change"],message:t("Please enter your domain name")},domain_ip:{required:!0,trigger:["blur","change"],message:t("Please enter your domain IP")},soa:{required:!0,trigger:["blur","change"],message:t("Please enter SOA")}},u=()=>{if(!r.domain_name)return r.soa="",r.nameserver1="",void(r.nameserver2="");r.soa="ns1."+r.domain_name,i.value||(r.nameserver1="ns1."+r.domain_name,r.nameserver2="ns2."+r.domain_name)},m=()=>{r.domain_ip=l.address};(async()=>{const{message:e}=await te();q(e)&&(r.nameserver1=e.NS1,r.nameserver2=e.NS2,Object.keys(e).length?i.value=!0:i.value=!1)})();return a({onConfirm:async()=>{var e;await(null==(e=o.value)?void 0:e.validate()),await le({domain:r.domain_name,domain_ip:r.domain_ip,soa:r.soa,ns1domain:r.nameserver1,ns2domain:r.nameserver2}),s()}}),(e,a)=>{const t=Me,l=Ie,n=Te,s=Ne,i=ae,c=Ae,p=We,_=be;return b(),k("div",ea,[g(p,{ref_key:"formRef",ref:o,model:D(r),rules:d},{default:x(()=>[g(l,{label:e.$t("Mail.Domain.index_3"),path:"domain_name"},{default:x(()=>[g(t,{class:"w-320px!",value:D(r).domain_name,"onUpdate:value":a[0]||(a[0]=e=>D(r).domain_name=e),placeholder:"Enter your domain name,eg: aapanel.com",onInput:u},null,8,["value"])]),_:1},8,["label"]),g(l,{label:"Domain IP",path:"domain_ip"},{default:x(()=>[g(s,{class:"flex-nowrap!",size:5},{default:x(()=>[g(t,{class:"w-320px!",value:D(r).domain_ip,"onUpdate:value":a[1]||(a[1]=e=>D(r).domain_ip=e),placeholder:"Enter your domain IP,eg: 1.2.3.4"},null,8,["value"]),g(n,{onClick:m},{default:x(()=>a[5]||(a[5]=[C(" USE IP ",-1)])),_:1,__:[5]})]),_:1})]),_:1}),g(l,{label:"SOA",path:"soa"},{default:x(()=>[g(s,{class:"items-center"},{default:x(()=>[g(t,{class:"w-320px!",value:D(r).soa,"onUpdate:value":a[2]||(a[2]=e=>D(r).soa=e),placeholder:"ns1.domain.com"},null,8,["value"]),g(c,null,{trigger:x(()=>a[6]||(a[6]=[S("i",{class:"i-uiw:question-circle-o text-16px text-#9DA1A6 cursor-pointer"},null,-1)])),default:x(()=>[S("div",null,[a[8]||(a[8]=C(" What is SOA record in DNS? ",-1)),g(i,{href:"https://www.aaPanel.com/docs/Function/Domains-basics.html#_4-what-is-the-soa-record",target:"_blank"},{default:x(()=>a[7]||(a[7]=[C(" View ",-1)])),_:1,__:[7]})])]),_:1})]),_:1})]),_:1}),g(l,{label:"NameServer 1",path:"nameserver1"},{default:x(()=>[g(t,{class:"w-320px!",value:D(r).nameserver1,"onUpdate:value":a[3]||(a[3]=e=>D(r).nameserver1=e),placeholder:"Your Name Server,eg: ns1.aapanel.com,Option"},null,8,["value"])]),_:1}),g(l,{label:"NameServer 2",path:"nameserver2"},{default:x(()=>[g(t,{class:"w-320px!",value:D(r).nameserver2,"onUpdate:value":a[4]||(a[4]=e=>D(r).nameserver2=e),placeholder:"Your Name Server,eg: ns2.aapanel.com,Option"},null,8,["value"])]),_:1})]),_:1},8,["model"]),g(_,null,{default:x(()=>[S("li",null,[a[10]||(a[10]=C(" How to add domain name using self-built DNS? ",-1)),g(i,{href:"https://www.aaPanel.com/docs/Function/Tutorial/build_dns_server.html",target:"_blank"},{default:x(()=>a[9]||(a[9]=[C(" View tutorial ",-1)])),_:1,__:[9]})])]),_:1})])}}}),ta=h({__name:"index",props:{data:{},onRefresh:{}},setup(e,{expose:a}){const{t:t}=v(),l=e,{onRefresh:n,data:s}=l,i=y(null),o=f({name_server:"",admin_email:"",serial_number:0,refresh:0,retry:0,expire:0,minimum:0}),r=[{key:"name_server",label:t("Nameserver"),placeholder:t("Enter your nameserver,eg: ns1.domain.com"),tooltip:t("name server")},{key:"admin_email",label:t("Admin Email"),placeholder:"Enter your admin email,eg: admin@domain.com",tooltip:t("model admin email")},{key:"serial_number",label:t("Serial Number"),placeholder:t("Enter your serial number,eg: 2023080101"),tooltip:t("zone file version,Modification is prohibited.")},{key:"refresh",label:t("Refresh"),placeholder:t("Enter your refresh,eg: 3600"),tooltip:t("How often to check the serial number on the master server")},{key:"retry",label:t("Retry"),placeholder:t("Enter your retry,eg: 3600"),tooltip:t("The interval time when the slaveserver reconnects to the masterserver")},{key:"expire",label:t("Expire"),placeholder:t("Enter your expire,eg: 604800"),tooltip:t("When the time exceeds the number of seconds set by Expire and the slave server cannot get in touch with the master, the slave will delete its copy")},{key:"minimum",label:t("Minimum"),placeholder:t("Enter your minimum,eg: 3600"),tooltip:t("Represents the default TTL value of all records in this zone file")}],d=["serial_number","refresh","retry","expire","minimum"],u=Object.fromEntries(r.map(e=>[e.key,{required:!0,...d.includes(e.key)?{type:"number"}:{},trigger:["blur","change"],message:"Please enter your ".concat(e.label.toLowerCase())}])),{loading:m,setLoading:c}=xe();(async()=>{try{c(!0);const{message:e}=await se({domain:s.domain});q(e)&&(o.name_server=e.nameserver,o.admin_email=e.admin_mail,o.serial_number=e.serial,o.refresh=e.refresh,o.retry=e.retry,o.expire=e.expire,o.minimum=e.minimum)}finally{c(!1)}})();return a({onConfirm:async()=>{var e;await(null==(e=i.value)?void 0:e.validate()),await ie({domain:s.domain,nameserver:o.name_server,admin_mail:o.admin_email,serial:o.serial_number,refresh:o.refresh,retry:o.retry,expire:o.expire,minimum:o.minimum}),n()}}),(e,a)=>{const t=Me,l=Ve,n=H,s=Be,c=Ie,p=We,_=ne;return b(),E(_,{show:D(m)},{default:x(()=>[g(p,{class:"p-20px",ref_key:"formRef",ref:i,model:D(o),rules:D(u)},{default:x(()=>[(b(),k(O,null,A(r,e=>g(c,{key:e.key,label:e.label,path:e.key},{default:x(()=>[d.includes(e.key)?(b(),E(l,{key:1,readonly:"serial_number"===e.key,class:"w-350px! mr-8px",value:D(o)[e.key],"onUpdate:value":a=>D(o)[e.key]=a,placeholder:e.placeholder},null,8,["readonly","value","onUpdate:value","placeholder"])):(b(),E(t,{key:0,class:"w-350px! mr-8px",value:D(o)[e.key],"onUpdate:value":a=>D(o)[e.key]=a,placeholder:e.placeholder},null,8,["value","onUpdate:value","placeholder"])),g(s,{trigger:"hover",placement:"top-start"},{trigger:x(()=>[g(n,{name:"common-ask",class:"color-#fc7938",size:"16"})]),default:x(()=>[C(" "+P(e.tooltip),1)]),_:2},1024)]),_:2},1032,["label","path"])),64))]),_:1},8,["model","rules"])]),_:1},8,["show"])}}}),la={class:"leading-17px"},na={class:"leading-17px"};const sa=h({__name:"index",setup(e){const a=R(()=>W(()=>import("./ssl-log.js?v=1764233927359"),__vite__mapDeps([10,11,2,3,4,5,6,1,8,7,12]))),{t:n}=v(),s=oe(),{dnsStatus:i,dnsInstall:o}=I(s),{canRefreshDns:r,refreshLoading:c,onRefreshDns:h}=Je(),y=f({p:1,limit:10,domain:"",id:t}),w=async()=>{await ue({id:y.id}),J(),L.show=!0},L=ve(n("SSL.Domain.index_23"),{path:"/www/server/panel/logs/dns_sync.log"}),U=ve(n("Add Domain"),{onRefresh:()=>{J()}}),j=ve(n("SOA Record"),{onRefresh:()=>{J()}}),z=e=>{var a,t,n;u.value=(null==(a=e.dns_resolve)?void 0:a.ns_resolve)||(null==(t=e.dns_resolve)?void 0:t.a_resolve)||"aaPanelDns"!==l.value?"":null==(n=e.dns_resolve)?void 0:n.tips,d.value=e.name,m.value=!0},A=async()=>{await je("install",async()=>{await _(),await s.getDNSStatus(),J()})},V=(e,a)=>{l.value=a,t.value=e,y.p=1,J()},B=()=>{y.p=1,J()},{keys:F,table:K,columns:Y}=fe([{type:"selection",width:40},{key:"name",title:n("Mail.Mass.index_45"),render:e=>g(Ne,{class:"items-center"},{default:()=>{var a,t;return[g(ae,{onClick:()=>z(e)},{default:()=>[e.name]}),(null==(a=e.dns_resolve)?void 0:a.ns_resolve)||(null==(t=e.dns_resolve)?void 0:t.a_resolve)||"aaPanelDns"!==l.value?"":g(Ae,{trigger:"focus",placement:"top-start"},{trigger:()=>g(H,{color:"#f08a00",name:"base-info",size:16},null),default:()=>{let a;return g(Ne,{class:"items-center"},{default:()=>{return[g("span",null,[e.dns_resolve.tips]),g(Te,{type:"primary",size:"small",onClick:()=>window.open("https://www.aaPanel.com/docs/Function/Tutorial/build_dns_server.html")},{default:()=>[C("View tutorial")]}),g(Te,{type:"primary",ghost:!0,size:"small",disabled:!r.value,loading:c.value,onClick:()=>h()},(t=a=n("Refresh"),"function"==typeof t||"[object Object]"===Object.prototype.toString.call(t)&&!T(t)?a:{default:()=>[a]}))];var t}})}}),""]}})},p({key:"ssl_info.end_time",title:"SSL Days"}),{key:"ssl_info.end_date",title:"SSL Expiration Time",render:e=>e.ssl_info.end_date?e.ssl_info.end_date:"--"},{key:"records",title:n("SSL.Domain.index_24"),align:"center"},ye({width:300,options:e=>[{label:n("SOA Record"),show:"aaPanelDns"===l.value,onClick:()=>{j.data.domain=e.name,j.show=!0}},{label:"Restore",show:!1,onClick:()=>{ge({title:"Restore domain name resolution",content:"Restore the default resolution of the domain name [".concat(e.name,"],still continue?"),onConfirm:async()=>{}})}},{label:n("SSL.index_58"),onClick:()=>{z(e)}},{label:n("Public.Btn.Delete"),show:"aaPanelDns"===l.value,onClick:()=>{ge({title:"Delete domain name resolution",content:"Delete the domain name resolution of the domain name [".concat(e.name,"],still continue?"),onConfirm:async()=>{await re({domain:e.name}),J()}})}}]})]),G=Pe(()=>{J()}),J=async()=>{if(t.value)try{K.loading=!0;const{message:e}=await de(y);q(e)&&(e.data.length>0?(K.data=e.data,K.total=e.total):(K.data=[],K.total=0))}finally{K.loading=!1}};return M(async()=>{(async()=>{await _(),await s.getDNSStatus(),J()})()}),(e,t)=>{const n=H,s=Te,r=ze,d=He,u=we,c=qe,p=he,_=_e,h=pe;return b(),k("div",null,[D(o)?N("",!0):(b(),E(r,{key:0,class:"mb-10px","show-icon":!1,type:"default"},{default:x(()=>[g(D(Ne),{class:"items-center"},{default:x(()=>[g(n,{name:"base-info",size:"17"}),S("div",la,P(e.$t("Build your own dns server based on pdns")),1),g(s,{type:"primary",size:"small",onClick:A},{default:x(()=>[C(P(e.$t("Install Self-built DNS")),1)]),_:1})]),_:1})]),_:1})),!D(i)&&D(o)?(b(),E(r,{key:1,class:"mb-10px",type:"warning"},{default:x(()=>[g(D(Ne),{class:"items-center"},{default:x(()=>[S("div",na,P(e.$t("The dns server is stopped, please start it first")),1),g(s,{type:"primary",size:"small",onClick:D(Se)},{default:x(()=>[C(P(e.$t("Set & Manage")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})):N("",!0),D(m)?N("",!0):(b(),E(_,{key:2},{toolsLeft:x(()=>[g(Qe,{value:D(y).id,"onUpdate:value":t[0]||(t[0]=e=>D(y).id=e),onChange:V},null,8,["value"]),"aaPanelDns"!==D(l)?(b(),k(O,{key:0},[g(s,{onClick:w,type:"primary",ghost:""},{default:x(()=>[C(P(e.$t("SSL.Domain.index_22")),1)]),_:1}),g(s,{onClick:t[1]||(t[1]=e=>D(L).show=!0)},{default:x(()=>[C(P(e.$t("SSL.Domain.index_23")),1)]),_:1})],64)):N("",!0),D(o)&&"aaPanelDns"===D(l)?(b(),k(O,{key:1},[D(i)?(b(),k(O,{key:0},[g(s,{type:"primary",onClick:t[2]||(t[2]=e=>D(U).show=!0)},{default:x(()=>[C(P(e.$t("Add Domain")),1)]),_:1}),g(s,{onClick:D(Re)},{default:x(()=>[C(P(e.$t("Apply DMARC Policy")),1)]),_:1},8,["onClick"]),g(s,{onClick:D(Le)},{default:x(()=>[C(P(e.$t("Enable DKIM/SPF")),1)]),_:1},8,["onClick"]),g(s,{onClick:D(Ue)},{default:x(()=>[C(P(e.$t("DNS Clear")),1)]),_:1},8,["onClick"])],64)):N("",!0),g(s,{onClick:D(Se)},{default:x(()=>[t[11]||(t[11]=S("i",{class:"i-domain:setting text-16px mr-1"},null,-1)),C(" "+P(e.$t("Set & Manage")),1)]),_:1,__:[11]},8,["onClick"])],64)):N("",!0)]),toolsRight:x(()=>[g(d,{value:D(y).domain,"onUpdate:value":t[3]||(t[3]=e=>D(y).domain=e),onSearch:B,placeholder:e.$t("WP.index_4")},null,8,["value","placeholder"])]),table:x(()=>[g(u,{"checked-row-keys":D(F),"onUpdate:checkedRowKeys":t[4]||(t[4]=e=>$(F)?F.value=e:null),"row-key":"name",loading:D(K).loading,data:D(K).data,columns:D(Y)},null,8,["checked-row-keys","loading","data","columns"])]),pageLeft:x(()=>[g(c,{"checked-row-keys":D(F),"onUpdate:checkedRowKeys":t[5]||(t[5]=e=>$(F)?F.value=e:null),"row-key":"name",data:D(K).data,options:D(G)},null,8,["checked-row-keys","data","options"])]),pageRight:x(()=>[g(p,{page:D(y).p,"onUpdate:page":t[6]||(t[6]=e=>D(y).p=e),"page-size":D(y).limit,"onUpdate:pageSize":t[7]||(t[7]=e=>D(y).limit=e),"store-key":"ssl-domain-page","item-count":D(K).total,onRefresh:J},null,8,["page","page-size","item-count"])]),_:1})),D(m)?(b(),E(Ze,{key:3,onChange:J})):N("",!0),g(h,{show:D(L).show,"onUpdate:show":t[8]||(t[8]=e=>D(L).show=e),title:D(L).title,data:D(L).data,width:650,"min-height":450,component:D(a)},null,8,["show","title","data","component"]),g(h,{show:D(U).show,"onUpdate:show":t[9]||(t[9]=e=>D(U).show=e),title:D(U).title,data:D(U).data,width:550,component:aa,footer:!0},null,8,["show","title","data"]),g(h,{show:D(j).show,"onUpdate:show":t[10]||(t[10]=e=>D(j).show=e),title:D(j).title,data:D(j).data,width:600,"min-height":400,component:ta,footer:!0},null,8,["show","title","data"])])}}}),ia=h({__name:"index",setup(e,{expose:a}){const{t:t}=v(),l=f({p:1,limit:10,search:""}),n=()=>{ge({title:"Clean up logs",content:"Are you sure you want to clean up logs?",onConfirm:async()=>{await me(),o()}})},{table:s,columns:i}=fe([{title:t("Config.Backup.index_11"),key:"log",ellipsis:{tooltip:{placement:"top",width:1e3}}},{align:"right",title:t("Logs.Panel.index_7"),width:180,key:"addtime"}]),o=async()=>{try{s.loading=!0;const{message:e}=await ce(V(l));q(e)&&(s.data=e.data||[],s.total=e.count||0)}finally{s.loading=!1}};return o(),a({init:o}),(e,a)=>{const t=Te,r=He,d=we,u=he,m=_e;return b(),E(m,null,{toolsLeft:x(()=>[g(t,{type:"primary",onClick:o},{default:x(()=>[C(P(e.$t("Public.Btn.Refresh")),1)]),_:1})]),toolsRight:x(()=>[g(r,{value:D(l).search,"onUpdate:value":a[0]||(a[0]=e=>D(l).search=e),placeholder:"Please enter keywords",onSearch:o},null,8,["value"]),g(t,{onClick:n},{default:x(()=>a[3]||(a[3]=[C("Clean up logs",-1)])),_:1,__:[3]})]),table:x(()=>[g(d,{loading:D(s).loading,data:D(s).data,columns:D(i)},null,8,["loading","data","columns"])]),pageRight:x(()=>[g(u,{page:D(l).p,"onUpdate:page":a[1]||(a[1]=e=>D(l).p=e),"page-size":D(l).limit,"onUpdate:pageSize":a[2]||(a[2]=e=>D(l).limit=e),"item-count":D(s).total,onRefresh:o},null,8,["page","page-size","item-count"])]),_:1})}}}),oa=h({__name:"index",setup(a){const t=ee(),{userInfo:l}=I(t),{t:s}=v(),i=[{key:"manage",label:s("SSL.Domain.index_7"),component:sa},{key:"host",label:s("SSL.Domain.index_27"),component:Ge},{key:"logs",label:s("Config.Safe.index_153"),component:ia}],o=e=>{"host"===e&&(m.value=!1)};return(a,t)=>{const s=e,r=Fe;return D(l).status?(b(),E(r,{key:0,class:"p-16px"},{default:x(()=>[g(s,{value:D(n),"onUpdate:value":[t[0]||(t[0]=e=>$(n)?n.value=e:null),o],options:i},null,8,["value"])]),_:1})):(b(),E(Ke,{key:1}))}}});export{oa as default};
