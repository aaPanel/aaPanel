const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/form8.js?v=1763625242172","js/public.js?v=1763625242172","js/page_layout.js?v=1763625242172","js/vue.js?v=1763625242172","js/__commonjsHelpers__.js?v=1763625242172","js/naive.js?v=1763625242172","js/common.js?v=1763625242172","css/page_layout.css?v=1763625242172","css/public.css?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang.js?v=1763625242172","js/ssl-log.js?v=1763625242172","js/index104.js?v=1763625242172","css/index19.css?v=1763625242172","js/domain-form.js?v=1763625242172","js/utils3.js?v=1763625242172"])))=>i.map(i=>d[i]);
import{_ as e}from"./index107.js?v=1763625242172";import{h as a,a as t,m as l,r as n,b as s,c as i,d as o,l as r,e as d,f as u,g as m,i as p,u as c,j as _}from"./utils3.js?v=1763625242172";import{k as h,P as v,e as f,r as g,X as y,b as w,R as b,S as k,a3 as x,V as S,U as D,j as C,a4 as P,_ as R,ad as L,ae as j,a2 as U,s as E,u as z,G as T,aj as $,an as O,O as A,F as I,a0 as N,o as M,N as V}from"./vue.js?v=1763625242172";import{d7 as B,d8 as F,d9 as q,c as H,a as W,_ as Y,m as G,da as K,db as X,dc as J,dd as Q,p as Z,u as ee,de as ae,df as te,o as le,dg as ne,dh as se,T as ie,di as oe,dj as re,dk as de,dl as ue,dm as me,dn as pe}from"./page_layout.js?v=1763625242172";import{_ as ce}from"./index.js?v=1763625242172";import{_ as _e}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1763625242172";import{_ as he}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1763625242172";import{e as ve,c as fe,f as ge,a as ye,h as we,m as be,_ as ke,d as xe}from"./public.js?v=1763625242172";import{o as Se,c as De,a as Ce,b as Pe,d as Re,e as Le}from"./utils4.js?v=1763625242172";import{dj as je,dk as Ue,aC as Ee,d9 as ze,dV as Te,dd as $e,dh as Oe,au as Ae,dP as Ie,df as Ne,d8 as Me,dS as Ve}from"./naive.js?v=1763625242172";import{_ as Be}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1763625242172";import{_ as Fe}from"./index.vue_vue_type_script_setup_true_lang.js?v=1763625242172";import{T as qe}from"./transition.js?v=1763625242172";import"./__commonjsHelpers__.js?v=1763625242172";import"./common.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1763625242172";import"./soft.js?v=1763625242172";import"./site.js?v=1763625242172";const He={class:"flex items-center"},We=h({__name:"index",setup(e){const s=R((()=>W((()=>import("./form8.js?v=1763625242172")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])))),i=R((()=>W((()=>import("./ssl-log.js?v=1763625242172")),__vite__mapDeps([10,11,2,3,4,5,6,1,8,7,12])))),{t:o}=v(),r=f({p:1,limit:10}),d=ve("",{isEdit:!1,onRefresh:()=>{j()}}),u=ve(o("SSL.Domain.index_5")),m=()=>{d.data.isEdit=!1,d.title=o("SSL.Domain.index_4"),d.show=!0},p=g(!1),{table:c,columns:_}=fe([{key:"alias",title:o("Config.Panel.index_36"),render:e=>e.alias?y("span",{class:"bt-link",onClick:()=>{a.value=e.id,t.value=e.name,l.value="manage"}},[e.alias]):"--"},{key:"api_user",title:o("Home.index_2"),render:e=>e.api_user?e.api_user:"--"},n((e=>{u.data.path=e,u.show=!0})),{key:"status",title:o("Public.Table.Status"),render:e=>y(je,{uncheckedValue:0,checkedValue:1,value:e.status,"onUpdate:value":[a=>e.status=a,async a=>{try{await B({id:e.id,status:a})}catch(t){e.status=1===a?0:1}}]},null)},{key:"permission",title:o("Database.index_21"),align:"center",render:e=>e.permission?e.permission:"--"},{key:"domains",title:o("Layout.Sider.domain_1"),align:"center",render:e=>e.domains.length},ge({width:250,options:e=>[{label:o("SSL.Domain.index_7"),onClick:()=>{a.value=e.id,t.value=e.name,l.value="manage"}},{label:o("Public.Btn.Edit"),onClick:()=>{"aaPanelDns"!==e.name?h(e):Se()}},{label:o("Public.Btn.Del"),show:"aaPanelDns"!==e.name,onClick:()=>{ye({title:o("SSL.Domain.index_8"),content:o("SSL.Domain.index_9"),onConfirm:async()=>{await F({id:e.id}),j()}})}}]})]),h=e=>{d.data.isEdit=!0,d.data.row=e,d.title=o("SSL.Domain.index_10"),d.show=!0};let L=null;const j=async()=>{try{p.value||(c.loading=!0);const{message:e}=await q(r);H(e)&&(p.value=e.data.some((e=>e.task.some((e=>100!==e.task_status)))),p.value?U():L&&clearTimeout(L),c.data=e.data,c.total=e.total)}finally{c.loading=!1}},U=async()=>{L=window.setTimeout((()=>{j()}),5e3)};return j(),w((()=>{L&&clearTimeout(L)})),(e,a)=>{const t=Y,l=Ue,n=Ee,o=we,p=he,h=_e,v=ce;return b(),k("div",null,[y(l,{"show-icon":!1,class:"mb-10px"},{default:x((()=>[D("div",He,[y(t,{name:"base-info",size:17,class:"mr-8px"}),a[4]||(a[4]=D("span",{class:"leading-17px"},"aaPanel Domain Name Management Center, allowing you to unify accounts across multiple domain providers without switching DNS platforms",-1))])])),_:1}),y(h,{feedback:!0},{toolsLeft:x((()=>[y(n,{type:"primary",onClick:m},{default:x((()=>[C(P(e.$t("SSL.Domain.index_4")),1)])),_:1})])),table:x((()=>[y(o,{loading:S(c).loading,data:S(c).data,columns:S(_)},null,8,["loading","data","columns"])])),pageRight:x((()=>[y(p,{page:S(r).p,"onUpdate:page":a[0]||(a[0]=e=>S(r).p=e),"page-size":S(r).limit,"onUpdate:pageSize":a[1]||(a[1]=e=>S(r).limit=e),"store-key":"ssl-host-page","item-count":S(c).total,onRefresh:j},null,8,["page","page-size","item-count"])])),_:1}),y(v,{show:S(d).show,"onUpdate:show":a[2]||(a[2]=e=>S(d).show=e),title:S(d).title,data:S(d).data,width:540,"min-height":300,footer:!0,component:S(s)},null,8,["show","title","data","component"]),y(v,{show:S(u).show,"onUpdate:show":a[3]||(a[3]=e=>S(u).show=e),title:S(u).title,data:S(u).data,width:700,height:450,footer:!1,component:S(i)},null,8,["show","title","data","component"])])}}});const Ye=h({__name:"host-select",props:{value:{},valueModifiers:{}},emits:L(["change"],["update:value"]),setup(e,{emit:a}){const{t:t}=v(),l=j(e,"value"),n=a,o=(e,a)=>{n("change",e,a.label)},r=e=>{if(e.disabled){let a;return y(ze,{class:"items-center"},{default:()=>{return[y("span",null,[e.label]),y(Ee,{type:"primary",size:"tiny",onClick:()=>{be(e.alias)}},(l=a=t("Public.Btn.Install"),"function"==typeof l||"[object Object]"===Object.prototype.toString.call(l)&&!z(l)?a:{default:()=>[a]}))];var l}})}return e.label+" ("+e.alias+")"};return(e,a)=>{const t=Te;return b(),U(t,E({loading:S(i),class:"w-300px"},e.$attrs,{filterable:"",value:l.value,"onUpdate:value":[a[0]||(a[0]=e=>l.value=e),o],options:S(s),"consistent-menu-width":!1,"render-label":r}),null,16,["loading","value","options"])}}});function Ge(){const e=g(!1);let a=null;const t=()=>{a&&(clearInterval(a),a=null)},l=()=>{t(),a=setInterval((async()=>{await Ce(),De.value&&(t(),e.value=!1,G.success("DNS check completed."))}),1e3)};return T((()=>{t()})),{canRefreshDns:De,refreshLoading:e,startDnsPolling:l,stopPolling:t,onRefreshDns:async()=>{t(),e.value=!0,await K({act:"start"}),l()}}}const Ke=h({__name:"domain-select",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const a=j(e,"value"),{t:t}=v(),l=e=>y(ze,{class:"items-center justify-between!"},{default:()=>[y("span",{class:"w-225px truncate"},[t("Mail.Mass.index_45"),C("ï¼š"),e.label]),e.ssl_info&&-1!==e.ssl_info?y($e,{type:e.ssl_info>30?"success":e.ssl_info>0?"warning":"error",class:"px-10px"},{default:()=>[e.ssl_info?e.ssl_info+" "+t("Crontab.arrange.index_41"):t("Config.Safe.index_166")]}):""]});return(e,t)=>{const n=Te;return b(),U(n,E(e.$attrs,{class:"w-350px",size:"large",filterable:"",value:a.value,"onUpdate:value":t[0]||(t[0]=e=>a.value=e),options:S(o),"consistent-menu-width":!1,loading:S(r),disabled:!S(o).length,"render-label":l}),null,16,["value","options","loading","disabled"])}}}),Xe=Z(h({__name:"domain",emits:["change"],setup(e,{emit:l}){const n=R((()=>W((()=>import("./domain-form.js?v=1763625242172")),__vite__mapDeps([13,9,3,4,5,6,2,1,8,7,14])))),s=l,{t:i}=v(),o=f({p:1,limit:10,domain:d,search:""}),r=ve("",{isEdit:!1,onRefresh:()=>{M()}}),c=()=>{r.data.isEdit=!1,r.title=i("SSL.Domain.index_17"),r.show=!0},_=()=>{s("change"),m.value=!1},h=()=>{o.p=1,M()},g=async()=>{M()},w=async(e,l)=>{t.value=l,a.value=e,d.value="",o.p=1,await p(),M()},{table:L,columns:j}=fe([{key:"record",title:i("SSL.Domain.index_11"),width:"20%"},{key:"record_type",title:i("Ftp.Table.index_3"),width:"10%"},{key:"record_value",title:i("SSL.Domain.index_13"),width:"20%",ellipsis:{tooltip:!0}},{key:"ttl",title:"TTL",width:100,render:e=>1===e.ttl?i("Mail.Mass.index_34"):e.ttl},{key:"priority",title:"Priority",width:100,render:e=>-1===e.priority?"--":e.priority},{key:"proxy",title:i("SSL.Domain.index_16"),render:e=>-1===e.proxy?"--":y(je,{"checked-value":1,"unchecked-value":0,value:e.proxy,"onUpdate:value":[a=>e.proxy=a,async t=>{const l={id:e.id,pid:a.value,domain:d.value,record:e.record,record_type:e.record_type,record_value:e.record_value,ttl:e.ttl,priority:e.priority,proxy:t,ps:e.ps};try{await X(l)}catch(n){e.proxy=1===t?0:1}}]},null)},{key:"ps",title:i("Public.Table.Ps")},ge({width:150,options:e=>[{label:i("Public.Btn.Edit"),onClick:()=>{N(e)}},{label:i("Public.Btn.Del"),onClick:()=>{ye({title:i("SSL.Domain.index_19"),content:i("SSL.Domain.index_20"),onConfirm:async()=>{await J({id:e.id}),M(),s("change")}})}}]})]),E=()=>{window.open("https://www.aaPanel.com/docs/Function/Tutorial/build_dns_server.html")},{canRefreshDns:z,refreshLoading:T,startDnsPolling:A,onRefreshDns:I}=Ge(),N=e=>{r.data.isEdit=!0,r.data.row=e,r.title=i("SSL.Domain.index_21"),r.show=!0},M=async()=>{try{if(""===d.value)return void(L.data=[]);L.loading=!0;const{message:e}=await Q({...o,search_pid:a.value});H(e)&&(L.data=e.data,L.total=e.total)}finally{L.loading=!1}};return(async()=>{await p(),await M(),u.value&&(await Ce(),z.value||(T.value=!0,A()))})(),(e,t)=>{const l=Y,s=Ee,i=Oe,d=ze,m=Ue,p=Be,v=we,f=he,R=_e,A=ce;return b(),k("div",null,[y(d,{class:"select-box"},{default:x((()=>[y(Ye,{value:S(a),"onUpdate:value":t[0]||(t[0]=e=>$(a)?a.value=e:null),onChange:w},null,8,["value"]),y(d,null,{default:x((()=>[y(Ke,{value:S(o).domain,"onUpdate:value":[t[1]||(t[1]=e=>S(o).domain=e),h]},null,8,["value"]),y(i,{trigger:"hover"},{trigger:x((()=>[y(s,{onClick:g,class:"h-40px w-40px"},{default:x((()=>[y(l,{name:"base-refresh"})])),_:1})])),default:x((()=>[D("span",null,P(e.$t("SSL.Domain.index_22")),1)])),_:1})])),_:1})])),_:1}),y(R,null,{toolsLeft:x((()=>[y(s,{type:"primary",onClick:c},{default:x((()=>[C(P(e.$t("SSL.Domain.index_17")),1)])),_:1}),y(s,{onClick:_},{default:x((()=>[C(P(e.$t("SSL.Domain.index_18")),1)])),_:1}),S(u)?(b(),U(m,{key:0,type:"warning"},{default:x((()=>[y(d,{class:"items-center"},{default:x((()=>[D("span",null,P(S(u)),1),y(s,{type:"primary",size:"small",onClick:E},{default:x((()=>t[6]||(t[6]=[C("View tutorial")]))),_:1,__:[6]}),y(s,{loading:S(T),type:"primary",ghost:"",size:"small",onClick:S(I),disabled:!S(z)},{default:x((()=>[C(P(e.$t("Public.Btn.Refresh")),1)])),_:1},8,["loading","onClick","disabled"])])),_:1})])),_:1})):O("",!0)])),toolsRight:x((()=>[y(p,{value:S(o).search,"onUpdate:value":t[2]||(t[2]=e=>S(o).search=e),onSearch:h},null,8,["value"])])),table:x((()=>[y(v,{loading:S(L).loading,data:S(L).data,columns:S(j),"store-key":"ssl-domain-page"},null,8,["loading","data","columns"])])),pageRight:x((()=>[y(f,{page:S(o).p,"onUpdate:page":t[3]||(t[3]=e=>S(o).p=e),"page-size":S(o).limit,"onUpdate:pageSize":t[4]||(t[4]=e=>S(o).limit=e),"item-count":S(L).total,onRefresh:M},null,8,["page","page-size","item-count"])])),_:1}),y(A,{show:S(r).show,"onUpdate:show":t[5]||(t[5]=e=>S(r).show=e),title:S(r).title,data:S(r).data,width:540,"min-height":300,footer:!0,component:S(n)},null,8,["show","title","data","component"])])}}}),[["__scopeId","data-v-8dac0587"]]),Je={class:"p-20px"},Qe=h({__name:"add-form",props:{onRefresh:{}},setup(e,{expose:a}){const{t:t}=v(),l=ee(),n=e,{onRefresh:s}=n,i=g(!1),o=g(null),r=f({domain_name:"",domain_ip:"",soa:"",nameserver1:"",nameserver2:""}),d={domain_name:{required:!0,trigger:["blur","change"],message:t("Please enter your domain name")},domain_ip:{required:!0,trigger:["blur","change"],message:t("Please enter your domain IP")},soa:{required:!0,trigger:["blur","change"],message:t("Please enter SOA")}},u=()=>{if(!r.domain_name)return r.soa="",r.nameserver1="",void(r.nameserver2="");r.soa="ns1."+r.domain_name,i.value||(r.nameserver1="ns1."+r.domain_name,r.nameserver2="ns2."+r.domain_name)},m=()=>{r.domain_ip=l.address};(async()=>{const{message:e}=await ae();H(e)&&(r.nameserver1=e.NS1,r.nameserver2=e.NS2,Object.keys(e).length?i.value=!0:i.value=!1)})();return a({onConfirm:async()=>{var e;await(null==(e=o.value)?void 0:e.validate()),await te({domain:r.domain_name,domain_ip:r.domain_ip,soa:r.soa,ns1domain:r.nameserver1,ns2domain:r.nameserver2}),s()}}),(e,a)=>{const t=Ae,l=Ie,n=Ee,s=ze,i=le,p=Oe,c=Fe,_=ke;return b(),k("div",Je,[y(c,{ref_key:"formRef",ref:o,model:S(r),rules:d},{default:x((()=>[y(l,{label:e.$t("Mail.Domain.index_3"),path:"domain_name"},{default:x((()=>[y(t,{class:"w-320px!",value:S(r).domain_name,"onUpdate:value":a[0]||(a[0]=e=>S(r).domain_name=e),placeholder:"Enter your domain name,eg: aapanel.com",onInput:u},null,8,["value"])])),_:1},8,["label"]),y(l,{label:"Domain IP",path:"domain_ip"},{default:x((()=>[y(s,{class:"flex-nowrap!",size:5},{default:x((()=>[y(t,{class:"w-320px!",value:S(r).domain_ip,"onUpdate:value":a[1]||(a[1]=e=>S(r).domain_ip=e),placeholder:"Enter your domain IP,eg: 1.2.3.4"},null,8,["value"]),y(n,{onClick:m},{default:x((()=>a[5]||(a[5]=[C(" USE IP ")]))),_:1,__:[5]})])),_:1})])),_:1}),y(l,{label:"SOA",path:"soa"},{default:x((()=>[y(s,{class:"items-center"},{default:x((()=>[y(t,{class:"w-320px!",value:S(r).soa,"onUpdate:value":a[2]||(a[2]=e=>S(r).soa=e),placeholder:"ns1.domain.com"},null,8,["value"]),y(p,null,{trigger:x((()=>a[6]||(a[6]=[D("i",{class:"i-uiw:question-circle-o text-16px text-#9DA1A6 cursor-pointer"},null,-1)]))),default:x((()=>[D("div",null,[a[8]||(a[8]=C(" What is SOA record in DNS? ")),y(i,{href:"https://www.aaPanel.com/docs/Function/Domains-basics.html#_4-what-is-the-soa-record",target:"_blank"},{default:x((()=>a[7]||(a[7]=[C(" View ")]))),_:1,__:[7]})])])),_:1})])),_:1})])),_:1}),y(l,{label:"NameServer 1",path:"nameserver1"},{default:x((()=>[y(t,{class:"w-320px!",value:S(r).nameserver1,"onUpdate:value":a[3]||(a[3]=e=>S(r).nameserver1=e),placeholder:"Your Name Server,eg: ns1.aapanel.com,Option"},null,8,["value"])])),_:1}),y(l,{label:"NameServer 2",path:"nameserver2"},{default:x((()=>[y(t,{class:"w-320px!",value:S(r).nameserver2,"onUpdate:value":a[4]||(a[4]=e=>S(r).nameserver2=e),placeholder:"Your Name Server,eg: ns2.aapanel.com,Option"},null,8,["value"])])),_:1})])),_:1},8,["model"]),y(_,null,{default:x((()=>[D("li",null,[a[10]||(a[10]=C(" How to add domain name using self-built DNS? ")),y(i,{href:"https://www.aaPanel.com/docs/Function/Tutorial/build_dns_server.html",target:"_blank"},{default:x((()=>a[9]||(a[9]=[C(" View tutorial ")]))),_:1,__:[9]})])])),_:1})])}}}),Ze=h({__name:"index",props:{data:{},onRefresh:{}},setup(e,{expose:a}){const{t:t}=v(),l=e,{onRefresh:n,data:s}=l,i=g(null),o=f({name_server:"",admin_email:"",serial_number:0,refresh:0,retry:0,expire:0,minimum:0}),r=[{key:"name_server",label:t("Nameserver"),placeholder:t("Enter your nameserver,eg: ns1.domain.com"),tooltip:t("name server")},{key:"admin_email",label:t("Admin Email"),placeholder:"Enter your admin email,eg: admin@domain.com",tooltip:t("model admin email")},{key:"serial_number",label:t("Serial Number"),placeholder:t("Enter your serial number,eg: 2023080101"),tooltip:t("zone file version,Modification is prohibited.")},{key:"refresh",label:t("Refresh"),placeholder:t("Enter your refresh,eg: 3600"),tooltip:t("How often to check the serial number on the master server")},{key:"retry",label:t("Retry"),placeholder:t("Enter your retry,eg: 3600"),tooltip:t("The interval time when the slaveserver reconnects to the masterserver")},{key:"expire",label:t("Expire"),placeholder:t("Enter your expire,eg: 604800"),tooltip:t("When the time exceeds the number of seconds set by Expire and the slave server cannot get in touch with the master, the slave will delete its copy")},{key:"minimum",label:t("Minimum"),placeholder:t("Enter your minimum,eg: 3600"),tooltip:t("Represents the default TTL value of all records in this zone file")}],d=["serial_number","refresh","retry","expire","minimum"],u=Object.fromEntries(r.map((e=>[e.key,{required:!0,...d.includes(e.key)?{type:"number"}:{},trigger:["blur","change"],message:"Please enter your ".concat(e.label.toLowerCase())}]))),{loading:m,setLoading:p}=xe();(async()=>{try{p(!0);const{message:e}=await ne({domain:s.domain});H(e)&&(o.name_server=e.nameserver,o.admin_email=e.admin_mail,o.serial_number=e.serial,o.refresh=e.refresh,o.retry=e.retry,o.expire=e.expire,o.minimum=e.minimum)}finally{p(!1)}})();return a({onConfirm:async()=>{var e;await(null==(e=i.value)?void 0:e.validate()),await se({domain:s.domain,nameserver:o.name_server,admin_mail:o.admin_email,serial:o.serial_number,refresh:o.refresh,retry:o.retry,expire:o.expire,minimum:o.minimum}),n()}}),(e,a)=>{const t=Ae,l=Ne,n=Y,s=Me,p=Ie,c=Fe,_=ie;return b(),U(_,{show:S(m)},{default:x((()=>[y(c,{class:"p-20px",ref_key:"formRef",ref:i,model:S(o),rules:S(u)},{default:x((()=>[(b(),k(I,null,A(r,(e=>y(p,{key:e.key,label:e.label,path:e.key},{default:x((()=>[d.includes(e.key)?(b(),U(l,{key:1,readonly:"serial_number"===e.key,class:"w-350px! mr-8px",value:S(o)[e.key],"onUpdate:value":a=>S(o)[e.key]=a,placeholder:e.placeholder},null,8,["readonly","value","onUpdate:value","placeholder"])):(b(),U(t,{key:0,class:"w-350px! mr-8px",value:S(o)[e.key],"onUpdate:value":a=>S(o)[e.key]=a,placeholder:e.placeholder},null,8,["value","onUpdate:value","placeholder"])),y(s,{trigger:"hover",placement:"top-start"},{trigger:x((()=>[y(n,{name:"common-ask",class:"color-#fc7938",size:"16"})])),default:x((()=>[C(" "+P(e.tooltip),1)])),_:2},1024)])),_:2},1032,["label","path"]))),64))])),_:1},8,["model","rules"])])),_:1},8,["show"])}}}),ea={class:"leading-17px"},aa={class:"leading-17px"};const ta=h({__name:"index",setup(e){const l=R((()=>W((()=>import("./ssl-log.js?v=1763625242172")),__vite__mapDeps([10,11,2,3,4,5,6,1,8,7,12])))),{t:n}=v(),s=oe(),{dnsStatus:i,dnsInstall:o}=N(s),{canRefreshDns:r,refreshLoading:p,onRefreshDns:h}=Ge(),g=f({p:1,limit:10,domain:"",id:a}),w=async()=>{await ue({id:g.id}),q(),L.show=!0},L=ve(n("SSL.Domain.index_23"),{path:"/www/server/panel/logs/dns_sync.log"}),j=ve("Add Domain",{onRefresh:()=>{q()}}),E=ve("SOA Record",{onRefresh:()=>{q()}}),T=e=>{var a,l,n;u.value=(null==(a=e.dns_resolve)?void 0:a.ns_resolve)||(null==(l=e.dns_resolve)?void 0:l.a_resolve)||"aaPanelDns"!==t.value?"":null==(n=e.dns_resolve)?void 0:n.tips,d.value=e.name,m.value=!0},$=async()=>{await Le("install",(async()=>{await _(),await s.getDNSStatus(),q()}))},A=(e,l)=>{t.value=l,a.value=e,g.p=1,q()},V=()=>{g.p=1,q()},{table:B,columns:F}=fe([{key:"name",title:n("Mail.Mass.index_45"),render:e=>y(ze,{class:"items-center"},{default:()=>{var a,l;return[y(le,{onClick:()=>T(e)},{default:()=>[e.name]}),(null==(a=e.dns_resolve)?void 0:a.ns_resolve)||(null==(l=e.dns_resolve)?void 0:l.a_resolve)||"aaPanelDns"!==t.value?"":y(Oe,{trigger:"focus",placement:"top-start"},{trigger:()=>y(Y,{color:"#f08a00",name:"base-info",size:16},null),default:()=>{let a;return y(ze,{class:"items-center"},{default:()=>{return[y("span",null,[e.dns_resolve.tips]),y(Ee,{type:"primary",size:"small",onClick:()=>window.open("https://www.aaPanel.com/docs/Function/Tutorial/build_dns_server.html")},{default:()=>[C("View tutorial")]}),y(Ee,{type:"primary",ghost:!0,size:"small",disabled:!r.value,loading:p.value,onClick:()=>h()},(t=a=n("Refresh"),"function"==typeof t||"[object Object]"===Object.prototype.toString.call(t)&&!z(t)?a:{default:()=>[a]}))];var t}})}}),""]}})},c({key:"ssl_info.end_time",title:"SSL Days"}),{key:"ssl_info.end_date",title:"SSL Expiration Time",render:e=>e.ssl_info.end_date?e.ssl_info.end_date:"--"},{key:"records",title:n("SSL.Domain.index_24"),align:"center"},ge({width:300,options:e=>[{label:"SOA Record",show:"aaPanelDns"===t.value,onClick:()=>{E.data.domain=e.name,E.show=!0}},{label:"Restore",show:!1,onClick:()=>{ye({title:"Restore domain name resolution",content:"Restore the default resolution of the domain name [".concat(e.name,"],still continue?"),onConfirm:async()=>{}})}},{label:n("SSL.index_58"),onClick:()=>{T(e)}},{label:n("Public.Btn.Delete"),show:"aaPanelDns"===t.value,onClick:()=>{ye({title:"Delete domain name resolution",content:"Delete the domain name resolution of the domain name [".concat(e.name,"],still continue?"),onConfirm:async()=>{await re({domain:e.name}),q()}})}}]})]),q=async()=>{if(a.value)try{B.loading=!0;const{message:e}=await de(g);H(e)&&(e.data.length>0?(B.data=e.data,B.total=e.total):(B.data=[],B.total=0))}finally{B.loading=!1}};return M((async()=>{(async()=>{await _(),await s.getDNSStatus(),q()})()})),(e,a)=>{const n=Y,s=Ee,r=Ue,d=Be,u=we,p=he,c=_e,_=ce;return b(),k("div",null,[S(o)?O("",!0):(b(),U(r,{key:0,class:"mb-10px","show-icon":!1,type:"default"},{default:x((()=>[y(S(ze),{class:"items-center"},{default:x((()=>[y(n,{name:"base-info",size:"17"}),D("div",ea,P(e.$t("Build your own dns server based on pdns")),1),y(s,{type:"primary",size:"small",onClick:$},{default:x((()=>[C(P(e.$t("Install Self-built DNS")),1)])),_:1})])),_:1})])),_:1})),!S(i)&&S(o)?(b(),U(r,{key:1,class:"mb-10px",type:"warning"},{default:x((()=>[y(S(ze),{class:"items-center"},{default:x((()=>[D("div",aa,P(e.$t("The dns server is stopped, please start it first")),1),y(s,{type:"primary",size:"small",onClick:S(Se)},{default:x((()=>[C(P(e.$t("Set & Manage")),1)])),_:1},8,["onClick"])])),_:1})])),_:1})):O("",!0),S(m)?O("",!0):(b(),U(c,{key:2},{toolsLeft:x((()=>[y(Ye,{value:S(g).id,"onUpdate:value":a[0]||(a[0]=e=>S(g).id=e),onChange:A},null,8,["value"]),"aaPanelDns"!==S(t)?(b(),k(I,{key:0},[y(s,{onClick:w,type:"primary",ghost:""},{default:x((()=>[C(P(e.$t("SSL.Domain.index_22")),1)])),_:1}),y(s,{onClick:a[1]||(a[1]=e=>S(L).show=!0)},{default:x((()=>[C(P(e.$t("SSL.Domain.index_23")),1)])),_:1})],64)):O("",!0),S(o)&&"aaPanelDns"===S(t)?(b(),k(I,{key:1},[S(i)?(b(),k(I,{key:0},[y(s,{type:"primary",onClick:a[2]||(a[2]=e=>S(j).show=!0)},{default:x((()=>[C(P(e.$t("Add Domain")),1)])),_:1}),y(s,{onClick:S(Pe)},{default:x((()=>[C(P(e.$t("Apply DMARC Policy")),1)])),_:1},8,["onClick"]),y(s,{onClick:S(Re)},{default:x((()=>[C(P(e.$t("Enable DKIM/SPF")),1)])),_:1},8,["onClick"])],64)):O("",!0),y(s,{onClick:S(Se)},{default:x((()=>[a[9]||(a[9]=D("i",{class:"i-domain:setting text-16px mr-1"},null,-1)),C(" "+P(e.$t("Set & Manage")),1)])),_:1,__:[9]},8,["onClick"])],64)):O("",!0)])),toolsRight:x((()=>[y(d,{value:S(g).domain,"onUpdate:value":a[3]||(a[3]=e=>S(g).domain=e),onSearch:V,placeholder:e.$t("WP.index_4")},null,8,["value","placeholder"])])),table:x((()=>[y(u,{loading:S(B).loading,data:S(B).data,columns:S(F)},null,8,["loading","data","columns"])])),pageRight:x((()=>[y(p,{page:S(g).p,"onUpdate:page":a[4]||(a[4]=e=>S(g).p=e),"page-size":S(g).limit,"onUpdate:pageSize":a[5]||(a[5]=e=>S(g).limit=e),"store-key":"ssl-domain-page","item-count":S(B).total,onRefresh:q},null,8,["page","page-size","item-count"])])),_:1})),S(m)?(b(),U(Xe,{key:3,onChange:q})):O("",!0),y(_,{show:S(L).show,"onUpdate:show":a[6]||(a[6]=e=>S(L).show=e),title:S(L).title,data:S(L).data,width:650,"min-height":450,component:S(l)},null,8,["show","title","data","component"]),y(_,{show:S(j).show,"onUpdate:show":a[7]||(a[7]=e=>S(j).show=e),title:S(j).title,data:S(j).data,width:550,component:Qe,footer:!0},null,8,["show","title","data"]),y(_,{show:S(E).show,"onUpdate:show":a[8]||(a[8]=e=>S(E).show=e),title:S(E).title,data:S(E).data,width:600,"min-height":400,component:Ze,footer:!0},null,8,["show","title","data"])])}}}),la=h({__name:"index",setup(e,{expose:a}){const{t:t}=v(),l=f({p:1,limit:10,search:""}),n=()=>{ye({title:"Clean up logs",content:"Are you sure you want to clean up logs?",onConfirm:async()=>{await pe(),o()}})},{table:s,columns:i}=fe([{title:t("Config.Backup.index_11"),key:"log",ellipsis:{tooltip:{placement:"top",width:1e3}}},{align:"right",title:t("Logs.Panel.index_7"),width:180,key:"addtime"}]),o=async()=>{try{s.loading=!0;const{message:e}=await me(V(l));H(e)&&(s.data=e.data||[],s.total=e.count||0)}finally{s.loading=!1}};return o(),a({init:o}),(e,a)=>{const t=Ee,r=Be,d=we,u=he,m=_e;return b(),U(m,null,{toolsLeft:x((()=>[y(t,{type:"primary",onClick:o},{default:x((()=>[C(P(e.$t("Public.Btn.Refresh")),1)])),_:1})])),toolsRight:x((()=>[y(r,{value:S(l).search,"onUpdate:value":a[0]||(a[0]=e=>S(l).search=e),placeholder:"Please enter keywords",onSearch:o},null,8,["value"]),y(t,{onClick:n},{default:x((()=>a[3]||(a[3]=[C("Clean up logs")]))),_:1,__:[3]})])),table:x((()=>[y(d,{loading:S(s).loading,data:S(s).data,columns:S(i)},null,8,["loading","data","columns"])])),pageRight:x((()=>[y(u,{page:S(l).p,"onUpdate:page":a[1]||(a[1]=e=>S(l).p=e),"page-size":S(l).limit,"onUpdate:pageSize":a[2]||(a[2]=e=>S(l).limit=e),"item-count":S(s).total,onRefresh:o},null,8,["page","page-size","item-count"])])),_:1})}}}),na=h({__name:"index",setup(a){const t=ee(),{userInfo:n}=N(t),{t:s}=v(),i=[{key:"manage",label:s("SSL.Domain.index_7"),component:ta},{key:"host",label:s("SSL.Domain.index_27"),component:We},{key:"logs",label:s("Config.Safe.index_153"),component:la}],o=e=>{"host"===e&&(m.value=!1)};return(a,t)=>{const s=e,r=Ve;return S(n).status?(b(),U(r,{key:0,class:"p-16px"},{default:x((()=>[y(s,{value:S(l),"onUpdate:value":[t[0]||(t[0]=e=>$(l)?l.value=e:null),o],options:i},null,8,["value"])])),_:1})):(b(),U(qe,{key:1}))}}});export{na as default};
