System.register(["./public-legacy.js?v=1763625242172","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1763625242172","./site-legacy.js?v=1763625242172","./page_layout-legacy.js?v=1763625242172","./ssl-lets-progress-legacy.js?v=1763625242172","./naive-legacy.js?v=1763625242172","./vue-legacy.js?v=1763625242172","./common-legacy.js?v=1763625242172","./__commonjsHelpers__-legacy.js?v=1763625242172","./index-legacy.js?v=1763625242172"],(function(e,a){"use strict";var l,t,n,s,i,d,u,o,r,p,c,_,m,h,y,v,f,g,S,x,w,b,k,L,A,$,j,z,U,Z,R,E,O,F,C,J,P,V,q,H,M,N,T,W;return{setters:[e=>{l=e.d,t=e.U,n=e.u,s=e.V,i=e.W,d=e._},e=>{u=e._},e=>{o=e.a3},e=>{r=e.e6,p=e.c,c=e.e7,_=e.x,m=e.h9,h=e.aY,y=e.T},e=>{v=e.a},e=>{f=e.d5,g=e.dU,S=e.dT,x=e.dP,w=e._,b=e.dV,k=e.au,L=e.d9,A=e.eg},e=>{$=e.k,j=e.P,z=e.r,U=e.e,Z=e.c,R=e.w,E=e.o,O=e.R,F=e.S,C=e.X,J=e.a3,P=e.V,V=e.j,q=e.a4,H=e.a2,M=e.an,N=e.F,T=e.O,W=e.U},null,null,null],execute:function(){const a={class:"p-16px"},B={key:0},X={key:1};e("default",$({__name:"index",props:{onRefresh:{type:Function},onOpenLog:{type:Function}},setup(e,{expose:$}){const{t:Y}=j(),D=e,G=z(null),I=U({auth_type:"dns",dns_manual:0,site:0,type:"wildcard",domains:"",domains_list:[],all:!1}),K=z([{label:Y("SSL.index_17"),value:"single"},{label:Y("SSL.index_18"),value:"wildcard"},{label:Y("SSL.index_19"),value:"wildcard_all"}]),Q=z([]),ee=z([]),ae=()=>{I.domains=""},le=()=>{I.domains_list=[],ue()},te=Z((()=>I.domains_list.length>0&&I.domains_list.length<ee.value.length));R((()=>I.domains_list),(e=>{e.length===ee.value.length?I.all=!0:e.length||(I.all=!1)})),R((()=>I.all),(e=>{e?(I.domains_list=ee.value.map((e=>e.name)),G.value?.validate()):I.domains_list=[]}));const ne={domains:{required:!0,trigger:"input",validator:(e,a)=>{if("single"===I.type){if(!a)return new Error(Y("SSL.index_20"));if(!/^[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+$/.test(a))return new Error(Y("SSL.index_21"))}else if("wildcard"===I.type){if(!a)return new Error(Y("SSL.index_22"));if(!/^(?:\*\.)?(?:[a-zA-Z0-9-]+\.)?[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+(\n(?:\*\.)?(?:[a-zA-Z0-9-]+\.)?[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+)*$/.test(a))return new Error(Y("SSL.index_23"))}else if("wildcard_all"===I.type){if(!a)return new Error(Y("SSL.index_24"));if(!/^\*\.[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+(\n\*\.[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+)*$/i.test(a))return new Error(Y("SSL.index_25"))}return!0}},domains_list:{required:!0,trigger:"change",type:"array",message:Y("SSL.SiteSSL.index_16")}},se=()=>({auth_type:I.dns_manual?"dns_manual":I.auth_type,domains:JSON.stringify("http"===I.auth_type?I.domains_list:"single"===I.type?[I.domains]:I.domains.split("\n")),site_id:I.dns_manual?-1:void 0}),{loading:ie,setLoading:de}=l(),ue=async()=>{try{de(!0);const{message:e}=await o({id:I.site});_(e)&&(ee.value=e.map((e=>({name:e.name}))))}finally{de(!1)}};return E((async()=>{await(async()=>{const{message:e}=await m();_(e)&&(Q.value=e.map((e=>({label:e.name,value:e.id}))),I.site=Q.value[0].value)})(),ue()})),$({onConfirm:async()=>{if(await(G.value?.validate()),I.dns_manual&&"dns"===I.auth_type){const e=JSON.stringify("single"===I.type?[I.domains]:I.domains.split("\n")),{message:l}=await r({site_id:-1,domains:e});if(p(l)&&Object.keys(l).length)return t(l.auths,-1,[I.domains],(()=>{D.onRefresh()}),!0),!1;const d=n({width:500,height:300,hideClose:!0,component:s});try{const{message:e}=await c(se(),!1);if(p(e)){if(e.deploy)return void D.onRefresh();Array.isArray(e.auths)&&e.auths.length&&t(e.auths,-1,[I.domains],(()=>{D.onRefresh()}))}}catch(a){i(f(a,"message",""))}finally{d.hide()}return}const{message:e}=await c(se());p(e)&&n({hideClose:!0,data:{isJump:!1,task_id:e.task_id,onFinish:()=>{D.onRefresh()}},component:v}),D.onRefresh()}}),(e,l)=>{const t=g,n=h,s=S,i=x,o=w,r=b,p=k,c=L,_=A,m=y,v=u,f=d;return O(),F("div",a,[C(v,{ref_key:"formRef",ref:G,model:P(I),rules:ne,"label-width":"150px"},{default:J((()=>[C(i,{label:e.$t("Waf.Setting.config_67"),path:"verify_method"},{default:J((()=>[C(s,{value:P(I).auth_type,"onUpdate:value":l[0]||(l[0]=e=>P(I).auth_type=e)},{default:J((()=>[C(n,null,{default:J((()=>[C(t,{value:"dns"},{default:J((()=>[V(q(e.$t("SSL.index_12")),1)])),_:1}),C(t,{value:"http"},{default:J((()=>[V(q(e.$t("SSL.SiteSSL.index_17")),1)])),_:1})])),_:1})])),_:1},8,["value"])])),_:1},8,["label"]),"dns"===P(I).auth_type?(O(),F("div",B,[C(i,{label:" "},{default:J((()=>[C(o,{checked:P(I).dns_manual,"onUpdate:checked":l[1]||(l[1]=e=>P(I).dns_manual=e),"checked-value":1,"unchecked-value":0},{default:J((()=>[V(q(e.$t("SSL.index_2")),1)])),_:1},8,["checked"])])),_:1}),C(i,{label:e.$t("SSL.index_13"),path:"type"},{default:J((()=>[C(r,{class:"w-300px",value:P(I).type,"onUpdate:value":[l[2]||(l[2]=e=>P(I).type=e),ae],options:P(K)},null,8,["value","options"])])),_:1},8,["label"]),"single"===P(I).type?(O(),H(i,{key:0,label:" ",path:"domains"},{default:J((()=>[C(p,{"input-props":{spellcheck:!1},class:"w-300px!",value:P(I).domains,"onUpdate:value":l[3]||(l[3]=e=>P(I).domains=e),placeholder:"aapanel.com"},null,8,["value"])])),_:1})):M("",!0),"wildcard"===P(I).type?(O(),H(i,{key:1,label:" ",path:"domains"},{default:J((()=>[C(p,{"input-props":{spellcheck:!1},type:"textarea",class:"w-300px!",value:P(I).domains,"onUpdate:value":l[4]||(l[4]=e=>P(I).domains=e),placeholder:e.$t("SSL.index_14")},null,8,["value","placeholder"])])),_:1})):M("",!0),"wildcard_all"===P(I).type?(O(),H(i,{key:2,label:" ",path:"domains"},{default:J((()=>[C(p,{"input-props":{spellcheck:!1},type:"textarea",class:"w-300px!",value:P(I).domains,"onUpdate:value":l[5]||(l[5]=e=>P(I).domains=e),placeholder:"*.aapanel.com"},null,8,["value"])])),_:1})):M("",!0)])):M("",!0),"http"===P(I).auth_type?(O(),F("div",X,[C(i,{label:e.$t("Home.index_68")},{default:J((()=>[C(r,{class:"w-300px",value:P(I).site,"onUpdate:value":[l[6]||(l[6]=e=>P(I).site=e),le],options:P(Q)},null,8,["value","options"])])),_:1},8,["label"]),C(i,{label:e.$t("Mail.Bcc.index_6"),path:"domains_list"},{default:J((()=>[C(m,{show:P(ie),class:"p-12px w-300px max-h-300px min-h-100px overflow-auto border border-solid border-#ccc"},{default:J((()=>[C(o,{class:"mb-12px",checked:P(I).all,"onUpdate:checked":l[7]||(l[7]=e=>P(I).all=e),label:e.$t("Public.SelectAll"),indeterminate:P(te)},null,8,["checked","label","indeterminate"]),C(_,{value:P(I).domains_list,"onUpdate:value":l[8]||(l[8]=e=>P(I).domains_list=e)},{default:J((()=>[C(c,{class:"flex-col!",size:12},{default:J((()=>[(O(!0),F(N,null,T(P(ee),(e=>(O(),H(o,{key:e.name,value:e.name,label:e.name},null,8,["value","label"])))),128))])),_:1})])),_:1},8,["value"])])),_:1},8,["show"])])),_:1},8,["label"])])):M("",!0)])),_:1},8,["model"]),C(f,{class:"mt-16px"},{default:J((()=>[W("li",null,q(e.$t("SSL.index_15")),1),l[9]||(l[9]=W("li",null,"Manually resolved certificates do not support auto-renewal",-1)),W("li",null,q(e.$t("SSL.index_16")),1)])),_:1,__:[9]})])}}}))}}}));
