const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/HighRiskSection.js?v=1763625242172","js/vue.js?v=1763625242172","js/__commonjsHelpers__.js?v=1763625242172","js/page_layout.js?v=1763625242172","js/naive.js?v=1763625242172","js/common.js?v=1763625242172","js/public.js?v=1763625242172","css/public.css?v=1763625242172","css/page_layout.css?v=1763625242172","css/HighRiskSection.css?v=1763625242172","js/MidRiskSection.js?v=1763625242172","css/MidRiskSection.css?v=1763625242172","js/CveSection.js?v=1763625242172","css/CveSection.css?v=1763625242172","js/LowRiskSection.js?v=1763625242172","css/LowRiskSection.css?v=1763625242172","js/MaliciousSection.js?v=1763625242172","css/MaliciousSection.css?v=1763625242172","js/WebVulnSection.js?v=1763625242172","css/WebVulnSection.css?v=1763625242172","js/ServerSecSection.js?v=1763625242172","css/ServerSecSection.css?v=1763625242172","js/html2pdf.js?v=1763625242172"])))=>i.map(i=>d[i]);
import{u as s,a as t,m as e,T as i,p as a}from"./page_layout.js?v=1763625242172";import{b as l}from"./public.js?v=1763625242172";import{B as n}from"./index42.js?v=1763625242172";import{k as r,e as o,r as c,c as d,o as u,R as v,a2 as p,a3 as m,U as _,a4 as g,H as h,V as f,S as w,F as b,O as y,j as S,an as k,a7 as x,_ as T}from"./vue.js?v=1763625242172";import"./naive.js?v=1763625242172";import"./common.js?v=1763625242172";import"./__commonjsHelpers__.js?v=1763625242172";import"./index102.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang13.js?v=1763625242172";import"./soft.js?v=1763625242172";import"./site.js?v=1763625242172";import"./index168.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang15.js?v=1763625242172";const L={id:"reportContent",class:"report-content"},j={class:"report-page cover-page"},H={class:"cover-header"},M={class:"report-date"},R={class:"cover-content"},z={class:"level-badge"},E={class:"stats-summary"},A={class:"stats-item"},D={class:"stats-icon warning-icon"},V=["innerHTML"],N={class:"stats-info"},C={class:"stats-value"},O={class:"stats-item"},P={class:"stats-icon cve-icon"},I=["innerHTML"],q={class:"stats-info"},F={class:"stats-value"},U={class:"stats-item"},B={class:"stats-icon scan-icon"},W=["innerHTML"],K={class:"stats-info"},X={class:"stats-value"},Y={class:"cover-info"},G={class:"info-grid"},J={class:"info-item"},Q={class:"info-value"},Z={class:"info-item"},$={class:"info-value"},ss={class:"info-item"},ts={class:"info-value"},es={class:"info-item"},is={class:"info-value"},as={class:"report-page toc-page"},ls={class:"toc-content"},ns={class:"toc-title"},rs={class:"toc-page"},os={class:"report-page content-page"},cs={class:"security-rating"},ds={class:"rating-value"},us={class:"rating-info"},vs=["innerHTML"],ps={class:"rating-date"},ms={class:"last-scan"},_s={class:"report-page content-page"},gs={class:"security-stats"},hs={class:"stats-row"},fs={class:"stats-icon warning-icon"},ws=["innerHTML"],bs={class:"stats-content"},ys={class:"stats-breakdown"},Ss={class:"stats-item high"},ks={class:"stats-item medium"},xs={class:"stats-item low"},Ts={class:"stats-row"},Ls={class:"stats-icon scan-icon"},js=["innerHTML"],Hs={class:"stats-content"},Ms={class:"stats-breakdown breakdown-block"},Rs={class:"breakdown-group"},zs={class:"group-items"},Es={class:"stats-item db-item"},As={class:"breakdown-group"},Ds={class:"group-items"},Vs={class:"stats-item scan-item"},Ns={class:"stats-item scan-item"},Cs={class:"stats-item scan-item"},Os={class:"page-header"},Ps={key:0},Is={class:"page-number"},qs={class:"report-page content-page"},Fs={class:"page-header"},Us={class:"page-number"},Bs={class:"scan-stats"},Ws={class:"stats-row"},Ks={class:"stats-value"},Xs={class:"stats-row"},Ys={class:"stats-value"},Gs={class:"stats-row"},Js={class:"stats-value"},Qs={class:"stats-info"},Zs={class:"stats-desc"},$s={class:"stats-desc"},st={class:"stats-desc"},tt=a(r({__name:"risk-report",setup(a,{expose:r}){const tt='<svg\r\n  t="1658198918096"\r\n  viewBox="0 0 1024 1024"\r\n  version="1.1"\r\n  xmlns="http://www.w3.org/2000/svg"\r\n  p-id="3020">\r\n  <path\r\n    d="M512 64q190.016 4.992 316.512 131.488T960 512q-4.992 190.016-131.488 316.512T512 960q-190.016-4.992-316.512-131.488T64 512q4.992-190.016 131.488-316.512T512 64z m0 192q-26.016 0-43.008 19.008T453.984 320l23.008 256q2.016 14.016 11.488 22.496t23.488 8.512 23.488-8.512 11.488-22.496l23.008-256q2.016-26.016-15.008-44.992T511.936 256z m0 512q22.016-0.992 36.512-15.008t14.496-36-14.496-36.512T512 665.984t-36.512 14.496-14.496 36.512 14.496 36T512 768z"\r\n    p-id="3021">\r\n  </path>\r\n</svg>\r\n',et="<svg class='icon' viewBox='0 0 1024 1024' xmlns='http://www.w3.org/2000/svg' data-spm-anchor-id='a313x.7781069.0.i7'>\r\n\t<path d='M842.667 981.333H181.333A53.393 53.393 0 0 1 128 928V96a53.393 53.393 0 0 1 53.333-53.333H648.08a52.987 52.987 0 0 1 37.713 15.62L880.38 252.873A52.987 52.987 0 0 1 896 290.587V928a53.393 53.393 0 0 1-53.333 53.333zm-661.334-896A10.667 10.667 0 0 0 170.667 96v832a10.667 10.667 0 0 0 10.666 10.667h661.334A10.667 10.667 0 0 0 853.333 928V298.667h-160A53.393 53.393 0 0 1 640 245.333v-160zM682.667 115.5v129.833A10.667 10.667 0 0 0 693.333 256h129.834zM704 768H320a21.333 21.333 0 0 1 0-42.667h384A21.333 21.333 0 0 1 704 768zm0-213.333H320A21.333 21.333 0 0 1 320 512h384a21.333 21.333 0 0 1 0 42.667zm-213.333-256H320A21.333 21.333 0 0 1 320 256h170.667a21.333 21.333 0 0 1 0 42.667z' />\r\n</svg>\r\n",it=s(),at=o({first:null,second:null,third:null,fourth:null,fifth:null,sixth:null,malicious_files:null,website_vulnerabilities:null,server_security:null}),lt=c(!1),nt=[{key:"high_risk",title:"High-risk issues",component:T((()=>t((()=>import("./HighRiskSection.js?v=1763625242172")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])))),data:()=>{var s;return null==(s=at.fifth)?void 0:s.focus_high_list},pageSize:2},{key:"mid_risk",title:"Mid-risk issues",component:T((()=>t((()=>import("./MidRiskSection.js?v=1763625242172")),__vite__mapDeps([10,1,2,3,4,5,6,7,8,11])))),data:()=>{var s;return null==(s=at.fifth)?void 0:s.focus_mid_list},pageSize:2},{key:"cve",title:"CVE vulnerabilities",component:T((()=>t((()=>import("./CveSection.js?v=1763625242172")),__vite__mapDeps([12,1,2,3,4,5,6,7,8,13])))),data:()=>{var s;return null==(s=at.fifth)?void 0:s.focus_cve_list},pageSize:2},{key:"low_risk",title:"Low-risk issues",component:T((()=>t((()=>import("./LowRiskSection.js?v=1763625242172")),__vite__mapDeps([14,1,2,3,4,5,6,7,8,15])))),data:()=>{var s;return null==(s=at.sixth)?void 0:s.low_warn_list},pageSize:2},{key:"malicious",title:"Malicious file detection",component:T((()=>t((()=>import("./MaliciousSection.js?v=1763625242172")),__vite__mapDeps([16,1,2,3,4,5,6,7,8,17])))),data:()=>{var s;return null==(s=at.malicious_files)?void 0:s.detected},pageSize:8},{key:"web_vuln",title:"Website vulnerability detection",component:T((()=>t((()=>import("./WebVulnSection.js?v=1763625242172")),__vite__mapDeps([18,1,2,3,4,5,6,7,8,19])))),data:()=>{var s;return null==(s=at.website_vulnerabilities)?void 0:s.info},pageSize:1},{key:"server_sec",title:"Server security detection",component:T((()=>t((()=>import("./ServerSecSection.js?v=1763625242172")),__vite__mapDeps([20,1,2,3,4,5,6,7,8,21])))),data:()=>{var s;return null==(s=at.server_security)?void 0:s.server_security_list},pageSize:8}];const rt=d((()=>nt.map((s=>{const t=function(s,t){if(!s||!s.length)return[];const e=[];for(let i=0;i<s.length;i+=t)e.push(s.slice(i,i+t));return e}(s.data(),s.pageSize);return{...s,pages:t,pageCount:t.length}})))),ot=d((()=>{let s=3;const t=[{title:"Security Rating Overview",page:s++},{title:"Security Overview Statistics",page:s++}];return rt.value.forEach((e=>{e.pageCount&&(t.push({title:e.title,page:s}),s+=e.pageCount)})),t.push({title:"Scan Statistics",page:s++}),t}));function ct(s,t=0){let e=4;for(const i of rt.value){if(i.key===s)return e+t;e+=i.pageCount}return e}return u((()=>{(async()=>{try{lt.value=!0;const{message:s}=await n();s&&"object"==typeof s&&(at.first=s.first||null,at.second=s.second||null,at.third=s.third||null,at.fourth=s.fourth||null,at.fifth=s.fifth||null,at.sixth=s.sixth||null,at.malicious_files=s.malicious_files||null,at.website_vulnerabilities=s.website_vulnerabilities||null,at.server_security=s.server_security||null)}finally{lt.value=!1}})()})),r({onConfirm:async()=>{if(it.isFree)return void l({source:399});const s=e.loading("Exporting PDF...");try{const s=await t((()=>import("./html2pdf.js?v=1763625242172").then((s=>s.h))),__vite__mapDeps([22,2,3,1,4,5,6,7,8])),i=document.getElementById("reportContent");if(!i)return void e.error("Failed to get report content");const a={margin:0,filename:"Security Scan Report_".concat((new Date).toISOString().split("T")[0],".pdf"),image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,allowTaint:!0,scrollX:0,scrollY:0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["css","legacy"]}};await s.default().set(a).from(i).save(),e.success("PDF export successful")}catch(i){e.error("PDF export failed")}finally{s.close()}}}),(s,t)=>{const e=i;return v(),p(e,{show:f(lt),description:"Loading...",class:"p-20px"},{default:m((()=>{var s,e,i,a,l,n,r,o,c,d,u,m,T,it,lt,nt,dt,ut,vt,pt,mt,_t,gt,ht,ft,wt,bt,yt,St,kt,xt,Tt,Lt,jt,Ht,Mt,Rt,zt;return[_("div",L,[_("div",j,[_("div",H,[t[0]||(t[0]=_("div",{class:"logo"},[_("img",{src:"/static/vite/images/aapanel.png",alt:"Logo"}),_("div",{class:"logo-text"},"aaPanel Security")],-1)),_("div",M,g((new Date).toISOString().split("T")[0]),1)]),_("div",R,[t[5]||(t[5]=_("h1",{class:"report-title"},"Security Scan Report",-1)),_("div",{class:h(["security-level","level-"+((null==(e=null==(s=f(at).second)?void 0:s.level)?void 0:e.toLowerCase())||"normal")])},[_("div",z,g((null==(i=f(at).second)?void 0:i.level)||"Unknown"),1),t[1]||(t[1]=_("div",{class:"level-text"},"Security Level",-1))],2),_("div",E,[_("div",A,[_("div",D,[_("div",{innerHTML:f(tt),class:"w-24px h-24px text-yellow-500"},null,8,V)]),_("div",N,[_("div",C,g(Number((null==(a=f(at).fourth)?void 0:a.high_warn)||0)+Number((null==(l=f(at).fourth)?void 0:l.low_warn)||0)+Number((null==(n=f(at).fourth)?void 0:n.mid_warn)||0)),1),t[2]||(t[2]=_("div",{class:"stats-label"},"Security Risks",-1))])]),_("div",O,[_("div",P,[_("div",{innerHTML:f('<svg t="1735025023293" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10305">\n\t<path d="M896 170.666667H128v512h768V170.666667zM85.333333 85.333333h853.333334c23.552 0 42.666667 16.981333 42.666666 37.930667v606.805333c0 20.949333-19.114667 37.930667-42.666666 37.930667H85.333333c-23.552 0-42.666667-16.981333-42.666666-37.930667V123.264C42.666667 102.314667 61.781333 85.333333 85.333333 85.333333z m196.266667 768h460.8c14.165333 0 25.6 9.557333 25.6 21.333334v42.666666c0 11.776-11.434667 21.333333-25.6 21.333334H281.6c-14.122667 0-25.6-9.557333-25.6-21.333334v-42.666666c0-11.776 11.477333-21.333333 25.6-21.333334z m187.733333-106.666666h85.333334v128h-85.333334v-128z" p-id="10306"></path>\n</svg>'),class:"w-24px h-24px text-purple-500"},null,8,I)]),_("div",q,[_("div",F,g((null==(r=f(at).fourth)?void 0:r.cve_num)||0),1),t[3]||(t[3]=_("div",{class:"stats-label"},"Scan Item",-1))])]),_("div",U,[_("div",B,[_("div",{innerHTML:f(et),class:"w-24px h-24px text-blue-500"},null,8,W)]),_("div",K,[_("div",X,g(Number((null==(o=f(at).fourth)?void 0:o.web_num)||0)+Number((null==(c=f(at).fourth)?void 0:c.sys_num)||0)+Number((null==(d=f(at).fourth)?void 0:d.kernel_num)||0)),1),t[4]||(t[4]=_("div",{class:"stats-label"},"Detection Type",-1))])])])]),_("div",Y,[_("div",G,[_("div",J,[t[6]||(t[6]=_("div",{class:"info-label"},"Host Name",-1)),_("div",Q,g((null==(u=f(at).first)?void 0:u.host)||"Unknown"),1)]),_("div",Z,[t[7]||(t[7]=_("div",{class:"info-label"},"IP Address",-1)),_("div",$,g((null==(m=f(at).first)?void 0:m.ip)||"Unknown"),1)]),_("div",ss,[t[8]||(t[8]=_("div",{class:"info-label"},"Report Date",-1)),_("div",ts,g((null==(T=f(at).first)?void 0:T.date)||"Unknown"),1)]),_("div",es,[t[9]||(t[9]=_("div",{class:"info-label"},"Last Scan",-1)),_("div",is,g((null==(it=f(at).second)?void 0:it.last_date)||"Unknown"),1)])])]),t[10]||(t[10]=_("div",{class:"cover-footer"},[_("div",{class:"footer-text"},"aaPanel Security Scanning System"),_("div",{class:"footer-note"},"This report provides a comprehensive security assessment of your server.")],-1))]),_("div",as,[t[12]||(t[12]=_("div",{class:"toc-header"},[_("h2",null,"Table of Contents")],-1)),_("div",ls,[(v(!0),w(b,null,y(f(ot),((s,e)=>(v(),w("div",{class:"toc-item",key:s.title},[_("span",ns,g(e+1)+". "+g(s.title),1),t[11]||(t[11]=_("span",{class:"toc-dots"},"...",-1)),_("span",rs,g(s.page),1)])))),128))])]),_("div",os,[t[14]||(t[14]=_("div",{class:"page-header"},[_("h2",null,"1. Security Rating Overview"),_("div",{class:"page-number"},"3")],-1)),_("div",cs,[_("div",{class:h(["rating-card","level-"+((null==(lt=f(at).second)?void 0:lt.total_level.toLowerCase())||"normal")])},[_("div",ds,g((null==(nt=f(at).second)?void 0:nt.total_level)||"Unknown"),1),t[13]||(t[13]=_("div",{class:"rating-label"},"Security Level",-1))],2),_("div",us,[_("div",{class:"rating-reason",innerHTML:(null==(dt=f(at).second)?void 0:dt.level_reason)||""},null,8,vs),_("div",ps," Report Date: "+g((null==(ut=f(at).second)?void 0:ut.date)||""),1),_("div",ms," Last Scan: "+g((null==(vt=f(at).second)?void 0:vt.last_date)||""),1)])])]),_("div",_s,[t[19]||(t[19]=_("div",{class:"page-header"},[_("h2",null,"2. Security Overview Statistics"),_("div",{class:"page-number"},"4")],-1)),_("div",gs,[_("div",hs,[_("div",fs,[_("div",{innerHTML:f(tt),class:"w-24px h-24px text-yellow-500"},null,8,ws)]),_("div",bs,[_("div",null,[t[15]||(t[15]=_("div",{class:"stats-label"},"Security Risks",-1)),_("div",{class:h(["stats-value",{"text-warning!":Number((null==(pt=f(at).fourth)?void 0:pt.high_warn)||0)+Number((null==(mt=f(at).fourth)?void 0:mt.low_warn)||0)+Number((null==(_t=f(at).fourth)?void 0:_t.mid_warn)||0)>0}])},g(Number((null==(gt=f(at).fourth)?void 0:gt.high_warn)||0)+Number((null==(ht=f(at).fourth)?void 0:ht.low_warn)||0)+Number((null==(ft=f(at).fourth)?void 0:ft.mid_warn)||0)),3)]),_("div",ys,[_("span",Ss,"High: "+g((null==(wt=f(at).fourth)?void 0:wt.high_warn)||0),1),_("span",ks,"Medium: "+g((null==(bt=f(at).fourth)?void 0:bt.mid_warn)||0),1),_("span",xs,"Low: "+g((null==(yt=f(at).fourth)?void 0:yt.low_warn)||0),1)])])]),_("div",Ts,[_("div",Ls,[_("div",{innerHTML:f(et),class:"w-24px h-24px text-blue-500"},null,8,js)]),_("div",Hs,[t[18]||(t[18]=_("div",{class:"stats-label"},"Virus Database & Scan Types",-1)),_("div",Ms,[_("div",Rs,[t[16]||(t[16]=_("div",{class:"group-title db-label"},"ðŸ¦  Virus Database",-1)),_("div",zs,[_("span",Es,"Number: "+g((null==(St=f(at).fourth)?void 0:St.cve_num)||0),1)])]),_("div",As,[t[17]||(t[17]=_("div",{class:"group-title scan-label"},"ðŸ” Scan Types",-1)),_("div",Ds,[_("span",Vs,"Web risk: "+g((null==(kt=f(at).fourth)?void 0:kt.web_num)||0),1),_("span",Ns,"System risk: "+g((null==(xt=f(at).fourth)?void 0:xt.sys_num)||0),1),_("span",Cs,"Kernel risk: "+g((null==(Tt=f(at).fourth)?void 0:Tt.kernel_num)||0),1)])])])])])])]),(v(!0),w(b,null,y(f(rt),(s=>(v(),w(b,null,[(v(!0),w(b,null,y(s.pages,((t,e)=>(v(),w("div",{key:e,class:"report-page content-page"},[_("div",Os,[_("h2",null,[S(g(s.title),1),e>0?(v(),w("span",Ps,"ï¼ˆContinue "+g(e+1)+"ï¼‰",1)):k("",!0)]),_("div",Is,g(ct(s.key,e)),1)]),(v(),p(x(s.component),{data:t,"total-pages":s.pageCount,"page-index":e},null,8,["data","total-pages","page-index"]))])))),128))],64)))),256)),_("div",qs,[_("div",Fs,[t[20]||(t[20]=_("h2",null,"Scan Statistics",-1)),_("div",Us,g(ct("stats",0)),1)]),_("div",Bs,[_("div",Ws,[t[21]||(t[21]=_("div",{class:"stats-label"},"Number of Security Scans:",-1)),_("div",Ks,g((null==(Lt=f(at).third)?void 0:Lt.warn_times)||0),1)]),_("div",Xs,[t[22]||(t[22]=_("div",{class:"stats-label"},"Number of Vulnerability Scans:",-1)),_("div",Ys,g((null==(jt=f(at).third)?void 0:jt.cve_times)||0),1)]),_("div",Gs,[t[23]||(t[23]=_("div",{class:"stats-label"},"Number of Repair Actions:",-1)),_("div",Js,g((null==(Ht=f(at).third)?void 0:Ht.repair_times)||0),1)]),_("div",Qs,[_("div",Zs,g((null==(Mt=f(at).third)?void 0:Mt.second_warn)||""),1),_("div",$s,g((null==(Rt=f(at).third)?void 0:Rt.second_cve)||""),1),_("div",st,g((null==(zt=f(at).third)?void 0:zt.repair)||""),1)])])])])]})),_:1},8,["show"])}}}),[["__scopeId","data-v-661164a0"]]);export{tt as default};
