import{d as e,_ as t}from"./public.js?v=1769066082311";import{_ as i}from"./index.vue_vue_type_script_setup_true_lang.js?v=1769066082311";import{s as a,g as r}from"./index63.js?v=1769066082311";import{T as s,d as o}from"./page_layout.js?v=1769066082311";import{k as n,P as l,r as u,e as m,a2 as p,V as d,a3 as _,W as c,U as f,j as x,a4 as y,S as b}from"./vue.js?v=1769066082311";import{dS as h,av as v,dg as g,d_ as j}from"./naive.js?v=1769066082311";import"./common.js?v=1769066082311";import"./__commonjsHelpers__.js?v=1769066082311";import"./ssh.js?v=1769066082311";import"./index112.js?v=1769066082311";import"./index104.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang2.js?v=1769066082311";import"./index103.js?v=1769066082311";import"./index114.js?v=1769066082311";import"./ssl-lets-progress.js?v=1769066082311";import"./index.js?v=1769066082311";const S=["textContent"],w=n({__name:"ssh-protection-config",setup(n,{expose:w}){const{t:R}=l(),T=u(null),C=m({maxRetry:5,period:300,prohibitionTime:86400}),$={maxRetry:{required:!0,message:R("Security.Conf.Index_28"),type:"number",trigger:["blur","input"]},period:{required:!0,message:R("Security.Conf.Index_28"),type:"number",trigger:["blur","input"]},prohibitionTime:{required:!0,message:R("Security.Conf.Index_28"),type:"number",trigger:["blur","input"]}},{loading:I,setLoading:M}=e();return(async()=>{try{M(!0);const{message:e}=await r();o(e)&&(C.maxRetry=e.maxretry,C.period=e.findtime,C.prohibitionTime=e.bantime)}finally{M(!1)}})(),w({onConfirm:async()=>{var e;await(null==(e=T.value)?void 0:e.validate());const t={maxretry:C.maxRetry,findtime:C.period,bantime:C.prohibitionTime};await a(t)}}),(e,a)=>{const r=g,o=j,n=v,l=h,u=i,m=t,w=s;return d(),p(w,{show:f(I),class:"p-16px"},{default:_(()=>[c(u,{ref_key:"formRef",ref:T,model:f(C),rules:$},{default:_(()=>[c(l,{label:e.$t("Maximum retry times"),path:"maxRetry"},{default:_(()=>[c(n,{class:"w-200px"},{default:_(()=>[c(r,{value:f(C).maxRetry,"onUpdate:value":a[0]||(a[0]=e=>f(C).maxRetry=e),"show-button":!1},null,8,["value"]),c(o,null,{default:_(()=>[x(y(e.$t("Waf.Site.index_35")),1)]),_:1})]),_:1})]),_:1},8,["label"]),c(l,{label:e.$t("Mail.Backup.index_3"),path:"period"},{default:_(()=>[c(n,{class:"w-200px"},{default:_(()=>[c(r,{value:f(C).period,"onUpdate:value":a[1]||(a[1]=e=>f(C).period=e),"show-button":!1},null,8,["value"]),c(o,null,{default:_(()=>[x(y(e.$t("Security.SiteSecurity.Metric.seconds")),1)]),_:1})]),_:1})]),_:1},8,["label"]),c(l,{label:"Prohibition time",path:"prohibitionTime"},{default:_(()=>[c(n,{class:"w-200px"},{default:_(()=>[c(r,{value:f(C).prohibitionTime,"onUpdate:value":a[2]||(a[2]=e=>f(C).prohibitionTime=e),"show-button":!1},null,8,["value"]),c(o,null,{default:_(()=>[x(y(e.$t("Security.SiteSecurity.Metric.seconds")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),c(m,null,{default:_(()=>[b("li",{textContent:y(e.$t("Monitor SSHD service logs, and prohibit IP access for 86400 seconds if the IP exceeds the maximum number of retries (5 times) within the set period (300 seconds)"))},null,8,S)]),_:1})]),_:1},8,["show"])}}});export{w as default};
