const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index121.js?v=1769066082311","js/index109.js?v=1769066082311","js/page_layout.js?v=1769066082311","js/vue.js?v=1769066082311","js/__commonjsHelpers__.js?v=1769066082311","js/naive.js?v=1769066082311","js/common.js?v=1769066082311","js/public.js?v=1769066082311","css/public.css?v=1769066082311","css/page_layout.css?v=1769066082311","css/index21.css?v=1769066082311","js/index.js?v=1769066082311","css/index123.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang.js?v=1769066082311","js/backup-info.js?v=1769066082311","js/utils.js?v=1769066082311","js/soft.js?v=1769066082311","js/site.js?v=1769066082311","css/backup-info.css?v=1769066082311","js/migrate-success.js?v=1769066082311","js/migrate-error.js?v=1769066082311"])))=>i.map(i=>d[i]);
import{T as e,n as a,_ as t,aE as s,i as o,a as l,d as r}from"./page_layout.js?v=1769066082311";import{_ as i}from"./index.js?v=1769066082311";import{e as n,p,_ as d}from"./public.js?v=1769066082311";import{_ as u}from"./index.vue_vue_type_script_setup_true_lang.js?v=1769066082311";import{k as _,P as c,a0 as g,a2 as m,V as h,U as w,a3 as f,W as x,S as b,j as v,a4 as C,e as y,r as k,_ as M,a5 as j}from"./vue.js?v=1769066082311";import T from"./backup-info.js?v=1769066082311";import{u as P}from"./utils.js?v=1769066082311";import{dS as D,db as O,de as U,di as q,dl as E,au as R,dg as $,aC as S,dT as I}from"./naive.js?v=1769066082311";const V=_({__name:"index",setup(s){const{t:o}=c(),l=P(),{loading:r,backupData:i}=g(l);return l.getData(),(s,l)=>{const n=U,p=t,d=q,_=O,c=D,g=u,y=e;return h(),m(y,{show:w(r),class:"p-16px"},{default:f(()=>[x(g,{ref:"formRef"},{default:f(()=>[x(c,{label:w(o)("Config.Migrate.index_10")},{default:f(()=>[x(_,null,{default:f(()=>[x(n,{class:"mr-8px"},{default:f(()=>[v(C(w(a)(w(i).disk_use)),1)]),_:1}),b("div",null,[b("span",null,C(w(o)("Config.Migrate.index_11")),1),x(n,{type:"success",class:"ml-16px mr-8px"},{default:f(()=>[v(C(w(a)(w(i).disk_free)),1)]),_:1}),x(d,{trigger:"hover",placement:"top-start"},{trigger:f(()=>[x(p,{name:"base-warning",class:"text-warning mr-4px",size:"16"})]),default:f(()=>[b("span",null,[b("li",null,C(w(o)("Config.Migrate.index_12"))+" "+C(w(a)(1.5*w(i).disk_use)),1),b("li",null,C(w(o)("Config.Migrate.index_13")),1)])]),_:1})])]),_:1})]),_:1},8,["label"]),x(c,{label:"Backup Data"},{default:f(()=>[x(T,{class:"w-600px"})]),_:1})]),_:1},512)]),_:1},8,["show"])}}}),A=()=>s.post("/mod/backup_restore/com/get_migrate_progress"),L=()=>s.post("/mod/backup_restore/com/stop_migrate",{},{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}}),z=()=>s.post("/mod/backup_restore/com/close_migrate_popup",{},{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!1}}),B=_({__name:"index",setup(e){const a=M(()=>l(()=>import("./index121.js?v=1769066082311"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),t=M(()=>l(()=>import("./migrate-success.js?v=1769066082311"),__vite__mapDeps([19,7,2,3,4,5,6,9,8,11,12,13,14,15,16,17,18]))),_=M(()=>l(()=>import("./migrate-error.js?v=1769066082311"),__vite__mapDeps([20,7,2,3,4,5,6,9,8,11,12,13,14,15,16,17,18]))),{t:g}=c(),T=n(g("Config.Migrate.index_4")),P=n(g("Config.Migrate.index_5"),{onRefresh:(e,a)=>{"success"===e?(U.data=a,U.show=!0):(q.data.errData=a,q.show=!0)}}),U=n(g("Config.Migrate.index_6")),q=n(g("Config.Migrate.index_7"),{onRetry:e=>{q.show=!1,P.show=!1,L.ip=e.server_ip,L.port=e.ssh_port,L.account=e.ssh_user,L.password=e.password,F()}}),A=k(null),L=y({ip:"",port:22,account:"",password:""}),z={ip:{required:!0,message:g("Term.index_9"),trigger:["blur","input"]},port:{required:!0,type:"number",message:g("Security.Conf.Index_28"),trigger:["blur","input"]},account:{required:!0,message:g("Term.index_11"),trigger:["blur","input"]},password:{required:!0,message:g("Term.index_14"),trigger:["blur","input"]}},B=()=>{T.show=!0},W=()=>({auth_type:"password",server_ip:L.ip,ssh_port:L.port,ssh_user:L.account,password:L.password,ps:L.ip}),F=async()=>{var e;await(null==(e=A.value)?void 0:e.validate()),p({title:g("Config.Migrate.index_8"),content:()=>x("span",null,[x(j("i18n-t"),{keypath:"Config.Migrate.index_9",scope:"global"},{default:()=>[x("b",{class:"color-warning text-2xl"},[v(" "),L.ip,v(" ")])]})]),onConfirm:async()=>{var e;await(e=W(),s.post("/mod/backup_restore/com/ssh_auth_check",e,{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}})),await(e=>s.post("/mod/backup_restore/com/add_migrate_task",e,{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}}))(W()),P.show=!0}})};return(async()=>{const{message:e}=await s.post("/mod/backup_restore/com/get_migrate_status");r(e)&&e.is_running&&(P.show=!0,L.ip=e.server_ip,L.port=e.ssh_port,L.account=e.ssh_user,L.password=e.password)})(),(e,s)=>{const o=R,l=D,r=$,n=O,p=S,c=u,y=d,k=i,M=I;return h(),m(M,{class:"p-16px"},{default:f(()=>[x(w(E),{type:"warning",class:"mb-16px"},{default:f(()=>[b("span",null,C(w(g)("Config.Migrate.index_1")),1)]),_:1}),x(c,{ref_key:"formRef",ref:A,model:w(L),rules:z},{default:f(()=>[x(n,null,{default:f(()=>[x(l,{label:e.$t("Term.index_8"),path:"ip"},{default:f(()=>[x(o,{class:"w-190px!",value:w(L).ip,"onUpdate:value":s[0]||(s[0]=e=>w(L).ip=e),placeholder:e.$t("Term.index_9")},null,8,["value","placeholder"])]),_:1},8,["label"]),x(l,{path:"port"},{default:f(()=>[x(r,{"show-button":!1,class:"w-80px!",value:w(L).port,"onUpdate:value":s[1]||(s[1]=e=>w(L).port=e),placeholder:e.$t("Docker.Container.create.index_7")},null,8,["value","placeholder"])]),_:1})]),_:1}),x(l,{label:e.$t("Term.index_10"),path:"account"},{default:f(()=>[x(o,{class:"w-280px!",value:w(L).account,"onUpdate:value":s[2]||(s[2]=e=>w(L).account=e),placeholder:e.$t("Term.index_11")},null,8,["value","placeholder"])]),_:1},8,["label"]),x(l,{label:e.$t("Database.index_14"),path:"password"},{default:f(()=>[x(o,{class:"w-280px!",value:w(L).password,"onUpdate:value":s[3]||(s[3]=e=>w(L).password=e),placeholder:e.$t("Term.index_14")},null,8,["value","placeholder"])]),_:1},8,["label"]),x(l,{label:" "},{default:f(()=>[x(p,{type:"primary",onClick:F},{default:f(()=>[v(C(w(g)("Config.Migrate.index_2")),1)]),_:1})]),_:1})]),_:1},8,["model"]),x(y,null,{default:f(()=>[s[8]||(s[8]=b("li",{class:"text-warning font-bold"},"Please use root user",-1)),b("li",null,[x(p,{type:"primary",text:"",onClick:B},{default:f(()=>[v(C(w(g)("Config.Migrate.index_3")),1)]),_:1})])]),_:1,__:[8]}),x(k,{show:w(T).show,"onUpdate:show":s[4]||(s[4]=e=>w(T).show=e),title:w(T).title,data:w(T).data,width:"850","min-height":250,component:V},null,8,["show","title","data"]),x(k,{show:w(P).show,"onUpdate:show":s[5]||(s[5]=e=>w(P).show=e),title:w(P).title,hideClose:!0,data:w(P).data,width:"750","min-height":250,component:w(a)},null,8,["show","title","data","component"]),x(k,{show:w(U).show,"onUpdate:show":s[6]||(s[6]=e=>w(U).show=e),title:w(U).title,hideClose:!0,data:w(U).data,width:"750","min-height":250,component:w(t)},null,8,["show","title","data","component"]),x(k,{show:w(q).show,"onUpdate:show":s[7]||(s[7]=e=>w(q).show=e),title:w(q).title,hideClose:!0,data:w(q).data,width:"750","min-height":250,component:w(_)},null,8,["show","title","data","component"])]),_:1})}}}),W=Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"}));export{z as a,L as c,A as g,W as i};
