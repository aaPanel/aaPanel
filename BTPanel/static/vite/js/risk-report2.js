const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/HighRiskSection2.js?v=1769066082311","js/vue.js?v=1769066082311","js/__commonjsHelpers__.js?v=1769066082311","js/page_layout.js?v=1769066082311","js/naive.js?v=1769066082311","js/common.js?v=1769066082311","js/public.js?v=1769066082311","css/public.css?v=1769066082311","css/page_layout.css?v=1769066082311","css/HighRiskSection2.css?v=1769066082311","js/MidRiskSection2.js?v=1769066082311","css/MidRiskSection2.css?v=1769066082311","js/CveSection2.js?v=1769066082311","css/CveSection2.css?v=1769066082311","js/LowRiskSection2.js?v=1769066082311","css/LowRiskSection2.css?v=1769066082311","js/MaliciousSection2.js?v=1769066082311","css/MaliciousSection2.css?v=1769066082311","js/WebVulnSection2.js?v=1769066082311","css/WebVulnSection2.css?v=1769066082311","js/ServerSecSection2.js?v=1769066082311","css/ServerSecSection2.css?v=1769066082311","js/html2pdf.js?v=1769066082311"])))=>i.map(i=>d[i]);
import{u as s,T as e,a as t,m as a,p as i}from"./page_layout.js?v=1769066082311";import{_ as l,W as n,C as o,F as r}from"./file3.js?v=1769066082311";import{b as c}from"./public.js?v=1769066082311";import{B as u}from"./toolview.js?v=1769066082311";import{k as d,e as v,r as p,c as m,_,o as f,a2 as g,V as h,a3 as w,S as b,R as y,a4 as S,H as k,U as x,F as L,O as T,j as R,an as j,a7 as E}from"./vue.js?v=1769066082311";import"./naive.js?v=1769066082311";import"./common.js?v=1769066082311";import"./__commonjsHelpers__.js?v=1769066082311";const D={id:"reportContent",class:"report-content"},H={class:"report-page cover-page"},M={class:"cover-header"},N={class:"report-date"},C={class:"cover-content"},O={class:"level-badge"},P={class:"stats-summary"},I={class:"stats-item"},V={class:"stats-icon warning-icon"},A=["innerHTML"],z={class:"stats-info"},F={class:"stats-value"},U={class:"stats-item"},W={class:"stats-icon cve-icon"},B=["innerHTML"],q={class:"stats-info"},K={class:"stats-value"},X={class:"stats-item"},Y={class:"stats-icon scan-icon"},G=["innerHTML"],J={class:"stats-info"},Q={class:"stats-value"},Z={class:"cover-info"},$={class:"info-grid"},ss={class:"info-item"},es={class:"info-value"},ts={class:"info-item"},as={class:"info-value"},is={class:"info-item"},ls={class:"info-value"},ns={class:"info-item"},os={class:"info-value"},rs={class:"report-page toc-page"},cs={class:"toc-content"},us={class:"toc-title"},ds={class:"toc-page"},vs={class:"report-page content-page"},ps={class:"security-rating"},ms={class:"rating-value"},_s={class:"rating-info"},fs=["innerHTML"],gs={class:"rating-date"},hs={class:"last-scan"},ws={class:"report-page content-page"},bs={class:"security-stats"},ys={class:"stats-row"},Ss={class:"stats-icon warning-icon"},ks=["innerHTML"],xs={class:"stats-content"},Ls={class:"stats-breakdown"},Ts={class:"stats-item high"},Rs={class:"stats-item medium"},js={class:"stats-item low"},Es={class:"stats-row"},Ds={class:"stats-icon scan-icon"},Hs=["innerHTML"],Ms={class:"stats-content"},Ns={class:"stats-breakdown breakdown-block"},Cs={class:"breakdown-group"},Os={class:"group-items"},Ps={class:"stats-item db-item"},Is={class:"breakdown-group"},Vs={class:"group-items"},As={class:"stats-item scan-item"},zs={class:"stats-item scan-item"},Fs={class:"stats-item scan-item"},Us={class:"page-header"},Ws={key:0},Bs={class:"page-number"},qs={class:"report-page content-page"},Ks={class:"page-header"},Xs={class:"page-number"},Ys={class:"scan-stats"},Gs={class:"stats-row"},Js={class:"stats-value"},Qs={class:"stats-row"},Zs={class:"stats-value"},$s={class:"stats-row"},se={class:"stats-value"},ee={class:"stats-info"},te={class:"stats-desc"},ae={class:"stats-desc"},ie={class:"stats-desc"},le=i(d({__name:"risk-report",setup(i,{expose:d}){const le=n,ne=o,oe=r,re=s(),ce=v({first:null,second:null,third:null,fourth:null,fifth:null,sixth:null,malicious_files:null,website_vulnerabilities:null,server_security:null}),ue=p(!1),de=[{key:"high_risk",title:"High-risk issues",component:_(()=>t(()=>import("./HighRiskSection2.js?v=1769066082311"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),data:()=>{var s;return null==(s=ce.fifth)?void 0:s.focus_high_list},pageSize:2},{key:"mid_risk",title:"Mid-risk issues",component:_(()=>t(()=>import("./MidRiskSection2.js?v=1769066082311"),__vite__mapDeps([10,1,2,3,4,5,6,7,8,11]))),data:()=>{var s;return null==(s=ce.fifth)?void 0:s.focus_mid_list},pageSize:2},{key:"cve",title:"CVE vulnerabilities",component:_(()=>t(()=>import("./CveSection2.js?v=1769066082311"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,13]))),data:()=>{var s;return null==(s=ce.fifth)?void 0:s.focus_cve_list},pageSize:2},{key:"low_risk",title:"Low-risk issues",component:_(()=>t(()=>import("./LowRiskSection2.js?v=1769066082311"),__vite__mapDeps([14,1,2,3,4,5,6,7,8,15]))),data:()=>{var s;return null==(s=ce.sixth)?void 0:s.low_warn_list},pageSize:2},{key:"malicious",title:"Malicious file detection",component:_(()=>t(()=>import("./MaliciousSection2.js?v=1769066082311"),__vite__mapDeps([16,1,2,3,4,5,6,7,8,17]))),data:()=>{var s;return null==(s=ce.malicious_files)?void 0:s.detected},pageSize:8},{key:"web_vuln",title:"Website vulnerability detection",component:_(()=>t(()=>import("./WebVulnSection2.js?v=1769066082311"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,19]))),data:()=>{var s;return null==(s=ce.website_vulnerabilities)?void 0:s.info},pageSize:1},{key:"server_sec",title:"Server security detection",component:_(()=>t(()=>import("./ServerSecSection2.js?v=1769066082311"),__vite__mapDeps([20,1,2,3,4,5,6,7,8,21]))),data:()=>{var s;return null==(s=ce.server_security)?void 0:s.server_security_list},pageSize:8}];const ve=m(()=>de.map(s=>{const e=function(s,e){if(!s||!s.length)return[];const t=[];for(let a=0;a<s.length;a+=e)t.push(s.slice(a,a+e));return t}(s.data(),s.pageSize);return{...s,pages:e,pageCount:e.length}})),pe=m(()=>{let s=3;const e=[{title:"Security Rating Overview",page:s++},{title:"Security Overview Statistics",page:s++}];return ve.value.forEach(t=>{t.pageCount&&(e.push({title:t.title,page:s}),s+=t.pageCount)}),e.push({title:"Scan Statistics",page:s++}),e});function me(s,e=0){let t=4;for(const a of ve.value){if(a.key===s)return t+e;t+=a.pageCount}return t}return f(()=>{(async()=>{try{ue.value=!0;const{message:s}=await u();s&&"object"==typeof s&&(ce.first=s.first||null,ce.second=s.second||null,ce.third=s.third||null,ce.fourth=s.fourth||null,ce.fifth=s.fifth||null,ce.sixth=s.sixth||null,ce.malicious_files=s.malicious_files||null,ce.website_vulnerabilities=s.website_vulnerabilities||null,ce.server_security=s.server_security||null)}finally{ue.value=!1}})()}),d({onConfirm:async()=>{if(re.isFree)return void c({source:399});const s=a.loading("Exporting PDF...");try{const s=await t(()=>import("./html2pdf.js?v=1769066082311").then(s=>s.h),__vite__mapDeps([22,2,3,1,4,5,6,7,8])),e=document.getElementById("reportContent");if(!e)return void a.error("Failed to get report content");const i={margin:0,filename:"Security Scan Report_".concat((new Date).toISOString().split("T")[0],".pdf"),image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,allowTaint:!0,scrollX:0,scrollY:0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["css","legacy"]}};await s.default().set(i).from(e).save(),a.success("PDF export successful")}catch(e){a.error("PDF export failed")}finally{s.close()}}}),(s,t)=>{const a=e;return h(),g(a,{show:x(ue),description:"Loading...",class:"p-20px"},{default:w(()=>{var s,e,a,i,n,o,r,c,u,d,v,p,m,_,f,w,re,ue,de,_e,fe,ge,he,we,be,ye,Se,ke,xe,Le,Te,Re,je,Ee,De,He,Me,Ne;return[b("div",D,[b("div",H,[b("div",M,[t[0]||(t[0]=b("div",{class:"logo"},[b("img",{src:l,alt:"Logo"}),b("div",{class:"logo-text"},"aaPanel Security")],-1)),b("div",N,S((new Date).toISOString().split("T")[0]),1)]),b("div",C,[t[5]||(t[5]=b("h1",{class:"report-title"},"Security Scan Report",-1)),b("div",{class:k(["security-level","level-"+((null==(e=null==(s=x(ce).second)?void 0:s.level)?void 0:e.toLowerCase())||"normal")])},[b("div",O,S((null==(a=x(ce).second)?void 0:a.level)||"Unknown"),1),t[1]||(t[1]=b("div",{class:"level-text"},"Security Level",-1))],2),b("div",P,[b("div",I,[b("div",V,[b("div",{innerHTML:x(le),class:"w-24px h-24px text-yellow-500"},null,8,A)]),b("div",z,[b("div",F,S(Number((null==(i=x(ce).fourth)?void 0:i.high_warn)||0)+Number((null==(n=x(ce).fourth)?void 0:n.low_warn)||0)+Number((null==(o=x(ce).fourth)?void 0:o.mid_warn)||0)),1),t[2]||(t[2]=b("div",{class:"stats-label"},"Security Risks",-1))])]),b("div",U,[b("div",W,[b("div",{innerHTML:x(ne),class:"w-24px h-24px text-purple-500"},null,8,B)]),b("div",q,[b("div",K,S((null==(r=x(ce).fourth)?void 0:r.cve_num)||0),1),t[3]||(t[3]=b("div",{class:"stats-label"},"Scan Item",-1))])]),b("div",X,[b("div",Y,[b("div",{innerHTML:x(oe),class:"w-24px h-24px text-blue-500"},null,8,G)]),b("div",J,[b("div",Q,S(Number((null==(c=x(ce).fourth)?void 0:c.web_num)||0)+Number((null==(u=x(ce).fourth)?void 0:u.sys_num)||0)+Number((null==(d=x(ce).fourth)?void 0:d.kernel_num)||0)),1),t[4]||(t[4]=b("div",{class:"stats-label"},"Detection Type",-1))])])])]),b("div",Z,[b("div",$,[b("div",ss,[t[6]||(t[6]=b("div",{class:"info-label"},"Host Name",-1)),b("div",es,S((null==(v=x(ce).first)?void 0:v.host)||"Unknown"),1)]),b("div",ts,[t[7]||(t[7]=b("div",{class:"info-label"},"IP Address",-1)),b("div",as,S((null==(p=x(ce).first)?void 0:p.ip)||"Unknown"),1)]),b("div",is,[t[8]||(t[8]=b("div",{class:"info-label"},"Report Date",-1)),b("div",ls,S((null==(m=x(ce).first)?void 0:m.date)||"Unknown"),1)]),b("div",ns,[t[9]||(t[9]=b("div",{class:"info-label"},"Last Scan",-1)),b("div",os,S((null==(_=x(ce).second)?void 0:_.last_date)||"Unknown"),1)])])]),t[10]||(t[10]=b("div",{class:"cover-footer"},[b("div",{class:"footer-text"},"aaPanel Security Scanning System"),b("div",{class:"footer-note"},"This report provides a comprehensive security assessment of your server.")],-1))]),b("div",rs,[t[12]||(t[12]=b("div",{class:"toc-header"},[b("h2",null,"Table of Contents")],-1)),b("div",cs,[(h(!0),y(L,null,T(x(pe),(s,e)=>(h(),y("div",{class:"toc-item",key:s.title},[b("span",us,S(e+1)+". "+S(s.title),1),t[11]||(t[11]=b("span",{class:"toc-dots"},"...",-1)),b("span",ds,S(s.page),1)]))),128))])]),b("div",vs,[t[14]||(t[14]=b("div",{class:"page-header"},[b("h2",null,"1. Security Rating Overview"),b("div",{class:"page-number"},"3")],-1)),b("div",ps,[b("div",{class:k(["rating-card","level-"+((null==(f=x(ce).second)?void 0:f.total_level.toLowerCase())||"normal")])},[b("div",ms,S((null==(w=x(ce).second)?void 0:w.total_level)||"Unknown"),1),t[13]||(t[13]=b("div",{class:"rating-label"},"Security Level",-1))],2),b("div",_s,[b("div",{class:"rating-reason",innerHTML:(null==(re=x(ce).second)?void 0:re.level_reason)||""},null,8,fs),b("div",gs," Report Date: "+S((null==(ue=x(ce).second)?void 0:ue.date)||""),1),b("div",hs," Last Scan: "+S((null==(de=x(ce).second)?void 0:de.last_date)||""),1)])])]),b("div",ws,[t[19]||(t[19]=b("div",{class:"page-header"},[b("h2",null,"2. Security Overview Statistics"),b("div",{class:"page-number"},"4")],-1)),b("div",bs,[b("div",ys,[b("div",Ss,[b("div",{innerHTML:x(le),class:"w-24px h-24px text-yellow-500"},null,8,ks)]),b("div",xs,[b("div",null,[t[15]||(t[15]=b("div",{class:"stats-label"},"Security Risks",-1)),b("div",{class:k(["stats-value",{"text-warning!":Number((null==(_e=x(ce).fourth)?void 0:_e.high_warn)||0)+Number((null==(fe=x(ce).fourth)?void 0:fe.low_warn)||0)+Number((null==(ge=x(ce).fourth)?void 0:ge.mid_warn)||0)>0}])},S(Number((null==(he=x(ce).fourth)?void 0:he.high_warn)||0)+Number((null==(we=x(ce).fourth)?void 0:we.low_warn)||0)+Number((null==(be=x(ce).fourth)?void 0:be.mid_warn)||0)),3)]),b("div",Ls,[b("span",Ts,"High: "+S((null==(ye=x(ce).fourth)?void 0:ye.high_warn)||0),1),b("span",Rs,"Medium: "+S((null==(Se=x(ce).fourth)?void 0:Se.mid_warn)||0),1),b("span",js,"Low: "+S((null==(ke=x(ce).fourth)?void 0:ke.low_warn)||0),1)])])]),b("div",Es,[b("div",Ds,[b("div",{innerHTML:x(oe),class:"w-24px h-24px text-blue-500"},null,8,Hs)]),b("div",Ms,[t[18]||(t[18]=b("div",{class:"stats-label"},"Virus Database & Scan Types",-1)),b("div",Ns,[b("div",Cs,[t[16]||(t[16]=b("div",{class:"group-title db-label"},"ðŸ¦  Virus Database",-1)),b("div",Os,[b("span",Ps,"Number: "+S((null==(xe=x(ce).fourth)?void 0:xe.cve_num)||0),1)])]),b("div",Is,[t[17]||(t[17]=b("div",{class:"group-title scan-label"},"ðŸ” Scan Types",-1)),b("div",Vs,[b("span",As,"Web risk: "+S((null==(Le=x(ce).fourth)?void 0:Le.web_num)||0),1),b("span",zs,"System risk: "+S((null==(Te=x(ce).fourth)?void 0:Te.sys_num)||0),1),b("span",Fs,"Kernel risk: "+S((null==(Re=x(ce).fourth)?void 0:Re.kernel_num)||0),1)])])])])])])]),(h(!0),y(L,null,T(x(ve),s=>(h(),y(L,null,[(h(!0),y(L,null,T(s.pages,(e,t)=>(h(),y("div",{key:t,class:"report-page content-page"},[b("div",Us,[b("h2",null,[R(S(s.title),1),t>0?(h(),y("span",Ws,"ï¼ˆContinue "+S(t+1)+"ï¼‰",1)):j("",!0)]),b("div",Bs,S(me(s.key,t)),1)]),(h(),g(E(s.component),{data:e,"total-pages":s.pageCount,"page-index":t},null,8,["data","total-pages","page-index"]))]))),128))],64))),256)),b("div",qs,[b("div",Ks,[t[20]||(t[20]=b("h2",null,"Scan Statistics",-1)),b("div",Xs,S(me("stats",0)),1)]),b("div",Ys,[b("div",Gs,[t[21]||(t[21]=b("div",{class:"stats-label"},"Number of Security Scans:",-1)),b("div",Js,S((null==(je=x(ce).third)?void 0:je.warn_times)||0),1)]),b("div",Qs,[t[22]||(t[22]=b("div",{class:"stats-label"},"Number of Vulnerability Scans:",-1)),b("div",Zs,S((null==(Ee=x(ce).third)?void 0:Ee.cve_times)||0),1)]),b("div",$s,[t[23]||(t[23]=b("div",{class:"stats-label"},"Number of Repair Actions:",-1)),b("div",se,S((null==(De=x(ce).third)?void 0:De.repair_times)||0),1)]),b("div",ee,[b("div",te,S((null==(He=x(ce).third)?void 0:He.second_warn)||""),1),b("div",ae,S((null==(Me=x(ce).third)?void 0:Me.second_cve)||""),1),b("div",ie,S((null==(Ne=x(ce).third)?void 0:Ne.repair)||""),1)])])])])]}),_:1},8,["show"])}}}),[["__scopeId","data-v-b88908f0"]]);export{le as default};
