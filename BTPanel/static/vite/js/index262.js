const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ssl-log.js?v=1753954525509","js/index101.js?v=1753954525509","js/vue.js?v=1753954525509","js/__commonjsHelpers__.js?v=1753954525509","js/page_layout.js?v=1753954525509","js/naive.js?v=1753954525509","js/common.js?v=1753954525509","js/public.js?v=1753954525509","css/public.css?v=1753954525509","css/page_layout.css?v=1753954525509","css/index18.css?v=1753954525509","js/index204.js?v=1753954525509","js/index.js?v=1753954525509","css/index99.css?v=1753954525509","js/index.vue_vue_type_script_setup_true_lang.js?v=1753954525509","js/index.vue_vue_type_script_setup_true_lang6.js?v=1753954525509","css/index84.css?v=1753954525509","js/index205.js?v=1753954525509","js/index237.js?v=1753954525509","css/index54.css?v=1753954525509","css/index85.css?v=1753954525509","js/domain-verification.js?v=1753954525509"])))=>i.map(i=>d[i]);
import{d5 as e,a as t,m as a,c as s,o as n,c8 as i,O as l,e as o,_ as d,u as r,w as u,aG as c}from"./page_layout.js?v=1753954525509";import{_}from"./index.js?v=1753954525509";import{_ as p}from"./index102.js?v=1753954525509";import{c as m,s as S,a as h,g as f,b as v}from"./ssl.js?v=1753954525509";import{C as x}from"./cert.js?v=1753954525509";import{u as y}from"./index233.js?v=1753954525509";import{e as w,d as L,ac as g,ad as C,a6 as b,_ as k,b as $,h as j,a2 as P,a3 as E,a4 as B,n as D,f as R,c as O,ae as A,af as N,u as U,ag as I,ah as T,ai as z,j as M,q as F,a5 as V}from"./public.js?v=1753954525509";import{_ as H}from"./index100.js?v=1753954525509";import{cP as J,b$ as q,c5 as G,c6 as X,bY as W,ay as Q,bT as Y,cF as K,cE as Z,cA as ee,_ as te,d1 as ae,D as se}from"./naive.js?v=1753954525509";import{k as ne,P as ie,r as le,c as oe,y as de,U as re,a1 as ue,a2 as ce,X as _e,Q as pe,W as me,a3 as Se,j as he,V as fe,ah as ve,al as xe,_ as ye,F as we,O as Le,H as ge,$ as Ce,e as be,aj as ke,w as $e,o as je,l as Pe,v as Ee,m as Be,x as De}from"./vue.js?v=1753954525509";import{_ as Re}from"./index127.js?v=1753954525509";import{_ as Oe}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1753954525509";import{u as Ae}from"./utils3.js?v=1753954525509";import{A as Ne}from"./index209.js?v=1753954525509";import{_ as Ue}from"./index.vue_vue_type_script_setup_true_lang.js?v=1753954525509";import{a as Ie}from"./ssl-lets-progress.js?v=1753954525509";import{a0 as Te}from"./site.js?v=1753954525509";import"./common.js?v=1753954525509";import"./__commonjsHelpers__.js?v=1753954525509";import"./index237.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang11.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang14.js?v=1753954525509";import"./theme-chrome.js?v=1753954525509";import"./file2.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang9.js?v=1753954525509";import"./index96.js?v=1753954525509";import"./index255.js?v=1753954525509";import"./new.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1753954525509";import"./soft.js?v=1753954525509";import"./index101.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1753954525509";import"./paypal-js.js?v=1753954525509";const ze={class:"cert-info"},Me={class:"cert-label"},Fe={class:"cert-value"},Ve={class:"cert-info"},He={class:"cert-label"},Je={class:"cert-value"},qe={class:"cert-info"},Ge={class:"cert-label"},Xe={class:"cert-value"},We={class:"cert-info"},Qe={class:"cert-label"},Ye={class:"cert-value"},Ke={key:0,class:"text-primary"},Ze={key:1,class:"text-error"},et={class:"cert-info"},tt={class:"cert-label"},at={class:"cert-value"},st={class:"w-48%"},nt={class:"mb-8px"},it={class:"w-48%"},lt={class:"mb-8px"},ot=o(ne({__name:"index",props:{info:{default:null},isRenew:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(o,{expose:d,emit:r}){const u=ye((()=>t((()=>import("./ssl-log.js?v=1753954525509")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])))),c=o,p=r,{t:f}=ie(),{data:v}=y(),$=w(f("SSL.index_43")),j=e(),P=le(-1),E=le(!1),B=le(!1),D=le(""),R=le("");let O="";const A=le("");let N="";const U=le({issuer:"",notAfter:"",notBefore:"",dns:[],subject:"",endtime:0}),I=oe((()=>P.value===x.LetsEncryptDeploy?f("Site.Cert.index_65"):P.value===x.BusinessDeploy?f("Site.Cert.index_64"):P.value===x.TestDeploy?f("Site.Cert.index_38"):f("Site.Cert.index_37"))),T=oe((()=>!!A.value)),z=oe((()=>c.isRenew||P.value===x.LetsEncryptDeploy)),M=oe((()=>!1)),F=oe((()=>E.value)),V=async e=>{e?(await S({siteName:v.name}),p("refresh")):L({title:f("Site.Cert.index_12"),content:f("Site.Cert.index_13"),onConfirm:async()=>{await m({siteName:v.name}),p("refresh")},onPublicClose:()=>{B.value=!0}})},Y=()=>{""!==R.value.trim()&&""!==A.value.trim()?R.value!==O&&O||A.value!==N&&N?L({title:f("Site.Cert.index_10"),content:f("Site.Cert.index_11"),onConfirm:async()=>{await K()}}):K():a.error(f("Site.Cert.index_9"))},K=async()=>{const{message:e}=await g({key:R.value,cert:A.value});s(e)&&e.hash&&(await C({hash:e.hash,domains:JSON.stringify([v.name]),append:1}),a.success(f("SSL.index_32"))),te()},Z=async()=>{var e;const{message:t}=await b({hash:(null==(e=c.info)?void 0:e.hash)||""});s(t)&&($.data.path=t.result,$.show=!0)},ee=async()=>{await h({updateOf:1,siteName:v.name}),te()},te=()=>{p("refresh"),j.setRefresh(!0)};return de((()=>{const{info:e}=c;e&&(P.value=e.type,E.value=e.status,B.value=e.httpTohttps,R.value=e.key||"",O=e.key||"",A.value=e.csr||"",N=e.csr||"",U.value=e.cert_data,D.value=e.index)})),d({init:p("refresh")}),(e,t)=>{const a=n,s=J,o=q,d=G,r=i,c=X,p=H,m=W,S=Q,h=k,f=_,v=l;return re(),ue(v,{show:e.loading},{default:ce((()=>[_e(T)?(re(),ue(c,{key:0,class:"mb-16px",type:"success","show-icon":!1},{default:ce((()=>[pe(r,{"x-gap":12,cols:"15"},{default:ce((()=>[pe(s,{span:"8"},{default:ce((()=>[me("div",ze,[me("div",Me,Se(e.$t("Site.Cert.index_44"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",Fe,[pe(a,null,{default:ce((()=>[he(Se(_e(I)),1)])),_:1})])])])),_:1}),pe(s,{span:"7"},{default:ce((()=>[me("div",Ve,[me("div",He,Se(e.$t("Site.Cert.index_45"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",Je,[pe(o,null,{default:ce((()=>[he(Se(_e(U).issuer),1)])),_:1})])])])),_:1}),pe(s,{span:"8"},{default:ce((()=>[me("div",qe,[me("div",Ge,Se(e.$t("Site.Cert.index_46"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",Xe,[pe(o,null,{default:ce((()=>[he(Se(_e(U).dns.join(e.$t("Public.Punctuation.Comma"))),1)])),_:1})])])])),_:1}),pe(s,{span:"7"},{default:ce((()=>[me("div",We,[me("div",Qe,Se(e.$t("Site.Cert.index_47"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",Ye,[_e(U).endtime>0?(re(),fe("span",Ke,Se(e.$t("Site.Cert.index_48",{date:_e(U).notAfter,days:_e(U).endtime})),1)):(re(),fe("span",Ze,Se(e.$t("Site.Cert.index_47")),1))])])])),_:1}),pe(s,{span:"8"},{default:ce((()=>[me("div",et,[me("div",tt,Se(e.$t("Site.Cert.index_49"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",at,[pe(d,{value:_e(B),"onUpdate:value":[t[0]||(t[0]=e=>ve(B)?B.value=e:null),V],size:"small"},null,8,["value"])])])])),_:1})])),_:1})])),_:1})):xe("",!0),pe(m,{class:"mb-16px",size:10,justify:"space-between"},{default:ce((()=>[me("div",st,[me("div",nt,Se(e.$t("Site.Cert.index_50")),1),pe(p,{value:_e(R),"onUpdate:value":t[1]||(t[1]=e=>ve(R)?R.value=e:null),rows:10},null,8,["value"])]),me("div",it,[me("div",lt,Se(e.$t("Site.Cert.index_51")),1),pe(p,{value:_e(A),"onUpdate:value":t[2]||(t[2]=e=>ve(A)?A.value=e:null),rows:10},null,8,["value"])])])),_:1}),pe(m,{class:"mb-12px"},{default:ce((()=>[pe(S,{type:"primary",onClick:Y},{default:ce((()=>[he(Se(_e(E)?e.$t("Public.Btn.Save"):e.$t("Site.Cert.index_52")),1)])),_:1}),_e(z)?(re(),ue(S,{key:0,type:"primary",onClick:Z},{default:ce((()=>[he(Se(e.$t("Site.Cert.index_53")),1)])),_:1})):xe("",!0),_e(M)?(re(),ue(S,{key:1},{default:ce((()=>[he(Se(e.$t("Site.Cert.index_54")),1)])),_:1})):xe("",!0),_e(F)?(re(),ue(S,{key:2,onClick:ee},{default:ce((()=>[he(Se(e.$t("Site.Cert.index_55")),1)])),_:1})):xe("",!0)])),_:1}),pe(h,null,{default:ce((()=>[me("li",null,Se(e.$t("Site.Cert.index_33")),1),me("li",null,Se(e.$t("Site.Cert.index_34")),1),me("li",null,Se(e.$t("Site.Cert.index_35")),1),me("li",null,Se(e.$t("Site.Cert.index_36")),1)])),_:1}),pe(f,{show:_e($).show,"onUpdate:show":t[3]||(t[3]=e=>_e($).show=e),title:_e($).title,data:_e($).data,width:650,"min-height":450,component:_e(u)},null,8,["show","title","data","component"])])),_:1},8,["show"])}}}),[["__scopeId","data-v-e1d3f276"]]),dt={class:"flex flex-wrap bg-#dff0d8 border-#d6e9c6 border-1px rounded-5px p-12px"},rt={class:"text-#3c763d w-100%"},ut=ne({__name:"top-tips",setup(e){const{t:t}=ie(),a=[t("SSL.SiteSSL.index_5"),t("SSL.SiteSSL.index_6"),t("SSL.SiteSSL.index_7"),t("SSL.SiteSSL.index_8"),t("SSL.SiteSSL.index_9"),t("SSL.SiteSSL.index_10"),t("SSL.SiteSSL.index_11")];return(e,t)=>{const s=d,n=W;return re(),fe("div",dt,[(re(),fe(we,null,Le(a,((e,t)=>pe(n,{size:5,key:e,class:ge(["flex-nowrap! leading-20px",{"w-33%":t!==a.length-1}])},{default:ce((()=>[pe(s,{name:"base-tick",size:16,color:"#ff8d00"}),me("span",rt,Se(e),1)])),_:2},1032,["class"]))),64))])}}}),ct={class:"my-10px"},_t=ne({__name:"table",setup(a){const n=ye((()=>t((()=>import("./index204.js?v=1753954525509")),__vite__mapDeps([11,12,2,3,6,7,4,5,9,8,13,14,15,16])))),i=ye((()=>t((()=>import("./index205.js?v=1753954525509")),__vite__mapDeps([17,18,2,3,5,6,4,7,8,9,19,20])))),l=ye((()=>t((()=>import("./domain-verification.js?v=1753954525509")),__vite__mapDeps([21,4,2,3,5,6,7,8,9,14])))),o=r(),{userInfo:d}=Ce(o),u=e(),{t:c}=ie(),p=be({p:1,limit:9999}),m=w(c("SSL.Business.index_41"),{onRefresh:(e,t)=>{f.data.request=!0,f.data.uc_id=t,f.data.verify=e,f.show=!0,g()}}),S=w(c("SSL.index_44")),h=w(c("SSL.index_49"),{onRefresh:()=>{g(),u.setRefresh(!0)}}),f=w(c("SSL.Business.index_42"),{onRefresh:()=>{g()}}),{table:v,columns:x}=$([{key:"verify_domains",title:c("Layout.Sider.mail_3"),render:e=>pe("span",{innerHTML:e.verify_domains&&e.verify_domains.length>0?e.verify_domains.join("<br/>"):"--"},null)},{key:"title",title:c("Site.Cert.index_44"),render:e=>e.order_info.title,ellipsis:{tooltip:!0}},Ae({title:c("SSL.index_54")}),{key:"order_status",title:c("SSL.Business.index_43"),render:e=>{const t=e.order_info;return t.certId||t.domains.length?!t.certId&&t.domains.length?pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_45"),he(" ")]):"PENDING"===t.order_status&&1===t.status?pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_46"),he(" ")]):"COMPLETE"===t.order_status&&1===t.status?pe("span",{class:"color-#20a53a"},[he(" "),c("SSL.Business.index_47"),he(" ")]):"CANCELLED"===t.order_status&&1===t.status||-1===t.status?pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_48"),he(" ")]):"FAILED"===t.order_status&&1===t.status?pe("span",{class:"color-error"},[he(" "),c("SSL.Business.index_49"),he(" ")]):"EXPIRED"===t.order_status&&1===t.status?pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_50"),he(" ")]):1!==t.status||["PENDING","COMPLETE","CANCELLED","FAILED","EXPIRED"].includes(t.order_status)?0===t.status?pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_52"),he(" ")]):void 0:pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_51"),he(" ")]):pe("span",{class:"color-warning cursor-pointer",onClick:()=>y(e)},[" ",c("SSL.Business.index_44")," "])}},j({width:140,options:e=>[{show:!e.order_info.certId&&!e.order_info.domains.length,label:c("SSL.Business.index_53"),onClick:()=>{y(e)}},{show:"PENDING"===e.order_info.order_status&&1===e.order_info.status,label:c("SSL.Business.index_54"),onClick:async()=>{const{message:t}=await P({uc_id:e.order_info.uc_id});s(t)&&(f.data.uc_id=e.order_info.uc_id,f.data.verify=t.data,f.data.paths=t.paths,f.show=!0)}},{show:"COMPLETE"===e.order_info.order_status&&1===e.order_info.status,label:c("SSL.index_58"),onClick:async()=>{h.data.row=e,h.show=!0}},{show:"COMPLETE"===e.order_info.order_status&&1===e.order_info.status,label:c("Ftp.Label.index_11"),onClick:async()=>{const t=window.location.origin+"/v2/business_ssl?action=download_cert&uc_id="+e.order_info.uc_id;window.open(t)}},{show:!1,label:c("Public.Btn.Del"),onClick:()=>{L({title:c("SSL.index_59"),content:c("SSL.index_60"),onConfirm:async()=>{await E({hash:e.hash}),g()}})}}]})]),y=e=>{m.data.row=e,m.show=!0},g=async()=>{try{v.loading=!0;const{message:e}=await B(p);s(e)&&(v.data=e.data,v.total=e.total)}finally{v.loading=!1}};return d.value.status&&g(),(e,t)=>{const a=Q,s=R,o=Oe,r=_,u=Re;return re(),fe("div",ct,[pe(u,{install:_e(d).status},{desc:ce((()=>[t[5]||(t[5]=me("span",{class:"mr-10px"},"Business certificates require login panel to start using them",-1)),pe(a,{type:"primary",onClick:_e(D)},{default:ce((()=>[he(Se(e.$t("Login.index_3")),1)])),_:1},8,["onClick"])])),default:ce((()=>[pe(o,null,{toolsLeft:ce((()=>[pe(a,{type:"primary",onClick:t[0]||(t[0]=e=>_e(S).show=!0)},{default:ce((()=>[he(Se(_e(c)("SSL.index_44")),1)])),_:1})])),table:ce((()=>[pe(s,{loading:_e(v).loading,data:_e(v).data,columns:_e(x),"max-height":220},null,8,["loading","data","columns"])])),_:1}),pe(r,{show:_e(S).show,"onUpdate:show":t[1]||(t[1]=e=>_e(S).show=e),title:_e(S).title,data:_e(S).data,"min-height":250,component:Ne},null,8,["show","title","data"]),pe(r,{show:_e(m).show,"onUpdate:show":t[2]||(t[2]=e=>_e(m).show=e),title:_e(m).title,data:_e(m).data,width:650,"min-height":450,component:_e(n)},null,8,["show","title","data","component"]),pe(r,{show:_e(h).show,"onUpdate:show":t[3]||(t[3]=e=>_e(h).show=e),title:_e(h).title,data:_e(h).data,width:720,height:530,component:_e(i)},null,8,["show","title","data","component"]),pe(r,{show:_e(f).show,"onUpdate:show":t[4]||(t[4]=e=>_e(f).show=e),title:_e(f).title,data:_e(f).data,width:650,"min-height":450,component:_e(l)},null,8,["show","title","data","component"])])),_:1},8,["install"])])}}}),pt={class:"text-error"};const mt=o({},[["render",function(e,t){const a=n,s=k;return re(),ue(s,null,{default:ce((()=>[me("li",pt,Se(e.$t("SSL.SiteSSL.index_1")),1),me("li",null,Se(e.$t("SSL.SiteSSL.index_2")),1),me("li",null,Se(e.$t("SSL.SiteSSL.index_3")),1),me("li",null,[he(Se(e.$t("SSL.SiteSSL.index_4"))+" ",1),pe(a,{href:"https://www.aapanel.com/docs/Function/BusinessCertificate.html",target:"_blank"},{default:ce((()=>[he(Se(e.$t("SSL.Business.index_20")),1)])),_:1})])])),_:1})}]]),St=ne({__name:"index",setup:e=>(e,t)=>(re(),fe("div",null,[pe(ut),pe(_t),pe(mt)]))}),ht={class:"cert-info"},ft={class:"cert-label"},vt={class:"cert-value"},xt={class:"cert-info"},yt={class:"cert-label"},wt={class:"cert-value"},Lt={class:"cert-info"},gt={class:"cert-label"},Ct={class:"cert-value"},bt={class:"cert-info"},kt={class:"cert-label"},$t={class:"cert-value"},jt={key:0,class:"text-primary"},Pt={key:1,class:"text-error"},Et={class:"w-48%"},Bt={class:"mb-8px"},Dt={class:"w-48%"},Rt={class:"mb-8px"},Ot=o(ne({__name:"cert",emits:["update"],setup(a,{emit:n}){const o=ye((()=>t((()=>import("./ssl-log.js?v=1753954525509")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])))),d=n,{t:r}=ie(),{data:u}=y(),c=w(r("SSL.index_43")),p=e(),m=le(!1),S=le(1),v=le(""),x=le(""),L=be({hash:"",issuer:"",notAfter:"",notBefore:"",dns:[],subject:"",endtime:0}),g=async()=>{const{message:e}=await b({hash:L.hash});s(e)&&(c.data.path=e.result,c.show=!0)},C=async()=>{await h({updateOf:1,siteName:u.name}),d("update"),p.setRefresh(!0)},{loading:$,setLoading:j}=O();return(async()=>{try{j(!0);const{message:e}=await f({siteName:u.name});s(e)&&(m.value=e.status,L.hash=e.hash,L.issuer=e.cert_data.issuer,L.notAfter=e.cert_data.notAfter,L.notBefore=e.cert_data.notBefore,L.dns=e.cert_data.dns,L.subject=e.cert_data.subject,L.endtime=e.cert_data.endtime,v.value=e.key,x.value=e.csr,S.value=e.auto_renew)}finally{j(!1)}})(),(e,t)=>{const a=J,s=q,n=i,d=X,r=H,u=W,p=Q,m=k,h=_,f=l;return re(),ue(f,{show:_e($)},{default:ce((()=>[pe(d,{class:"mb-16px",type:"success","show-icon":!1},{default:ce((()=>[pe(n,{"x-gap":12,cols:"15"},{default:ce((()=>[_e(S)?(re(),ue(a,{key:0,span:"16"},{default:ce((()=>[me("div",ht,[me("div",ft,Se(e.$t("SSL.SiteSSL.index_22"))+"：",1),me("div",vt,Se(e.$t("SSL.SiteSSL.index_23")),1)])])),_:1})):xe("",!0),pe(a,{span:"7"},{default:ce((()=>[me("div",xt,[me("div",yt,Se(e.$t("Site.Cert.index_45"))+"：",1),me("div",wt,[pe(s,null,{default:ce((()=>[he(Se(_e(L).issuer),1)])),_:1})])])])),_:1}),pe(a,{span:"8"},{default:ce((()=>[me("div",Lt,[me("div",gt,Se(e.$t("Site.Cert.index_46"))+"：",1),me("div",Ct,[pe(s,null,{default:ce((()=>[he(Se(_e(L).dns.join(e.$t("Public.Punctuation.Comma"))),1)])),_:1})])])])),_:1}),pe(a,{span:"7"},{default:ce((()=>[me("div",bt,[me("div",kt,Se(e.$t("Site.Cert.index_47"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",$t,[_e(L).endtime>0?(re(),fe("span",jt,Se(e.$t("Site.Cert.index_48",{date:_e(L).notAfter,days:_e(L).endtime})),1)):(re(),fe("span",Pt,Se(e.$t("Site.Cert.index_47")),1))])])])),_:1})])),_:1})])),_:1}),pe(u,{class:"mb-16px",size:10,justify:"space-between"},{default:ce((()=>[me("div",Et,[me("div",Bt,Se(e.$t("Site.Cert.index_50")),1),pe(r,{readonly:"",value:_e(v),"onUpdate:value":t[0]||(t[0]=e=>ve(v)?v.value=e:null),rows:14},null,8,["value"])]),me("div",Dt,[me("div",Rt,Se(e.$t("Site.Cert.index_51")),1),pe(r,{readonly:"",value:_e(x),"onUpdate:value":t[1]||(t[1]=e=>ve(x)?x.value=e:null),rows:14},null,8,["value"])])])),_:1}),pe(u,{class:"mb-12px"},{default:ce((()=>[pe(p,{type:"primary",onClick:g},{default:ce((()=>[he(Se(e.$t("Site.Cert.index_53")),1)])),_:1}),pe(p,{onClick:C},{default:ce((()=>[he(Se(e.$t("Site.Cert.index_55")),1)])),_:1})])),_:1}),pe(m,null,{default:ce((()=>[me("li",null,Se(e.$t("SSL.SiteSSL.index_24")),1),me("li",null,Se(e.$t("SSL.SiteSSL.index_25")),1)])),_:1}),pe(h,{show:_e(c).show,"onUpdate:show":t[2]||(t[2]=e=>_e(c).show=e),title:_e(c).title,data:_e(c).data,width:650,"min-height":450,component:_e(o)},null,8,["show","title","data","component"])])),_:1},8,["show"])}}}),[["__scopeId","data-v-f7890837"]]),At={class:"flex items-center"},Nt={class:"leading-17px"},Ut={class:"w-full"},It={class:"w-full"},Tt={class:"text-error"},zt=ne({__name:"apply",emits:["update"],setup(t,{emit:n}){const i=ke(),{t:o}=ie(),{data:r}=y(),_=e(),p=n,m=be({auth_type:"http",dns_manual:0,auto_wildcard:0,domains:[],all:!1}),S={domains:{required:!0,trigger:"change",type:"array",message:o("SSL.SiteSSL.index_16")}},h=le(null),f=le([]),v=e=>{var t;return null==(t=f.value.find((t=>t.name===e)))?void 0:t.auto},x=()=>{i.push("/ssl_domain/domain")},w=oe((()=>m.domains.length>0&&m.domains.length<f.value.length));$e((()=>m.domains),(e=>{e.length===f.value.length?m.all=!0:e.length||(m.all=!1)})),$e((()=>m.all),(e=>{var t;e?(m.domains=f.value.map((e=>e.name)),null==(t=h.value)||t.validate()):m.domains=[]})),$e((()=>m.auth_type),(e=>{var t;"dns"===e?(m.domains=f.value.filter((e=>e.auto)).map((e=>e.name)),null==(t=h.value)||t.validate()):m.domains=[]}));const L=oe((()=>m.domains.filter((e=>!v(e))))),g=async()=>{var e;if(await(null==(e=h.value)?void 0:e.validate()),"dns"===m.auth_type&&L.value.length&&!m.dns_manual)return void a.error({content:()=>Be("span",{innerHTML:"".concat(L.value.join("<br/>")).concat(o("SSL.SiteSSL.index_14"))})});let t={auth_type:m.dns_manual?"dns_manual":m.auth_type,auto_wildcard:m.auto_wildcard,domains:JSON.stringify(m.domains),site_id:m.dns_manual?r.id:void 0,deploy:m.dns_manual?0:1};if(m.dns_manual&&"dns"===m.auth_type){const{message:e}=await A({site_id:r.id,domains:JSON.stringify(m.domains)});if(s(e)&&Object.keys(e).length)return void N(e.auths,r.id,m.domains,(()=>{p("update"),_.setRefresh(!0)}),!0);const n=U({width:500,height:300,hideClose:!0,component:I});try{const{message:e}=await T(t,!1);s(e)&&(e.deploy?(a.success(e.result||o("SSL.index_32")),p("update"),_.setRefresh(!0)):Array.isArray(e.auths)&&e.auths.length&&N(e.auths,r.id,m.domains,(()=>{p("update"),_.setRefresh(!0)})))}catch(i){z(Y(i,"message",""))}finally{n.hide()}return}const{message:n}=await T(t);s(n)&&U({hideClose:!0,data:{isJump:!1,task_id:n.task_id,onFinish:()=>{p("update"),_.setRefresh(!0)}},component:Ie})},{loading:C,setLoading:b}=O();return je((()=>{(async()=>{try{b(!0);const{message:e}=await Te({id:r.id});if(u(e)){const t=e.map((async e=>{const{message:t}=await M({domain:e.name});s(t)&&f.value.push({name:e.name,auto:!!t.hash})}));await Promise.all(t)}}finally{b(!1)}})()})),(e,t)=>{const a=d,s=X,n=K,i=c,o=Z,r=ee,u=te,_=W,p=ae,y=se,b=l,$=Q,j=Ue,P=k;return re(),fe("div",null,[Pe(pe(s,{"show-icon":!1,class:"mb-10px"},{default:ce((()=>[me("div",At,[pe(a,{name:"base-info",size:"17",class:"mr-8px"}),me("span",Nt,Se(e.$t("SSL.SiteSSL.index_12")),1)])])),_:1},512),[[Ee,"dns"===_e(m).auth_type]]),pe(j,{ref_key:"formRef",ref:h,model:_e(m),rules:S,"label-width":"140"},{default:ce((()=>[pe(r,{label:e.$t("Config.Safe.Ssl.index_2")},{default:ce((()=>[pe(o,{value:_e(m).auth_type,"onUpdate:value":t[0]||(t[0]=e=>_e(m).auth_type=e)},{default:ce((()=>[pe(i,null,{default:ce((()=>[pe(n,{value:"http"},{default:ce((()=>[he(Se(e.$t("SSL.SiteSSL.index_17")),1)])),_:1}),pe(n,{value:"dns"},{default:ce((()=>[he(Se(e.$t("SSL.index_12"))+" (Wildcard support) ",1)])),_:1})])),_:1})])),_:1},8,["value"])])),_:1},8,["label"]),Pe(pe(r,{label:" ","show-feedback":!1},{default:ce((()=>[pe(u,{checked:_e(m).dns_manual,"onUpdate:checked":t[1]||(t[1]=e=>_e(m).dns_manual=e),"checked-value":1,"unchecked-value":0},{default:ce((()=>[he(Se(e.$t("SSL.index_2")),1)])),_:1},8,["checked"])])),_:1},512),[[Ee,"dns"===_e(m).auth_type]]),Pe(pe(r,{label:" "},{default:ce((()=>[pe(u,{checked:_e(m).auto_wildcard,"onUpdate:checked":t[2]||(t[2]=e=>_e(m).auto_wildcard=e),"checked-value":1,"unchecked-value":0},{default:ce((()=>[he(Se(e.$t("SSL.SiteSSL.index_20")),1)])),_:1},8,["checked"])])),_:1},512),[[Ee,"dns"===_e(m).auth_type]]),pe(r,{label:e.$t("Mail.Domain.index_3"),path:"domains"},{default:ce((()=>[pe(b,{show:_e(C),class:"p-12px w-300px max-h-300px min-h-100px overflow-auto border border-solid border-#ccc"},{default:ce((()=>[pe(u,{class:"mb-12px",checked:_e(m).all,"onUpdate:checked":t[3]||(t[3]=e=>_e(m).all=e),label:e.$t("Public.SelectAll"),indeterminate:_e(w)},null,8,["checked","label","indeterminate"]),_e(f).length?(re(),ue(p,{key:0,value:_e(m).domains,"onUpdate:value":t[4]||(t[4]=e=>_e(m).domains=e)},{default:ce((()=>[pe(_,{class:"flex-col!",size:12},{default:ce((()=>[(re(!0),fe(we,null,Le(_e(f),(e=>(re(),ue(u,{key:e.name,value:e.name,label:e.name},null,8,["value","label"])))),128))])),_:1})])),_:1},8,["value"])):(re(),ue(y,{key:1,description:"No domain name"}))])),_:1},8,["show"])])),_:1},8,["label"]),Pe(pe(r,{label:" "},{default:ce((()=>[pe(s,{"show-icon":!1,type:_e(L).length?"warning":"success"},{default:ce((()=>[(re(!0),fe(we,null,Le(_e(m).domains,(t=>(re(),ue(_,{key:t},{default:ce((()=>[v(t)?(re(),ue(_,{key:0,class:"flex-nowrap! py-3px"},{default:ce((()=>[pe(a,{name:"base-success",size:"17",color:"#20a53a"}),me("span",Ut,"["+Se(t)+"] "+Se(e.$t("SSL.SiteSSL.index_13")),1)])),_:2},1024)):(re(),ue(_,{key:1,class:"flex-nowrap! py-3px items-center!"},{default:ce((()=>[pe(a,{name:"base-error",size:"17",color:"#E85445"}),me("span",It,"["+Se(t)+"] "+Se(e.$t("SSL.SiteSSL.index_14")),1),pe($,{type:"primary",size:"tiny",onClick:x},{default:ce((()=>[he(Se(e.$t("SSL.SiteSSL.index_21")),1)])),_:1})])),_:2},1024))])),_:2},1024)))),128))])),_:1},8,["type"])])),_:1},512),[[Ee,"dns"===_e(m).auth_type&&_e(m).domains.length&&!_e(m).dns_manual]]),pe(r,{label:" "},{default:ce((()=>[pe($,{type:"primary",onClick:g},{default:ce((()=>[he(Se(e.$t("Public.Btn.Apply")),1)])),_:1})])),_:1})])),_:1},8,["model"]),Pe(pe(P,{class:"mt-16px"},{default:ce((()=>[me("li",Tt,Se(e.$t("SSL.SiteSSL.index_15")),1),me("li",null,Se(e.$t("Site.Cert.index_21")),1),me("li",null,Se(e.$t("Site.Cert.index_23")),1),me("li",null,Se(e.$t("Site.Cert.index_24")),1)])),_:1},512),[[Ee,"http"===_e(m).auth_type]]),Pe(pe(P,{class:"mt-24px"},{default:ce((()=>[t[5]||(t[5]=me("li",null,"Manually resolved certificates do not support auto-renewal",-1)),me("li",null,Se(e.$t("Site.Cert.index_25")),1),me("li",null,Se(e.$t("Site.Cert.index_26")),1),me("li",null,Se(e.$t("Site.Cert.index_27")),1),me("li",null,Se(e.$t("Site.Cert.index_28")),1)])),_:1,__:[5]},512),[[Ee,"dns"===_e(m).auth_type]])])}}}),Mt=ne({__name:"index",props:{isOpen:{type:Boolean},type:{},onRefresh:{type:Function}},setup(e){const t=e,a=()=>{t.onRefresh()};return(e,s)=>(re(),fe("div",null,[t.isOpen&&"Let's Encrypt"===t.type?(re(),ue(Ot,{key:0,onUpdate:a})):(re(),ue(zt,{key:1,onUpdate:a}))]))}}),Ft=ne({__name:"index",props:{onMenuChange:{type:Function}},setup(e,{expose:t}){const{data:n}=y(),{t:i}=ie(),l=be({p:1,limit:99999}),{columns:o,table:d}=$([{key:"domain",title:i("Site.Cert.index_29"),render:e=>pe("span",{innerHTML:e.verify_domains.length>0?e.verify_domains.join("<br/>"):"--"},null)},Ae({title:i("SSL.index_54"),width:140}),{key:"issuer",title:i("Site.Cert.index_30"),ellipsis:{tooltip:!0}},j({width:150,options:t=>[{label:i("Public.Btn.Deploy"),onClick:async()=>{try{await C({hash:t.hash,domains:JSON.stringify([n.name]),append:1}),a.success(i("SSL.index_32")),setTimeout((()=>{e.onMenuChange()}),500)}catch(s){console.log(s)}}},{show:"Let's Encrypt"===t.provider,label:i("Public.Btn.Del"),onClick:()=>{(e=>{F({title:i("Site.Cert.index_31"),content:i("Site.Cert.index_32"),onConfirm:async()=>{await E({hash:e.hash}),c()}})})(t)}}]})]),{loading:r,setLoading:u}=O(!0),c=async()=>{try{u(!0);const{message:e}=await V(l);s(e)&&(d.data=e.data)}finally{u(!1)}};return c(),t({init:c}),(e,t)=>{const a=R;return re(),fe("div",null,[pe(a,{loading:_e(r),columns:_e(o),data:_e(d).data,"max-height":510},null,8,["loading","columns","data"])])}}}),Vt={class:"mr-12px"},Ht={key:0,class:"mr-12px"},Jt={key:1,class:"mr-12px"},qt=ne({__name:"index",setup(a,{expose:n}){const i=ye((()=>t((()=>import("./ssl-log.js?v=1753954525509")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])))),l=e(),{data:o}=y(),{t:d}=ie(),r=le("current"),u=le(""),c=w(d("SSL.index_43")),m=le(x.NotDeploy),S=le(""),h=le(!1),f=le(0),L=le(!1),g=le(""),C=async()=>{const{message:e}=await b({hash:u.value});s(e)&&(c.data.path=e.result,c.show=!0)},k=e=>{j.value[0].data&&(j.value[0].data.loading=e)},$=async()=>{try{k(!0);const{message:a}=await v({siteName:o.name});s(a)&&(m.value=a.type,h.value=a.status,f.value=Y(a,"cert_data.endtime",0),g.value=a.cert_data.issuer_O||"",L.value=(()=>{let e=!1;return f.value<=30&&(e=!0),m.value===x.TestDeploy&&f.value<0&&(e=!0),m.value!==x.SaveOrHolderDeploy&&m.value!==x.NotDeploy||(e=!1),e})(),S.value=a.cert_data.dns.join(","),u.value=a.hash,t=a,j.value[0].data&&(j.value[0].data.info=t),e=L.value,j.value[0].data&&(j.value[0].data.isRenew=e))}catch(a){h.value=!1,L.value=!1}finally{k(!1)}var e,t},j=le([{key:"current",label:()=>pe("div",null,[pe("span",null,[he("Current Certs - ")]),pe("span",{class:h.value?"text-#1d9534":"text-red-500"},[he("["),h.value?"Deployed":"Not Deployed",he("]")])]),data:{info:null,isRenew:!1,loading:!0,onRefresh:$},component:De(ot)},{key:"business",label:d("Site.Cert.index_64"),component:De(St)},{key:"let",label:d("Site.Cert.index_65"),data:{isOpen:oe((()=>h.value)),type:oe((()=>g.value)),onRefresh:$},component:De(Mt)},{key:"holder",label:d("Site.Cert.index_66"),component:De(Ft),data:{onMenuChange:()=>{r.value="current",$(),l.setRefresh(!0)}}}]);return n({init:()=>{$()}}),(e,t)=>{const a=Q,s=X,n=p,l=_;return re(),fe("div",null,[_e(h)?xe("",!0):(re(),ue(s,{key:0,class:"mb-12px",type:"error","show-icon":!1,style:{"--n-padding":"9px 16px"}},{default:ce((()=>[me("span",Vt,Se(e.$t("Site.Cert.index_41")),1),pe(a,{size:"tiny",type:"primary",onClick:t[0]||(t[0]=e=>r.value="business")},{default:ce((()=>[he(Se(e.$t("Site.Cert.index_43")),1)])),_:1})])),_:1})),_e(h)&&_e(L)?(re(),ue(s,{key:1,class:"mb-12px",type:"error","show-icon":!1,style:{"--n-padding":"9px 16px"}},{default:ce((()=>[_e(f)>0?(re(),fe("span",Ht,Se(e.$t("SSL.SiteSSL.index_26",[_e(S),_e(f)])),1)):(re(),fe("span",Jt,Se(e.$t("SSL.SiteSSL.index_19",[_e(S)])),1)),pe(a,{size:"tiny",type:"primary",onClick:C},{default:ce((()=>[he(Se(e.$t("Site.Cert.index_53")),1)])),_:1})])),_:1})):xe("",!0),pe(n,{value:_e(r),"onUpdate:value":t[1]||(t[1]=e=>ve(r)?r.value=e:null),options:_e(j)},null,8,["value","options"]),pe(l,{show:_e(c).show,"onUpdate:show":t[2]||(t[2]=e=>_e(c).show=e),title:_e(c).title,data:_e(c).data,width:650,"min-height":450,component:_e(i)},null,8,["show","title","data","component"])])}}});export{qt as default};
