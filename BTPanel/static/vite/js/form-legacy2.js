System.register(["./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy20.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy10.js?v=1769066082311","./vue-legacy.js?v=1769066082311","./page_layout-legacy.js?v=1769066082311","./public-legacy.js?v=1769066082311","./alarm-legacy.js?v=1769066082311","./naive-legacy.js?v=1769066082311","./index-legacy220.js?v=1769066082311","./__commonjsHelpers__-legacy.js?v=1769066082311","./common-legacy.js?v=1769066082311"],function(e,l){"use strict";var a,t,u,n,i,r,d,s,o,v,p,_,m,c,f,y,g,h,b,x,w,k,U,j,$,C,A,E,M,P,R,S,B,D,O,H,I,T,F,V,W,G,L,Y,q,z,J,K,N;return{setters:[e=>{a=e._},e=>{t=e._},e=>{u=e._},e=>{n=e.k,i=e.R,r=e.V,d=e.ad,s=e.ae,o=e.t,v=e.c,p=e.F,_=e.S,m=e.an,c=e.W,f=e.U,y=e.I,g=e.a4,h=e.a3,b=e.a2,x=e.j,w=e.O,k=e.a7,U=e.P,j=e.a0,$=e.r,C=e.e,A=e.x,E=e.ak,M=e.n},e=>{P=e.aI,R=e.k,S=e.u,B=e.d,D=e.x,O=e.cl},e=>{H=e._,I=e.d,T=e.b},e=>{F=e.j,V=e.h,W=e.i},e=>{G=e.dW,L=e.av,Y=e.dg,q=e.d_,z=e.dU,J=e.dV,K=e.dS},e=>{N=e._},null,null],execute:function(){const l=n({__name:"form-template-field-none",props:{field:{}},setup:e=>(e,l)=>(r(),i("div"))}),Q={key:0,class:"ml-10px whitespace-pre"},X=n({__name:"form-template-field-select",props:d({field:{}},{value:{default:null},valueModifiers:{}}),emits:["update:value"],setup(e){const l=e,a=s(e,"value"),t=o(l,"field"),u=v(()=>t.value.items.map(e=>({label:`${e.title}${t.value.unit||""}`,value:e.value})));return(e,l)=>{const n=G;return r(),i(p,null,[_("div",{style:y({width:f(t).width?"160px":"260px"})},[c(n,{value:a.value,"onUpdate:value":l[0]||(l[0]=e=>a.value=e),disabled:f(t).disabled,options:f(u)},null,8,["value","disabled","options"])],4),f(t).suffix?(r(),i("div",Q,g(f(t).suffix),1)):m("",!0)],64)}}}),Z={key:0,class:"ml-10px whitespace-pre"},ee=n({__name:"form-template-field-number",props:d({field:{}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(e){const l=o(e,"field"),a=s(e,"value"),t=()=>{a.value||(a.value=l.value.default)};return(e,u)=>{const n=Y,d=q,s=L;return r(),i(p,null,[_("div",null,[c(s,null,{default:h(()=>[c(n,{value:a.value,"onUpdate:value":u[0]||(u[0]=e=>a.value=e),class:"w-100px",min:1,"show-button":!1,placeholder:"",onBlur:t},null,8,["value"]),f(l).unit?(r(),b(d,{key:0,class:"min-w-52px text-center"},{default:h(()=>[x(g(f(l).unit),1)]),_:1})):m("",!0)]),_:1})]),f(l).suffix?(r(),i("span",Z,g(f(l).suffix),1)):m("",!0)],64)}}}),le=n({__name:"form-template-field-radio",props:d({field:{}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(e){const l=e,a=s(e,"value"),t=o(l,"field");return(e,l)=>{const u=J,n=z;return r(),b(n,{value:a.value,"onUpdate:value":l[0]||(l[0]=e=>a.value=e)},{default:h(()=>[(r(!0),i(p,null,w(f(t).items,e=>(r(),b(u,{key:e.value,value:e.value},{default:h(()=>[x(g(e.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])}}}),ae=n({__name:"form-template-field-help",props:{field:{}},setup:e=>(e,l)=>{const a=H;return r(),b(a,null,{default:h(()=>[(r(!0),i(p,null,w(e.field.list,e=>(r(),i("li",{key:e},g(e),1))),128))]),_:1})}}),te=n({__name:"form-template-field",props:d({field:{}},{value:{},valueModifiers:{}}),emits:d(["change"],["update:value"]),setup(e,{emit:a}){const t=e,u=a,n=s(e,"value"),i=o(t,"field"),d=(()=>{switch(i.value.type){case"select":return X;case"number":return ee;case"radio":return le;case"help":return ae;default:return l}})(),v=e=>{u("change",e,i.value.attr)};return(e,l)=>(r(),b(k(f(d)),{value:n.value,"onUpdate:value":[l[0]||(l[0]=e=>n.value=e),v],field:f(i)},null,40,["value","field"]))}}),ue=n({__name:"form-template",props:d({type:{default:"none"},template:{default:()=>({field:[],sorted:[]})}},{value:{default:()=>({})},valueModifiers:{}}),emits:["update:value"],setup(e,{expose:l}){const a=e,{t:t}=U(),u=o(a,"type"),n=o(a,"template"),d=s(e,"value"),_=v(()=>{const{field:e,sorted:l}=n.value,a=[];return l.forEach(l=>{const t=[];l.forEach(l=>{const a=e.find(e=>e.attr===l);a&&t.push(a)}),a.push(t)}),a}),y=(e,l)=>{"system_disk"===u.value&&"cycle"===l&&g(),"project_status"===u.value&&"cycle"===l&&x()},g=()=>{const{cycle:e}=d.value;switch(e){case 1:n.value.field[2].unit="GB",n.value.field[2].name=t("Config.Alarm.index_26");break;case 2:n.value.field[2].unit="%",n.value.field[2].name=t("Config.Alarm.index_27")}},x=()=>{const{field:e}=n.value,[,l]=e,{all_items:a}=l;if(a&&P(d.value.cycle)){const e=a[R(d.value.cycle)-1];e.length>0?(l.items=e,d.value.project=e[0].value):(l.items=[],d.value.project=null)}},k=()=>{switch(u.value){case"system_disk":g();break;case"project_status":x()}};return k(),l({render:k}),(e,l)=>{const a=K;return r(!0),i(p,null,w(f(_),(e,l)=>(r(),i(p,null,[1===e.length?(r(!0),i(p,{key:0},w(e,e=>(r(),b(a,{key:`${f(u)}-${e.attr}`,label:e.name},{default:h(()=>[c(te,{value:d.value[e.attr],"onUpdate:value":l=>d.value[e.attr]=l,field:e,onChange:y},null,8,["value","onUpdate:value","field"])]),_:2},1032,["label"]))),128)):m("",!0),e.length>1?(r(),i("div",{key:`${f(u)}-${l+1}`,class:"flex"},[(r(!0),i(p,null,w(e,(e,l)=>(r(),b(a,{key:`${f(u)}-${e.attr}`,label:e.name,"label-width":0!==l?"auto":void 0},{default:h(()=>[c(te,{value:d.value[e.attr],"onUpdate:value":l=>d.value[e.attr]=l,field:e,onChange:y},null,8,["value","onUpdate:value","field"])]),_:2},1032,["label","label-width"]))),128))])):m("",!0)],64))),256)}}}),ne=n({__name:"form-advanced",props:d({config:{default:()=>({})},inverse:{type:Boolean,default:!1},timeRangeShow:{type:Boolean,default:!1}},{value:{default:()=>({day_num:0,total:0,send_interval:0,time_range:[]})},valueModifiers:{}}),emits:["update:value"],setup(e){const l=e,a=o(l,"config"),t=s(e,"value"),u=e=>l.inverse?!a.value[e]:a.value[e];return(e,l)=>{const a=Y,n=q,d=L,s=K,o=N;return r(),i(p,null,[u("day_num")?(r(),b(s,{key:0,label:e.$t("Config.Alarm.index_28"),path:"day_num"},{default:h(()=>[c(d,null,{default:h(()=>[c(a,{value:t.value.day_num,"onUpdate:value":l[0]||(l[0]=e=>t.value.day_num=e),class:"w-100px",min:0,"show-button":!1,placeholder:""},null,8,["value"]),c(n,{class:"min-w-52px text-center"},{default:h(()=>[x(g(e.$t("Public.Unit.Times")),1)]),_:1})]),_:1})]),_:1},8,["label"])):m("",!0),u("total")?(r(),b(s,{key:1,label:e.$t("Config.Alarm.index_30"),path:"total"},{default:h(()=>[c(d,null,{default:h(()=>[c(a,{value:t.value.total,"onUpdate:value":l[1]||(l[1]=e=>t.value.total=e),class:"w-100px",min:0,"show-button":!1,placeholder:""},null,8,["value"]),c(n,{class:"min-w-52px text-center"},{default:h(()=>[x(g(e.$t("Public.Unit.Times")),1)]),_:1})]),_:1})]),_:1},8,["label"])):m("",!0),u("send_interval")?(r(),b(s,{key:2,label:e.$t("Config.Alarm.index_31"),path:"send_interval"},{default:h(()=>[c(d,null,{default:h(()=>[c(a,{value:t.value.send_interval,"onUpdate:value":l[2]||(l[2]=e=>t.value.send_interval=e),class:"w-100px",min:0,"show-button":!1,placeholder:""},null,8,["value"]),c(n,{class:"min-w-52px text-center"},{default:h(()=>[x(g(e.$t("Public.Unit.Seconds")),1)]),_:1})]),_:1})]),_:1},8,["label"])):m("",!0),e.timeRangeShow?(r(),b(s,{key:3,label:e.$t("Config.Alarm.index_33"),path:"time_range","show-feedback":!1},{default:h(()=>[c(o,{value:t.value.time_range,"onUpdate:value":l[3]||(l[3]=e=>t.value.time_range=e)},null,8,["value"])]),_:1},8,["label"])):m("",!0)],64)}}}),ie={class:"px-20px py-24px"},re={class:"w-260px"},de={class:"w-260px"};e("default",n({__name:"form",props:{isEdit:{type:Boolean},alert_type:{},row:{}},emits:["refresh"],setup(e,{expose:l,emit:n}){const d=e,s=S(),{isPro:p}=j(s),m=n,{t:y}=U(),g=o(d,"isEdit"),b=$(null),w=$(),k=$(!1),R=C({type:null,method:[],day_num:0,total:0,send_interval:0,time_range:[(new Date).setHours(0,0,0,0),(new Date).setHours(23,59,59,0)],template:{}}),H=C({day_num:{trigger:["input","blur"],validator:()=>!(!R.day_num&&0!==R.day_num)||(N.value.day_num||(k.value=!0),new Error(y("Config.Alarm.index_22")))},total:{trigger:["input","blur"],validator:()=>!(!R.total&&0!==R.total)||(N.value.total||(k.value=!0),new Error(y("Config.Alarm.index_23")))},send_interval:{trigger:["input","blur"],validator:()=>!(!R.send_interval&&0!==R.send_interval)||(N.value.send_interval||(k.value=!0),new Error(y("Config.Alarm.index_24")))},method:{trigger:["change"],validator:()=>0!==R.method.length||new Error(y("Config.Alarm.index_25"))}}),L=A([]),Y=v(()=>L.value.map((e,l)=>({label:e.title,value:l,disabled:"80"===e.id&&!p.value,data:e}))),q=v(()=>{let e="none";const l=L.value[R.type||0];return l&&(e=l.source),e}),z=e=>c("div",null,[c("span",null,[e.label,x(" ")]),14===e.value?c("span",{class:"float-right cursor-pointer color-#ffb800",onClick:()=>{T({source:323})}},[x("PRO")]):""]),J=$({field:[],sorted:[]}),N=$({}),Q=()=>L.value[R.type||0],X=()=>{const e=Q();J.value=e.template,J.value.field.forEach(l=>{l.default?R.template[l.attr]=l.default:R.template[l.attr]=e.default[l.attr]}),R.day_num=0,R.total=0,R.send_interval=0;const l={},{advanced_default:a}=e;B(a)&&Object.entries(a).forEach(([e,a])=>{B(a)?Object.entries(a).forEach(([e,a])=>{l[e]=!0,ee(e,a)}):P(a)&&(l[e]=!0,ee(e,a))}),N.value=l},Z=["day_num","total","send_interval"],ee=(e,l)=>{Z.includes(e)&&(R[e]=l)},le=()=>{X(),M(()=>{w.value.render()})},{loading:ae,setLoading:te}=I(),se=e=>{const l=new Date,a=l.getFullYear(),t=l.getMonth(),u=l.getDate();return new Date(a,t,u).getTime()+1e3*e};return(async()=>{await(async()=>{try{te(!0);const{message:e}=await W();D(e)&&(L.value=e,R.type=0,g.value||X())}finally{te(!1)}})();const{row:e}=d;g.value&&e&&(R.type=L.value.findIndex(l=>l.id===e.template_id),X(),R.method=e.sender,e.number_rule&&(R.day_num=e.number_rule.day_num,R.total=e.number_rule.total),e.time_rule&&(R.send_interval=e.time_rule.send_interval,e.time_rule.time_range&&e.time_rule.time_range.length>0&&(R.time_range=[se(e.time_rule.time_range[0]),se(e.time_rule.time_range[1])])),Object.keys(R.template).forEach(l=>{e.task_data&&(R.template[l]=e.task_data[l])}),await M(),w.value.render()),d.alert_type&&(R.type=d.alert_type,le())})(),l({onConfirm:async()=>{await(b.value?.validate());const{row:e}=d,l=(()=>{const e=Q();return{template_id:e.id,task_data:{task_data:{tid:e.id,type:e.source,title:e.title,status:!0,count:0,interval:600,project:"",...R.template},sender:R.method,number_rule:{day_num:R.day_num,total:R.total},time_rule:{send_interval:R.send_interval,time_range:[O(R.time_range[0]),O(R.time_range[1])]}}}})();g.value&&e?await F({...l,task_id:e.id}):await V(l),m("refresh")}}),(e,l)=>{const n=G,d=K,s=u,o=t,v=a;return r(),i("div",ie,[c(v,{ref_key:"formRef",ref:b,model:f(R),rules:f(H),"label-width":"140"},{default:h(()=>[c(d,{label:e.$t("Config.Alarm.index_19")},{default:h(()=>[_("div",re,[c(n,{value:f(R).type,"onUpdate:value":[l[0]||(l[0]=e=>f(R).type=e),le],options:f(Y),loading:f(ae),"render-label":z},null,8,["value","options","loading"])])]),_:1},8,["label"]),c(ue,{ref_key:"templateRef",ref:w,value:f(R).template,"onUpdate:value":l[1]||(l[1]=e=>f(R).template=e),type:f(q),template:f(J)},null,8,["value","type","template"]),c(ne,{value:f(R),"onUpdate:value":l[2]||(l[2]=e=>E(R)?R.value=e:null),config:f(N)},null,8,["value","config"]),c(d,{label:e.$t("Config.Alarm.index_20"),path:"method"},{default:h(()=>[_("div",de,[c(s,{value:f(R).method,"onUpdate:value":l[3]||(l[3]=e=>f(R).method=e)},null,8,["value"])])]),_:1},8,["label"]),c(o,{show:f(k),"onUpdate:show":l[5]||(l[5]=e=>E(k)?k.value=e:null),title:e.$t("Config.Alarm.index_21")},{default:h(()=>[c(ne,{value:f(R),"onUpdate:value":l[4]||(l[4]=e=>E(R)?R.value=e:null),config:f(N),inverse:!0,"time-range-show":!0},null,8,["value","config"])]),_:1},8,["show","title"])]),_:1},8,["model","rules"])])}}}))}}});
