System.register(["./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1764830988434","./index.vue_vue_type_script_setup_true_lang-legacy19.js?v=1764830988434","./index.vue_vue_type_script_setup_true_lang-legacy15.js?v=1764830988434","./vue-legacy.js?v=1764830988434","./page_layout-legacy.js?v=1764830988434","./public-legacy.js?v=1764830988434","./alarm-legacy.js?v=1764830988434","./naive-legacy.js?v=1764830988434","./index-legacy211.js?v=1764830988434","./__commonjsHelpers__-legacy.js?v=1764830988434","./common-legacy.js?v=1764830988434"],function(e,l){"use strict";var a,t,u,n,i,r,d,s,o,v,p,m,_,c,f,g,y,h,b,x,w,k,U,j,$,C,A,E,M,R,P,B,D,O,S,H,T,F,I,V,G,L,W,Y,Z,q,z,J,K;return{setters:[e=>{a=e._},e=>{t=e._},e=>{u=e._},e=>{n=e.k,i=e.R,r=e.V,d=e.ad,s=e.ae,o=e.t,v=e.c,p=e.F,m=e.S,_=e.an,c=e.W,f=e.U,g=e.I,y=e.a4,h=e.a3,b=e.a2,x=e.j,w=e.O,k=e.a7,U=e.P,j=e.a0,$=e.r,C=e.e,A=e.x,E=e.ak,M=e.n},e=>{R=e.aH,P=e.k,B=e.u,D=e.d,O=e.x,S=e.c9},e=>{H=e._,T=e.d,F=e.b},e=>{I=e.j,V=e.h,G=e.i},e=>{L=e.dV,W=e.av,Y=e.df,Z=e.dZ,q=e.dT,z=e.dU,J=e.dR},e=>{K=e._},null,null],execute:function(){const l=n({__name:"form-template-field-none",props:{field:{}},setup:e=>(e,l)=>(r(),i("div"))}),N={key:0,class:"ml-10px whitespace-pre"},Q=n({__name:"form-template-field-select",props:d({field:{}},{value:{default:null},valueModifiers:{}}),emits:["update:value"],setup(e){const l=e,a=s(e,"value"),t=o(l,"field"),u=v(()=>t.value.items.map(e=>({label:`${e.title}${t.value.unit||""}`,value:e.value})));return(e,l)=>{const n=L;return r(),i(p,null,[m("div",{style:g({width:f(t).width?"160px":"260px"})},[c(n,{value:a.value,"onUpdate:value":l[0]||(l[0]=e=>a.value=e),disabled:f(t).disabled,options:f(u)},null,8,["value","disabled","options"])],4),f(t).suffix?(r(),i("div",N,y(f(t).suffix),1)):_("",!0)],64)}}}),X={key:0,class:"ml-10px whitespace-pre"},ee=n({__name:"form-template-field-number",props:d({field:{}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(e){const l=o(e,"field"),a=s(e,"value"),t=()=>{a.value||(a.value=l.value.default)};return(e,u)=>{const n=Y,d=Z,s=W;return r(),i(p,null,[m("div",null,[c(s,null,{default:h(()=>[c(n,{value:a.value,"onUpdate:value":u[0]||(u[0]=e=>a.value=e),class:"w-100px",min:1,"show-button":!1,placeholder:"",onBlur:t},null,8,["value"]),f(l).unit?(r(),b(d,{key:0,class:"min-w-52px text-center"},{default:h(()=>[x(y(f(l).unit),1)]),_:1})):_("",!0)]),_:1})]),f(l).suffix?(r(),i("span",X,y(f(l).suffix),1)):_("",!0)],64)}}}),le=n({__name:"form-template-field-radio",props:d({field:{}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(e){const l=e,a=s(e,"value"),t=o(l,"field");return(e,l)=>{const u=z,n=q;return r(),b(n,{value:a.value,"onUpdate:value":l[0]||(l[0]=e=>a.value=e)},{default:h(()=>[(r(!0),i(p,null,w(f(t).items,e=>(r(),b(u,{key:e.value,value:e.value},{default:h(()=>[x(y(e.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])}}}),ae=n({__name:"form-template-field-help",props:{field:{}},setup:e=>(e,l)=>{const a=H;return r(),b(a,null,{default:h(()=>[(r(!0),i(p,null,w(e.field.list,e=>(r(),i("li",{key:e},y(e),1))),128))]),_:1})}}),te=n({__name:"form-template-field",props:d({field:{}},{value:{},valueModifiers:{}}),emits:d(["change"],["update:value"]),setup(e,{emit:a}){const t=e,u=a,n=s(e,"value"),i=o(t,"field"),d=(()=>{switch(i.value.type){case"select":return Q;case"number":return ee;case"radio":return le;case"help":return ae;default:return l}})(),v=e=>{u("change",e,i.value.attr)};return(e,l)=>(r(),b(k(f(d)),{value:n.value,"onUpdate:value":[l[0]||(l[0]=e=>n.value=e),v],field:f(i)},null,40,["value","field"]))}}),ue=n({__name:"form-template",props:d({type:{default:"none"},template:{default:()=>({field:[],sorted:[]})}},{value:{default:()=>({})},valueModifiers:{}}),emits:["update:value"],setup(e,{expose:l}){const a=e,{t:t}=U(),u=o(a,"type"),n=o(a,"template"),d=s(e,"value"),m=v(()=>{const{field:e,sorted:l}=n.value,a=[];return l.forEach(l=>{const t=[];l.forEach(l=>{const a=e.find(e=>e.attr===l);a&&t.push(a)}),a.push(t)}),a}),g=(e,l)=>{"system_disk"===u.value&&"cycle"===l&&y(),"project_status"===u.value&&"cycle"===l&&x()},y=()=>{const{cycle:e}=d.value;switch(e){case 1:n.value.field[2].unit="GB",n.value.field[2].name=t("Config.Alarm.index_26");break;case 2:n.value.field[2].unit="%",n.value.field[2].name=t("Config.Alarm.index_27")}},x=()=>{const{field:e}=n.value,[,l]=e,{all_items:a}=l;if(a&&R(d.value.cycle)){const e=a[P(d.value.cycle)-1];e.length>0?(l.items=e,d.value.project=e[0].value):(l.items=[],d.value.project=null)}},k=()=>{switch(u.value){case"system_disk":y();break;case"project_status":x()}};return k(),l({render:k}),(e,l)=>{const a=J;return r(!0),i(p,null,w(f(m),(e,l)=>(r(),i(p,null,[1===e.length?(r(!0),i(p,{key:0},w(e,e=>(r(),b(a,{key:`${f(u)}-${e.attr}`,label:e.name},{default:h(()=>[c(te,{value:d.value[e.attr],"onUpdate:value":l=>d.value[e.attr]=l,field:e,onChange:g},null,8,["value","onUpdate:value","field"])]),_:2},1032,["label"]))),128)):_("",!0),e.length>1?(r(),i("div",{key:`${f(u)}-${l+1}`,class:"flex"},[(r(!0),i(p,null,w(e,(e,l)=>(r(),b(a,{key:`${f(u)}-${e.attr}`,label:e.name,"label-width":0!==l?"auto":void 0},{default:h(()=>[c(te,{value:d.value[e.attr],"onUpdate:value":l=>d.value[e.attr]=l,field:e,onChange:g},null,8,["value","onUpdate:value","field"])]),_:2},1032,["label","label-width"]))),128))])):_("",!0)],64))),256)}}}),ne=n({__name:"form-advanced",props:d({config:{default:()=>({})},inverse:{type:Boolean,default:!1},timeRangeShow:{type:Boolean,default:!1}},{value:{default:()=>({day_num:0,total:0,send_interval:0,time_range:[]})},valueModifiers:{}}),emits:["update:value"],setup(e){const l=e,a=o(l,"config"),t=s(e,"value"),u=e=>l.inverse?!a.value[e]:a.value[e];return(e,l)=>{const a=Y,n=Z,d=W,s=J,o=K;return r(),i(p,null,[u("day_num")?(r(),b(s,{key:0,label:e.$t("Config.Alarm.index_28"),path:"day_num"},{default:h(()=>[c(d,null,{default:h(()=>[c(a,{value:t.value.day_num,"onUpdate:value":l[0]||(l[0]=e=>t.value.day_num=e),class:"w-100px",min:0,"show-button":!1,placeholder:""},null,8,["value"]),c(n,{class:"min-w-52px text-center"},{default:h(()=>[x(y(e.$t("Public.Unit.Times")),1)]),_:1})]),_:1})]),_:1},8,["label"])):_("",!0),u("total")?(r(),b(s,{key:1,label:e.$t("Config.Alarm.index_30"),path:"total"},{default:h(()=>[c(d,null,{default:h(()=>[c(a,{value:t.value.total,"onUpdate:value":l[1]||(l[1]=e=>t.value.total=e),class:"w-100px",min:0,"show-button":!1,placeholder:""},null,8,["value"]),c(n,{class:"min-w-52px text-center"},{default:h(()=>[x(y(e.$t("Public.Unit.Times")),1)]),_:1})]),_:1})]),_:1},8,["label"])):_("",!0),u("send_interval")?(r(),b(s,{key:2,label:e.$t("Config.Alarm.index_31"),path:"send_interval"},{default:h(()=>[c(d,null,{default:h(()=>[c(a,{value:t.value.send_interval,"onUpdate:value":l[2]||(l[2]=e=>t.value.send_interval=e),class:"w-100px",min:0,"show-button":!1,placeholder:""},null,8,["value"]),c(n,{class:"min-w-52px text-center"},{default:h(()=>[x(y(e.$t("Public.Unit.Seconds")),1)]),_:1})]),_:1})]),_:1},8,["label"])):_("",!0),e.timeRangeShow?(r(),b(s,{key:3,label:e.$t("Config.Alarm.index_33"),path:"time_range","show-feedback":!1},{default:h(()=>[c(o,{value:t.value.time_range,"onUpdate:value":l[3]||(l[3]=e=>t.value.time_range=e)},null,8,["value"])]),_:1},8,["label"])):_("",!0)],64)}}}),ie={class:"px-20px py-24px"},re={class:"w-260px"},de={class:"w-260px"};e("default",n({__name:"form",props:{isEdit:{type:Boolean},row:{}},emits:["refresh"],setup(e,{expose:l,emit:n}){const d=e,s=B(),{isPro:p}=j(s),_=n,{t:g}=U(),y=o(d,"isEdit"),b=$(null),w=$(),k=$(!1),P=C({type:null,method:[],day_num:0,total:0,send_interval:0,time_range:[(new Date).setHours(0,0,0,0),(new Date).setHours(23,59,59,0)],template:{}}),H=C({day_num:{trigger:["input","blur"],validator:()=>!(!P.day_num&&0!==P.day_num)||(K.value.day_num||(k.value=!0),new Error(g("Config.Alarm.index_22")))},total:{trigger:["input","blur"],validator:()=>!(!P.total&&0!==P.total)||(K.value.total||(k.value=!0),new Error(g("Config.Alarm.index_23")))},send_interval:{trigger:["input","blur"],validator:()=>!(!P.send_interval&&0!==P.send_interval)||(K.value.send_interval||(k.value=!0),new Error(g("Config.Alarm.index_24")))},method:{trigger:["change"],validator:()=>0!==P.method.length||new Error(g("Config.Alarm.index_25"))}}),W=A([]),Y=v(()=>W.value.map((e,l)=>({label:e.title,value:l,disabled:"80"===e.id&&!p.value,data:e}))),Z=v(()=>{let e="none";const l=W.value[P.type||0];return l&&(e=l.source),e}),q=e=>c("div",null,[c("span",null,[e.label,x(" ")]),14===e.value?c("span",{class:"float-right cursor-pointer color-#ffb800",onClick:()=>{F({source:323})}},[x("PRO")]):""]),z=$({field:[],sorted:[]}),K=$({}),N=()=>W.value[P.type||0],Q=()=>{const e=N();z.value=e.template,z.value.field.forEach(l=>{l.default?P.template[l.attr]=l.default:P.template[l.attr]=e.default[l.attr]}),P.day_num=0,P.total=0,P.send_interval=0;const l={},{advanced_default:a}=e;D(a)&&Object.entries(a).forEach(([e,a])=>{D(a)?Object.entries(a).forEach(([e,a])=>{l[e]=!0,ee(e,a)}):R(a)&&(l[e]=!0,ee(e,a))}),K.value=l},X=["day_num","total","send_interval"],ee=(e,l)=>{X.includes(e)&&(P[e]=l)},le=()=>{Q(),M(()=>{w.value.render()})},{loading:ae,setLoading:te}=T(),se=e=>{const l=new Date,a=l.getFullYear(),t=l.getMonth(),u=l.getDate();return new Date(a,t,u).getTime()+1e3*e};return(async()=>{await(async()=>{try{te(!0);const{message:e}=await G();O(e)&&(W.value=e,P.type=0,y.value||Q())}finally{te(!1)}})();const{row:e}=d;y.value&&e&&(P.type=W.value.findIndex(l=>l.id===e.template_id),Q(),P.method=e.sender,e.number_rule&&(P.day_num=e.number_rule.day_num,P.total=e.number_rule.total),e.time_rule&&(P.send_interval=e.time_rule.send_interval,e.time_rule.time_range&&e.time_rule.time_range.length>0&&(P.time_range=[se(e.time_rule.time_range[0]),se(e.time_rule.time_range[1])])),Object.keys(P.template).forEach(l=>{e.task_data&&(P.template[l]=e.task_data[l])}),await M(),w.value.render())})(),l({onConfirm:async()=>{await(b.value?.validate());const{row:e}=d,l=(()=>{const e=N();return{template_id:e.id,task_data:{task_data:{tid:e.id,type:e.source,title:e.title,status:!0,count:0,interval:600,project:"",...P.template},sender:P.method,number_rule:{day_num:P.day_num,total:P.total},time_rule:{send_interval:P.send_interval,time_range:[S(P.time_range[0]),S(P.time_range[1])]}}}})();y.value&&e?await I({...l,task_id:e.id}):await V(l),_("refresh")}}),(e,l)=>{const n=L,d=J,s=u,o=t,v=a;return r(),i("div",ie,[c(v,{ref_key:"formRef",ref:b,model:f(P),rules:f(H),"label-width":"140"},{default:h(()=>[c(d,{label:e.$t("Config.Alarm.index_19")},{default:h(()=>[m("div",re,[c(n,{value:f(P).type,"onUpdate:value":[l[0]||(l[0]=e=>f(P).type=e),le],options:f(Y),loading:f(ae),"render-label":q},null,8,["value","options","loading"])])]),_:1},8,["label"]),c(ue,{ref_key:"templateRef",ref:w,value:f(P).template,"onUpdate:value":l[1]||(l[1]=e=>f(P).template=e),type:f(Z),template:f(z)},null,8,["value","type","template"]),c(ne,{value:f(P),"onUpdate:value":l[2]||(l[2]=e=>E(P)?P.value=e:null),config:f(K)},null,8,["value","config"]),c(d,{label:e.$t("Config.Alarm.index_20"),path:"method"},{default:h(()=>[m("div",de,[c(s,{value:f(P).method,"onUpdate:value":l[3]||(l[3]=e=>f(P).method=e)},null,8,["value"])])]),_:1},8,["label"]),c(o,{show:f(k),"onUpdate:show":l[5]||(l[5]=e=>E(k)?k.value=e:null),title:e.$t("Config.Alarm.index_21")},{default:h(()=>[c(ne,{value:f(P),"onUpdate:value":l[4]||(l[4]=e=>E(P)?P.value=e:null),config:f(K),inverse:!0,"time-range-show":!0},null,8,["value","config"])]),_:1},8,["show","title"])]),_:1},8,["model","rules"])])}}}))}}});
