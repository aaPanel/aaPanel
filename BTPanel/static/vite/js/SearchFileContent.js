import{_ as e}from"./index.js?v=1763625242172";import{m as a,bf as t,_ as l,q as s,bO as n,bP as o,p as i}from"./page_layout.js?v=1763625242172";import{k as c,P as r,i as u,r as d,R as f,S as h,X as p,a3 as m,U as v,V as _,j as b,a4 as C,a2 as k,an as F,F as j,O as x,au as y,aj as M}from"./vue.js?v=1763625242172";import{o as g}from"./index39.js?v=1763625242172";import{R as $}from"./ResourceManagerWindow.js?v=1763625242172";import{au as w,aC as U,az as O,dP as R,_ as P,dU as S,dT as W,dW as D}from"./naive.js?v=1763625242172";import"./common.js?v=1763625242172";import"./__commonjsHelpers__.js?v=1763625242172";import"./public.js?v=1763625242172";import"./soft2.js?v=1763625242172";import"./soft.js?v=1763625242172";import"./site.js?v=1763625242172";import"./file2.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1763625242172";const H={class:"search-wrapper"},T={class:"w-100% flex justify-start gap-6 items-center"},q={class:"w-100% flex justify-between"},z={class:"search-res"},I={class:"top-desc"},L={class:"mr-5px"},E={class:"match-list"},V={class:"text-font1 fw-bold"},X=["innerHTML"],A=i(c({__name:"SearchFileContent",props:{currentPath:{type:String,default:"/"}},setup(i,{expose:c}){const A=i,{t:B}=r(),G=u("fileStore"),{currentPath:J,resetSearchFileContentFormData:K}=G;function N(){K()}c({open:function(){te.value=!0,Z.value.path=J.value},close:N});const{searchStatistics:Q,searchRes:Y,searchFileContentFormData:Z}=G,ee=d(),ae=d(A.currentPath),te=d(!1);function le(){!async function(){const e=a.loading(B("file.searchFileContentModal.searching"));try{const e=await t.post("/files?action=files_search",Z.value,{requestOptions:{isOriginalResult:!0}});Y.value=e.message,Object.keys(Y.value).length&&(Q.value.files=Object.keys(Y.value).length,Q.value.times=Object.values(Y.value).flat().reduce(((e,a)=>e+Object.values(a).length),0))}catch(l){console.warn(l)}finally{e.close()}}()}function se(e,a){const t=new RegExp(a,"g");return e.replace(t,'<span style="color:#ff3300">'.concat(a,"</span>"))}function ne(){ee.value.open()}function oe(e){Z.value.path=e}return(a,t)=>{const i=w,c=U,r=O,u=R,d=P,A=l,B=S,G=W,K=D,ie=s,ce=n,re=o,ue=e;return f(),h(j,null,[p(ue,{show:_(te),"onUpdate:show":t[7]||(t[7]=e=>M(te)?te.value=e:null),title:a.$t("file.searchFileContentModal.title"),width:720,onPublicClose:N},{default:m((()=>[v("div",H,[p(K,{"label-placement":"left","label-width":60,"label-align":"left"},{default:m((()=>[p(u,{label:a.$t("file.searchFileContentModal.search")},{default:m((()=>[p(r,null,{default:m((()=>[p(i,{value:_(Z).text,"onUpdate:value":t[0]||(t[0]=e=>_(Z).text=e)},null,8,["value"]),p(c,{type:"primary",onClick:le},{default:m((()=>[b(C(a.$t("file.searchFileContentModal.search")),1)])),_:1})])),_:1})])),_:1},8,["label"]),p(u,{label:a.$t("file.searchFileContentModal.suffix")},{default:m((()=>[p(i,{value:_(Z).exts,"onUpdate:value":t[1]||(t[1]=e=>_(Z).exts=e)},null,8,["value"])])),_:1},8,["label"]),p(u,{label:a.$t("file.searchFileContentModal.folder")},{default:m((()=>[v("div",T,[p(i,{value:_(Z).path,"onUpdate:value":t[3]||(t[3]=e=>_(Z).path=e)},{suffix:m((()=>[p(d,{checked:_(Z).is_subdir,"onUpdate:checked":t[2]||(t[2]=e=>_(Z).is_subdir=e),"checked-value":1,"unchecked-value":0},{default:m((()=>[b(C(a.$t("file.searchFileContentModal.subdir")),1)])),_:1},8,["checked"])])),_:1},8,["value"]),p(A,{name:"file-dir",color:"#000",size:"24",style:{cursor:"pointer"},onClick:ne})])])),_:1},8,["label"]),p(u,{label:a.$t("file.searchFileContentModal.mode")},{default:m((()=>[v("div",q,[p(G,{value:_(Z).mode,"onUpdate:value":t[4]||(t[4]=e=>_(Z).mode=e)},{default:m((()=>[p(B,{value:0},{default:m((()=>[b(C(a.$t("file.searchFileContentModal.words")),1)])),_:1}),p(B,{value:1},{default:m((()=>[b(C(a.$t("file.searchFileContentModal.regex")),1)])),_:1})])),_:1},8,["value"]),v("div",null,[0==_(Z).mode?(f(),k(d,{key:0,checked:_(Z).isword,"onUpdate:checked":t[5]||(t[5]=e=>_(Z).isword=e),label:a.$t("file.searchFileContentModal.matchWholeWord"),class:"mr-5","checked-value":1,"unchecked-value":0},null,8,["checked","label"])):F("",!0),p(d,{checked:_(Z).iscase,"onUpdate:checked":t[6]||(t[6]=e=>_(Z).iscase=e),label:a.$t("file.searchFileContentModal.matchCase"),"checked-value":1,"unchecked-value":0},null,8,["checked","label"])])])])),_:1},8,["label"])])),_:1}),v("div",z,[v("div",I,[v("span",L,C(a.$t("file.searchFileContentModal.searchResult")),1),v("span",null,C(_(Q).times)+" "+C(a.$t("file.searchFileContentModal.matchesIn"))+" "+C(_(Q).files)+" "+C(a.$t("file.searchFileContentModal.files")),1)]),p(ie,{style:{"margin-bottom":"20px"}}),(f(!0),h(j,null,x(_(Y),((e,t)=>(f(),k(re,{key:t,class:"mb-10px"},{default:m((()=>[p(ce,{title:"".concat(t," (").concat(a.$t("file.searchFileContentModal.match")," ").concat(Object.values(e).length," ").concat(a.$t("file.searchFileContentModal.times"),")"),name:"1"},{"header-extra":m((()=>[p(c,{text:"",type:"primary",onClick:y((e=>async function(e){g(0,e,J.value)}(t)),["stop"])},{default:m((()=>[b(C(a.$t("file.searchFileContentModal.edit")),1)])),_:2},1032,["onClick"])])),default:m((()=>[v("div",E,[(f(!0),h(j,null,x(e,((e,t)=>(f(),h("div",{class:"match-list-item",key:t},[v("div",V,C(a.$t("file.searchFileContentModal.line"))+" "+C(t)+": ",1),v("div",{innerHTML:se(e,_(Z).text)},null,8,X)])))),128))])])),_:2},1032,["title"])])),_:2},1024)))),128))])])])),_:1},8,["show","title"]),p($,{"current-path":_(ae),ref_key:"resourceRef",ref:ee,onChooseDir:oe},null,8,["current-path"])],64)}}}),[["__scopeId","data-v-17c24141"]]);export{A as default};
