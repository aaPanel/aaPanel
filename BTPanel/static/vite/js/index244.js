import{_ as e}from"./public.js?v=1763625242172";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.js?v=1763625242172";import{_ as a}from"./index.vue_vue_type_script_setup_true_lang10.js?v=1763625242172";import{_ as l}from"./index99.js?v=1763625242172";import{b5 as r,d$ as s}from"./page_layout.js?v=1763625242172";import{bb as o}from"./site.js?v=1763625242172";import{k as i,P as u,r as p,e as d,R as n,S as _,X as x,a3 as y,V as v,a2 as m,an as h,U as c,a4 as f,j as P,aj as b}from"./vue.js?v=1763625242172";import{dj as S,dP as g,dV as $,au as k,d9 as w,d8 as j}from"./naive.js?v=1763625242172";import"./common.js?v=1763625242172";import"./__commonjsHelpers__.js?v=1763625242172";import"./index98.js?v=1763625242172";const U={class:"m-15px"},H={class:"w-440px"},q={class:"list-none!"},R={class:"list-none!"},E={class:"list-none!"},C=i({__name:"index",emits:["refresh"],setup(i,{expose:C,emit:N}){const{t:V}=u(),B=N,I=()=>{"2"===A.proxy_type?A.proxy_host="$http_host":A.proxy_host=""},J=e=>{if("2"===A.proxy_type)return void(A.proxy_host="$http_host");let t=e.replace(/^http[s]?:\/\//,"");t=t.replace(/(:|\?|\/|\\)(.*)$/,""),L.value||(A.proxy_host=t)},L=p(!1),O=()=>{A.proxy_host&&"$http_host"!==A.proxy_host&&(L.value=!0)},X=p(null),z=[{label:V("Site.Proxy.index_11"),value:"1"},{label:V("Site.Proxy.index_12"),value:"2"}],A=d({domains:"",proxy_type:"1",url:"http://",unx:"",proxy_host:"$http_host",remark:"",keepuri:1,rewrite:[{key:"",value:""}]}),D=p([{key:"",value:""}]),F={domains:{required:!0,trigger:["blur","change"],validator:(e,t)=>{if(""===t.trim())return new Error(V("Site.PHP.add_site_23"));const a=t.trim().split("\n")[0].split(":")[1];return!(a&&(!r(a)||Number(a)<100))||new Error(V("Site.Proxy.index_13"))}},url:{required:!0,trigger:["blur","change"],validator:(e,t)=>{if(!t.replace(/^http[s]?:\/\//,""))return new Error(V("Site.Proxy.index_14"));const a=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;let l=t.replace(/^http[s]?:\/\//,"");return l=l.replace(/(:|\?|\/|\\)(.*)$/,""),L.value||(a.test(l)?A.proxy_host="$http_host":A.proxy_host=l),!0}},unx:{required:!0,message:V("Site.PHP.add_site_26"),trigger:["blur","change"]},proxy_host:{required:!0,message:V("Site.PHP.add_site_26"),trigger:["blur","change"]}},G=e=>{const t=e.trim().split("\n")[0].split(":")[0];t&&(A.remark=t)};return C({onConfirm:async()=>{var e;await(null==(e=X.value)?void 0:e.validate());const t=D.value.filter((e=>""!==e.key||""!==e.value)).map((e=>({dir1:e.key,dir2:e.value})));let a={...A,proxy_type:"1"==A.proxy_type,proxy_pass:"1"==A.proxy_type?A.url:A.unx,rewritedir:JSON.stringify(t)};await o(a),B("refresh")}}),(r,o)=>{const i=S,u=g,p=l,d=$,C=k,N=a,V=w,B=j,L=s,K=t,M=e;return n(),_("div",U,[x(K,{ref_key:"formRef",ref:X,model:v(A),rules:F},{default:y((()=>["1"==v(A).proxy_type?(n(),m(u,{key:0,label:"Show Proxy Path"},{default:y((()=>[x(i,{value:v(A).keepuri,"onUpdate:value":o[0]||(o[0]=e=>v(A).keepuri=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1})):h("",!0),x(u,{label:r.$t("Site.PHP.add_site_4"),path:"domains"},{default:y((()=>[c("div",H,[x(p,{value:v(A).domains,"onUpdate:value":[o[1]||(o[1]=e=>v(A).domains=e),G]},{default:y((()=>[c("p",null,f(r.$t("Site.PHP.add_site_5")),1),c("p",null,f(r.$t("Site.PHP.add_site_6")),1),c("p",null,f(r.$t("Site.PHP.add_site_7")),1)])),_:1},8,["value"])])])),_:1},8,["label"]),x(V,null,{default:y((()=>[x(u,{label:r.$t("Site.Proxy.index_1")},{default:y((()=>[x(d,{value:v(A).proxy_type,"onUpdate:value":[o[2]||(o[2]=e=>v(A).proxy_type=e),I],options:z,class:"w-120px"},null,8,["value"])])),_:1},8,["label"]),"1"==v(A).proxy_type?(n(),m(u,{key:0,path:"url",class:"w-310px"},{default:y((()=>[x(C,{value:v(A).url,"onUpdate:value":o[3]||(o[3]=e=>v(A).url=e),onInput:J},null,8,["value"])])),_:1})):(n(),m(u,{key:1,path:"unx",class:"w-310px"},{default:y((()=>[x(N,{"checked-type":["dir","file"],value:v(A).unx,"onUpdate:value":o[4]||(o[4]=e=>v(A).unx=e),onChange:J},null,8,["value"])])),_:1}))])),_:1}),"1"==v(A).proxy_type?(n(),m(u,{key:1,label:r.$t("Site.Proxy.index_2"),path:"proxy_host",class:"w-570px"},{default:y((()=>[x(B,{trigger:"hover"},{trigger:y((()=>[x(C,{value:v(A).proxy_host,"onUpdate:value":o[5]||(o[5]=e=>v(A).proxy_host=e),onBlur:O},null,8,["value"])])),default:y((()=>[P(" "+f(r.$t("Site.Proxy.index_4")),1)])),_:1})])),_:1},8,["label"])):h("",!0),x(u,{label:"URL Rewrite"},{default:y((()=>[x(L,{class:"w-440px",min:1,value:v(D),"onUpdate:value":o[6]||(o[6]=e=>b(D)?D.value=e:null),preset:"pair","key-placeholder":"/aaa","value-placeholder":"/bbb"},null,8,["value"])])),_:1}),x(u,{label:r.$t("Site.Proxy.index_3"),class:"w-570px"},{default:y((()=>[x(C,{value:v(A).remark,"onUpdate:value":o[7]||(o[7]=e=>v(A).remark=e),placeholder:r.$t("Site.Proxy.index_5")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"]),x(M,{class:"mt-16px"},{default:y((()=>[c("li",null,f(r.$t("Site.Proxy.index_6")),1),c("li",null,f(r.$t("Site.Proxy.index_7")),1),c("li",q,f(r.$t("Site.Proxy.index_8")),1),c("li",R,f(r.$t("Site.Proxy.index_9")),1),c("li",E,f(r.$t("Site.Proxy.index_10")),1)])),_:1})])}}});export{C as default};
