import{_ as e}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1758789124250";import{_ as a}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1758789124250";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1758789124250";import{c as i,f as s,a as l,d as n,h as o}from"./public.js?v=1758789124250";import{bi as d,n as p,f8 as c,bf as m,f9 as r,fa as _,d as u,x as f,bl as y}from"./page_layout.js?v=1758789124250";import{a as k}from"./soft.js?v=1758789124250";import{aC as h}from"./naive.js?v=1758789124250";import{k as b,P as g,e as w,N as x,R as j,V as v,W as C,a3 as R,U as S,ak as B,j as D,a4 as U}from"./vue.js?v=1758789124250";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1758789124250";import"./common.js?v=1758789124250";import"./__commonjsHelpers__.js?v=1758789124250";import"./site.js?v=1758789124250";const z={class:"p-20px"},L=b({__name:"index",props:{data:{}},setup(b){const{t:L}=g(),F=b,{row:P}=F.data,T=d(),K=async()=>{await y(T.type,{id:P.id}),E(),T.setRefresh(!0)},H=w({p:1,limit:10,search:P.id}),{keys:N,table:V,columns:W}=i([{type:"selection",width:40},{key:"filename",title:L("Component.UploadFile.index_3"),ellipsis:{tooltip:{width:"trigger"}}},{key:"type",title:L("Ftp.Table.index_3"),width:80},{key:"size",title:L("Site.TableRow.index_23"),width:90,render:e=>p(e.size)},{key:"addtime",title:L("Site.TableRow.index_25"),width:146},s({width:180,options:e=>[{label:L("Public.Btn.Click"),show:"local disk"!==e.type,onClick:()=>{k({title:e.type,name:e.type,admin:!0})}},{label:L("Database.tools.index_3"),show:"local disk"===e.type,onClick:()=>{l({title:L("Database.tools.index_17"),content:L("Database.tools.index_18"),onConfirm:async({hide:a})=>{await c(T.type,{file:e.filename,name:P.name}),T.setRefresh(!0),a()}})}},{label:L("Ftp.Label.index_11"),show:"local disk"===e.type,onClick:()=>{m(e.filename,e.name)}},{label:L("Public.Btn.Del"),onClick:()=>{l({title:L("Site.Batch.index_18"),content:L("Database.tools.index_19"),onConfirm:async({hide:a})=>{await r({id:e.id}),E(),T.setRefresh(!0),a()}})}}]})]),$=[{key:"del",type:"confirm",label:L("Site.Batch.index_20"),confirm:{title:L("Site.Batch.index_21"),desc:L("Site.Batch.index_11"),columns:[W.value[1]],api:e=>r({id:e.id},!1),done:()=>{E()}}}],{loading:q,setLoading:A}=n(),E=async()=>{try{A(!0);const{message:e}=await _(x(H));u(e)?(V.data=e.data.map(e=>({...e,filename:e.filename.includes("|")?"/"+e.filename.split("|").slice(1).join("|"):e.filename,type:e.filename.includes("|")?e.filename.split("|")[0]:"local disk"})),V.total=f(e.page)):(V.data=[],V.total=0),P.backup_count=V.total}finally{N.value=[],A(!1)}};return E(),(i,s)=>{const l=h,n=o,d=t,p=a,c=e;return v(),j("div",z,[C(c,null,{toolsLeft:R(()=>[C(l,{class:"backup-btn",type:"primary",onClick:K},{default:R(()=>[D(U(i.$t("Database.index_16")),1)]),_:1})]),table:R(()=>[C(n,{"checked-row-keys":S(N),"onUpdate:checkedRowKeys":s[0]||(s[0]=e=>B(N)?N.value=e:null),loading:S(q),"loading-num":6,data:S(V).data,columns:S(W)},null,8,["checked-row-keys","loading","data","columns"])]),pageLeft:R(()=>[C(d,{"checked-row-keys":S(N),"onUpdate:checkedRowKeys":s[1]||(s[1]=e=>B(N)?N.value=e:null),data:S(V).data,options:$},null,8,["checked-row-keys","data"])]),pageRight:R(()=>[C(p,{page:S(H).p,"onUpdate:page":s[2]||(s[2]=e=>S(H).p=e),"page-size":S(H).limit,"onUpdate:pageSize":s[3]||(s[3]=e=>S(H).limit=e),"item-count":S(V).total,onRefresh:E},null,8,["page","page-size","item-count"])]),_:1})])}}});export{L as default};
