import{_ as e}from"./index107.js?v=1763625242172";import{_ as a}from"./index132.js?v=1763625242172";import{_ as l}from"./index.vue_vue_type_script_setup_true_lang.js?v=1763625242172";import{x as t,u as i,g as r,f as n,c as o,o as s,_ as d,m as u}from"./page_layout.js?v=1763625242172";import{k as p,a0 as _,ae as m,r as c,R as v,a2 as b,V as f,n as h,w as x,c as g,P as w,e as k,a3 as y,U as S,a4 as j,j as P,an as $,S as L,X as E,l as U,aj as R,v as W}from"./vue.js?v=1763625242172";import{u as A,g as q,a as C,c as V,b as z,d as B}from"./index87.js?v=1763625242172";import{d as D,m as H,_ as F}from"./public.js?v=1763625242172";import{D as M}from"./domain-input.js?v=1763625242172";import{g as I}from"./site.js?v=1763625242172";import{dV as N,dU as T,dT as J,dP as O,au as Q,d8 as X,d9 as Y,_ as Z,dj as G,dZ as K,aC as ee,dY as ae,az as le}from"./naive.js?v=1763625242172";import{_ as te}from"./index.vue_vue_type_script_setup_true_lang17.js?v=1763625242172";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang10.js?v=1763625242172";import{o as re}from"./upload.js?v=1763625242172";import{_ as ne}from"./task-view.vue_vue_type_script_setup_true_lang.js?v=1763625242172";import"./common.js?v=1763625242172";import"./__commonjsHelpers__.js?v=1763625242172";import"./index.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang12.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1763625242172";import"./index130.js?v=1763625242172";import"./php.js?v=1763625242172";import"./soft.js?v=1763625242172";import"./site4.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang15.js?v=1763625242172";import"./index245.js?v=1763625242172";import"./index99.js?v=1763625242172";import"./index100.js?v=1763625242172";import"./theme-monokai.js?v=1763625242172";import"./file.js?v=1763625242172";import"./refersh.js?v=1763625242172";import"./index104.js?v=1763625242172";import"./ssl.js?v=1763625242172";import"./cert.js?v=1763625242172";import"./ssl-lets-progress.js?v=1763625242172";import"./utils3.js?v=1763625242172";import"./index217.js?v=1763625242172";import"./paypal-js.js?v=1763625242172";import"./index98.js?v=1763625242172";const oe=p({__name:"index",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const a=A(),{phpVersion:l}=_(a),i=m(e,"value"),{loading:r,setLoading:n}=D(),o=c([]),s=e=>{l.value=e};return(async()=>{try{n(!0);const{message:e}=await I(),a=t(e)?e:[];o.value=a.reverse().filter((e=>"00"!==e.version)).map((e=>({label:e.name,value:e.version}))),await h(),a.length>0&&(i.value="00"==a[0].version?"":a[0].version,l.value="00"==a[0].version?"":a[0].version)}finally{n(!1)}})(),(e,a)=>{const l=N;return v(),b(l,{value:i.value,"onUpdate:value":[a[0]||(a[0]=e=>i.value=e),s],loading:f(r),options:f(o)},null,8,["value","loading","options"])}}}),se=p({__name:"index",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const a=A();x((()=>a.phpVersion),(e=>{s(e)}));const l=g((()=>a.phpVersion?"Not supported by current PHP":"Please select PHP version")),i=m(e,"value"),{loading:r,setLoading:n}=D(),o=c([]),s=async e=>{try{n(!0),i.value="";const{message:a}=await q({php_version_short:e});t(a)&&(o.value=a.map((e=>({label:e.version,value:e.version}))),await h(),a.length>0&&(i.value=a[0].version))}finally{n(!1)}};return a.phpVersion&&s(a.phpVersion),(e,a)=>{const t=N;return v(),b(t,{value:i.value,"onUpdate:value":a[0]||(a[0]=e=>i.value=e),loading:f(r),options:f(o),placeholder:f(l)},null,8,["value","loading","options","placeholder"])}}}),de={key:1},ue={class:"w-400px"},pe={class:"w-400px"},_e={class:"w-230px"},me={class:"w-230px"},ce={class:"w-400px"},ve={class:"w-230px mr-16px"},be={class:"w-400px"},fe={class:"w-400px"},he=p({__name:"index",props:{getList:{type:Function}},setup(e,{expose:t}){const p=e,{t:m}=w(),h=i(),{multiService:x}=_(h),q=A(),{mysql:V,php:z,webserver:B}=_(q),D=g((()=>"apache"===B.value&&!x.value)),F=c(null),I=c(null),N=c([]),K=k({type:0,domain_auto:[""],domain:"",weblog_title:"",language:"en",php_version:null,wp_version:null,user_name:r(6),admin_password:n(16,"wp"),pw_weak:!1,admin_email:"",Login_url:"wp-admin",redirection_url:"404",prefix:"wp_"+r(6)+"_",enable_cache:!D.value,wps:!1,is_create_default_file:!0}),ee={domain:{required:!0,trigger:["blur","input"],validator:()=>0!==K.type||""!==K.domain.trim()||new Error(m("Site.RulesError.index_31"))},domain_auto:{trigger:["blur"],validator:(e,a)=>!(1===K.type&&!a[0])||new Error(m("Site.PHP.add_site_23"))},weblog_title:{required:!0,trigger:["blur","input"],validator:()=>""!==K.weblog_title.trim()||new Error(m("Site.RulesError.index_3"))},language:{trigger:"change",validator:()=>null!==K.language||new Error(m("Site.RulesError.index_4"))},php_version:{trigger:"change",validator:()=>null!==K.php_version||new Error(m("Site.RulesError.index_5"))},wp_version:{trigger:"change",validator:()=>null!==K.php_version||new Error(m("Site.RulesError.index_6"))},user_name:{required:!0,trigger:["blur","input"],validator:()=>""!==K.user_name.trim()||new Error(m("Site.RulesError.index_7"))},admin_password:{required:!0,trigger:["blur","input"],validator:()=>""!==K.admin_password.trim()||new Error(m("Site.RulesError.index_8"))},admin_email:{required:!0,trigger:["blur","input"],validator:()=>""!==K.admin_email.trim()||new Error(m("Site.RulesError.index_9"))},redirection_url:{required:!0,trigger:["blur","input"],validator:()=>""!==K.redirection_url.trim()||new Error(m("Site.RulesError.index_12"))},Login_url:{required:!0,trigger:["blur","input"],validator:()=>""!==K.Login_url.trim()||new Error(m("Site.RulesError.index_11"))},prefix:{required:!0,trigger:["blur","input"],validator:()=>""!==K.prefix.trim()||new Error(m("Site.RulesError.index_10"))}},ae=e=>{var a;if(null==(a=F.value)||a.restoreValidation(),!e)return void(K.domain=K.domain_auto[0]);const l=K.domain.trim();l!==K.domain_auto[0]&&(K.domain_auto=l?[l]:[""],K.domain_auto.forEach(((e,a)=>{var l;return null==(l=I.value)?void 0:l.onDomainItemBlur(e,a)})))};return t({onConfirm:async()=>{var e;await new Promise(((e,a)=>{0===N.value.filter((e=>e.support.includes("auto"))).length&&1===K.type?(u.error("This domain does not support automatic resolution, please choose manual resolution"),a(!1)):e(!0)})),await(null==(e=F.value)?void 0:e.validate());const{message:a}=await C((()=>{const{domain:e,php_version:a}=K,l=e.replace(new RegExp(/([-.])/g),"_");if(null===a)throw u.error(m("Site.RulesError.index_5")),new Error(m("Site.RulesError.index_5"));const t=N.value.map((e=>({domain:e.domain,hash:e.hash,support:[...e.auto?["auto"]:[],...e.ssl_cert?["ssl_cert"]:[],...e.cf_proxy?["cf_proxy"]:[]]})));return{webname:{domain:e,domainlist:[],count:0},type:"PHP",port:80,type_id:0,ftp:!1,sql:"MySQL",codeing:"utf8",set_ssl:0,force_ssl:0,project_type:"WP",path:q.sitePath+"/"+(0===K.type?e:K.domain_auto[0]),ps:l,version:a,datauser:"sql_"+l,datapassword:r(16),password:K.admin_password,pw_weak:K.pw_weak?"on":"off",email:K.admin_email,weblog_title:K.weblog_title,language:K.language,user_name:K.user_name,prefix:K.prefix,enable_cache:K.enable_cache?1:0,enable_whl:0,whl_page:K.Login_url?K.Login_url:null,whl_redirect_admin:K.redirection_url?K.redirection_url:null,package_version:K.wp_version,wp_parse_list:1===K.type&&t.length?JSON.stringify(t):null,is_create_default_file:K.is_create_default_file}})());o(a)&&p.getList()}}),(e,t)=>{const i=s,r=T,n=J,o=d,u=O,p=Q,_=X,m=Y,c=Z,h=G,x=l,g=a;return v(),b(g,{install:f(V).setup&&f(z).setup},{desc:y((()=>[S("span",null,j(e.$t("WP.index_6")),1),f(z).setup?$("",!0):(v(),b(i,{key:0,class:"ml-4px",onClick:t[0]||(t[0]=e=>f(H)("php-8.0"))},{default:y((()=>[P(j(e.$t("WP.index_7")),1)])),_:1})),f(V).setup?$("",!0):(v(),L("span",de,[t[17]||(t[17]=S("span",{class:"mx-4px"},"|",-1)),E(i,{onClick:t[1]||(t[1]=e=>f(H)("mysql"))},{default:y((()=>[P(j(e.$t("WP.index_8")),1)])),_:1})]))])),default:y((()=>[E(x,{ref_key:"formRef",ref:F,model:f(K),rules:ee},{default:y((()=>[E(u,{label:e.$t("SSL.index_1")},{default:y((()=>[E(n,{value:f(K).type,"onUpdate:value":[t[2]||(t[2]=e=>f(K).type=e),ae]},{default:y((()=>[E(r,{value:0},{default:y((()=>[P(j(e.$t("SSL.index_2")),1)])),_:1}),E(r,{value:1},{default:y((()=>[P(j(e.$t("SSL.index_3")),1)])),_:1})])),_:1},8,["value"]),E(o,{name:"ssl-stars",size:22})])),_:1},8,["label"]),U(E(u,{label:e.$t("Site.Lable.index_1"),path:"domain_auto"},{default:y((()=>[E(M,{ref_key:"domainInputRef",ref:I,value:f(K).domain_auto,"onUpdate:value":t[3]||(t[3]=e=>f(K).domain_auto=e),"parse-list":f(N),"onUpdate:parseList":t[4]||(t[4]=e=>R(N)?N.value=e:null),is_wp:""},null,8,["value","parse-list"])])),_:1},8,["label"]),[[W,1===f(K).type]]),U(E(u,{label:e.$t("Site.Lable.index_1"),path:"domain"},{default:y((()=>[S("div",ue,[E(p,{value:f(K).domain,"onUpdate:value":t[5]||(t[5]=e=>f(K).domain=e),placeholder:e.$t("Site.Placeholder.index_12")},null,8,["value","placeholder"])])])),_:1},8,["label"]),[[W,0===f(K).type]]),E(u,{label:e.$t("Site.Lable.index_20"),path:"weblog_title"},{default:y((()=>[S("div",pe,[E(p,{value:f(K).weblog_title,"onUpdate:value":t[6]||(t[6]=e=>f(K).weblog_title=e),placeholder:e.$t("Site.Placeholder.index_13")},null,8,["value","placeholder"])])])),_:1},8,["label"]),E(u,{label:e.$t("Site.Lable.index_21"),path:"language"},{default:y((()=>[S("div",_e,[E(te,{value:f(K).language,"onUpdate:value":t[7]||(t[7]=e=>f(K).language=e)},null,8,["value"])])])),_:1},8,["label"]),E(u,{label:e.$t("Site.Lable.index_22"),path:"php_version"},{default:y((()=>[S("div",me,[E(oe,{value:f(K).php_version,"onUpdate:value":t[8]||(t[8]=e=>f(K).php_version=e)},null,8,["value"])])])),_:1},8,["label"]),E(u,{label:e.$t("Site.Lable.index_23"),path:"wp_version"},{default:y((()=>[E(m,{class:"items-center",size:8},{default:y((()=>[E(se,{value:f(K).wp_version,"onUpdate:value":t[9]||(t[9]=e=>f(K).wp_version=e),class:"w-230px"},null,8,["value"]),E(_,{trigger:"hover"},{trigger:y((()=>[E(o,{name:"common-ask",size:"18",color:"#999"})])),default:y((()=>[P(" "+j(e.$t("WP.Add.index_8")),1)])),_:1})])),_:1})])),_:1},8,["label"]),E(u,{label:e.$t("Site.Lable.index_24"),path:"user_name"},{default:y((()=>[S("div",ce,[E(p,{value:f(K).user_name,"onUpdate:value":t[10]||(t[10]=e=>f(K).user_name=e),placeholder:e.$t("Site.Placeholder.index_14")},null,8,["value","placeholder"])])])),_:1},8,["label"]),E(u,{label:e.$t("Site.Lable.index_27"),path:"admin_password"},{default:y((()=>[S("div",ve,[E(p,{value:f(K).admin_password,"onUpdate:value":t[11]||(t[11]=e=>f(K).admin_password=e),placeholder:e.$t("Site.Placeholder.index_15")},null,8,["value","placeholder"])]),E(c,{checked:f(K).pw_weak,"onUpdate:checked":t[12]||(t[12]=e=>f(K).pw_weak=e)},{default:y((()=>[S("span",null,j(e.$t("WP.Add.index_9")),1)])),_:1},8,["checked"])])),_:1},8,["label"]),E(u,{label:e.$t("Site.Lable.index_28"),path:"admin_email"},{default:y((()=>[S("div",be,[E(p,{value:f(K).admin_email,"onUpdate:value":t[13]||(t[13]=e=>f(K).admin_email=e),placeholder:e.$t("Site.Placeholder.index_16")},null,8,["value","placeholder"])])])),_:1},8,["label"]),E(u,{label:e.$t("Site.Lable.index_29"),path:"prefix"},{default:y((()=>[S("div",fe,[E(p,{value:f(K).prefix,"onUpdate:value":t[14]||(t[14]=e=>f(K).prefix=e),placeholder:e.$t("Site.Placeholder.index_17")},null,8,["value","placeholder"])])])),_:1},8,["label"]),E(u,{label:e.$t("Site.Lable.index_31"),"show-feedback":!1},{default:y((()=>[E(c,{checked:f(K).enable_cache,"onUpdate:checked":t[15]||(t[15]=e=>f(K).enable_cache=e),disabled:f(D)},{default:y((()=>t[18]||(t[18]=[S("span",null,"Enable cache, Apache is not supported under single service",-1)]))),_:1,__:[18]},8,["checked","disabled"])])),_:1},8,["label"]),E(u,{label:e.$t("SSL.SiteSSL.index_18")},{default:y((()=>[E(h,{value:f(K).is_create_default_file,"onUpdate:value":t[16]||(t[16]=e=>f(K).is_create_default_file=e)},null,8,["value"])])),_:1},8,["label"])])),_:1},8,["model"])])),_:1},8,["install"])}}}),xe={key:1},ge={class:"w-302px ml-12px"},we={class:"w-302px ml-12px"},ke={class:"w-400px"},ye={class:"w-230px"},Se=p({__name:"index",props:{getList:{type:Function}},setup(e,{expose:t}){const{t:i}=w(),r=A(),{web:n,mysql:o,php:d}=_(r),u=e,p=c(null),m=c(null),h=c(null),x=k({method:1,bak_file:"",domain:"",sub_path:"",php_version:null,enable_cache:!1,db_bak_file:""}),U={bak_file:{trigger:["blur","input"],validator:()=>""!==x.bak_file.trim()||new Error(i("WP.Add.import_6"))},domain:{trigger:["blur","input"],validator:()=>""!==x.domain.trim()||new Error(i("Site.RulesError.index_31"))},php_version:{trigger:"change",validator:()=>null!==x.php_version||new Error(i("Site.RulesError.index_5"))},db_bak_file:{trigger:["blur","input"],validator:()=>""!==x.db_bak_file.trim()||new Error(i("WP.Add.import_6"))}},W=g((()=>x.domain?"/".concat(x.domain,"/"):"/")),q=e=>{const a="/www/server/panel/temp";re({path:a,uploadData:{multiple:!1},onUploadSuccess:l=>{"wp"===e?(x.bak_file="".concat(a,"/").concat(l[0].name),C()):"db"===e&&(x.db_bak_file="".concat(a,"/").concat(l[0].name),D())}})},C=()=>{var e;null==(e=m.value)||e.restoreValidation()},D=()=>{var e;null==(e=h.value)||e.restoreValidation()};return t({onConfirm:async()=>{var e;await(null==(e=p.value)?void 0:e.validate());const a=3===x.method?{db_bak_file:x.db_bak_file,bak_file:x.bak_file,domain:x.domain,sub_path:x.sub_path,php_ver_short:x.php_version||"",enable_cache:x.enable_cache?1:0}:{bak_file:x.bak_file,domain:x.domain,sub_path:x.sub_path,php_ver_short:x.php_version||"",enable_cache:x.enable_cache?1:0};1===x.method?await V(a):2===x.method?await z(a):3===x.method&&await B(a),u.getList()}}),(e,t)=>{const i=s,u=K,_=J,c=O,g=ee,w=ie,k=Q,A=ae,V=le,z=Z,B=l,M=F,I=a;return v(),b(I,{install:f(o).setup&&f(d).setup},{desc:y((()=>[S("span",null,j(e.$t("WP.index_6")),1),f(d).setup?$("",!0):(v(),b(i,{key:0,class:"ml-4px",onClick:t[0]||(t[0]=e=>f(H)("php-8.0"))},{default:y((()=>[P(j(e.$t("WP.index_7")),1)])),_:1})),f(o).setup?$("",!0):(v(),L("span",xe,[t[12]||(t[12]=S("span",{class:"mx-4px"},"|",-1)),E(i,{onClick:t[1]||(t[1]=e=>f(H)("mysql"))},{default:y((()=>[P(j(e.$t("WP.index_8")),1)])),_:1})]))])),default:y((()=>[E(B,{ref_key:"formRef",ref:p,modelValue:f(x),"onUpdate:modelValue":t[11]||(t[11]=e=>R(x)?x.value=e:null),rules:U},{default:y((()=>[E(c,{label:e.$t("WP.Add.import_1")},{default:y((()=>[E(_,{value:f(x).method,"onUpdate:value":t[2]||(t[2]=e=>f(x).method=e)},{default:y((()=>[E(u,{label:e.$t("WP.Add.import_2"),value:1},null,8,["label"]),E(u,{label:e.$t("WP.Add.import_3"),value:2},null,8,["label"]),E(u,{label:"Manual Backup",value:3})])),_:1},8,["value"])])),_:1},8,["label"]),E(c,{ref_key:"bakFileRef",ref:m,label:"WP backup file",path:"bak_file"},{default:y((()=>[E(g,{onClick:t[3]||(t[3]=e=>q("wp"))},{default:y((()=>[P(j(e.$t("Docker.App.Backup.index_3")),1)])),_:1}),S("div",ge,[E(w,{value:f(x).bak_file,"onUpdate:value":t[4]||(t[4]=e=>f(x).bak_file=e),"default-path":"/www/backup/wordpress","checked-type":["file"],onChange:C},null,8,["value"])])])),_:1},512),3===f(x).method?(v(),b(c,{key:0,ref_key:"dbBakFileRef",ref:h,label:"DB backup file",path:"db_bak_file"},{default:y((()=>[E(g,{onClick:t[5]||(t[5]=e=>q("db"))},{default:y((()=>[P(j(e.$t("Docker.App.Backup.index_3")),1)])),_:1}),S("div",we,[E(w,{value:f(x).db_bak_file,"onUpdate:value":t[6]||(t[6]=e=>f(x).db_bak_file=e),"default-path":"/www/backup/wordpress","checked-type":["file"],onChange:D},null,8,["value"])])])),_:1},512)):$("",!0),E(c,{label:e.$t("Site.Lable.index_1"),path:"domain"},{default:y((()=>[S("div",ke,[E(k,{value:f(x).domain,"onUpdate:value":t[7]||(t[7]=e=>f(x).domain=e),placeholder:e.$t("Site.Placeholder.index_12")},null,8,["value","placeholder"])])])),_:1},8,["label"]),E(c,{label:e.$t("Site.PHP.add_site_9"),path:"path"},{default:y((()=>[E(V,{class:"w-400px"},{default:y((()=>[E(A,null,{default:y((()=>[P(j(f(r).sitePath)+j(f(W)),1)])),_:1}),E(k,{value:f(x).sub_path,"onUpdate:value":t[8]||(t[8]=e=>f(x).sub_path=e),placeholder:e.$t("WP.Add.import_5")},null,8,["value","placeholder"])])),_:1})])),_:1},8,["label"]),E(c,{label:e.$t("Site.Lable.index_22"),path:"php_version"},{default:y((()=>[S("div",ye,[E(oe,{value:f(x).php_version,"onUpdate:value":t[9]||(t[9]=e=>f(x).php_version=e)},null,8,["value"])])])),_:1},8,["label"]),E(c,{label:e.$t("Site.Lable.index_31"),"show-feedback":!1},{default:y((()=>[E(z,{checked:f(x).enable_cache,"onUpdate:checked":t[10]||(t[10]=e=>f(x).enable_cache=e),disabled:"nginx"!==f(n).type},{default:y((()=>[P(j(e.$t("WP.Add.index_10")),1)])),_:1},8,["checked","disabled"])])),_:1},8,["label"])])),_:1},8,["modelValue"]),3===f(x).method?(v(),b(M,{key:0},{default:y((()=>t[13]||(t[13]=[S("li",null," Manual backup deployment relies on the wp-config.php file, please ensure that it exists and is configured correctly. ",-1)]))),_:1,__:[13]})):$("",!0)])),_:1},8,["install"])}}}),je={class:"p-20px h-full"},Pe=p({__name:"index",props:{done:{type:Function}},setup(a,{expose:l}){const{t:t}=w(),i=a,r=c("single"),n=c(),o=[{key:"single",label:t("WP.Add.index_1"),isLazy:!0,component:he,data:{getList:i.done}},{key:"import",label:t("WP.Add.index_2"),isLazy:!0,component:Se,data:{getList:i.done}}];return l({onConfirm:async()=>{var e;await(null==(e=n.value)?void 0:e.onConfirm())}}),(a,l)=>{const t=e;return v(),b(ne,{title:a.$t("WP.Add.index_7"),params:"backup_deploy"},{default:y((()=>[S("div",je,[E(t,{ref_key:"tabsRef",ref:n,value:f(r),"onUpdate:value":l[0]||(l[0]=e=>R(r)?r.value=e:null),options:o},null,8,["value"])])])),_:1},8,["title"])}}});export{Pe as default};
