System.register(["./index-legacy107.js?v=1764830988434","./page_layout-legacy.js?v=1764830988434","./vue-legacy.js?v=1764830988434","./public-legacy.js?v=1764830988434","./index-legacy.js?v=1764830988434","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1764830988434","./index.vue_vue_type_script_setup_true_lang-legacy2.js?v=1764830988434","./config-legacy.js?v=1764830988434","./naive-legacy.js?v=1764830988434","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1764830988434","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1764830988434","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1764830988434"],function(e,t){"use strict";var s,a,i,l,n,c,o,u,r,d,p,S,_,y,g,x,v,m,f,h,b,H,w,k,$,B,L,j,C,A,O,U,q,P,M,R,T,z,N,J,F,V,D,I,W,E,G,K,Q,X,Y,Z,ee,te,se,ae,ie,le,ne,ce,oe;return{setters:[e=>{s=e._},e=>{a=e.aD,i=e.i,l=e.d,n=e.q,c=e.o,o=e.a,u=e.bf,r=e.m,d=e.M,p=e.p,S=e.u,_=e.x,y=e.l},e=>{g=e.k,x=e.P,v=e.r,m=e.c,f=e.am,h=e.R,b=e.V,H=e.W,w=e.a3,k=e.S,$=e.ak,B=e.U,L=e.a4,j=e.j,C=e.a2,A=e._,O=e.a0,U=e.e,q=e.o,P=e.N,M=e.l,R=e.v,T=e.F,z=e.n},e=>{N=e.e,J=e.d,F=e.a,V=e.b,D=e.c,I=e.h},e=>{W=e._},e=>{E=e._},e=>{G=e._},e=>{K=e.g},e=>{Q=e.dR,X=e.dj,Y=e.df,Z=e.aC,ee=e.dV,te=e.bJ,se=e.dT,ae=e.e1,ie=e.da,le=e.dS},e=>{ne=e._},e=>{ce=e._},e=>{oe=e._}],execute:function(){var ue=document.createElement("style");ue.textContent=".ul-style[data-v-c0b88226]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-c0b88226]{display:flex;align-items:center}\n/*$vite$:1*/",document.head.appendChild(ue),e("o",(e,t=!0)=>a.post("/ssh_security?action=set_sshkey",e,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_3"),successMessage:t}}));const re=e("g",()=>a.post("/ssh_security?action=get_key")),de=(e("a",e=>a.post("/ssh_security?action=get_logs",e)),e("b",()=>a.post("/ssh_security?action=get_login_send"))),pe=(e("s",(e,t)=>a.post("/ssh_security?action="+(e?"set_login_send":"clear_login_send"),t,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_9"),successMessage:!0}})),e("c",()=>a.post("/ssh_security?action=return_ip")),e("e",e=>a.post("/ssh_security?action=add_return_ip",e,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_10"),successMessage:!0}})),e("d",e=>a.post("/ssh_security?action=del_return_ip",e,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_11"),successMessage:!0}})),{class:"px-16px pt-4px pb-16px"}),Se={class:"mx-20px"},_e={class:"w-200px mr-6px"},ye={class:"ml-10px text-desc"},ge={class:"my-24px"},xe={class:"w-360px"},ve={class:"flex w-260px"},me={class:"flex-1 mr-6px"},fe={class:"ml-10px text-desc"},he={class:"ml-10px text-desc"},be={class:"my-24px"},He={class:"ml-10px text-desc"},we={class:"mt-20px text-desc"},ke=g({__name:"index",setup(e,{expose:s}){const p=A(()=>o(()=>t.import("./open-legacy.js?v=1764830988434"),void 0)),S=A(()=>o(()=>t.import("./view-legacy.js?v=1764830988434"),void 0)),_=A(()=>o(()=>t.import("./index-legacy212.js?v=1764830988434"),void 0)),{t:y}=x(),g=v(!1),O=async e=>{var t;await(t={status:e},a.post("/ssh_security?action="+(t.status?"set_password":"stop_password"),t,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_2"),successMessage:!0}}))},U=v(!1),q=N(y("Security.SSH.Basic.index_19"),{onRefresh:()=>{Le()}}),P=()=>{U.value=!1},M=async e=>{e?q.show=!0:(await a.post("/ssh_security?action=stop_key",{},{requestOptions:{loading:i.global.t("Security.SSH.Api.index_4"),successMessage:!0}}),Le())},R=v(22),T=async()=>{var e;u(R.value)?await(e={port:R.value},a.post("/firewall?action=SetSshPort",e,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_5"),successMessage:!0}})):r.error(y("Security.SSH.Basic.index_20"),{close:!0})},z=v(null),V=v([]),D=async e=>{var t;await(t={p_type:e},a.post("/ssh_security?action=set_root",t,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_6"),successMessage:!0}}))},I=v(""),te=()=>{""!==I.value.trim()?F({title:y("Security.SSH.Basic.index_22"),content:y("Security.SSH.Basic.index_23"),onConfirm:async()=>{var e;await(e={username:"root",password:I.value},a.post("/ssh_security?action=set_root_password",e,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_7"),successMessage:!0}}))}}):r.error(y("Security.SSH.Basic.index_21"))},se=N(y("Security.SSH.Basic.index_2")),ae=()=>{U.value?se.show=!0:r.error(y("Security.SSH.Basic.index_24"))},ie=async()=>{if(!U.value)return void r.error(y("Security.SSH.Basic.index_25"));const{close:e}=r.loading(y("Security.SSH.Basic.index_26"));try{await re(),window.open(`${d()}/ssh_security?action=download_key`)}finally{e()}},le=v(""),ne=v({}),ce=m(()=>void 0===Object.keys(ne.value).find(e=>e===le.value)),oe=m(()=>{const e=ne.value[le.value];return e?e.title:""}),ue=N(y("Security.SSH.Basic.index_13"),{onSetName:e=>{le.value=e}}),ke=()=>{ue.data.config=ne.value,ue.show=!0},$e=f(),Be=()=>{$e.push("/security/system-hardening")},Le=async()=>{const{message:e}=await a.post("/ssh_security?action=get_config");l(e)&&(g.value="yes"===e.password,U.value="yes"===e.pubkey,R.value=e.port,z.value=e.root_login_type,l(e.root_login_types)&&(V.value=Object.entries(e.root_login_types).map(([e,t])=>({label:t,value:e}))))},je=async()=>{const{message:e}=await de();l(e)&&(le.value=e.result)},Ce=async()=>{const{message:e}=await K();l(e)&&(ne.value=e)},{setLoading:Ae}=J(!0);return(async()=>{try{Ae(!0),await Promise.all([Le(),je(),Ce()])}finally{Ae(!1)}})(),s({init:()=>{je(),Le()}}),(e,t)=>{const s=X,a=Q,i=Y,l=Z,o=n,u=ee,r=G,d=c,y=E,x=W;return b(),h("div",pe,[H(y,{"label-width":"140px"},{default:w(()=>[H(a,{label:e.$t("Security.SSH.Basic.index_1")},{default:w(()=>[H(s,{value:B(g),"onUpdate:value":[t[0]||(t[0]=e=>$(g)?g.value=e:null),O],size:"small"},null,8,["value"]),k("span",Se,L(e.$t("Security.SSH.Basic.index_2")),1),H(s,{value:B(U),"onUpdate:value":[t[1]||(t[1]=e=>$(U)?U.value=e:null),M],size:"small"},null,8,["value"])]),_:1},8,["label"]),H(a,{label:e.$t("Security.SSH.Basic.index_3"),"show-feedback":!1},{default:w(()=>[k("div",_e,[H(i,{value:B(R),"onUpdate:value":t[2]||(t[2]=e=>$(R)?R.value=e:null),min:1,max:65535,"show-button":!1},null,8,["value"])]),H(l,{type:"primary",onClick:T},{default:w(()=>[j(L(e.$t("Public.Btn.Save")),1)]),_:1}),k("div",ye,L(e.$t("Security.SSH.Basic.index_4")),1)]),_:1},8,["label"]),k("div",ge,[H(o)]),H(a,{label:e.$t("Security.SSH.Basic.index_5")},{default:w(()=>[k("div",xe,[H(u,{value:B(z),"onUpdate:value":[t[3]||(t[3]=e=>$(z)?z.value=e:null),D],options:B(V)},null,8,["value","options"])])]),_:1},8,["label"]),H(a,{label:e.$t("Security.SSH.Basic.index_6")},{default:w(()=>[k("div",ve,[k("div",me,[H(r,{value:B(I),"onUpdate:value":t[4]||(t[4]=e=>$(I)?I.value=e:null),default:!1},null,8,["value"])]),H(l,{type:"primary",onClick:te},{default:w(()=>[j(L(e.$t("Public.Btn.Reset")),1)]),_:1})]),k("div",fe,L(e.$t("Security.SSH.Basic.index_8")),1)]),_:1},8,["label"]),H(a,{label:e.$t("Security.SSH.Basic.index_9"),"show-feedback":!1},{default:w(()=>[H(l,{type:"primary",class:"btn-xs",onClick:ae},{default:w(()=>[j(L(e.$t("Security.SSH.Basic.index_10")),1)]),_:1}),H(l,{class:"btn-xs ml-10px",onClick:ie},{default:w(()=>[j(L(e.$t("Public.Btn.Download")),1)]),_:1}),k("div",he,L(e.$t("Security.SSH.Basic.index_12")),1)]),_:1},8,["label"]),k("div",be,[H(o)]),H(a,{label:e.$t("Security.SSH.Basic.index_13"),"show-feedback":!1},{default:w(()=>[B(ce)?(b(),C(d,{key:0,type:"warning",onClick:ke},{default:w(()=>[j(L(e.$t("Security.SSH.Basic.index_14")),1)]),_:1})):(b(),C(d,{key:1,onClick:ke},{default:w(()=>[j(L(e.$t("Security.SSH.Basic.index_15",[B(oe)])),1)]),_:1})),H(l,{type:"primary",class:"btn-xs ml-10px",onClick:ke},{default:w(()=>[j(L(e.$t("Public.Btn.Set")),1)]),_:1}),k("div",He,L(e.$t("Security.SSH.Basic.index_12")),1)]),_:1},8,["label"]),k("div",we,[j(L(e.$t("Security.SSH.Basic.index_17"))+" ",1),H(d,{onClick:Be},{default:w(()=>[j(">>"+L(e.$t("Security.SSH.Basic.index_18")),1)]),_:1})])]),_:1}),H(x,{show:B(q).show,"onUpdate:show":t[5]||(t[5]=e=>B(q).show=e),title:B(q).title,data:B(q).data,width:400,"min-height":124,footer:!0,component:B(p),onPublicClose:P},null,8,["show","title","data","component"]),H(x,{show:B(se).show,"onUpdate:show":t[6]||(t[6]=e=>B(se).show=e),title:B(se).title,width:400,"min-height":322,component:B(S)},null,8,["show","title","component"]),H(x,{show:B(ue).show,"onUpdate:show":t[7]||(t[7]=e=>B(ue).show=e),title:B(ue).title,data:B(ue).data,width:1e3,height:600,component:B(_)},null,8,["show","title","data","component"])])}}}),$e={class:"pt-40px pb-40px"},Be={class:"mb-24px text-center text-22px font-bold"},Le={class:"mb-16px"},je={class:"ul-style"},Ce={class:"ml-4px"},Ae={class:"text-center my-24px"},Oe={class:"flex justify-center"},Ue={class:"w-76%"},qe=p(g({__name:"free",setup(e){const t=()=>{V({source:100})};return(e,s)=>{const a=Z,i=te;return b(),h("div",$e,[k("div",Be,L(e.$t("Security.SSH.Logs.free_1")),1),k("div",Le,[k("ul",je,[k("li",null,[k("span",Ce,L(e.$t("Security.SSH.Logs.free_2")),1)])])]),k("div",Ae,[H(a,{type:"primary",class:"h-36px text-14px",onClick:t},{default:w(()=>[j(L(e.$t("WP.Transition.index_7")),1)]),_:1})]),k("div",Oe,[k("div",Ue,[H(i,{class:"flex justify-center w-full",src:B("/static/vite/images/ssh-logs.png")},null,8,["src"])])])])}}}),[["__scopeId","data-v-c0b88226"]]),Pe=g({__name:"index",setup(e,{expose:t}){const{t:s}=x(),n=S(),{isPro:c}=O(n),{table:o,columns:u,setLoading:d}=D([{key:"address",title:s("Security.SSH.Logs.index_5"),render:e=>H("a",{class:"bt-link",href:"javascript:;",onClick:()=>{p(e)}},[e.address,j(":"),H("span",{class:"text-#666 cursor-default"},[e.port])])},{key:"area",title:s("Security.SSH.Logs.index_6"),render:e=>e.area.info||"--"},{key:"user",title:s("Security.SSH.Logs.index_7")},{key:"status",title:s("Security.SSH.Logs.index_8"),render:e=>H("span",{class:e.status?"text-primary":"text-error"},[e.status?s("Security.SSH.Logs.index_14"):s("Security.SSH.Logs.index_15")])},{key:"time",title:s("Security.SSH.Logs.index_9")}]),p=e=>{F({title:s("Security.SSH.Logs.index_10"),content:e.deny_status?s("Security.SSH.Logs.index_13"):s("Security.SSH.Logs.index_11"),onConfirm:async()=>{if(e.deny_status){const{message:s}=await(t={address:e.address},a.post("/safe/syslog/remove_ip_rules",{data:JSON.stringify(t)},{requestOptions:{loading:i.global.t("Security.SSH.Api.index_8")}}));_(s)&&s.length>0&&r.success(s[0].msg)}else{const{message:t}=await(e=>a.post("/safe/syslog/create_ip_rules",{data:JSON.stringify(e)},{requestOptions:{loading:i.global.t("Security.SSH.Api.index_8")}}))({address:e.address,types:"drop",brief:s("Security.SSH.Logs.index_12"),domain:"",choose:"address"});_(t)&&t.length>0&&r.success(t[0].msg)}var t;v()}})},y=U({p:1,limit:20,select:"ALL",search:"",historyType:"ALL"}),g=()=>{c.value&&(y.p=1,v())},v=async()=>{try{d(!0);const{message:t}=await(e=P(y),a.post("/mod/ssh/com/get_ssh_list",{data:JSON.stringify(e)}));l(t)&&(o.data=_(t.data)?t.data:[],o.total=t.total)}finally{d(!1)}var e};return q(()=>{g()}),t({init:e=>{y.select=e||"ALL",g()}}),(e,t)=>{const s=Z,a=ae,i=se,l=oe,n=I,r=ce,d=ne;return B(c)?(b(),C(d,{key:0},{toolsLeft:w(()=>[H(s,{type:"primary",onClick:g},{default:w(()=>[j(L(e.$t("Public.Btn.Refresh")),1)]),_:1})]),toolsRight:w(()=>[H(i,{value:B(y).select,"onUpdate:value":[t[0]||(t[0]=e=>B(y).select=e),g]},{default:w(()=>[H(a,{value:"ALL"},{default:w(()=>[j(L(e.$t("Security.SSH.Logs.index_1")),1)]),_:1}),H(a,{value:"Accepted"},{default:w(()=>[j(L(e.$t("Security.SSH.Logs.index_2")),1)]),_:1}),H(a,{value:"Failed"},{default:w(()=>[j(L(e.$t("Security.SSH.Logs.index_3")),1)]),_:1})]),_:1},8,["value"]),H(l,{value:B(y).search,"onUpdate:value":t[1]||(t[1]=e=>B(y).search=e),width:"320",placeholder:e.$t("Security.SSH.Logs.index_4"),onSearch:g},null,8,["value","placeholder"])]),table:w(()=>[H(n,{loading:B(o).loading,data:B(o).data,columns:B(u)},null,8,["loading","data","columns"])]),pageRight:w(()=>[H(r,{page:B(y).p,"onUpdate:page":t[2]||(t[2]=e=>B(y).p=e),"page-size":B(y).limit,"onUpdate:pageSize":t[3]||(t[3]=e=>B(y).limit=e),"store-key":"security-ssh-logs","item-count":B(o).total,onRefresh:v},null,8,["page","page-size","item-count"])]),_:1})):(b(),C(qe,{key:1}))}}}),Me={class:"mr-10px"},Re={class:"mx-20px"},Te=g({__name:"index",setup(e){const{t:t}=x(),o=U({status:!1,success:0,successToday:0,error:0,errorToday:0}),u=v(),r=v("basic"),d=[{key:"basic",label:t("Security.SSH.index_5"),component:ke},{key:"logs",label:t("Security.SSH.index_6"),data:{type:"ALL"},component:Pe}],p=e=>{u.value.setValue("logs"),z(()=>{const t=u.value.getCompRef("logs");t&&t.init(e)})},S=async()=>{const{message:e}=await a.post("/safe/ssh/GetSshInfo");l(e)&&(o.status=e.status)},_=async()=>{const{message:e}=await a.post("/mod/ssh/com/get_ssh_intrusion");l(e)&&(o.success=e.success,o.successToday=e.today_success,o.error=e.error,o.errorToday=e.today_error)},g=e=>{F({title:t("Security.SSH.index_7"),content:t(e?"Security.SSH.index_8":"Security.SSH.index_9"),onConfirm:async()=>{var t;await(t={status:e?0:1},a.post("/firewall?action=SetSshStatus",t,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_1"),successMessage:!0}})),S(),_()}})},{loading:m,setLoading:f}=J();return f(!0),Promise.all([S(),_()]).finally(()=>{f(!1)}),(e,t)=>{const a=y,i=X,l=n,S=c,_=ie,x=le,v=s;return b(),h(T,null,[H(x,{class:"mb-16px p-16px"},{default:w(()=>[M(H(a,{width:600,height:20,sharp:!1,size:"medium"},null,512),[[R,B(m)]]),M(H(_,{class:"items-center",size:0},{default:w(()=>[k("div",Me,L(e.$t("Security.SSH.index_1")),1),H(i,{value:B(o).status,"onUpdate:value":g},null,8,["value"]),k("div",Re,[H(l,{class:"mx-0! text-20px",vertical:""})]),k("div",null,[k("span",null,L(e.$t("Security.SSH.index_2")),1),H(S,{onClick:t[0]||(t[0]=e=>p("Accepted"))},{default:w(()=>[j(L(e.$t("Security.SSH.index_3",[B(o).success,B(o).successToday])),1)]),_:1}),t[3]||(t[3]=k("span",{class:"mx-10px"},"/",-1)),H(S,{type:"error",onClick:t[1]||(t[1]=e=>p("Failed"))},{default:w(()=>[j(L(e.$t("Security.SSH.index_4",[B(o).error,B(o).errorToday])),1)]),_:1})])]),_:1},512),[[R,!B(m)]])]),_:1}),H(x,{class:"p-16px"},{default:w(()=>[H(v,{ref_key:"tabsRef",ref:u,value:B(r),"onUpdate:value":t[2]||(t[2]=e=>$(r)?r.value=e:null),options:d},null,8,["value"])]),_:1})],64)}}}),ze=Object.freeze(Object.defineProperty({__proto__:null,default:Te},Symbol.toStringTag,{value:"Module"}));e("i",ze)}}});
