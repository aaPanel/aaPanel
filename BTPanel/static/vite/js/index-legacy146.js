System.register(["./index-legacy223.js?v=1769066082311","./public-legacy.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy18.js?v=1769066082311","./vue-legacy.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy11.js?v=1769066082311","./page_layout-legacy.js?v=1769066082311","./soft-legacy.js?v=1769066082311","./naive-legacy.js?v=1769066082311","./php-legacy.js?v=1769066082311","./index-legacy103.js?v=1769066082311","./index-legacy109.js?v=1769066082311","./logs-legacy.js?v=1769066082311","./file-legacy.js?v=1769066082311","./common-legacy.js?v=1769066082311","./__commonjsHelpers__-legacy.js?v=1769066082311","./alarm-legacy.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy10.js?v=1769066082311","./index-legacy105.js?v=1769066082311","./theme-monokai-legacy.js?v=1769066082311","./site-legacy.js?v=1769066082311"],function(e,n){"use strict";var a,t,l,s,i,o,u,_,c,r,d,f,b,p,y,m,g,x,h,z,v,k,w,q,P,M,j,S,B,N,C,I,$,T,U,F,L,G,R,K,O,Q,A,D,E,H,J,W,V,X,Y,Z,ee,ne,ae,te,le,se,ie,oe,ue;return{setters:[e=>{a=e._},e=>{t=e._,l=e.a,s=e.d,i=e.c,o=e.h,u=e.f,_=e.p},e=>{c=e._,r=e.a},e=>{d=e.k,f=e.R,b=e.V,p=e.W,y=e.a3,m=e.S,g=e.a4,x=e.F,h=e.P,z=e.U,v=e.j,k=e.a2,w=e.r,q=e.ak,P=e.e,M=e.O},e=>{j=e._},e=>{S=e.e9,B=e.ea,N=e.q,C=e.eb,I=e.aJ,$=e.ec,T=e.d,U=e.a9,F=e.a8,L=e.T,G=e.aa,R=e.n,K=e.ed,O=e.ee,Q=e.ef,A=e.eg,D=e.eh,E=e.x,H=e.ei,J=e.ej},e=>{W=e.g,V=e.m,X=e.p},e=>{Y=e.aC,Z=e.db,ee=e.dg,ne=e.dl,ae=e.dk,te=e.dW},e=>{le=e.s},e=>{se=e._},e=>{ie=e._},e=>{oe=e.o},e=>{ue=e.a},null,null,null,null,null,null,null,null],execute:function(){const n=d({__name:"index",setup:e=>(e,n)=>{const a=t;return b(),f(x,null,[p(c),p(a,{class:"mt-10px"},{default:y(()=>[m("li",null,g(e.$t("Plugin.Mysql.index_25")),1)]),_:1})],64)}}),_e=d({__name:"index",setup(e,{expose:n}){const{t:a}=h(),s=()=>{l({title:a("Plugin.Mysql.index_16"),content:a("Plugin.Mysql.index_17",[V.datadir]),onConfirm:async()=>{await S({datadir:V.datadir})}})};return W(),n({init:W}),(e,n)=>{const a=j,l=Y,i=Z,o=t;return b(),f(x,null,[p(i,null,{default:y(()=>[p(a,{value:z(V).datadir,"onUpdate:value":n[0]||(n[0]=e=>z(V).datadir=e),class:"w-300px"},null,8,["value"]),p(l,{type:"primary",onClick:s},{default:y(()=>[v(g(e.$t("Plugin.Mysql.index_13")),1)]),_:1})]),_:1}),p(o,{class:"mt-10px"},{default:y(()=>[m("li",null,g(e.$t("Plugin.Mysql.index_14")),1),m("li",null,g(e.$t("Plugin.Mysql.index_15")),1)]),_:1})],64)}}}),ce=d({__name:"index",setup(e,{expose:n}){const a=async()=>{await B({port:V.port})};return W(),n({init:W}),(e,n)=>{const t=ee,l=Y,s=Z;return b(),k(s,null,{default:y(()=>[p(t,{class:"w-100px!","show-button":!1,value:z(V).port,"onUpdate:value":n[0]||(n[0]=e=>z(V).port=e),placeholder:e.$t("Site.TableRow.index_16")},null,8,["value","placeholder"]),p(l,{type:"primary",onClick:a},{default:y(()=>[v(g(e.$t("Public.Btn.Conf")),1)]),_:1})]),_:1})}}}),re=d({__name:"index",setup(e,{expose:n}){const{t:a}=h(),i=w(!1),o=async()=>{try{await C()}catch{i.value=!i.value}},u=()=>{l({title:a("Plugin.Mysql.index_22",[X.title]),content:a("Plugin.Mysql.index_24",[X.title]),onConfirm:async()=>{await le({name:"mysqld",type:"restart"})}})},_=()=>{I(encodeURIComponent("/www/server/data/ssl.zip"))},{loading:c,setLoading:r}=s(),d=async()=>{try{r(!0);const{message:e}=await $();T(e)&&(i.value=e.status)}finally{r(!1)}};return d(),n({init:d}),(e,n)=>{const a=ne,l=ae,s=Y,r=Z,d=N,h=t;return b(),f(x,null,[p(a,{class:"mb-16px",type:"info"},{default:y(()=>n[1]||(n[1]=[v(" This feature will be discontinued in the next version ",-1)])),_:1,__:[1]}),p(r,{class:"items-center"},{default:y(()=>[m("span",null,g(e.$t("Plugin.Mysql.index_30"))+" Mysql SSL",1),p(l,{value:z(i),"onUpdate:value":[n[0]||(n[0]=e=>q(i)?i.value=e:null),o],loading:z(c)},null,8,["value","loading"]),p(s,{onClick:u,type:"primary"},{default:y(()=>[v(g(e.$t("Plugin.Mysql.index_22",[z(X).title])),1)]),_:1})]),_:1}),p(d,{class:"my-16px!"}),p(h,{class:"mb-16px"},{default:y(()=>[m("li",null,g(e.$t("Database.Mysql.index_27")),1),m("li",null,[v(g(e.$t("Database.Mysql.index_28"))+" ",1),m("a",{class:"bt-link",onClick:_},"【SSL.zip】")])]),_:1})],64)}}}),de=[{label:"Launch Time",value:"Run",isTime:!0},{label:"Total Connections",value:"Connections"},{label:"Send",value:"Bytes_sent",isSize:!0},{label:"Receive",value:"Bytes_received",isSize:!0},{label:"Query per second",value:"query"},{label:"Transaction per second",value:"transaction"},{label:"File",value:"File"},{label:"Position",value:"Position"}],fe=[{name:"Active/Max connections",function:e=>e.Threads_running+"/"+e.Max_used_connections,value:"",ps:"If too high, increase max_connections"},{name:"Thread cache hit rate",value:"",function:e=>{const n=(100*(1-Number(e.Threads_created)/Number(e.Connections))).toFixed(2);return n?n+"%":"0"},ps:"If too low, increase thread_cache_size"},{value:"",name:"Index hit rate",function:e=>{const n=Number(e.Key_reads),a=Number(e.Key_read_requests);return(a>0?(100*(1-n/a)).toFixed(2):"0.00")+"%"},ps:"If too low, increase key_buffer_size"},{value:"",name:"Innodb index hit rate",function:e=>{const n=(100*(1-Number(e.Innodb_buffer_pool_reads)/Number(e.Innodb_buffer_pool_read_requests))).toFixed(2);return n||"0"},ps:"If too low, increase innodb_buffer_pool_size"},{value:"",name:"Query cache hit rate",function:e=>{let n=(parseInt(e.Qcache_hits)/(parseInt(e.Qcache_hits)+parseInt(e.Qcache_inserts))*100).toFixed(2)+"%";return"NaN%"==n&&(n="OFF"),n},ps:"If too low, increase query_cache_size"},{value:"",name:"Created temporary tables to disk",function:e=>{const n=(Number(e.Created_tmp_disk_tables)/Number(e.Created_tmp_tables)*100).toFixed(2);return n?n+"%":"0"},ps:"If too high, increase tmp_table_size"},{value:"",name:"Opened table",function:e=>e.Open_tables,ps:"If too high, increase table_open_cache"},{value:"",name:"Amount unindexed",function:e=>e.Select_full_join,ps:"If not 0, please check index of database table"},{value:"",name:"Amount unindexed in table join",function:e=>e.Select_range_check,ps:"If not 0, please check index of database table"},{value:"",name:"Number of merges after sorting",function:e=>e.Sort_merge_passes,ps:"If too high, increase sort_buffer_size"},{value:"",name:"Number of lock tables",function:e=>e.Table_locks_waited,ps:"If too high, consider increase your database performance"}],be=d({__name:"index",setup(e,{expose:n}){const{t:a}=h(),t=P({}),{table:l,columns:u}=i([{title:a("Plugin.Apache.index_12"),key:"name",width:"30%"},{title:a("Plugin.Apache.index_13"),key:"value",width:"20%"},{title:a("Public.Table.Note"),key:"ps",ellipsis:{tooltip:!0}}]),_=e=>{if("query"===e.value)return parseInt((Number(t.Questions)/Number(t.Uptime)).toString());if("transaction"===e.value)return parseInt(((parseInt(t.Com_commit)+parseInt(t.Com_rollback))/Number(t.Uptime)).toString());const n=t[e.value];return void 0===n?"--":e.isTime?G(n):e.isSize?R(n):n},{loading:c,setLoading:r}=s(),d=async()=>{try{r(!0);const{message:e}=await K();T(e)&&(Object.assign(t,e),fe.forEach(e=>{e.function&&(e.value=e.function(t))}),l.data=fe)}finally{r(!1)}};return d(),n({init:d}),(e,n)=>{const a=F,t=U,s=L,i=o;return b(),f(x,null,[p(s,{show:z(c)},{default:y(()=>[p(t,{"label-placement":"left",bordered:"",column:2},{default:y(()=>[(b(!0),f(x,null,M(z(de),e=>(b(),k(a,{label:e.label,key:e.value},{default:y(()=>[v(g(_(e)),1)]),_:2},1032,["label"]))),128))]),_:1})]),_:1},8,["show"]),p(i,{class:"mt-10px",loading:z(c),data:z(l).data,columns:z(u)},null,8,["loading","data","columns"])],64)}}}),pe=[{label:"1-2GB",value:"1-2GB",data:{key_buffer_size:32,query_cache_size:32,tmp_table_size:32,innodb_buffer_pool_size:64,sort_buffer_size:256,read_buffer_size:256,read_rnd_buffer_size:256,join_buffer_size:512,thread_stack:256,binlog_cache_size:64,thread_cache_size:64,table_open_cache:128,max_connections:100}},{label:"2-4GB",value:"2-4GB",data:{key_buffer_size:64,query_cache_size:64,tmp_table_size:64,innodb_buffer_pool_size:128,sort_buffer_size:512,read_buffer_size:512,read_rnd_buffer_size:512,join_buffer_size:1024,thread_stack:256,binlog_cache_size:64,thread_cache_size:96,table_open_cache:192,max_connections:200}},{label:"4-8GB",value:"4-8GB",data:{key_buffer_size:128,query_cache_size:128,tmp_table_size:128,innodb_buffer_pool_size:256,sort_buffer_size:1024,read_buffer_size:1024,read_rnd_buffer_size:768,join_buffer_size:2048,thread_stack:256,binlog_cache_size:128,thread_cache_size:128,table_open_cache:384,max_connections:300}},{label:"8-16GB",value:"8-16GB",data:{key_buffer_size:256,query_cache_size:256,tmp_table_size:256,innodb_buffer_pool_size:512,sort_buffer_size:1024,read_buffer_size:2048,read_rnd_buffer_size:1024,join_buffer_size:2048,thread_stack:384,binlog_cache_size:192,thread_cache_size:192,table_open_cache:1024,max_connections:400}},{label:"16-32GB",value:"16-32GB",data:{key_buffer_size:1024,query_cache_size:384,tmp_table_size:1024,innodb_buffer_pool_size:1024,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:2048,join_buffer_size:4096,thread_stack:512,binlog_cache_size:256,thread_cache_size:256,table_open_cache:2048,max_connections:500}}],ye={key_buffer_size:"MB, Buffer size for indexing",query_cache_size:"MB, Query cache, set to 0 for not enabled",tmp_table_size:"MB, Temporary table cache size",innodb_buffer_pool_size:"MB, Innodb buffer size",innodb_log_buffer_size:"MB, Innodb log buffer size",sort_buffer_size:"KB * Num of connections, Buffer size per thread sort",read_buffer_size:"KB * Num of connections, Read buffer size",read_rnd_buffer_size:"KB * Num of connections, Random read buffer size",join_buffer_size:"KB * Num of connections, Join table buffer size",thread_stack:"KB * Num of connections, Stack size per thread",binlog_cache_size:"KB * Num of connections, Bin log cache size (multiples of 4096)",thread_cache_size:"Thread cache size",table_open_cache:"Table open cache (NOT exceed 2048 at most)",max_connections:"Max connections"},me={class:"w-150px!"},ge={class:"w-250px! color-#666"},xe={class:"color-#666"},he=d({__name:"index",setup(e,{expose:n}){const{t:a}=h(),t=w(),i=w(),o=P({}),u=(e,n)=>{for(const a in n.data)o[a]=n.data[a];_()},_=()=>{const e=new Set(["key_buffer_size","query_cache_size","tmp_table_size","innodb_buffer_pool_size","innodb_log_buffer_size"]),n=new Set(["sort_buffer_size","read_buffer_size","read_rnd_buffer_size","join_buffer_size","thread_stack","binlog_cache_size"]),a=Number(o.max_connections||0),{a:t,b:l}=Object.entries(o).reduce((a,[t,l])=>{const s=Number(l);return e.has(t)?a.a+=s:n.has(t)&&(a.b+=s/1024),a},{a:0,b:0});i.value=(t+l*a).toString()},c=async()=>{const e={...o,query_cache_type:o.query_cache_size>0?1:0,max_heap_table_size:o.tmp_table_size};await O(e),_()},r=()=>{l({title:a("Plugin.Mysql.index_22",[X.title]),content:a("Plugin.Mysql.index_24",[X.title]),onConfirm:async()=>{await le({name:"mysqld",type:"restart"})}})},{loading:d,setLoading:j}=s(),S=async()=>{try{j(!0),t.value=null;const{message:e}=await Q();if(T(e)){const n=e.mem;n.join_buffer_size??=512,n.thread_stack??=256,n.binlog_cache_size??=32;for(const e in ye)e in n&&(o[e]=n[e]);_()}}finally{j(!1)}};return S(),n({init:S}),(e,n)=>{const a=te,l=Z,s=se,_=N,h=ee,w=Y,P=L;return b(),f(x,null,[p(l,{class:"justify-center!"},{default:y(()=>[p(l,{class:"items-center"},{default:y(()=>[m("span",null,g(e.$t("Plugin.Mysql.index_20")),1),p(a,{class:"w-150px",value:z(t),"onUpdate:value":[n[0]||(n[0]=e=>q(t)?t.value=e:null),u],options:z(pe),placeholder:e.$t("Ftp.Placeholder.Index_2")},null,8,["value","options","placeholder"])]),_:1}),p(l,{class:"items-center"},{default:y(()=>[v(g(e.$t("Plugin.Mysql.index_21")),1),p(s,{text:"MB",class:"w-150px!",value:z(i),"onUpdate:value":n[1]||(n[1]=e=>q(i)?i.value=e:null),readonly:""},null,8,["value"])]),_:1})]),_:1}),p(_,{class:"my-10px!"}),p(P,{show:z(d)},{default:y(()=>[(b(!0),f(x,null,M(z(o),(e,n)=>(b(),k(l,{class:"items-center flex-nowrap! py-2px",key:n},{default:y(()=>[m("div",me,g(n),1),p(h,{class:"w-150px!",value:z(o)[n],"onUpdate:value":e=>z(o)[n]=e,min:0,"show-button":!1},null,8,["value","onUpdate:value"]),m("div",ge,g(z(ye)[n]),1)]),_:2},1024))),128)),p(l,{class:"items-center justify-center! mt-10px"},{default:y(()=>[p(w,{type:"primary",onClick:c},{default:y(()=>[v(g(e.$t("Public.Btn.Save")),1)]),_:1}),p(w,{onClick:r},{default:y(()=>[v(g(e.$t("Plugin.Mysql.index_22",[z(X).title])),1)]),_:1}),m("span",xe,"*"+g(e.$t("Plugin.Mysql.index_23")),1)]),_:1})]),_:1},8,["show"])],64)}}}),ze=d({__name:"index",setup(e,{expose:n}){const a=w("None"),{loading:t,setLoading:l}=s(),i=async()=>{await oe({close:1}),o()},o=async()=>{try{l(!0);const{message:e}=await oe();T(e)&&(a.value=e.result?e.result:"None")}finally{l(!1)}};return o(),n({init:o}),(e,n)=>{const l=Y,s=ie,o=L;return b(),f(x,null,[p(l,{class:"mb-10px",onClick:i},{default:y(()=>[v(g(e.$t("Crontab.Planned.index_25")),1)]),_:1}),p(o,{class:"h-580px",show:z(t)},{default:y(()=>[p(s,{log:z(a)},null,8,["log"])]),_:1},8,["show"])],64)}}}),ve=d({__name:"index",setup(e,{expose:n}){const a=w("None"),{loading:t,setLoading:l}=s(),i=async()=>{try{l(!0);const{message:e}=await A();T(e)&&(a.value=e.result?e.result:"None")}finally{l(!1)}};return i(),n({init:i}),(e,n)=>{const l=ie,s=L;return b(),k(s,{class:"h-610px",show:z(t)},{default:y(()=>[p(l,{log:z(a)},null,8,["log"])]),_:1},8,["show"])}}}),ke={class:"ml-20px"},we=d({__name:"index",setup(e,{expose:n}){const{t:a}=h(),c=P({binlog_status:!1,size:0}),{table:r,columns:d}=i([{key:"name",title:a("Site.TableRow.index_22")},{key:"title",title:a("Site.TableRow.index_23"),render:e=>R(e.size)},{key:"title",title:a("Plugin.Mysql.index_8"),render:e=>G(e.last_modified)},u({width:70,options:e=>[{label:a("Public.Btn.Del"),onClick:()=>{_({title:a("Plugin.Mysql.index_9"),content:a("Plugin.Mysql.index_10",[e.name]),onConfirm:async()=>{await ue({path:e.path}),M()}})}}]})]),v=e=>{const n=a(e?"Public.Confirm.Enable":"Public.Status.Disable"),t=a(e?"Plugin.Mysql.index_11":"Plugin.Mysql.index_12");l({title:`${n} ${a("Plugin.Mysql.index_6")}`,content:t,onConfirm:async()=>{await H(),q()}})},{loading:k,setLoading:w}=s(),q=async()=>{const{message:e}=await H({status:1});T(e)&&(c.binlog_status=e.binlog_status,c.size=e.size)},M=async()=>{try{w(!0);const{message:e}=await D();E(e)&&(r.data=e)}finally{w(!1)}},j=()=>{q(),M()};return j(),n({init:j}),(e,n)=>{const a=ae,l=Z,s=N,i=t,u=o;return b(),f(x,null,[p(l,{class:"items-center"},{default:y(()=>[m("span",null,g(e.$t("Plugin.Mysql.index_6")),1),p(a,{value:z(c).binlog_status,loading:z(k),"onUpdate:value":v},null,8,["value","loading"]),m("span",ke,g(z(R)(z(c).size)),1)]),_:1}),p(s,{class:"my-16px!"}),p(i,{class:"mb-16px"},{default:y(()=>[m("li",null,g(e.$t("Plugin.Mysql.index_7")),1)]),_:1}),p(u,{loading:z(k),data:z(r).data,columns:z(d),"max-height":400},null,8,["loading","data","columns"])],64)}}}),qe=d({__name:"index",setup(e,{expose:n}){const a=w(!1),l=async e=>{await J({status:e?1:0}),u()},{loading:i,setLoading:o}=s(),u=async()=>{try{o(!0),await J(),a.value=!0}catch{a.value=!1}finally{o(!1)}};return u(),n({init:u}),(e,n)=>{const s=ae,o=Z,u=N,_=t;return b(),f(x,null,[p(o,{class:"items-center"},{default:y(()=>[m("span",null,g(e.$t("Plugin.Mysql.index_18")),1),p(s,{value:z(a),"onUpdate:value":[n[0]||(n[0]=e=>q(a)?a.value=e:null),l],loading:z(i)},null,8,["value","loading"])]),_:1}),p(u,{class:"my-16px!"}),p(_,{class:"mb-16px"},{default:y(()=>[m("li",null,g(e.$t("Plugin.Mysql.index_19")),1)]),_:1})],64)}}});e("default",d({__name:"index",setup(e){const{t:t}=h(),l=w("service"),s=[{key:"service",label:t("Security.History.Index_10"),component:n},{key:"file",label:t("Site.Config.index_15"),data:{path:"/etc/my.cnf"},component:r},{key:"location",label:t("Plugin.Mysql.index_26"),component:_e},{key:"port",label:t("Site.TableRow.index_16"),component:ce},{key:"ssl",label:"SSL",show:!1,component:re},{key:"status",label:t("Docker.Setting.index_2"),component:be},{key:"optimization",label:t("Plugin.Mysql.index_27"),component:he},{key:"logs",label:t("Site.Config.index_101"),component:ze},{key:"slow",label:t("Plugin.Mysql.index_28"),component:ve},{key:"binary",label:t("Plugin.Mysql.index_6"),component:we},{key:"memory",label:t("Plugin.Mysql.index_18"),component:qe}];return(e,n)=>{const t=a;return b(),k(t,{value:z(l),"onUpdate:value":n[0]||(n[0]=e=>q(l)?l.value=e:null),data:s},null,8,["value"])}}}))}}});
