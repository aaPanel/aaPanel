const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ssh-protection-config.js?v=1769066082311","js/public.js?v=1769066082311","js/page_layout.js?v=1769066082311","js/vue.js?v=1769066082311","js/__commonjsHelpers__.js?v=1769066082311","js/naive.js?v=1769066082311","js/common.js?v=1769066082311","css/page_layout.css?v=1769066082311","css/public.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang.js?v=1769066082311","js/ssh.js?v=1769066082311","js/index112.js?v=1769066082311","js/index104.js?v=1769066082311","css/index16.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang2.js?v=1769066082311","js/index103.js?v=1769066082311","css/index15.css?v=1769066082311","js/index114.js?v=1769066082311","css/index23.css?v=1769066082311","js/ssl-lets-progress.js?v=1769066082311","js/index.js?v=1769066082311","css/index123.css?v=1769066082311","css/ssl-lets-progress.css?v=1769066082311","css/index22.css?v=1769066082311","js/ssh-protection-log.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang5.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang6.js?v=1769066082311","css/index17.css?v=1769066082311","css/ssh-protection-log.css?v=1769066082311","js/form2.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang20.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang10.js?v=1769066082311","js/alarm.js?v=1769066082311","js/index220.js?v=1769066082311","css/index42.css?v=1769066082311","js/config2.js?v=1769066082311","css/config.css?v=1769066082311","js/confirm.js?v=1769066082311","js/confirm.vue_vue_type_script_setup_true_lang.js?v=1769066082311","js/view.js?v=1769066082311"])))=>i.map(i=>d[i]);
import{k as e,j as t,h as s,e as a,b as l,c as n,r as o,i}from"./ssh.js?v=1769066082311";import{d as r,p as c,aE as d,i as u,m as p,M as f,q as _,_ as y,aH as m,cK as g,a as x,cL as v,aa as h,l as b,aA as S,x as w}from"./page_layout.js?v=1769066082311";import{k as $,P,am as k,e as C,c as L,a2 as H,V as I,a3 as T,W as E,S as R,a4 as z,U as A,R as j,O as B,H as O,I as U,F,Z as D,x as V,r as q,l as M,q as N,v as K,a0 as G,o as W,n as Z,a5 as J,an as Y,j as Q,_ as X}from"./vue.js?v=1769066082311";import{dT as ee,db as te,de as se,av as ae,dg as le,d_ as ne,aC as oe,dk as ie,dW as re,dU as ce,dV as de,dZ as ue,dl as pe}from"./naive.js?v=1769066082311";import{u as fe,m as _e,c as ye,a as me,h as ge}from"./public.js?v=1769066082311";import{f as xe,g as ve}from"./index112.js?v=1769066082311";const he={class:"text-primary font-bold text-3xl"},be={class:"text-error font-bold text-3xl"},Se={key:1,class:"w-full h-full bg-[var(--security-server-safe-progress)]"},we={class:"text-primary"},$e={class:"text-error"},Pe=c($({__name:"ssh-login",setup(t){const{t:s}=P(),a=k(),l=C({success:0,error:0,today_success:0,today_error:0,yesterday_success:0,yesterday_error:0,seven_success:0,seven_error:0}),n=L(()=>[{label:s("Public.Search.Today"),success:l.today_success,error:l.today_error},{label:s("Public.Search.Yesterday"),success:l.yesterday_success,error:l.yesterday_error},{label:"7 ".concat(s("Crontab.arrange.index_41")),success:l.seven_success,error:l.seven_error}]),o=(e,t)=>0===t?"0%":"".concat(e/t*100,"%"),i=()=>{a.push({path:"/security/ssh",query:{menu:"logs"}})};return(async()=>{const{message:t}=await e();r(t)&&(l.success=t.success,l.today_success=t.today_success,l.error=t.error,l.today_error=t.today_error,l.yesterday_success=t.yesterday_success,l.yesterday_error=t.yesterday_error,l.seven_success=t.sevenday_success,l.seven_error=t.sevenday_error)})(),(e,t)=>{const s=te,a=ee;return I(),H(a,{class:"p-16px",bordered:!1},{default:T(()=>[E(s,{class:"items-center",size:32},{default:T(()=>[E(s,null,{default:T(()=>[E(s,{class:"stat-box primary p-16px items-center flex-col! rounded-8px min-w-160px",onClick:i},{default:T(()=>[R("span",he,z(A(l).success),1),R("span",null,z(e.$t("SSH login successful")),1)]),_:1}),E(s,{class:"stat-box error p-16px items-center flex-col! rounded-8px min-w-160px",onClick:i},{default:T(()=>[R("span",be,z(A(l).error),1),R("span",null,z(e.$t("SSH login failed")),1)]),_:1})]),_:1}),E(s,{class:"flex-1 flex-col!",size:12},{default:T(()=>[(I(!0),j(F,null,B(A(n),(e,t)=>(I(),H(s,{key:t,class:"items-center flex-nowrap!"},{default:T(()=>[R("div",{class:O(["text-14px min-w-80px",{"text-2xl font-bold":!t}])},z(e.label),3),E(s,{size:0,class:"flex-1 rounded-8px overflow-hidden",style:U({height:t?"8px":"12px"})},{default:T(()=>[e.success+e.error>0?(I(),j(F,{key:0},[R("div",{class:"h-full bg-primary",style:U({width:o(e.success,e.success+e.error)})},null,4),R("div",{class:"h-full bg-error",style:U({width:o(e.error,e.success+e.error)})},null,4)],64)):(I(),j("div",Se))]),_:2},1032,["style"]),E(s,null,{default:T(()=>[R("span",we,z(e.success),1),R("span",$e,z(e.error),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-ebe32ed6"]]),{t:ke}=u.global,Ce=()=>d.post("/ssh_security?action=get_sshd_anti_logs"),Le=e=>d.post("/safe/serversafe/repair_security",{data:JSON.stringify(e)},{requestOptions:{loading:ke("Component.Pay.index_12"),successMessage:!0}}),He=e=>d.post("/ssh_security?action=set_anti_conf",e,{requestOptions:{loading:ke("Component.Pay.index_12"),successMessage:!0}}),Ie=()=>d.post("/ssh_security?action=get_anti_conf"),Te=e=>d.post("/ssh_security?action=del_ban_ip",e,{requestOptions:{loading:ke("Component.Pay.index_12"),successMessage:!0}}),{t:Ee}=u.global,Re=D("service",()=>{const e=C({sshPort:22,complexityLevel:3,minPasswordLength:15,sshAlert:!1,sshProtection:!1,panelAlert:!1,panelOtp:!1,panelSsl:!0,noLoginCode:404,rootLoginType:"without-password",sshKey:!0}),a=C({score:0,total_score:100,score_text:"-",loading:!1}),l=C([{label:Ee("Total banned IP"),value:"-"},{label:Ee("Total failed connection"),value:"-"},{label:Ee("Current banned IP"),value:"-"},{label:Ee("Current failed connection"),value:"-"}]),n=V([]),o=C({install:!0}),i=q([]),c=q([]);return{safeConfig:e,panelLogin:i,sshLogin:c,info:a,sshBruteForce:o,safeItems:n,protectionInfo:l,getSafeConfig:async()=>{var t,s,o,i,c,u,p,f,_,y;try{a.loading=!0;const{message:m}=await d.post("/safe/serversafe/get_security_info");if(r(m)&&(a.score=m.score,a.total_score=m.total_score,a.score_text=m.score_text,n.value=m.security_data,e.sshPort=null==(t=m.security_data.find(e=>1===e.id))?void 0:t.value,e.complexityLevel=null==(s=m.security_data.find(e=>2===e.id))?void 0:s.value,e.minPasswordLength=null==(o=m.security_data.find(e=>3===e.id))?void 0:o.value,e.sshAlert=!!(null==(i=m.security_data.find(e=>4===e.id))?void 0:i.status),e.sshProtection=!!(null==(c=m.security_data.find(e=>6===e.id))?void 0:c.value),e.panelAlert=!!(null==(u=m.security_data.find(e=>7===e.id))?void 0:u.status),e.panelOtp=null==(p=m.security_data.find(e=>8===e.id))?void 0:p.value,e.panelSsl=null==(f=m.security_data.find(e=>10===e.id))?void 0:f.value,e.noLoginCode=null==(_=m.security_data.find(e=>9===e.id))?void 0:_.value,e.rootLoginType=null==(y=m.security_data.find(e=>5===e.id))?void 0:y.value,a.loading=!1,e.sshProtection)){const{message:e}=await Ce();r(e)&&(l[0].value=e.total_banned,l[1].value=e.total_failed,l[2].value=e.currently_banned,l[3].value=e.currently_failed)}}finally{a.loading=!1}},getPanelLogin:async()=>{const{message:e}=await(t={limit:5,p:1},d.post("/logs/panel/get_panel_login_log",t));var t;r(e)&&(i.value=e.data)},getSshLogin:async()=>{const{message:e}=await s({limit:5,p:1,search:"",select:""});r(e)&&(c.value=e.data)},getBruteForceInfo:async()=>{const{message:s}=await t();r(s)&&(o.install=1===s.fail2ban.installed,e.sshKey="yes"===s.config.pubkey)}}}),{t:ze}=u.global,Ae=[{label:"403 - Access Denied",value:403},{label:"404 - Page Not Found",value:404},{label:"416 - Invalid Request",value:416},{label:"408 - Client Timeout",value:408},{label:"400 - Client Request Error",value:400},{label:"401 - Unauthorized Access",value:401}],je=e=>{if(!e||"string"!=typeof e)return"-";const t=e.toLowerCase();return t.includes("edg/")?"Edge":t.includes("opr/")||t.includes("opera")?"Opera":!t.includes("chrome")||t.includes("edg/")||t.includes("opr/")?t.includes("firefox")?"Firefox":t.includes("safari")&&!t.includes("chrome")?"Safari":t.includes("msie")||t.includes("trident/")?"IE":"Unknown":"Chrome"},Be=e=>e<=50?"text-error":e>50&&e<80?"text-warning":"text-primary",Oe=async()=>{const{safeConfig:e}=Re();if(!e.sshKey)return void p.error(ze("Security.SSH.Basic.index_25"));const{close:t}=p.loading(ze("Security.SSH.Basic.index_26"));try{await a(),window.open("".concat(f(),"/ssh_security?action=download_key"))}finally{t()}},Ue={class:"p-16px"},Fe={class:"stat-box"},De={class:"flex justify-between"},Ve={class:"text-2xl font-bold"},qe={class:"color-desc"},Me=c($({__name:"config-card",props:{title:{type:String,default:""},titleTips:{type:String,default:""},tips:{type:String,default:""}},setup:e=>(t,s)=>{const a=te,l=_;return I(),j("div",Ue,[R("div",Fe,[R("div",De,[E(a,{class:"flex-col!"},{default:T(()=>[R("span",Ve,z(e.title),1),R("span",qe,z(e.titleTips),1)]),_:1}),E(a,{class:"flex-nowrap! items-center"},{default:T(()=>[N(t.$slots,"default",{},void 0,!0)]),_:3})]),E(l,{class:"my-10px!"}),M(R("span",null,z(e.tips),513),[[K,e.tips]]),N(t.$slots,"content",{},void 0,!0)])])}}),[["__scopeId","data-v-33de2b22"]]),Ne={class:"safety-config-page pb-20px"},Ke={class:"text-primary font-bold"},Ge={class:"text-primary"},We={class:"whitespace-nowrap"},Ze={class:"mb-10px"},Je=$({__name:"config-safe",props:{target:{type:Number,default:0}},setup(e){const t=Re(),{safeConfig:s}=G(t),a=e,o=()=>{t.getSafeConfig()},i=()=>{s.value.sshPort=Math.floor(64536*Math.random())+1e3},r=async()=>{await l({port:s.value.sshPort}),o()},c=async()=>{await Le({name:"Password Complexity Policy",args:{minclass:s.value.complexityLevel}}),o()},d=async()=>{await Le({name:"Password Length Limit",args:{len:s.value.minPasswordLength}}),o()},u=async e=>{st(e,o)},p=async()=>{await g({status_code:s.value.noLoginCode}),o()},f=async()=>{await n({p_type:s.value.rootLoginType}),o()};return W(()=>{a.target&&Z(()=>{const e=document.getElementById(a.target.toString());e&&e.scrollIntoView({behavior:"smooth",block:"center"})})}),(t,a)=>{const l=se,n=le,_=y,g=ne,x=ae,v=oe,h=J("i18n-t"),b=m,S=te,w=ie,$=re,P=de,k=ce;return I(),j("div",Ne,[E(Me,{id:"1",title:t.$t("SSH port change"),"title-tips":t.$t("Recommended: Use a non-22 port"),tips:t.$t("Modify the default SSH port to avoid malicious scanning"),class:O({"flash-border":1===e.target})},{default:T(()=>[E(l,{type:"warning",size:"small"},{default:T(()=>[Q(z(t.$t("Important")),1)]),_:1}),E(x,{class:"w-200px"},{default:T(()=>[E(n,{value:A(s).sshPort,"onUpdate:value":a[0]||(a[0]=e=>A(s).sshPort=e),"show-button":!1},null,8,["value"]),E(g,{onClick:i},{default:T(()=>[E(_,{name:"base-refresh"})]),_:1})]),_:1}),E(v,{type:"primary",size:"small",onClick:r},{default:T(()=>[Q(z(t.$t("Public.Btn.Apply")),1)]),_:1})]),_:1},8,["title","title-tips","tips","class"]),E(Me,{id:"2",title:t.$t("Password complexity"),"title-tips":t.$t("Recommended: Use a level greater than 3"),class:O({"flash-border":2===e.target})},{content:T(()=>[R("div",null,[E(h,{keypath:"Enable password complexity checks, the current complexity level will contain numbers, uppercase letters, lowercase letters, and special characters {a} types of characters"},{a:T(()=>[R("span",Ke,z(A(s).complexityLevel),1)]),_:1})]),E(S,{class:"items-center mt-10px"},{default:T(()=>[R("span",null,z(t.$t("Complexity level"))+":",1),E(b,{value:A(s).complexityLevel,"onUpdate:value":a[1]||(a[1]=e=>A(s).complexityLevel=e),min:1,max:4,step:1,class:"w-300px",onDragend:c},null,8,["value"]),R("span",Ge,z(A(s).complexityLevel)+"/4",1)]),_:1})]),_:1},8,["title","title-tips","class"]),E(Me,{id:"3",title:t.$t("Password length limit"),"title-tips":t.$t("Recommended: Use a password length of 9-20 characters"),tips:t.$t("Set the minimum password length requirement"),class:O({"flash-border":3===e.target})},{default:T(()=>[R("span",We,z(t.$t("Minimum length"))+":",1),E(n,{"show-button":!1,value:A(s).minPasswordLength,"onUpdate:value":a[2]||(a[2]=e=>A(s).minPasswordLength=e),min:6,max:64,class:"w-100px",size:"small"},null,8,["value"]),E(v,{type:"primary",size:"small",onClick:d},{default:T(()=>[Q(z(t.$t("Public.Btn.Apply")),1)]),_:1})]),_:1},8,["title","title-tips","tips","class"]),E(Me,{id:4,title:t.$t("SSH login alert"),"title-tips":t.$t("Recommended: Enable SSH login alerts"),tips:t.$t("Send alert notifications when SSH logs in"),class:O({"flash-border":4===e.target})},{default:T(()=>[R("span",{class:O(A(s).sshAlert?"text-primary":"text-error")},z(A(s).sshAlert?t.$t("Configured"):t.$t("Not configured")),3),E(v,{type:"primary",size:"small",onClick:a[3]||(a[3]=e=>A(tt)(o,6))},{default:T(()=>[Q(z(t.$t("Configure alert")),1)]),_:1})]),_:1},8,["title","title-tips","tips","class"]),E(Me,{id:"6",title:t.$t("SSH Brute Force Protection"),"title-tips":t.$t("Recommended: Enable SSH Brute Force Protection"),tips:t.$t("Deployed in the background after activation to prevent brute-force attacks"),class:O({"flash-border":6===e.target})},{default:T(()=>[E(w,{value:A(s).sshProtection,"onUpdate:value":a[4]||(a[4]=e=>A(at)(o))},null,8,["value"])]),_:1},8,["title","title-tips","tips","class"]),E(Me,{id:"7",title:t.$t("Panel login alert"),"title-tips":t.$t("Recommended: Enable panel login alerts"),tips:t.$t("Send alert notifications when the panel logs in"),class:O({"flash-border":7===e.target})},{default:T(()=>[R("span",{class:O(A(s).panelAlert?"text-primary":"text-error")},z(A(s).panelAlert?t.$t("Configured"):t.$t("Not configured")),3),E(v,{type:"primary",size:"small",onClick:a[5]||(a[5]=e=>A(tt)(o,7))},{default:T(()=>[Q(z(t.$t("Configure alert")),1)]),_:1})]),_:1},8,["title","title-tips","tips","class"]),E(Me,{id:"8",title:t.$t("Panel Google Authenticator login"),"title-tips":t.$t("Recommended: Enable Google Authenticator login"),tips:t.$t("Enable Google Authenticator login to enhance security"),class:O({"flash-border":8===e.target})},{default:T(()=>[E(w,{value:A(s).panelOtp,"onUpdate:value":u},null,8,["value"])]),_:1},8,["title","title-tips","tips","class"]),E(Me,{id:"9",title:t.$t("Not logged in response status code"),"title-tips":t.$t("Recommended: Set 404 as the response code"),tips:t.$t("The security entry was incorrect and returned certain status"),class:O({"flash-border":9===e.target})},{default:T(()=>[E($,{"consistent-menu-width":!1,value:A(s).noLoginCode,"onUpdate:value":a[6]||(a[6]=e=>A(s).noLoginCode=e),options:A(Ae),class:"w-200px",size:"small"},null,8,["value","options"]),E(v,{type:"primary",size:"small",onClick:p},{default:T(()=>[Q(z(t.$t("Public.Btn.Apply")),1)]),_:1})]),_:1},8,["title","title-tips","tips","class"]),E(Me,{id:"10",title:t.$t("Panel SSL"),"title-tips":t.$t("Recommended: Enable panel HTTPS"),tips:t.$t("Enable HTTPS access (the panel will restart when set)"),class:O({"flash-border":10===e.target})},{default:T(()=>[E(w,{value:A(s).panelSsl,"onUpdate:value":A(lt)},null,8,["value","onUpdate:value"])]),_:1},8,["title","title-tips","tips","class"]),E(Me,{id:"5",title:t.$t("Root password login settings"),"title-tips":t.$t("Recommended: Use only key login"),class:O({"flash-border":5===e.target})},{content:T(()=>[R("div",Ze,z(t.$t("Recommended to only allow key login")),1),E(k,{value:A(s).rootLoginType,"onUpdate:value":a[7]||(a[7]=e=>A(s).rootLoginType=e)},{default:T(()=>[E(P,{value:"without-password"},{default:T(()=>[Q(z(t.$t("Only key login")),1)]),_:1}),E(P,{value:"forced-commands-only"},{default:T(()=>[Q(z(t.$t("Only command execution")),1)]),_:1}),E(P,{value:"yes"},{default:T(()=>[Q(z(t.$t("Password and key login + key")),1)]),_:1}),E(P,{value:"no"},{default:T(()=>[Q(z(t.$t("Prohibited login")),1)]),_:1})]),_:1},8,["value"])]),default:T(()=>[E(v,{type:"primary",size:"small",onClick:f},{default:T(()=>[Q(z(t.$t("Public.Btn.Apply")),1)]),_:1})]),_:1},8,["title","title-tips","class"]),"without-password"===A(s).rootLoginType||"yes"===A(s).rootLoginType?(I(),H(Me,{key:0,title:t.$t("Root key settings"),tips:t.$t("Enable aaPanel key, view and download")},{default:T(()=>[E(v,{type:"primary",size:"small",onClick:A(nt)},{default:T(()=>[Q(z(t.$t("View key")),1)]),_:1},8,["onClick"]),E(v,{size:"small",onClick:A(Oe)},{default:T(()=>[Q(z(t.$t("Download key")),1)]),_:1},8,["onClick"])]),_:1},8,["title","tips"])):Y("",!0)])}}}),{t:Ye}=u.global,Qe=()=>{fe({title:Ye("SSH protection configuration"),width:"400px",minHeight:"200px",footer:!0,component:X(()=>x(()=>import("./ssh-protection-config.js?v=1769066082311"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])))})},Xe=()=>{fe({title:Ye("SSH protection log"),width:"600px",minHeight:"300px",component:X(()=>x(()=>import("./ssh-protection-log.js?v=1769066082311"),__vite__mapDeps([24,25,26,2,3,4,5,6,1,8,7,27,10,11,9,12,13,14,15,16,17,18,19,20,21,22,23,28])))})},et=e=>{fe({title:Ye("Security configuration"),width:"800px",height:"800px",component:Je,data:{target:e}})},tt=(e,t)=>{fe({title:Ye("Configuration alarm task"),width:"860px",minHeight:"340px",footer:!0,data:{isEdit:!1,onRefresh:e,alert_type:t},component:X(()=>x(()=>import("./form2.js?v=1769066082311"),__vite__mapDeps([29,9,3,4,5,6,30,2,1,8,7,31,32,33,34])))})},st=async(e,t)=>{const s=Re(),{safeConfig:a}=G(s);e?a.value.panelOtp?fe({title:Ye("Config.Safe.index_62"),width:600,component:X(()=>x(()=>import("./config2.js?v=1769066082311"),__vite__mapDeps([35,1,2,3,4,5,6,7,8,36])))}):fe({title:Ye("Config.Safe.index_63"),width:670,footer:!0,data:{onRefresh:t},component:X(()=>x(()=>import("./confirm.js?v=1769066082311"),__vite__mapDeps([37,38,2,3,4,5,6,1,8,7,11,9,12,13,14,15,16,17,18,19,20,21,22,23,35,36])))}):(await v({act:0},!0),t())},at=async e=>{const t=Re(),{safeConfig:s,sshBruteForce:a}=G(t);a.value.install?(await He({act:!s.value.sshProtection}),e()):_e("fail2ban",()=>{t.getBruteForceInfo()})},lt=e=>{e?xe():ve()},nt=()=>{const{safeConfig:e}=Re();e.sshKey?fe({title:Ye("Security.SSH.Basic.index_2"),width:"400px",minHeight:"322px",component:X(()=>x(()=>import("./view.js?v=1769066082311"),__vite__mapDeps([39,12,3,4,5,6,2,1,8,7,13,10])))}):p.error(Ye("Security.SSH.Basic.index_24"))},ot={class:"text-2xl font-bold"},it={class:"font-bold text-3xl"},rt={class:"text-2xl font-bold"},ct=["textContent"],dt=c($({__name:"ssh-protection",setup(e){const t=Re(),{sshBruteForce:s,safeConfig:a,protectionInfo:l}=G(t),n=async()=>{_e("fail2ban",()=>{t.getBruteForceInfo()})},o=async e=>{await He({act:e}),await t.getBruteForceInfo(),t.getSafeConfig()};return(e,t)=>{const i=ie,r=oe,c=te,d=y,u=ee;return I(),H(u,{class:"p-16px"},{default:T(()=>[A(s).install?(I(),j(F,{key:0},[E(c,{class:"justify-between!"},{default:T(()=>[E(c,{class:"items-center"},{default:T(()=>[R("span",ot,z(e.$t("SSH protection")),1),E(i,{value:A(a).sshProtection,"onUpdate:value":o},null,8,["value"]),E(r,{type:"primary",size:"small",onClick:A(Qe)},{default:T(()=>[Q(z(e.$t("Security.Tabs.Index_1")),1)]),_:1},8,["onClick"])]),_:1}),E(r,{type:"primary",text:"",onClick:A(Xe)},{default:T(()=>[Q(z(e.$t("Public.Btn.Details")),1)]),_:1},8,["onClick"])]),_:1}),E(c,{class:"flex-nowrap!"},{default:T(()=>[(I(!0),j(F,null,B(A(l),(e,t)=>(I(),H(c,{class:"stat-box flex-col!",key:t},{default:T(()=>[R("span",it,z(e.value),1),R("span",null,z(e.label),1)]),_:2},1024))),128))]),_:1})],64)):(I(),H(c,{key:1,class:"justify-between! items-center h-full"},{default:T(()=>[E(c,{class:"items-center"},{default:T(()=>[E(d,{name:"base-info",size:36,color:"#f2711c"}),E(c,{class:"flex-col!"},{default:T(()=>[R("span",rt,z(e.$t("SSH protection function is not installed")),1),R("span",{textContent:z(e.$t("After installing the SSH protection function, you can effectively prevent malicious login attempts"))},null,8,ct)]),_:1})]),_:1}),E(r,{type:"primary",onClick:n},{default:T(()=>[Q(z(e.$t("Public.Btn.Install")),1)]),_:1})]),_:1}))]),_:1})}}}),[["__scopeId","data-v-c9229bb2"]]),ut={class:"text-2xl font-bold"},pt={class:"flex justify-between w-full"},ft={class:"font-bold"},_t={class:"flex justify-between w-full"},yt={class:"font-bold"},mt=c($({__name:"ssh-login-table",setup(e){const t=Re(),{panelLogin:s,sshLogin:a}=G(t),l=L(()=>{var e;const t=(null==(e=s.value)?void 0:e[0])||{};return{remote_addr:t.remote_addr||"-",remote_port:t.remote_port||0,login_time:t.login_time||0,login_type:t.login_type||0}}),n=L(()=>{var e;const t=(null==(e=a.value)?void 0:e[0])||{};return{address:t.address||"-",status:t.status||0,time:t.time||0,port:t.port||0}});return(e,t)=>{const s=te,a=ee;return I(),H(a,{class:"p-16px"},{default:T(()=>[R("span",ut,z(e.$t("Last login information")),1),E(s,{class:"mt-16px",size:16},{default:T(()=>[E(s,{size:16,class:"stat-box"},{default:T(()=>[R("div",pt,[R("span",ft,z(e.$t("SSH login")),1),R("span",{class:O(A(n).status?"text-primary":"text-error")},z(A(n).status?e.$t("Site.PHP.index_35"):e.$t("Security.SSH.Logs.index_3")),3)]),E(s,{class:"flex-col!"},{default:T(()=>[R("span",null,"IP: "+z(A(n).address),1),R("span",null,z(e.$t("Config.Safe.index_152"))+": "+z(A(h)(A(n).time)||"-"),1),R("span",null,z(e.$t("Site.TableRow.index_16"))+": "+z(A(n).port),1)]),_:1})]),_:1}),E(s,{size:12,class:"stat-box"},{default:T(()=>[R("div",_t,[R("span",yt,z(e.$t("Panel login")),1),R("span",{class:O(A(l).login_type?"text-primary":"text-error")},z(A(l).login_type?e.$t("Site.PHP.index_35"):e.$t("Security.SSH.Logs.index_3")),3)]),E(s,{class:"flex-col!"},{default:T(()=>[R("span",null,"IP: "+z(A(l).remote_addr),1),R("span",null,z(e.$t("Config.Safe.index_152"))+": "+z(A(h)(A(l).login_time)||"-"),1),R("span",null,z(e.$t("Site.TableRow.index_16"))+": "+z(A(l).remote_port),1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-ea1dc392"]]),gt=$({__name:"index",setup:e=>(e,t)=>{const s=te;return I(),H(s,{class:"flex-nowrap!"},{default:T(()=>[E(s,{class:"flex-1"},{default:T(()=>[E(Pe),E(dt)]),_:1}),E(mt,{class:"flex-1"})]),_:1})}}),xt={class:"flex justify-between items-center mb-16px"},vt={class:"text-2xl font-bold"},ht={class:"w-full"},bt={class:"w-full"},St=$({__name:"index",setup(e){const t=Re(),{info:s,safeItems:a}=G(t);return(e,t)=>{const l=te,n=oe,o=b,i=ue,r=y,c=pe,d=S,u=ee;return I(),H(u,{class:"p-16px"},{default:T(()=>[R("div",xt,[E(l,{class:"items-center!"},{default:T(()=>[R("span",vt,[Q(z(e.$t("Safety rating"))+": ",1),R("text",{class:O(A(Be)(A(s).score))},z(A(s).score)+" / "+z(A(s).total_score),3)]),R("span",null,z(A(s).score_text),1)]),_:1}),E(n,{type:"primary",size:"small",onClick:t[0]||(t[0]=e=>A(et)())},{default:T(()=>[t[1]||(t[1]=R("i",{class:"i-material-symbols:settings-outline text-16px mr-3px"},null,-1)),R("span",null,z(e.$t("Security configuration")),1)]),_:1,__:[1]})]),E(d,{cols:"1 s:2 m:3 l:3 xl:5",responsive:"screen","x-gap":12,"y-gap":12},{default:T(()=>[A(s).loading?(I(),j(F,{key:0},B(10,e=>E(i,{key:e},{default:T(()=>[E(o,{height:"100px",sharp:!1})]),_:2},1024)),64)):(I(!0),j(F,{key:1},B(A(a),(e,t)=>(I(),H(i,{key:t},{default:T(()=>[E(c,{class:"cursor-pointer p-10px min-h-100px",title:e.name,type:e.status?"success":"error",onClick:t=>A(et)(e.id),"show-icon":!1},{default:T(()=>[e.status?(I(),H(l,{key:0,class:"flex-nowrap!",size:4},{default:T(()=>[E(r,{name:"base-success",size:"17",color:"#20a53a"}),R("span",ht,z(e.desc),1)]),_:2},1024)):(I(),H(l,{key:1,class:"flex-nowrap!",size:4},{default:T(()=>[E(r,{name:"base-error",size:"17",color:"#E85445"}),R("span",bt,z(e.desc),1)]),_:2},1024))]),_:2},1032,["title","type","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})}}}),wt={class:"text-2xl font-bold"},$t=$({__name:"login-ssh",setup(e){const{t:t}=P(),s=k(),a=Re(),{sshLogin:l}=G(a),{columns:n}=ye([{title:"IP",key:"address",render:e=>E("a",{class:"bt-link",href:"javascript:;",onClick:()=>{d(e)}},[e.address])},{title:t("Security.History.Index_11"),key:"time"},{title:t("Site.TableRow.index_16"),key:"port"},{title:t("Public.Table.Status"),key:"status",render:e=>E("span",{class:1===e.status?"text-primary":"text-error"},[Q(" "),1===e.status?t("Site.PHP.index_35"):t("Security.SSH.Logs.index_3"),Q(" ")])},{title:t("Site.Lable.index_25"),key:"user"}]),r=L(()=>l.value),c=()=>{s.push({path:"/security/ssh",query:{menu:"logs"}})},d=e=>{me({title:t("Security.SSH.Logs.index_10"),content:e.deny_status?t("Security.SSH.Logs.index_13"):t("Security.SSH.Logs.index_11"),onConfirm:async()=>{if(e.deny_status){const{message:t}=await o({address:e.address});w(t)&&t.length>0&&p.success(t[0].msg)}else{const{message:s}=await i({address:e.address,types:"drop",brief:t("Security.SSH.Logs.index_12"),domain:"",choose:"address"});w(s)&&s.length>0&&p.success(s[0].msg)}a.getSshLogin()}})};return(e,t)=>{const s=oe,a=te,l=ge,o=ee;return I(),H(o,{class:"p-16px"},{default:T(()=>[E(a,{class:"mb-10px justify-between!"},{default:T(()=>[R("span",wt,"SSH "+z(e.$t("last 5 login records")),1),E(s,{type:"primary",text:"",onClick:c},{default:T(()=>[Q(z(e.$t("View more")),1)]),_:1})]),_:1}),E(l,{data:A(r),columns:A(n)},null,8,["data","columns"])]),_:1})}}}),Pt={class:"text-2xl font-bold"},kt=$({__name:"login-aapanel",setup(e){const{t:t}=P(),s=Re(),{panelLogin:a}=G(s),{columns:l}=ye([{title:"IP",key:"remote_addr"},{title:t("Security.History.Index_11"),key:"login_time",render:e=>E("span",null,[h(e.login_time)])},{title:t("Site.TableRow.index_16"),key:"remote_port"},{title:t("Public.Table.Status"),key:"login_type",render:e=>E("span",{class:1===e.login_type?"text-primary":"text-error"},[1===e.login_type?t("Site.PHP.index_35"):t("Security.SSH.Logs.index_3")])},{title:t("Waf.Site.Config.index_46"),key:"user_agent",render:e=>E("span",null,[je(e.user_agent)])}]),n=L(()=>a.value);return(e,t)=>{const s=te,a=ge,o=ee;return I(),H(o,{class:"p-16px"},{default:T(()=>[E(s,{class:"mb-10px"},{default:T(()=>[R("span",Pt,"aaPanel "+z(e.$t("last 5 login records")),1)]),_:1}),E(a,{data:A(n),columns:A(l)},null,8,["data","columns"])]),_:1})}}}),Ct=$({__name:"index",setup:e=>(e,t)=>{const s=te;return I(),H(s,{class:"flex-nowrap!"},{default:T(()=>[E($t),E(kt)]),_:1})}}),Lt=$({__name:"index",setup(e){const t=Re();return t.getSafeConfig(),t.getPanelLogin(),t.getSshLogin(),t.getBruteForceInfo(),(e,t)=>{const s=te;return I(),H(s,{class:"flex-col!"},{default:T(()=>[E(gt),E(St),E(Ct)]),_:1})}}}),Ht=Object.freeze(Object.defineProperty({__proto__:null,default:Lt},Symbol.toStringTag,{value:"Module"}));export{Ce as a,Te as d,Ie as g,Ht as i,He as s};
