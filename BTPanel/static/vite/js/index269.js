const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index212.js?v=1763625242172","js/index.js?v=1763625242172","js/vue.js?v=1763625242172","js/__commonjsHelpers__.js?v=1763625242172","js/common.js?v=1763625242172","js/public.js?v=1763625242172","js/page_layout.js?v=1763625242172","js/naive.js?v=1763625242172","css/page_layout.css?v=1763625242172","css/public.css?v=1763625242172","css/index110.css?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang.js?v=1763625242172","js/index.vue_vue_type_script_setup_true_lang8.js?v=1763625242172","css/index93.css?v=1763625242172","js/index213.js?v=1763625242172","js/index245.js?v=1763625242172","css/index59.css?v=1763625242172","css/index94.css?v=1763625242172","js/domain-verification.js?v=1763625242172"])))=>i.map(i=>d[i]);
import{_ as e}from"./index107.js?v=1763625242172";import{dU as t,m as a,e2 as s,c as n,e3 as i,e4 as l,o as d,cx as o,T as r,p as u,_ as c,u as _,du as p,dv as m,dw as S,a as f,e6 as h,e7 as v,x,am as y,aY as w,dx as C}from"./page_layout.js?v=1763625242172";import{c as L,s as g,a as b,g as k,b as $}from"./ssl.js?v=1763625242172";import{C as j}from"./cert.js?v=1763625242172";import{u as P}from"./index241.js?v=1763625242172";import{a as E,u as B,_ as D,e as R,c as N,f as U,l as O,h as A,d as I,U as T,V as z,W as M,p as F}from"./public.js?v=1763625242172";import{_ as J}from"./index99.js?v=1763625242172";import{a as H}from"./ssl-lets-progress.js?v=1763625242172";import{e2 as V,dc as q,dj as G,dk as X,d9 as W,aC as Y,d5 as K,dU as Q,dT as Z,dP as ee,_ as te,eg as ae,H as se}from"./naive.js?v=1763625242172";import{k as ne,P as ie,r as le,c as de,y as oe,R as re,a2 as ue,a3 as ce,V as _e,X as pe,U as me,a4 as Se,j as fe,S as he,aj as ve,an as xe,F as ye,O as we,H as Ce,a0 as Le,e as ge,_ as be,am as ke,w as $e,o as je,l as Pe,v as Ee,m as Be,x as De}from"./vue.js?v=1763625242172";import{_ as Re}from"./index132.js?v=1763625242172";import{_ as Ne}from"./index.js?v=1763625242172";import{_ as Ue}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1763625242172";import{u as Oe}from"./utils3.js?v=1763625242172";import{A as Ae}from"./index217.js?v=1763625242172";import{_ as Ie}from"./index.vue_vue_type_script_setup_true_lang.js?v=1763625242172";import{a3 as Te}from"./site.js?v=1763625242172";import"./common.js?v=1763625242172";import"./__commonjsHelpers__.js?v=1763625242172";import"./index245.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang12.js?v=1763625242172";import"./index100.js?v=1763625242172";import"./theme-monokai.js?v=1763625242172";import"./file.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang10.js?v=1763625242172";import"./index98.js?v=1763625242172";import"./index263.js?v=1763625242172";import"./new.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1763625242172";import"./soft.js?v=1763625242172";import"./index104.js?v=1763625242172";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1763625242172";import"./paypal-js.js?v=1763625242172";const ze={class:"cert-info"},Me={class:"cert-label"},Fe={class:"cert-value"},Je={class:"cert-info"},He={class:"cert-label"},Ve={class:"cert-value"},qe={class:"cert-info"},Ge={class:"cert-label"},Xe={class:"cert-value"},We={class:"cert-info"},Ye={class:"cert-label"},Ke={class:"cert-value"},Qe={key:0,class:"text-primary"},Ze={key:1,class:"text-error"},et={class:"cert-info"},tt={class:"cert-label"},at={class:"cert-value"},st={class:"w-48%"},nt={class:"mb-8px"},it={class:"w-48%"},lt={class:"mb-8px"},dt=u(ne({__name:"index",props:{info:{default:null},isRenew:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(e,{expose:u,emit:c}){const _=e,p=c,{t:m}=ie(),{data:S}=P(),f=t(),h=le(-1),v=le(!1),x=le(!1),y=le(""),w=le("");let C="";const k=le("");let $="";const R=le({issuer:"",notAfter:"",notBefore:"",dns:[],subject:"",endtime:0}),N=de((()=>h.value===j.LetsEncryptDeploy?m("Site.Cert.index_65"):h.value===j.BusinessDeploy?m("Site.Cert.index_64"):h.value===j.TestDeploy?m("Site.Cert.index_38"):m("Site.Cert.index_37"))),U=de((()=>!!k.value)),O=de((()=>_.isRenew||h.value===j.LetsEncryptDeploy)),A=de((()=>!1)),I=de((()=>v.value)),T=async e=>{e?(await g({siteName:S.name}),p("refresh")):E({title:m("Site.Cert.index_12"),content:m("Site.Cert.index_13"),onConfirm:async()=>{await L({siteName:S.name}),p("refresh")},onPublicClose:()=>{x.value=!0}})},z=()=>{""!==w.value.trim()&&""!==k.value.trim()?w.value!==C&&C||k.value!==$&&$?E({title:m("Site.Cert.index_10"),content:m("Site.Cert.index_11"),onConfirm:async()=>{await M()}}):M():a.error(m("Site.Cert.index_9"))},M=async()=>{const{message:e}=await s({key:w.value,cert:k.value});n(e)&&e.hash&&(await i({hash:e.hash,domains:JSON.stringify([S.name]),append:1}),a.success(m("SSL.index_32"))),Q()},F=async()=>{var e;const{message:t}=await l({hash:(null==(e=_.info)?void 0:e.hash)||""});n(t)&&B({hideClose:!0,data:{isJump:!1,task_id:t.task_id,onFinish:()=>{p("refresh")}},component:H})},K=async()=>{await b({updateOf:1,siteName:S.name}),Q()},Q=()=>{p("refresh"),f.setRefresh(!0)};return oe((()=>{const{info:e}=_;e&&(h.value=e.type,v.value=e.status,x.value=e.httpTohttps,w.value=e.key||"",C=e.key||"",k.value=e.csr||"",$=e.csr||"",R.value=e.cert_data,y.value=e.index)})),u({init:p("refresh")}),(e,t)=>{const a=d,s=V,n=q,i=G,l=o,u=X,c=J,_=W,p=Y,m=D,S=r;return re(),ue(S,{show:e.loading},{default:ce((()=>[_e(U)?(re(),ue(u,{key:0,class:"mb-16px",type:"success","show-icon":!1},{default:ce((()=>[pe(l,{"x-gap":12,cols:"15"},{default:ce((()=>[pe(s,{span:"8"},{default:ce((()=>[me("div",ze,[me("div",Me,Se(e.$t("Site.Cert.index_44"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",Fe,[pe(a,null,{default:ce((()=>[fe(Se(_e(N)),1)])),_:1})])])])),_:1}),pe(s,{span:"7"},{default:ce((()=>[me("div",Je,[me("div",He,Se(e.$t("Site.Cert.index_45"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",Ve,[pe(n,null,{default:ce((()=>[fe(Se(_e(R).issuer||"other"),1)])),_:1})])])])),_:1}),pe(s,{span:"8"},{default:ce((()=>[me("div",qe,[me("div",Ge,Se(e.$t("Site.Cert.index_46"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",Xe,[pe(n,null,{default:ce((()=>[fe(Se(_e(R).dns.join(e.$t("Public.Punctuation.Comma"))),1)])),_:1})])])])),_:1}),pe(s,{span:"7"},{default:ce((()=>[me("div",We,[me("div",Ye,Se(e.$t("Site.Cert.index_47"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",Ke,[_e(R).endtime>0?(re(),he("span",Qe,Se(e.$t("Site.Cert.index_48",{date:_e(R).notAfter,days:_e(R).endtime})),1)):(re(),he("span",Ze,Se(e.$t("Site.Cert.index_47")),1))])])])),_:1}),pe(s,{span:"8"},{default:ce((()=>[me("div",et,[me("div",tt,Se(e.$t("Site.Cert.index_49"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",at,[pe(i,{value:_e(x),"onUpdate:value":[t[0]||(t[0]=e=>ve(x)?x.value=e:null),T],size:"small"},null,8,["value"])])])])),_:1})])),_:1})])),_:1})):xe("",!0),pe(_,{class:"mb-16px",size:10,justify:"space-between"},{default:ce((()=>[me("div",st,[me("div",nt,Se(e.$t("Site.Cert.index_50")),1),pe(c,{value:_e(w),"onUpdate:value":t[1]||(t[1]=e=>ve(w)?w.value=e:null),rows:10},null,8,["value"])]),me("div",it,[me("div",lt,Se(e.$t("Site.Cert.index_51")),1),pe(c,{value:_e(k),"onUpdate:value":t[2]||(t[2]=e=>ve(k)?k.value=e:null),rows:10},null,8,["value"])])])),_:1}),pe(_,{class:"mb-12px"},{default:ce((()=>[pe(p,{type:"primary",onClick:z},{default:ce((()=>[fe(Se(_e(v)?e.$t("Public.Btn.Save"):e.$t("Site.Cert.index_52")),1)])),_:1}),_e(O)?(re(),ue(p,{key:0,type:"primary",onClick:F},{default:ce((()=>[fe(Se(e.$t("Site.Cert.index_53")),1)])),_:1})):xe("",!0),_e(A)?(re(),ue(p,{key:1},{default:ce((()=>[fe(Se(e.$t("Site.Cert.index_54")),1)])),_:1})):xe("",!0),_e(I)?(re(),ue(p,{key:2,onClick:K},{default:ce((()=>[fe(Se(e.$t("Site.Cert.index_55")),1)])),_:1})):xe("",!0)])),_:1}),pe(m,null,{default:ce((()=>[me("li",null,Se(e.$t("Site.Cert.index_33")),1),me("li",null,Se(e.$t("Site.Cert.index_34")),1),me("li",null,Se(e.$t("Site.Cert.index_35")),1),me("li",null,Se(e.$t("Site.Cert.index_36")),1)])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-4bc7ae38"]]),ot={class:"business-top-tips flex flex-wrap border-#d6e9c6 border-1px rounded-5px p-12px"},rt={class:"text-#3c763d w-100%"},ut=u(ne({__name:"top-tips",setup(e){const{t:t}=ie(),a=[t("SSL.SiteSSL.index_5"),t("SSL.SiteSSL.index_6"),t("SSL.SiteSSL.index_7"),t("SSL.SiteSSL.index_8"),t("SSL.SiteSSL.index_9"),t("SSL.SiteSSL.index_10"),t("SSL.SiteSSL.index_11")];return(e,t)=>{const s=c,n=W;return re(),he("div",ot,[(re(),he(ye,null,we(a,((e,t)=>pe(n,{size:5,key:e,class:Ce(["flex-nowrap! leading-20px",{"w-33%":t!==a.length-1}])},{default:ce((()=>[pe(s,{name:"base-tick",size:16,color:"#ff8d00"}),me("span",rt,Se(e),1)])),_:2},1032,["class"]))),64))])}}}),[["__scopeId","data-v-12873ea8"]]),ct={class:"my-10px"},_t=ne({__name:"table",setup(e){const a=be((()=>f((()=>import("./index212.js?v=1763625242172")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])))),s=be((()=>f((()=>import("./index213.js?v=1763625242172")),__vite__mapDeps([14,15,2,3,7,4,6,5,9,8,16,17])))),i=be((()=>f((()=>import("./domain-verification.js?v=1763625242172")),__vite__mapDeps([18,6,2,3,7,4,5,9,8,11])))),l=_(),{userInfo:d}=Le(l),o=t(),{t:r}=ie(),u=ge({p:1,limit:9999}),c=R(r("SSL.Business.index_41"),{onRefresh:(e,t)=>{x.data.request=!0,x.data.uc_id=t,x.data.verify=e,x.show=!0,L()}}),h=R(r("SSL.index_44")),v=R(r("SSL.index_49"),{onRefresh:()=>{L(),o.setRefresh(!0)}}),x=R(r("SSL.Business.index_42"),{onRefresh:()=>{L()}}),{table:y,columns:w}=N([{key:"verify_domains",title:r("Layout.Sider.mail_3"),render:e=>pe("span",{innerHTML:e.verify_domains&&e.verify_domains.length>0?e.verify_domains.join("<br/>"):"--"},null)},{key:"title",title:r("Site.Cert.index_44"),render:e=>e.order_info.title,ellipsis:{tooltip:!0}},Oe({title:r("SSL.index_54")}),{key:"order_status",title:r("SSL.Business.index_43"),render:e=>{const t=e.order_info;return t.certId||t.domains.length?!t.certId&&t.domains.length?pe("span",{class:"color-warning"},[fe(" "),r("SSL.Business.index_45"),fe(" ")]):"PENDING"===t.order_status&&1===t.status?pe("span",{class:"color-warning"},[fe(" "),r("SSL.Business.index_46"),fe(" ")]):"COMPLETE"===t.order_status&&1===t.status?pe("span",{class:"color-#20a53a"},[fe(" "),r("SSL.Business.index_47"),fe(" ")]):"CANCELLED"===t.order_status&&1===t.status||-1===t.status?pe("span",{class:"color-warning"},[fe(" "),r("SSL.Business.index_48"),fe(" ")]):"FAILED"===t.order_status&&1===t.status?pe("span",{class:"color-error"},[fe(" "),r("SSL.Business.index_49"),fe(" ")]):"EXPIRED"===t.order_status&&1===t.status?pe("span",{class:"color-warning"},[fe(" "),r("SSL.Business.index_50"),fe(" ")]):1!==t.status||["PENDING","COMPLETE","CANCELLED","FAILED","EXPIRED"].includes(t.order_status)?0===t.status?pe("span",{class:"color-warning"},[fe(" "),r("SSL.Business.index_52"),fe(" ")]):void 0:pe("span",{class:"color-warning"},[fe(" "),r("SSL.Business.index_51"),fe(" ")]):pe("span",{class:"color-warning cursor-pointer",onClick:()=>C(e)},[" ",r("SSL.Business.index_44")," "])}},U({width:140,options:e=>[{show:!e.order_info.certId&&!e.order_info.domains.length,label:r("SSL.Business.index_53"),onClick:()=>{C(e)}},{show:"PENDING"===e.order_info.order_status&&1===e.order_info.status,label:r("SSL.Business.index_54"),onClick:async()=>{const{message:t}=await p({uc_id:e.order_info.uc_id});n(t)&&(x.data.uc_id=e.order_info.uc_id,x.data.verify=t.data,x.data.paths=t.paths,x.show=!0)}},{show:"COMPLETE"===e.order_info.order_status&&1===e.order_info.status,label:r("SSL.index_58"),onClick:async()=>{v.data.row=e,v.show=!0}},{show:"COMPLETE"===e.order_info.order_status&&1===e.order_info.status,label:r("Ftp.Label.index_11"),onClick:async()=>{const t=window.location.origin+"/v2/business_ssl?action=download_cert&uc_id="+e.order_info.uc_id;window.open(t)}},{show:!1,label:r("Public.Btn.Del"),onClick:()=>{E({title:r("SSL.index_59"),content:r("SSL.index_60"),onConfirm:async()=>{await m({hash:e.hash}),L()}})}}]})]),C=e=>{c.data.row=e,c.show=!0},L=async()=>{try{y.loading=!0;const{message:e}=await S(u);n(e)&&(y.data=e.data,y.total=e.total)}finally{y.loading=!1}};return d.value.status&&L(),(e,t)=>{const n=Y,l=A,o=Ue,u=Ne,_=Re;return re(),he("div",ct,[pe(_,{install:_e(d).status},{desc:ce((()=>[t[5]||(t[5]=me("span",{class:"mr-10px"},"Business certificates require login panel to start using them",-1)),pe(n,{type:"primary",onClick:_e(O)},{default:ce((()=>[fe(Se(e.$t("Login.index_3")),1)])),_:1},8,["onClick"])])),default:ce((()=>[pe(o,null,{toolsLeft:ce((()=>[pe(n,{type:"primary",onClick:t[0]||(t[0]=e=>_e(h).show=!0)},{default:ce((()=>[fe(Se(_e(r)("SSL.index_44")),1)])),_:1})])),table:ce((()=>[pe(l,{loading:_e(y).loading,data:_e(y).data,columns:_e(w),"max-height":220},null,8,["loading","data","columns"])])),_:1}),pe(u,{show:_e(h).show,"onUpdate:show":t[1]||(t[1]=e=>_e(h).show=e),title:_e(h).title,data:_e(h).data,"min-height":250,component:Ae},null,8,["show","title","data"]),pe(u,{show:_e(c).show,"onUpdate:show":t[2]||(t[2]=e=>_e(c).show=e),title:_e(c).title,data:_e(c).data,width:650,"min-height":450,component:_e(a)},null,8,["show","title","data","component"]),pe(u,{show:_e(v).show,"onUpdate:show":t[3]||(t[3]=e=>_e(v).show=e),title:_e(v).title,data:_e(v).data,width:720,height:530,component:_e(s)},null,8,["show","title","data","component"]),pe(u,{show:_e(x).show,"onUpdate:show":t[4]||(t[4]=e=>_e(x).show=e),title:_e(x).title,data:_e(x).data,width:650,"min-height":450,component:_e(i)},null,8,["show","title","data","component"])])),_:1},8,["install"])])}}}),pt={class:"text-error"};const mt=u({},[["render",function(e,t){const a=d,s=D;return re(),ue(s,null,{default:ce((()=>[me("li",pt,Se(e.$t("SSL.SiteSSL.index_1")),1),me("li",null,Se(e.$t("SSL.SiteSSL.index_2")),1),me("li",null,Se(e.$t("SSL.SiteSSL.index_3")),1),me("li",null,[fe(Se(e.$t("SSL.SiteSSL.index_4"))+" ",1),pe(a,{href:"https://www.aapanel.com/docs/Function/BusinessCertificate.html",target:"_blank"},{default:ce((()=>[fe(Se(e.$t("SSL.Business.index_20")),1)])),_:1})])])),_:1})}]]),St=ne({__name:"index",setup:e=>(e,t)=>(re(),he("div",null,[pe(ut),pe(_t),pe(mt)]))}),ft={class:"cert-info"},ht={class:"cert-label"},vt={class:"cert-value"},xt={class:"cert-info"},yt={class:"cert-label"},wt={class:"cert-value"},Ct={class:"cert-info"},Lt={class:"cert-label"},gt={class:"cert-value"},bt={class:"cert-info"},kt={class:"cert-label"},$t={class:"cert-value"},jt={key:0,class:"text-primary"},Pt={key:1,class:"text-error"},Et={class:"w-48%"},Bt={class:"mb-8px"},Dt={class:"w-48%"},Rt={class:"mb-8px"},Nt=u(ne({__name:"cert",emits:["update"],setup(e,{emit:a}){const s=a;ie();const{data:i}=P(),d=t(),u=le(!1),c=le(1),_=le(""),p=le(""),m=ge({hash:"",issuer:"",notAfter:"",notBefore:"",dns:[],subject:"",endtime:0}),S=async()=>{const{message:e}=await l({hash:m.hash});n(e)&&B({hideClose:!0,data:{isJump:!1,task_id:e.task_id,onFinish:()=>{x()}},component:H})},f=async()=>{await b({updateOf:1,siteName:i.name}),s("update"),d.setRefresh(!0)},{loading:h,setLoading:v}=I(),x=async()=>{try{v(!0);const{message:e}=await k({siteName:i.name});n(e)&&(u.value=e.status,m.hash=e.hash,m.issuer=e.cert_data.issuer,m.notAfter=e.cert_data.notAfter,m.notBefore=e.cert_data.notBefore,m.dns=e.cert_data.dns,m.subject=e.cert_data.subject,m.endtime=e.cert_data.endtime,_.value=e.key,p.value=e.csr,c.value=e.auto_renew)}finally{v(!1)}};return x(),(e,t)=>{const a=V,s=q,n=o,i=X,l=J,d=W,u=Y,v=D,x=r;return re(),ue(x,{show:_e(h)},{default:ce((()=>[pe(i,{class:"mb-16px",type:"success","show-icon":!1},{default:ce((()=>[pe(n,{"x-gap":12,cols:"15"},{default:ce((()=>[_e(c)?(re(),ue(a,{key:0,span:"16"},{default:ce((()=>[me("div",ft,[me("div",ht,Se(e.$t("SSL.SiteSSL.index_22"))+"：",1),me("div",vt,Se(e.$t("SSL.SiteSSL.index_23")),1)])])),_:1})):xe("",!0),pe(a,{span:"7"},{default:ce((()=>[me("div",xt,[me("div",yt,Se(e.$t("Site.Cert.index_45"))+"：",1),me("div",wt,[pe(s,null,{default:ce((()=>[fe(Se(_e(m).issuer),1)])),_:1})])])])),_:1}),pe(a,{span:"8"},{default:ce((()=>[me("div",Ct,[me("div",Lt,Se(e.$t("Site.Cert.index_46"))+"：",1),me("div",gt,[pe(s,null,{default:ce((()=>[fe(Se(_e(m).dns.join(e.$t("Public.Punctuation.Comma"))),1)])),_:1})])])])),_:1}),pe(a,{span:"7"},{default:ce((()=>[me("div",bt,[me("div",kt,Se(e.$t("Site.Cert.index_47"))+Se(e.$t("Public.Punctuation.Colon")),1),me("div",$t,[_e(m).endtime>0?(re(),he("span",jt,Se(e.$t("Site.Cert.index_48",{date:_e(m).notAfter,days:_e(m).endtime})),1)):(re(),he("span",Pt,Se(e.$t("Site.Cert.index_47")),1))])])])),_:1})])),_:1})])),_:1}),pe(d,{class:"mb-16px",size:10,justify:"space-between"},{default:ce((()=>[me("div",Et,[me("div",Bt,Se(e.$t("Site.Cert.index_50")),1),pe(l,{readonly:"",value:_e(_),"onUpdate:value":t[0]||(t[0]=e=>ve(_)?_.value=e:null),rows:14},null,8,["value"])]),me("div",Dt,[me("div",Rt,Se(e.$t("Site.Cert.index_51")),1),pe(l,{readonly:"",value:_e(p),"onUpdate:value":t[1]||(t[1]=e=>ve(p)?p.value=e:null),rows:14},null,8,["value"])])])),_:1}),pe(d,{class:"mb-12px"},{default:ce((()=>[pe(u,{type:"primary",onClick:S},{default:ce((()=>[fe(Se(e.$t("Site.Cert.index_53")),1)])),_:1}),pe(u,{onClick:f},{default:ce((()=>[fe(Se(e.$t("Site.Cert.index_55")),1)])),_:1})])),_:1}),pe(v,null,{default:ce((()=>[me("li",null,Se(e.$t("SSL.SiteSSL.index_24")),1),me("li",null,Se(e.$t("SSL.SiteSSL.index_25")),1)])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-50ee5bfe"]]),Ut={class:"flex items-center"},Ot={class:"leading-17px"},At={class:"w-full"},It={class:"w-full"},Tt={class:"text-error"},zt=ne({__name:"apply",emits:["update"],setup(e,{emit:s}){const i=ke(),{t:l}=ie(),{data:d}=P(),o=t(),u=s,_=ge({auth_type:"http",dns_manual:0,auto_wildcard:0,domains:[],all:!1}),p={domains:{required:!0,trigger:"change",type:"array",message:l("SSL.SiteSSL.index_16")}},m=le(null),S=le([]),f=e=>{var t;return null==(t=S.value.find((t=>t.name===e)))?void 0:t.auto},C=()=>{i.push("/ssl_domain/domain")},L=de((()=>_.domains.length>0&&_.domains.length<S.value.length));$e((()=>_.domains),(e=>{e.length===S.value.length?_.all=!0:e.length||(_.all=!1)})),$e((()=>_.all),(e=>{var t;e?(_.domains=S.value.map((e=>e.name)),null==(t=m.value)||t.validate()):_.domains=[]})),$e((()=>_.auth_type),(e=>{var t;"dns"===e?(_.domains=S.value.filter((e=>e.auto)).map((e=>e.name)),null==(t=m.value)||t.validate()):_.domains=[]}));const g=de((()=>_.domains.filter((e=>!f(e))))),b=async()=>{var e;if(await(null==(e=m.value)?void 0:e.validate()),"dns"===_.auth_type&&g.value.length&&!_.dns_manual)return void a.error({content:()=>Be("span",{innerHTML:"".concat(g.value.join("<br/>")).concat(l("SSL.SiteSSL.index_14"))})});let t={auth_type:_.dns_manual?"dns_manual":_.auth_type,auto_wildcard:_.auto_wildcard,domains:JSON.stringify(_.domains),site_id:_.dns_manual?d.id:void 0,deploy:_.dns_manual?0:1};if(_.dns_manual&&"dns"===_.auth_type){const{message:e}=await h({site_id:d.id,domains:JSON.stringify(_.domains)});if(n(e)&&Object.keys(e).length)return void T(e.auths,d.id,_.domains,(()=>{u("update"),o.setRefresh(!0)}),!0);const s=B({width:500,height:300,hideClose:!0,component:z});try{const{message:e}=await v(t,!1);n(e)&&(e.deploy?(a.success(e.result||l("SSL.index_32")),u("update"),o.setRefresh(!0)):Array.isArray(e.auths)&&e.auths.length&&T(e.auths,d.id,_.domains,(()=>{u("update"),o.setRefresh(!0)})))}catch(i){M(K(i,"message",""))}finally{s.hide()}return}const{message:s}=await v(t);n(s)&&B({hideClose:!0,data:{isJump:!1,task_id:s.task_id,onFinish:()=>{u("update"),o.setRefresh(!0)}},component:H})},{loading:k,setLoading:$}=I();return je((()=>{(async()=>{try{$(!0);const{message:e}=await Te({id:d.id});if(x(e)){const t=e.map((async e=>{const{message:t}=await y({domain:e.name});n(t)&&S.value.push({name:e.name,auto:t.support.includes("auto")})}));await Promise.all(t)}}finally{$(!1)}})()})),(e,t)=>{const a=c,s=X,n=Q,i=w,l=Z,d=ee,o=te,u=W,h=ae,v=se,x=r,y=Y,$=Ie,j=D;return re(),he("div",null,[Pe(pe(s,{"show-icon":!1,class:"mb-10px"},{default:ce((()=>[me("div",Ut,[pe(a,{name:"base-info",size:"17",class:"mr-8px"}),me("span",Ot,Se(e.$t("SSL.SiteSSL.index_12")),1)])])),_:1},512),[[Ee,"dns"===_e(_).auth_type]]),pe($,{ref_key:"formRef",ref:m,model:_e(_),rules:p,"label-width":"140"},{default:ce((()=>[pe(d,{label:e.$t("Config.Safe.Ssl.index_2")},{default:ce((()=>[pe(l,{value:_e(_).auth_type,"onUpdate:value":t[0]||(t[0]=e=>_e(_).auth_type=e)},{default:ce((()=>[pe(i,null,{default:ce((()=>[pe(n,{value:"http"},{default:ce((()=>[fe(Se(e.$t("SSL.SiteSSL.index_17")),1)])),_:1}),pe(n,{value:"dns"},{default:ce((()=>[fe(Se(e.$t("SSL.index_12"))+" (Wildcard support) ",1)])),_:1})])),_:1})])),_:1},8,["value"])])),_:1},8,["label"]),Pe(pe(d,{label:" ","show-feedback":!1},{default:ce((()=>[pe(o,{checked:_e(_).dns_manual,"onUpdate:checked":t[1]||(t[1]=e=>_e(_).dns_manual=e),"checked-value":1,"unchecked-value":0},{default:ce((()=>[fe(Se(e.$t("SSL.index_2")),1)])),_:1},8,["checked"])])),_:1},512),[[Ee,"dns"===_e(_).auth_type]]),Pe(pe(d,{label:" "},{default:ce((()=>[pe(o,{checked:_e(_).auto_wildcard,"onUpdate:checked":t[2]||(t[2]=e=>_e(_).auto_wildcard=e),"checked-value":1,"unchecked-value":0},{default:ce((()=>[fe(Se(e.$t("SSL.SiteSSL.index_20")),1)])),_:1},8,["checked"])])),_:1},512),[[Ee,"dns"===_e(_).auth_type]]),pe(d,{label:e.$t("Mail.Domain.index_3"),path:"domains"},{default:ce((()=>[pe(x,{show:_e(k),class:"p-12px w-300px max-h-300px min-h-100px overflow-auto border border-solid border-#ccc"},{default:ce((()=>[pe(o,{class:"mb-12px",checked:_e(_).all,"onUpdate:checked":t[3]||(t[3]=e=>_e(_).all=e),label:e.$t("Public.SelectAll"),indeterminate:_e(L)},null,8,["checked","label","indeterminate"]),_e(S).length?(re(),ue(h,{key:0,value:_e(_).domains,"onUpdate:value":t[4]||(t[4]=e=>_e(_).domains=e)},{default:ce((()=>[pe(u,{class:"flex-col!",size:12},{default:ce((()=>[(re(!0),he(ye,null,we(_e(S),(e=>(re(),ue(o,{key:e.name,value:e.name,label:e.name},null,8,["value","label"])))),128))])),_:1})])),_:1},8,["value"])):(re(),ue(v,{key:1,description:"No domain name"}))])),_:1},8,["show"])])),_:1},8,["label"]),Pe(pe(d,{label:" "},{default:ce((()=>[pe(s,{"show-icon":!1,type:_e(g).length?"warning":"success"},{default:ce((()=>[(re(!0),he(ye,null,we(_e(_).domains,(t=>(re(),ue(u,{key:t},{default:ce((()=>[f(t)?(re(),ue(u,{key:0,class:"flex-nowrap! py-3px"},{default:ce((()=>[pe(a,{name:"base-success",size:"17",color:"#20a53a"}),me("span",At,"["+Se(t)+"] "+Se(e.$t("SSL.SiteSSL.index_13")),1)])),_:2},1024)):(re(),ue(u,{key:1,class:"flex-nowrap! py-3px items-center!"},{default:ce((()=>[pe(a,{name:"base-error",size:"17",color:"#E85445"}),me("span",It,"["+Se(t)+"] "+Se(e.$t("SSL.SiteSSL.index_14")),1),pe(y,{type:"primary",size:"tiny",onClick:C},{default:ce((()=>[fe(Se(e.$t("SSL.SiteSSL.index_21")),1)])),_:1})])),_:2},1024))])),_:2},1024)))),128))])),_:1},8,["type"])])),_:1},512),[[Ee,"dns"===_e(_).auth_type&&_e(_).domains.length&&!_e(_).dns_manual]]),pe(d,{label:" "},{default:ce((()=>[pe(y,{type:"primary",onClick:b},{default:ce((()=>[fe(Se(e.$t("Public.Btn.Apply")),1)])),_:1})])),_:1})])),_:1},8,["model"]),Pe(pe(j,{class:"mt-16px"},{default:ce((()=>[me("li",Tt,Se(e.$t("SSL.SiteSSL.index_15")),1),me("li",null,Se(e.$t("Site.Cert.index_21")),1),me("li",null,Se(e.$t("Site.Cert.index_23")),1),me("li",null,Se(e.$t("Site.Cert.index_24")),1)])),_:1},512),[[Ee,"http"===_e(_).auth_type]]),Pe(pe(j,{class:"mt-24px"},{default:ce((()=>[t[5]||(t[5]=me("li",null,"Manually resolved certificates do not support auto-renewal",-1)),me("li",null,Se(e.$t("Site.Cert.index_25")),1),me("li",null,Se(e.$t("Site.Cert.index_26")),1),me("li",null,Se(e.$t("Site.Cert.index_27")),1),me("li",null,Se(e.$t("Site.Cert.index_28")),1)])),_:1,__:[5]},512),[[Ee,"dns"===_e(_).auth_type]])])}}}),Mt=ne({__name:"index",props:{isOpen:{type:Boolean},type:{},onRefresh:{type:Function}},setup(e){const t=e,a=()=>{t.onRefresh()};return(e,s)=>(re(),he("div",null,[t.isOpen&&"Let's Encrypt"===t.type?(re(),ue(Nt,{key:0,onUpdate:a})):(re(),ue(zt,{key:1,onUpdate:a}))]))}}),Ft=ne({__name:"index",props:{onMenuChange:{type:Function}},setup(e,{expose:t}){const{data:s}=P(),{t:l}=ie(),d=ge({p:1,limit:99999}),{columns:o,table:r}=N([{key:"domain",title:l("Site.Cert.index_29"),render:e=>pe("span",{innerHTML:e.verify_domains.length>0?e.verify_domains.join("<br/>"):"--"},null)},Oe({title:l("SSL.index_54"),width:140}),{key:"issuer",title:l("Site.Cert.index_30"),ellipsis:{tooltip:!0}},U({width:150,options:t=>[{label:l("Public.Btn.Deploy"),onClick:async()=>{try{await i({hash:t.hash,domains:JSON.stringify([s.name]),append:1}),a.success(l("SSL.index_32")),setTimeout((()=>{e.onMenuChange()}),500)}catch(n){console.log(n)}}},{show:"Let's Encrypt"===t.provider,label:l("Public.Btn.Del"),onClick:()=>{(e=>{F({title:l("Site.Cert.index_31"),content:l("Site.Cert.index_32"),onConfirm:async()=>{await m({hash:e.hash}),_()}})})(t)}}]})]),{loading:u,setLoading:c}=I(!0),_=async()=>{try{c(!0);const{message:e}=await C(d);n(e)&&(r.data=e.data)}finally{c(!1)}};return _(),t({init:_}),(e,t)=>{const a=A;return re(),he("div",null,[pe(a,{loading:_e(u),columns:_e(o),data:_e(r).data,"max-height":510},null,8,["loading","columns","data"])])}}}),Jt={class:"mr-12px"},Ht={key:0,class:"mr-12px"},Vt={key:1,class:"mr-12px"},qt=ne({__name:"index",setup(a,{expose:s}){const i=t(),{data:d}=P(),{t:o}=ie(),r=le("current"),u=le(""),c=le(j.NotDeploy),_=le(""),p=le(!1),m=le(0),S=le(!1),f=le(""),h=async()=>{const{message:e}=await l({hash:u.value});n(e)&&B({hideClose:!0,data:{isJump:!1,task_id:e.task_id,onFinish:()=>{x()}},component:H})},v=e=>{y.value[0].data&&(y.value[0].data.loading=e)},x=async()=>{try{v(!0);const{message:a}=await $({siteName:d.name});n(a)&&(c.value=a.type,p.value=a.status,m.value=K(a,"cert_data.endtime",0),f.value=a.cert_data.issuer_O||"",S.value=(()=>{let e=!1;return m.value<=30&&(e=!0),c.value===j.TestDeploy&&m.value<0&&(e=!0),c.value!==j.SaveOrHolderDeploy&&c.value!==j.NotDeploy||(e=!1),e})(),_.value=a.cert_data.dns.join(","),u.value=a.hash,t=a,y.value[0].data&&(y.value[0].data.info=t),e=S.value,y.value[0].data&&(y.value[0].data.isRenew=e))}catch(a){p.value=!1,S.value=!1}finally{v(!1)}var e,t},y=le([{key:"current",label:()=>pe("div",null,[pe("span",null,[fe("Current Certs - ")]),pe("span",{class:p.value?"text-#1d9534":"text-red-500"},[fe("["),p.value?"Deployed":"Not Deployed",fe("]")])]),data:{info:null,isRenew:!1,loading:!0,onRefresh:x},component:De(dt)},{key:"business",label:o("Site.Cert.index_64"),component:De(St)},{key:"let",label:o("Site.Cert.index_65"),data:{isOpen:de((()=>p.value)),type:de((()=>f.value)),onRefresh:x},component:De(Mt)},{key:"holder",label:o("Site.Cert.index_66"),component:De(Ft),data:{onMenuChange:()=>{r.value="current",x(),i.setRefresh(!0)}}}]);return s({init:()=>{x()}}),(t,a)=>{const s=Y,n=X,i=e;return re(),he("div",null,[_e(p)?xe("",!0):(re(),ue(n,{key:0,class:"mb-12px",type:"error","show-icon":!1,style:{"--n-padding":"9px 16px"}},{default:ce((()=>[me("span",Jt,Se(t.$t("Site.Cert.index_41")),1),pe(s,{size:"tiny",type:"primary",onClick:a[0]||(a[0]=e=>r.value="business")},{default:ce((()=>[fe(Se(t.$t("Site.Cert.index_43")),1)])),_:1})])),_:1})),_e(p)&&_e(S)?(re(),ue(n,{key:1,class:"mb-12px",type:"error","show-icon":!1,style:{"--n-padding":"9px 16px"}},{default:ce((()=>[_e(m)>0?(re(),he("span",Ht,Se(t.$t("SSL.SiteSSL.index_26",[_e(_),_e(m)])),1)):(re(),he("span",Vt,Se(t.$t("SSL.SiteSSL.index_19",[_e(_)])),1)),pe(s,{size:"tiny",type:"primary",onClick:h},{default:ce((()=>[fe(Se(t.$t("Site.Cert.index_53")),1)])),_:1})])),_:1})):xe("",!0),pe(i,{value:_e(r),"onUpdate:value":a[1]||(a[1]=e=>ve(r)?r.value=e:null),options:_e(y)},null,8,["value","options"])])}}});export{qt as default};
