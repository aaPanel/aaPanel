const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index212.js?v=1764233927359","js/index.js?v=1764233927359","js/vue.js?v=1764233927359","js/__commonjsHelpers__.js?v=1764233927359","js/common.js?v=1764233927359","js/public.js?v=1764233927359","js/page_layout.js?v=1764233927359","js/naive.js?v=1764233927359","css/page_layout.css?v=1764233927359","css/public.css?v=1764233927359","css/index110.css?v=1764233927359","js/index.vue_vue_type_script_setup_true_lang.js?v=1764233927359","js/index.vue_vue_type_script_setup_true_lang8.js?v=1764233927359","css/index93.css?v=1764233927359","js/index213.js?v=1764233927359","js/index245.js?v=1764233927359","css/index59.css?v=1764233927359","css/index94.css?v=1764233927359","js/domain-verification.js?v=1764233927359"])))=>i.map(i=>d[i]);
import{_ as e}from"./index107.js?v=1764233927359";import{d$ as t,cx as a,o as s,T as n,m as i,e3 as l,d,e4 as o,e5 as r,p as u,_ as c,u as _,dt as p,du as m,dv as S,a as f,aY as h,e7 as v,e8 as x,x as y,am as w,dy as C}from"./page_layout.js?v=1764233927359";import{c as L,s as g,a as b,g as k,b as $}from"./ssl.js?v=1764233927359";import{C as j}from"./cert.js?v=1764233927359";import{u as P}from"./index85.js?v=1764233927359";import{_ as E,a as B,u as R,e as D,c as N,f as O,h as U,l as A,d as I,V as T,W as M,X as z,p as F}from"./public.js?v=1764233927359";import{_ as J}from"./index99.js?v=1764233927359";import{a as H}from"./ssl-lets-progress.js?v=1764233927359";import{dk as V,e2 as G,dc as q,dj as W,da as X,aC as Y,dR as K,dT as Q,dU as Z,_ as ee,eg as te,G as ae,d5 as se}from"./naive.js?v=1764233927359";import{k as ne,P as ie,r as le,c as de,y as oe,a2 as re,V as ue,a3 as ce,an as _e,W as pe,U as me,S as Se,a4 as fe,j as he,R as ve,ak as xe,F as ye,O as we,H as Ce,a0 as Le,e as ge,_ as be,am as ke,w as $e,o as je,l as Pe,v as Ee,m as Be,x as Re}from"./vue.js?v=1764233927359";import{_ as De}from"./index132.js?v=1764233927359";import{_ as Ne}from"./index.js?v=1764233927359";import{_ as Oe}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1764233927359";import{u as Ue}from"./utils3.js?v=1764233927359";import{A as Ae}from"./index217.js?v=1764233927359";import{_ as Ie}from"./index.vue_vue_type_script_setup_true_lang.js?v=1764233927359";import{a3 as Te}from"./site.js?v=1764233927359";import"./common.js?v=1764233927359";import"./__commonjsHelpers__.js?v=1764233927359";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1764233927359";import"./index.vue_vue_type_script_setup_true_lang12.js?v=1764233927359";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1764233927359";import"./site4.js?v=1764233927359";import"./index245.js?v=1764233927359";import"./index.vue_vue_type_script_setup_true_lang10.js?v=1764233927359";import"./index98.js?v=1764233927359";import"./index100.js?v=1764233927359";import"./theme-monokai.js?v=1764233927359";import"./file.js?v=1764233927359";import"./index104.js?v=1764233927359";import"./soft.js?v=1764233927359";import"./useOperate.js?v=1764233927359";import"./useModal2.js?v=1764233927359";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1764233927359";import"./paypal-js.js?v=1764233927359";const Me={class:"cert-info"},ze={class:"cert-label"},Fe={class:"cert-value"},Je={class:"cert-info"},He={class:"cert-label"},Ve={class:"cert-value"},Ge={class:"cert-info"},qe={class:"cert-label"},We={class:"cert-value"},Xe={class:"cert-info"},Ye={class:"cert-label"},Ke={class:"cert-value"},Qe={key:0,class:"text-primary"},Ze={key:1,class:"text-error"},et={class:"cert-info"},tt={class:"cert-label"},at={class:"cert-value"},st={class:"w-48%"},nt={class:"mb-8px"},it={class:"w-48%"},lt={class:"mb-8px"},dt=u(ne({__name:"index",props:{info:{default:null},isRenew:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(e,{expose:u,emit:c}){const _=e,p=c,{t:m}=ie(),{data:S}=P(),f=t(),h=le(-1),v=le(!1),x=le(!1),y=le(""),w=le("");let C="";const k=le("");let $="";const D=le({issuer:"",notAfter:"",notBefore:"",dns:[],subject:"",endtime:0}),N=de(()=>h.value===j.LetsEncryptDeploy?m("Site.Cert.index_65"):h.value===j.BusinessDeploy?m("Site.Cert.index_64"):h.value===j.TestDeploy?m("Site.Cert.index_38"):m("Site.Cert.index_37")),O=de(()=>!!k.value),U=de(()=>_.isRenew||h.value===j.LetsEncryptDeploy),A=de(()=>!1),I=de(()=>v.value),T=async e=>{e?(await g({siteName:S.name}),p("refresh")):B({title:m("Site.Cert.index_12"),content:m("Site.Cert.index_13"),onConfirm:async()=>{await L({siteName:S.name}),p("refresh")},onPublicClose:()=>{x.value=!0}})},M=()=>{""!==w.value.trim()&&""!==k.value.trim()?w.value!==C&&C||k.value!==$&&$?B({title:m("Site.Cert.index_10"),content:m("Site.Cert.index_11"),onConfirm:async()=>{await z()}}):z():i.error(m("Site.Cert.index_9"))},z=async()=>{const{message:e}=await l({key:w.value,cert:k.value});d(e)&&e.hash&&(await o({hash:e.hash,domains:JSON.stringify([S.name]),append:1}),i.success(m("SSL.index_32"))),Q()},F=async()=>{var e;const{message:t}=await r({hash:(null==(e=_.info)?void 0:e.hash)||""});d(t)&&R({hideClose:!0,data:{isJump:!1,task_id:t.task_id,onFinish:()=>{p("refresh")}},component:H})},K=async()=>{await b({updateOf:1,siteName:S.name}),Q()},Q=()=>{p("refresh"),f.setRefresh(!0)};return oe(()=>{const{info:e}=_;e&&(h.value=e.type,v.value=e.status,x.value=e.httpTohttps,w.value=e.key||"",C=e.key||"",k.value=e.csr||"",$=e.csr||"",D.value=e.cert_data,y.value=e.index)}),u({init:p("refresh")}),(e,t)=>{const i=s,l=G,d=q,o=W,r=a,u=V,c=J,_=X,p=Y,m=E,S=n;return ue(),re(S,{show:e.loading},{default:ce(()=>[me(O)?(ue(),re(u,{key:0,class:"mb-16px",type:"success","show-icon":!1},{default:ce(()=>[pe(r,{"x-gap":12,cols:"15"},{default:ce(()=>[pe(l,{span:"8"},{default:ce(()=>[Se("div",Me,[Se("div",ze,fe(e.$t("Site.Cert.index_44"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",Fe,[pe(i,null,{default:ce(()=>[he(fe(me(N)),1)]),_:1})])])]),_:1}),pe(l,{span:"7"},{default:ce(()=>[Se("div",Je,[Se("div",He,fe(e.$t("Site.Cert.index_45"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",Ve,[pe(d,null,{default:ce(()=>[he(fe(me(D).issuer||"other"),1)]),_:1})])])]),_:1}),pe(l,{span:"8"},{default:ce(()=>[Se("div",Ge,[Se("div",qe,fe(e.$t("Site.Cert.index_46"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",We,[pe(d,null,{default:ce(()=>[he(fe(me(D).dns.join(e.$t("Public.Punctuation.Comma"))),1)]),_:1})])])]),_:1}),pe(l,{span:"7"},{default:ce(()=>[Se("div",Xe,[Se("div",Ye,fe(e.$t("Site.Cert.index_47"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",Ke,[me(D).endtime>0?(ue(),ve("span",Qe,fe(e.$t("Site.Cert.index_48",{date:me(D).notAfter,days:me(D).endtime})),1)):(ue(),ve("span",Ze,fe(e.$t("Site.Cert.index_47")),1))])])]),_:1}),pe(l,{span:"8"},{default:ce(()=>[Se("div",et,[Se("div",tt,fe(e.$t("Site.Cert.index_49"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",at,[pe(o,{value:me(x),"onUpdate:value":[t[0]||(t[0]=e=>xe(x)?x.value=e:null),T],size:"small"},null,8,["value"])])])]),_:1})]),_:1})]),_:1})):_e("",!0),pe(_,{class:"mb-16px",size:10,justify:"space-between"},{default:ce(()=>[Se("div",st,[Se("div",nt,fe(e.$t("Site.Cert.index_50")),1),pe(c,{value:me(w),"onUpdate:value":t[1]||(t[1]=e=>xe(w)?w.value=e:null),rows:10},null,8,["value"])]),Se("div",it,[Se("div",lt,fe(e.$t("Site.Cert.index_51")),1),pe(c,{value:me(k),"onUpdate:value":t[2]||(t[2]=e=>xe(k)?k.value=e:null),rows:10},null,8,["value"])])]),_:1}),pe(_,{class:"mb-12px"},{default:ce(()=>[pe(p,{type:"primary",onClick:M},{default:ce(()=>[he(fe(me(v)?e.$t("Public.Btn.Save"):e.$t("Site.Cert.index_52")),1)]),_:1}),me(U)?(ue(),re(p,{key:0,type:"primary",onClick:F},{default:ce(()=>[he(fe(e.$t("Site.Cert.index_53")),1)]),_:1})):_e("",!0),me(A)?(ue(),re(p,{key:1},{default:ce(()=>[he(fe(e.$t("Site.Cert.index_54")),1)]),_:1})):_e("",!0),me(I)?(ue(),re(p,{key:2,onClick:K},{default:ce(()=>[he(fe(e.$t("Site.Cert.index_55")),1)]),_:1})):_e("",!0)]),_:1}),pe(m,null,{default:ce(()=>[Se("li",null,fe(e.$t("Site.Cert.index_33")),1),Se("li",null,fe(e.$t("Site.Cert.index_34")),1),Se("li",null,fe(e.$t("Site.Cert.index_35")),1),Se("li",null,fe(e.$t("Site.Cert.index_36")),1)]),_:1})]),_:1},8,["show"])}}}),[["__scopeId","data-v-d003ad66"]]),ot={class:"business-top-tips flex flex-wrap border-#d6e9c6 border-1px rounded-5px p-12px"},rt={class:"text-#3c763d w-100%"},ut=u(ne({__name:"top-tips",setup(e){const{t:t}=ie(),a=[t("SSL.SiteSSL.index_5"),t("SSL.SiteSSL.index_6"),t("SSL.SiteSSL.index_7"),t("SSL.SiteSSL.index_8"),t("SSL.SiteSSL.index_9"),t("SSL.SiteSSL.index_10"),t("SSL.SiteSSL.index_11")];return(e,t)=>{const s=c,n=X;return ue(),ve("div",ot,[(ue(),ve(ye,null,we(a,(e,t)=>pe(n,{size:5,key:e,class:Ce(["flex-nowrap! leading-20px",{"w-33%":t!==a.length-1}])},{default:ce(()=>[pe(s,{name:"base-tick",size:16,color:"#ff8d00"}),Se("span",rt,fe(e),1)]),_:2},1032,["class"])),64))])}}}),[["__scopeId","data-v-da25cdef"]]),ct={class:"my-10px"},_t=ne({__name:"table",setup(e){const a=be(()=>f(()=>import("./index212.js?v=1764233927359"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),s=be(()=>f(()=>import("./index213.js?v=1764233927359"),__vite__mapDeps([14,15,2,3,7,4,6,5,9,8,16,17]))),n=be(()=>f(()=>import("./domain-verification.js?v=1764233927359"),__vite__mapDeps([18,6,2,3,7,4,5,9,8,11]))),i=_(),{userInfo:l}=Le(i),o=t(),{t:r}=ie(),u=ge({p:1,limit:9999}),c=D(r("SSL.Business.index_41"),{onRefresh:(e,t)=>{x.data.request=!0,x.data.uc_id=t,x.data.verify=e,x.show=!0,L()}}),h=D(r("SSL.index_44")),v=D(r("SSL.index_49"),{onRefresh:()=>{L(),o.setRefresh(!0)}}),x=D(r("SSL.Business.index_42"),{onRefresh:()=>{L()}}),{table:y,columns:w}=N([{key:"verify_domains",title:r("Layout.Sider.mail_3"),render:e=>pe("span",{innerHTML:e.verify_domains&&e.verify_domains.length>0?e.verify_domains.join("<br/>"):"--"},null)},{key:"title",title:r("Site.Cert.index_44"),render:e=>e.order_info.title,ellipsis:{tooltip:!0}},Ue({title:r("SSL.index_54")}),{key:"order_status",title:r("SSL.Business.index_43"),render:e=>{const t=e.order_info;return t.certId||t.domains.length?!t.certId&&t.domains.length?pe("span",{class:"color-warning"},[he(" "),r("SSL.Business.index_45"),he(" ")]):"PENDING"===t.order_status&&1===t.status?pe("span",{class:"color-warning"},[he(" "),r("SSL.Business.index_46"),he(" ")]):"COMPLETE"===t.order_status&&1===t.status?pe("span",{class:"color-#20a53a"},[he(" "),r("SSL.Business.index_47"),he(" ")]):"CANCELLED"===t.order_status&&1===t.status||-1===t.status?pe("span",{class:"color-warning"},[he(" "),r("SSL.Business.index_48"),he(" ")]):"FAILED"===t.order_status&&1===t.status?pe("span",{class:"color-error"},[he(" "),r("SSL.Business.index_49"),he(" ")]):"EXPIRED"===t.order_status&&1===t.status?pe("span",{class:"color-warning"},[he(" "),r("SSL.Business.index_50"),he(" ")]):1!==t.status||["PENDING","COMPLETE","CANCELLED","FAILED","EXPIRED"].includes(t.order_status)?0===t.status?pe("span",{class:"color-warning"},[he(" "),r("SSL.Business.index_52"),he(" ")]):void 0:pe("span",{class:"color-warning"},[he(" "),r("SSL.Business.index_51"),he(" ")]):pe("span",{class:"color-warning cursor-pointer",onClick:()=>C(e)},[" ",r("SSL.Business.index_44")," "])}},O({width:140,options:e=>[{show:!e.order_info.certId&&!e.order_info.domains.length,label:r("SSL.Business.index_53"),onClick:()=>{C(e)}},{show:"PENDING"===e.order_info.order_status&&1===e.order_info.status,label:r("SSL.Business.index_54"),onClick:async()=>{const{message:t}=await p({uc_id:e.order_info.uc_id});d(t)&&(x.data.uc_id=e.order_info.uc_id,x.data.verify=t.data,x.data.paths=t.paths,x.show=!0)}},{show:"COMPLETE"===e.order_info.order_status&&1===e.order_info.status,label:r("SSL.index_58"),onClick:async()=>{v.data.row=e,v.show=!0}},{show:"COMPLETE"===e.order_info.order_status&&1===e.order_info.status,label:r("Ftp.Label.index_11"),onClick:async()=>{const t=window.location.origin+"/v2/business_ssl?action=download_cert&uc_id="+e.order_info.uc_id;window.open(t)}},{show:!1,label:r("Public.Btn.Del"),onClick:()=>{B({title:r("SSL.index_59"),content:r("SSL.index_60"),onConfirm:async()=>{await m({hash:e.hash}),L()}})}}]})]),C=e=>{c.data.row=e,c.show=!0},L=async()=>{try{y.loading=!0;const{message:e}=await S(u);d(e)&&(y.data=e.data,y.total=e.total)}finally{y.loading=!1}};return l.value.status&&L(),(e,t)=>{const i=Y,d=U,o=Oe,u=Ne,_=De;return ue(),ve("div",ct,[pe(_,{install:me(l).status},{desc:ce(()=>[t[5]||(t[5]=Se("span",{class:"mr-10px"},"Business certificates require login panel to start using them",-1)),pe(i,{type:"primary",onClick:me(A)},{default:ce(()=>[he(fe(e.$t("Login.index_3")),1)]),_:1},8,["onClick"])]),default:ce(()=>[pe(o,null,{toolsLeft:ce(()=>[pe(i,{type:"primary",onClick:t[0]||(t[0]=e=>me(h).show=!0)},{default:ce(()=>[he(fe(me(r)("SSL.index_44")),1)]),_:1})]),table:ce(()=>[pe(d,{loading:me(y).loading,data:me(y).data,columns:me(w),"max-height":220},null,8,["loading","data","columns"])]),_:1}),pe(u,{show:me(h).show,"onUpdate:show":t[1]||(t[1]=e=>me(h).show=e),title:me(h).title,data:me(h).data,"min-height":250,component:Ae},null,8,["show","title","data"]),pe(u,{show:me(c).show,"onUpdate:show":t[2]||(t[2]=e=>me(c).show=e),title:me(c).title,data:me(c).data,width:650,"min-height":450,component:me(a)},null,8,["show","title","data","component"]),pe(u,{show:me(v).show,"onUpdate:show":t[3]||(t[3]=e=>me(v).show=e),title:me(v).title,data:me(v).data,width:720,height:530,component:me(s)},null,8,["show","title","data","component"]),pe(u,{show:me(x).show,"onUpdate:show":t[4]||(t[4]=e=>me(x).show=e),title:me(x).title,data:me(x).data,width:650,"min-height":450,component:me(n)},null,8,["show","title","data","component"])]),_:1},8,["install"])])}}}),pt={class:"text-error"};const mt=u({},[["render",function(e,t){const a=s,n=E;return ue(),re(n,null,{default:ce(()=>[Se("li",pt,fe(e.$t("SSL.SiteSSL.index_1")),1),Se("li",null,fe(e.$t("SSL.SiteSSL.index_2")),1),Se("li",null,fe(e.$t("SSL.SiteSSL.index_3")),1),Se("li",null,[he(fe(e.$t("SSL.SiteSSL.index_4"))+" ",1),pe(a,{href:"https://www.aapanel.com/docs/Function/BusinessCertificate.html",target:"_blank"},{default:ce(()=>[he(fe(e.$t("SSL.Business.index_20")),1)]),_:1})])]),_:1})}]]),St=ne({__name:"index",setup:e=>(e,t)=>(ue(),ve("div",null,[pe(ut),pe(_t),pe(mt)]))}),ft={class:"cert-info"},ht={class:"cert-label"},vt={class:"cert-value"},xt={class:"cert-info"},yt={class:"cert-label"},wt={class:"cert-value"},Ct={class:"cert-info"},Lt={class:"cert-label"},gt={class:"cert-value"},bt={class:"cert-info"},kt={class:"cert-label"},$t={class:"cert-value"},jt={key:0,class:"text-primary"},Pt={key:1,class:"text-error"},Et={class:"w-48%"},Bt={class:"mb-8px"},Rt={class:"w-48%"},Dt={class:"mb-8px"},Nt=u(ne({__name:"cert",emits:["update"],setup(e,{emit:s}){const i=s,{t:l}=ie(),{data:o}=P(),u=t(),c=le(!1),_=le(1),p=le(""),m=le(""),S=ge({hash:"",issuer:"",notAfter:"",notBefore:"",dns:[],subject:"",endtime:0}),f=async()=>{const{message:e}=await r({hash:S.hash});d(e)&&R({hideClose:!0,data:{isJump:!1,task_id:e.task_id,onFinish:()=>{y()}},component:H})},h=async()=>{await b({updateOf:1,siteName:o.name}),i("update"),u.setRefresh(!0)},{loading:v,setLoading:x}=I(),y=async()=>{try{x(!0);const{message:e}=await k({siteName:o.name});d(e)&&(c.value=e.status,S.hash=e.hash,S.issuer=e.cert_data.issuer,S.notAfter=e.cert_data.notAfter,S.notBefore=e.cert_data.notBefore,S.dns=e.cert_data.dns,S.subject=e.cert_data.subject,S.endtime=e.cert_data.endtime,p.value=e.key,m.value=e.csr,_.value=e.auto_renew)}finally{x(!1)}};return y(),(e,t)=>{const s=G,i=q,l=a,d=V,o=J,r=X,u=Y,c=E,x=n;return ue(),re(x,{show:me(v)},{default:ce(()=>[pe(d,{class:"mb-16px",type:"success","show-icon":!1},{default:ce(()=>[pe(l,{"x-gap":12,cols:"15"},{default:ce(()=>[me(_)?(ue(),re(s,{key:0,span:"16"},{default:ce(()=>[Se("div",ft,[Se("div",ht,fe(e.$t("SSL.SiteSSL.index_22"))+"：",1),Se("div",vt,fe(e.$t("SSL.SiteSSL.index_23")),1)])]),_:1})):_e("",!0),pe(s,{span:"7"},{default:ce(()=>[Se("div",xt,[Se("div",yt,fe(e.$t("Site.Cert.index_45"))+"：",1),Se("div",wt,[pe(i,null,{default:ce(()=>[he(fe(me(S).issuer),1)]),_:1})])])]),_:1}),pe(s,{span:"8"},{default:ce(()=>[Se("div",Ct,[Se("div",Lt,fe(e.$t("Site.Cert.index_46"))+"：",1),Se("div",gt,[pe(i,null,{default:ce(()=>[he(fe(me(S).dns.join(e.$t("Public.Punctuation.Comma"))),1)]),_:1})])])]),_:1}),pe(s,{span:"7"},{default:ce(()=>[Se("div",bt,[Se("div",kt,fe(e.$t("Site.Cert.index_47"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",$t,[me(S).endtime>0?(ue(),ve("span",jt,fe(e.$t("Site.Cert.index_48",{date:me(S).notAfter,days:me(S).endtime})),1)):(ue(),ve("span",Pt,fe(e.$t("Site.Cert.index_47")),1))])])]),_:1})]),_:1})]),_:1}),pe(r,{class:"mb-16px",size:10,justify:"space-between"},{default:ce(()=>[Se("div",Et,[Se("div",Bt,fe(e.$t("Site.Cert.index_50")),1),pe(o,{readonly:"",value:me(p),"onUpdate:value":t[0]||(t[0]=e=>xe(p)?p.value=e:null),rows:14},null,8,["value"])]),Se("div",Rt,[Se("div",Dt,fe(e.$t("Site.Cert.index_51")),1),pe(o,{readonly:"",value:me(m),"onUpdate:value":t[1]||(t[1]=e=>xe(m)?m.value=e:null),rows:14},null,8,["value"])])]),_:1}),pe(r,{class:"mb-12px"},{default:ce(()=>[pe(u,{type:"primary",onClick:f},{default:ce(()=>[he(fe(e.$t("Site.Cert.index_53")),1)]),_:1}),pe(u,{onClick:h},{default:ce(()=>[he(fe(e.$t("Site.Cert.index_55")),1)]),_:1})]),_:1}),pe(c,null,{default:ce(()=>[Se("li",null,fe(e.$t("SSL.SiteSSL.index_24")),1),Se("li",null,fe(e.$t("SSL.SiteSSL.index_25")),1)]),_:1})]),_:1},8,["show"])}}}),[["__scopeId","data-v-bc2b39ec"]]),Ot={class:"flex items-center"},Ut={class:"leading-17px"},At={class:"w-full"},It={class:"w-full"},Tt={class:"text-error"},Mt=ne({__name:"apply",emits:["update"],setup(e,{emit:a}){const s=ke(),{t:l}=ie(),{data:o}=P(),r=t(),u=a,_=ge({auth_type:"http",dns_manual:0,auto_wildcard:0,domains:[],all:!1}),p={domains:{required:!0,trigger:"change",type:"array",message:l("SSL.SiteSSL.index_16")}},m=le(null),S=le([]),f=e=>{var t;return null==(t=S.value.find(t=>t.name===e))?void 0:t.auto},C=()=>{s.push("/ssl_domain/domain")},L=de(()=>_.domains.length>0&&_.domains.length<S.value.length);$e(()=>_.domains,e=>{e.length===S.value.length?_.all=!0:e.length||(_.all=!1)}),$e(()=>_.all,e=>{var t;e?(_.domains=S.value.map(e=>e.name),null==(t=m.value)||t.validate()):_.domains=[]}),$e(()=>_.auth_type,e=>{var t;"dns"===e?(_.domains=S.value.filter(e=>e.auto).map(e=>e.name),null==(t=m.value)||t.validate()):_.domains=[]});const g=de(()=>_.domains.filter(e=>!f(e))),b=async()=>{var e;if(await(null==(e=m.value)?void 0:e.validate()),"dns"===_.auth_type&&g.value.length&&!_.dns_manual)return void i.error({content:()=>Be("span",{innerHTML:"".concat(g.value.join("<br/>")).concat(l("SSL.SiteSSL.index_14"))})});let t={auth_type:_.dns_manual?"dns_manual":_.auth_type,auto_wildcard:_.auto_wildcard,domains:JSON.stringify(_.domains),site_id:_.dns_manual?o.id:void 0,deploy:_.dns_manual?0:1};if(_.dns_manual&&"dns"===_.auth_type){const{message:e}=await v({site_id:o.id,domains:JSON.stringify(_.domains)});if(d(e)&&Object.keys(e).length)return void T(e.auths,o.id,_.domains,()=>{u("update"),r.setRefresh(!0)},!0);const a=R({width:500,height:300,hideClose:!0,component:M});try{const{message:e}=await x(t,!1);d(e)&&(e.deploy?(i.success(e.result||l("SSL.index_32")),u("update"),r.setRefresh(!0)):Array.isArray(e.auths)&&e.auths.length&&T(e.auths,o.id,_.domains,()=>{u("update"),r.setRefresh(!0)}))}catch(s){z(se(s,"message",""))}finally{a.hide()}return}const{message:a}=await x(t);d(a)&&R({hideClose:!0,data:{isJump:!1,task_id:a.task_id,onFinish:()=>{u("update"),r.setRefresh(!0)}},component:H})},{loading:k,setLoading:$}=I();return je(()=>{(async()=>{try{$(!0);const{message:e}=await Te({id:o.id});if(y(e)){const t=e.map(async e=>{const{message:t}=await w({domain:e.name});d(t)&&S.value.push({name:e.name,auto:t.support.includes("auto")})});await Promise.all(t)}}finally{$(!1)}})()}),(e,t)=>{const a=c,s=V,i=Z,l=h,d=Q,o=K,r=ee,u=X,v=te,x=ae,y=n,w=Y,$=Ie,j=E;return ue(),ve("div",null,[Pe(pe(s,{"show-icon":!1,class:"mb-10px"},{default:ce(()=>[Se("div",Ot,[pe(a,{name:"base-info",size:"17",class:"mr-8px"}),Se("span",Ut,fe(e.$t("SSL.SiteSSL.index_12")),1)])]),_:1},512),[[Ee,"dns"===me(_).auth_type]]),pe($,{ref_key:"formRef",ref:m,model:me(_),rules:p,"label-width":"140"},{default:ce(()=>[pe(o,{label:e.$t("Config.Safe.Ssl.index_2")},{default:ce(()=>[pe(d,{value:me(_).auth_type,"onUpdate:value":t[0]||(t[0]=e=>me(_).auth_type=e)},{default:ce(()=>[pe(l,null,{default:ce(()=>[pe(i,{value:"http"},{default:ce(()=>[he(fe(e.$t("SSL.SiteSSL.index_17")),1)]),_:1}),pe(i,{value:"dns"},{default:ce(()=>[he(fe(e.$t("SSL.index_12"))+" (Wildcard support) ",1)]),_:1})]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),Pe(pe(o,{label:" ","show-feedback":!1},{default:ce(()=>[pe(r,{checked:me(_).dns_manual,"onUpdate:checked":t[1]||(t[1]=e=>me(_).dns_manual=e),"checked-value":1,"unchecked-value":0},{default:ce(()=>[he(fe(e.$t("SSL.index_2")),1)]),_:1},8,["checked"])]),_:1},512),[[Ee,"dns"===me(_).auth_type]]),Pe(pe(o,{label:" "},{default:ce(()=>[pe(r,{checked:me(_).auto_wildcard,"onUpdate:checked":t[2]||(t[2]=e=>me(_).auto_wildcard=e),"checked-value":1,"unchecked-value":0},{default:ce(()=>[he(fe(e.$t("SSL.SiteSSL.index_20")),1)]),_:1},8,["checked"])]),_:1},512),[[Ee,"dns"===me(_).auth_type]]),pe(o,{label:e.$t("Mail.Domain.index_3"),path:"domains"},{default:ce(()=>[pe(y,{show:me(k),class:"p-12px w-300px max-h-300px min-h-100px overflow-auto border border-solid border-#ccc"},{default:ce(()=>[pe(r,{class:"mb-12px",checked:me(_).all,"onUpdate:checked":t[3]||(t[3]=e=>me(_).all=e),label:e.$t("Public.SelectAll"),indeterminate:me(L)},null,8,["checked","label","indeterminate"]),me(S).length?(ue(),re(v,{key:0,value:me(_).domains,"onUpdate:value":t[4]||(t[4]=e=>me(_).domains=e)},{default:ce(()=>[pe(u,{class:"flex-col!",size:12},{default:ce(()=>[(ue(!0),ve(ye,null,we(me(S),e=>(ue(),re(r,{key:e.name,value:e.name,label:e.name},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])):(ue(),re(x,{key:1,description:"No domain name"}))]),_:1},8,["show"])]),_:1},8,["label"]),Pe(pe(o,{label:" "},{default:ce(()=>[pe(s,{"show-icon":!1,type:me(g).length?"warning":"success"},{default:ce(()=>[(ue(!0),ve(ye,null,we(me(_).domains,t=>(ue(),re(u,{key:t},{default:ce(()=>[f(t)?(ue(),re(u,{key:0,class:"flex-nowrap! py-3px"},{default:ce(()=>[pe(a,{name:"base-success",size:"17",color:"#20a53a"}),Se("span",At,"["+fe(t)+"] "+fe(e.$t("SSL.SiteSSL.index_13")),1)]),_:2},1024)):(ue(),re(u,{key:1,class:"flex-nowrap! py-3px items-center!"},{default:ce(()=>[pe(a,{name:"base-error",size:"17",color:"#E85445"}),Se("span",It,"["+fe(t)+"] "+fe(e.$t("SSL.SiteSSL.index_14")),1),pe(w,{type:"primary",size:"tiny",onClick:C},{default:ce(()=>[he(fe(e.$t("SSL.SiteSSL.index_21")),1)]),_:1})]),_:2},1024))]),_:2},1024))),128))]),_:1},8,["type"])]),_:1},512),[[Ee,"dns"===me(_).auth_type&&me(_).domains.length&&!me(_).dns_manual]]),pe(o,{label:" "},{default:ce(()=>[pe(w,{type:"primary",onClick:b},{default:ce(()=>[he(fe(e.$t("Public.Btn.Apply")),1)]),_:1})]),_:1})]),_:1},8,["model"]),Pe(pe(j,{class:"mt-16px"},{default:ce(()=>[Se("li",Tt,fe(e.$t("SSL.SiteSSL.index_15")),1),Se("li",null,fe(e.$t("Site.Cert.index_21")),1),Se("li",null,fe(e.$t("Site.Cert.index_23")),1),Se("li",null,fe(e.$t("Site.Cert.index_24")),1)]),_:1},512),[[Ee,"http"===me(_).auth_type]]),Pe(pe(j,{class:"mt-24px"},{default:ce(()=>[t[5]||(t[5]=Se("li",null,"Manually resolved certificates do not support auto-renewal",-1)),Se("li",null,fe(e.$t("Site.Cert.index_25")),1),Se("li",null,fe(e.$t("Site.Cert.index_26")),1),Se("li",null,fe(e.$t("Site.Cert.index_27")),1),Se("li",null,fe(e.$t("Site.Cert.index_28")),1)]),_:1,__:[5]},512),[[Ee,"dns"===me(_).auth_type]])])}}}),zt=ne({__name:"index",props:{isOpen:{type:Boolean},type:{},onRefresh:{type:Function}},setup(e){const t=e,a=()=>{t.onRefresh()};return(e,s)=>(ue(),ve("div",null,[t.isOpen&&"Let's Encrypt"===t.type?(ue(),re(Nt,{key:0,onUpdate:a})):(ue(),re(Mt,{key:1,onUpdate:a}))]))}}),Ft=ne({__name:"index",props:{onMenuChange:{type:Function}},setup(e,{expose:t}){const{data:a}=P(),{t:s}=ie(),n=ge({p:1,limit:99999}),{columns:l,table:r}=N([{key:"domain",title:s("Site.Cert.index_29"),render:e=>pe("span",{innerHTML:e.verify_domains.length>0?e.verify_domains.join("<br/>"):"--"},null)},Ue({title:s("SSL.index_54"),width:140}),{key:"issuer",title:s("Site.Cert.index_30"),ellipsis:{tooltip:!0}},O({width:150,options:t=>[{label:s("Public.Btn.Deploy"),onClick:async()=>{try{await o({hash:t.hash,domains:JSON.stringify([a.name]),append:1}),i.success(s("SSL.index_32")),setTimeout(()=>{e.onMenuChange()},500)}catch(n){console.log(n)}}},{show:"Let's Encrypt"===t.provider,label:s("Public.Btn.Del"),onClick:()=>{(e=>{F({title:s("Site.Cert.index_31"),content:s("Site.Cert.index_32"),onConfirm:async()=>{await m({hash:e.hash}),_()}})})(t)}}]})]),{loading:u,setLoading:c}=I(!0),_=async()=>{try{c(!0);const{message:e}=await C(n);d(e)&&(r.data=e.data)}finally{c(!1)}};return _(),t({init:_}),(e,t)=>{const a=U;return ue(),ve("div",null,[pe(a,{loading:me(u),columns:me(l),data:me(r).data,"max-height":510},null,8,["loading","columns","data"])])}}}),Jt={class:"mr-12px"},Ht={key:0,class:"mr-12px"},Vt={key:1,class:"mr-12px"},Gt=ne({__name:"index",setup(a,{expose:s}){const n=t(),{data:i}=P(),{t:l}=ie(),o=le("current"),u=le(""),c=le(j.NotDeploy),_=le(""),p=le(!1),m=le(0),S=le(!1),f=le(""),h=async()=>{const{message:e}=await r({hash:u.value});d(e)&&R({hideClose:!0,data:{isJump:!1,task_id:e.task_id,onFinish:()=>{x()}},component:H})},v=e=>{y.value[0].data&&(y.value[0].data.loading=e)},x=async()=>{try{v(!0);const{message:a}=await $({siteName:i.name});d(a)&&(c.value=a.type,p.value=a.status,m.value=se(a,"cert_data.endtime",0),f.value=a.cert_data.issuer_O||"",S.value=(()=>{let e=!1;return m.value<=30&&(e=!0),c.value===j.TestDeploy&&m.value<0&&(e=!0),c.value!==j.SaveOrHolderDeploy&&c.value!==j.NotDeploy||(e=!1),e})(),_.value=a.cert_data.dns.join(","),u.value=a.hash,t=a,y.value[0].data&&(y.value[0].data.info=t),e=S.value,y.value[0].data&&(y.value[0].data.isRenew=e))}catch(a){p.value=!1,S.value=!1}finally{v(!1)}var e,t},y=le([{key:"current",label:()=>pe("div",null,[pe("span",null,[he("Current Certs - ")]),pe("span",{class:p.value?"text-#1d9534":"text-red-500"},[he("["),p.value?"Deployed":"Not Deployed",he("]")])]),data:{info:null,isRenew:!1,loading:!0,onRefresh:x},component:Re(dt)},{key:"business",label:l("Site.Cert.index_64"),component:Re(St)},{key:"let",label:l("Site.Cert.index_65"),data:{isOpen:de(()=>p.value),type:de(()=>f.value),onRefresh:x},component:Re(zt)},{key:"holder",label:l("Site.Cert.index_66"),component:Re(Ft),data:{onMenuChange:()=>{o.value="current",x(),n.setRefresh(!0)}}}]);return s({init:()=>{x()}}),(t,a)=>{const s=Y,n=V,i=e;return ue(),ve("div",null,[me(p)?_e("",!0):(ue(),re(n,{key:0,class:"mb-12px",type:"error","show-icon":!1,style:{"--n-padding":"9px 16px"}},{default:ce(()=>[Se("span",Jt,fe(t.$t("Site.Cert.index_41")),1),pe(s,{size:"tiny",type:"primary",onClick:a[0]||(a[0]=e=>o.value="business")},{default:ce(()=>[he(fe(t.$t("Site.Cert.index_43")),1)]),_:1})]),_:1})),me(p)&&me(S)?(ue(),re(n,{key:1,class:"mb-12px",type:"error","show-icon":!1,style:{"--n-padding":"9px 16px"}},{default:ce(()=>[me(m)>0?(ue(),ve("span",Ht,fe(t.$t("SSL.SiteSSL.index_26",[me(_),me(m)])),1)):(ue(),ve("span",Vt,fe(t.$t("SSL.SiteSSL.index_19",[me(_)])),1)),pe(s,{size:"tiny",type:"primary",onClick:h},{default:ce(()=>[he(fe(t.$t("Site.Cert.index_53")),1)]),_:1})]),_:1})):_e("",!0),pe(i,{value:me(o),"onUpdate:value":a[1]||(a[1]=e=>xe(o)?o.value=e:null),options:me(y)},null,8,["value","options"])])}}});export{Gt as default};
