import{_ as s}from"./index101.js?v=1752142539265";import{o as e,_ as a,d as t}from"./page_layout.js?v=1752142539265";import{c as r,g as o}from"./index17.js?v=1752142539265";import{d as n}from"./public.js?v=1752142539265";import{k as p,P as i,e as l,o as _,b as c,U as m,X as u,an as g,Q as d,V as f,a2 as x,j,a1 as h,W as v}from"./vue.js?v=1752142539265";import{c3 as w,by as y,bX as k}from"./naive.js?v=1752142539265";import"./common.js?v=1752142539265";import"./__commonjsHelpers__.js?v=1752142539265";import"./index.js?v=1752142539265";import"./index.vue_vue_type_script_setup_true_lang.js?v=1752142539265";import"./backup-info.js?v=1752142539265";import"./utils.js?v=1752142539265";import"./soft.js?v=1752142539265";const b={class:"p-16px"},C={class:"h-250px"},I=p({__name:"index",props:{onRefresh:{}},emits:["close"],setup(p,{emit:I}){const{t:R}=i(),z=I,M=p,X=l({task_msg:"",exec_log:"",progress:0}),q=()=>{n({title:R("Config.Backup.index_14"),content:R("Config.Migrate.index_24"),onConfirm:async()=>{B&&clearInterval(B),await r(),z("close")}})};let B=null;const D=async()=>{const{message:s}=await o();t(s)&&(X.task_msg=s.migrate_msg,X.exec_log=s.migrate_log,X.progress=s.migrate_progress,2!==s.run_status&&3!==s.run_status||(B&&clearInterval(B),2===s.run_status?M.onRefresh("success",{panel_addr:s.panel_addr,panel_user:s.panel_user,panel_password:s.panel_password,start_time:s.start_time,last_update:s.last_update}):M.onRefresh("error",{errData:s.err_info,start_time:s.start_time,last_update_time:s.last_update,server_ip:s.server_ip,ssh_port:s.ssh_port,ssh_user:s.ssh_user,password:s.password}),z("close")))};return _((()=>{D(),B=window.setInterval((()=>{D()}),2e3)})),c((()=>{B&&clearInterval(B)})),(t,r)=>{const o=e,n=w,p=y,i=a,l=k,_=s;return u(),m("div",b,[g("",!0),d(n,{type:"warning"},{default:x((()=>[r[1]||(r[1]=f("span",{class:"color-warning"},"Migration is in progress, please do not close the page, if you have any questions please contact us in time ",-1)),d(o,{href:"mailto:support@aapanel.com",target:"_blank"},{default:x((()=>r[0]||(r[0]=[j("support@aapanel.com")]))),_:1,__:[0]})])),_:1,__:[1]}),d(l,{class:"flex-nowrap! items-center my-10px",size:5},{default:x((()=>[d(p,{height:24,percentage:v(X).progress,"indicator-placement":"inside",processing:v(X).progress<100,status:"success"},null,8,["percentage","processing"]),v(X).progress<100?(u(),h(i,{key:0,name:"base-error",class:"text-error hover:text-#777777",size:20,onClick:q})):g("",!0)])),_:1}),f("div",C,[d(_,{log:v(X).exec_log},null,8,["log"])])])}}});export{I as default};
