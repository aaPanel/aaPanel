import{_ as a}from"./index.vue_vue_type_script_setup_true_lang.js?v=1769066082311";import{m as e,d as i}from"./page_layout.js?v=1769066082311";import{d as s}from"./public.js?v=1769066082311";import{c as n}from"./site.js?v=1769066082311";import{i as o}from"./index50.js?v=1769066082311";import{k as t,P as l,r,e as p,am as d,R as m,V as u,W as v,a3 as _,S as c,a2 as f,an as g,U as h,j,a4 as x,F as b}from"./vue.js?v=1769066082311";import{dS as y,av as w,au as M,d_ as S,dW as W}from"./naive.js?v=1769066082311";import"./common.js?v=1769066082311";import"./__commonjsHelpers__.js?v=1769066082311";import"./index.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1769066082311";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1769066082311";import"./mail.js?v=1769066082311";const k={class:"p-20px pt-24px pb-8px"},P={class:"w-240px"},U={class:"w-240px"},C=t({__name:"install",props:{domain:{type:Object}},emits:["refresh"],setup(t,{expose:C,emit:E}){const H=E,{t:I}=l(),R=r(null),$=p({domain:"",php_version:null}),F={domain:{trigger:"change",validator:()=>""!==$.domain.trim()||new Error(I("Mail.Setting.index_20"))},php_version:{trigger:"change",validator:()=>null!==$.php_version||new Error(I("Mail.Setting.index_21"))}},L=r([]),O=async()=>{const{message:a}=await n();if(i(a)){L.value=a.versions.reverse().map(a=>({label:a.name,value:a.version}));const e=a.versions.findIndex(a=>"74"===a.version);$.php_version=-1!==e?a.versions[e].version:a.versions[0].version}},{loading:V,setLoading:q}=s(),z=d();return(async()=>{try{q(!0),await Promise.all([O()])}finally{q(!1)}})(),C({onConfirm:async()=>{var a,i,s;await(null==(a=R.value)?void 0:a.validate()),await o({webmail_domain:"".concat($.domain,".").concat((null==(i=t.domain)?void 0:i.domain)||""),php_version:$.php_version||"",domain:(null==(s=t.domain)?void 0:s.domain)||""});const{close:n}=e.success({content:()=>v(b,null,[j("WebMail Installation Successful, "),v("br",null,null),j(' Manage WebMail view in "'),v("a",{class:"bt-link",href:"javascript:;",onClick:()=>{z.push("/site/php"),n()}},[j("Website > PHP Project")]),j('"')]),close:!0,maxWidth:480});H("refresh")}}),(e,i)=>{const s=M,n=S,o=w,l=y,r=W,p=a;return u(),m("div",k,[v(p,{ref_key:"formRef",ref:R,model:h($),rules:F},{default:_(()=>[v(l,{label:e.$t("Mail.Setting.index_18"),path:"domain"},{default:_(()=>[c("div",P,[v(o,null,{default:_(()=>{var a;return[v(s,{value:h($).domain,"onUpdate:value":i[0]||(i[0]=a=>h($).domain=a)},null,8,["value"]),(null==(a=t.domain)?void 0:a.domain)?(u(),f(n,{key:0},{default:_(()=>{var a;return[j(" ."+x(null==(a=t.domain)?void 0:a.domain),1)]}),_:1})):g("",!0)]}),_:1})])]),_:1},8,["label"]),v(l,{label:e.$t("Mail.Setting.index_19"),path:"php_version"},{default:_(()=>[c("div",U,[v(r,{value:h($).php_version,"onUpdate:value":i[1]||(i[1]=a=>h($).php_version=a),loading:h(V),options:h(L)},null,8,["value","loading","options"])])]),_:1},8,["label"])]),_:1},8,["model"])])}}});export{C as default};
