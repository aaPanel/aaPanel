System.register(["./index-legacy114.js?v=1769066082311","./page_layout-legacy.js?v=1769066082311","./vue-legacy.js?v=1769066082311","./public-legacy.js?v=1769066082311","./ssh-legacy.js?v=1769066082311","./index-legacy.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy2.js?v=1769066082311","./config-legacy.js?v=1769066082311","./naive-legacy.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1769066082311","./common-legacy.js?v=1769066082311","./__commonjsHelpers__-legacy.js?v=1769066082311","./index-legacy103.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1769066082311"],function(e,t){"use strict";var a,s,l,i,n,c,u,o,r,d,y,p,S,_,x,v,g,m,f,h,w,b,H,k,$,L,B,j,C,U,P,R,T,z,A,F,W,q,N,O,V,D,E,I,M,G,J,K,Q,X,Y,Z,ee,te,ae,se,le,ie,ne,ce,ue,oe,re,de,ye,pe,Se,_e,xe,ve,ge,me,fe;return{setters:[e=>{a=e._},e=>{s=e.d,l=e.q,i=e.o,n=e.a,c=e.bi,u=e.m,o=e.M,r=e.p,d=e.u,y=e.x,p=e.l},e=>{S=e.k,_=e.P,x=e.r,v=e.c,g=e.am,m=e.R,f=e.V,h=e.W,w=e.a3,b=e.S,H=e.ak,k=e.U,$=e.a4,L=e.j,B=e.a2,j=e._,C=e.a0,U=e.e,P=e.o,R=e.N,T=e.l,z=e.v,A=e.F,F=e.n},e=>{W=e.e,q=e.d,N=e.a,O=e.b,V=e.c,D=e.h},e=>{E=e.g,I=e.s,M=e.a,G=e.b,J=e.c,K=e.d,Q=e.e,X=e.f,Y=e.h,Z=e.r,ee=e.i,te=e.j,ae=e.k,se=e.l},e=>{le=e._},e=>{ie=e._},e=>{ne=e._},e=>{ce=e.g},e=>{ue=e.dS,oe=e.dk,re=e.dg,de=e.aC,ye=e.dW,pe=e.bL,Se=e.dU,_e=e.e2,xe=e.db,ve=e.dT},e=>{ge=e._},e=>{me=e._},e=>{fe=e._},null,null,null,null],execute:function(){var he=document.createElement("style");he.textContent=".ul-style[data-v-c0b88226]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-c0b88226]{display:flex;align-items:center}\n/*$vite$:1*/",document.head.appendChild(he);const we={class:"px-16px pt-4px pb-16px"},be={class:"mx-20px"},He={class:"w-200px mr-6px"},ke={class:"ml-10px text-desc"},$e={class:"my-24px"},Le={class:"w-360px"},Be={class:"flex w-260px"},je={class:"flex-1 mr-6px"},Ce={class:"ml-10px text-desc"},Ue={class:"ml-10px text-desc"},Pe={class:"my-24px"},Re={class:"ml-10px text-desc"},Te={class:"mt-20px text-desc"},ze=S({__name:"index",setup(e,{expose:a}){const r=j(()=>n(()=>t.import("./open-legacy.js?v=1769066082311"),void 0)),d=j(()=>n(()=>t.import("./view-legacy.js?v=1769066082311"),void 0)),y=j(()=>n(()=>t.import("./index-legacy224.js?v=1769066082311"),void 0)),{t:p}=_(),S=x(!1),C=async e=>{await I({status:e})},U=x(!1),P=W(p("Security.SSH.Basic.index_19"),{onRefresh:()=>{me()}}),R=()=>{U.value=!1},T=async e=>{e?P.show=!0:(await M(),me())},z=x(22),A=async()=>{c(z.value)?await G({port:z.value}):u.error(p("Security.SSH.Basic.index_20"),{close:!0})},F=x(null),O=x([]),V=async e=>{await J({p_type:e})},D=x(""),Y=()=>{""!==D.value.trim()?N({title:p("Security.SSH.Basic.index_22"),content:p("Security.SSH.Basic.index_23"),onConfirm:async()=>{await K({username:"root",password:D.value})}}):u.error(p("Security.SSH.Basic.index_21"))},Z=W(p("Security.SSH.Basic.index_2")),ee=()=>{U.value?Z.show=!0:u.error(p("Security.SSH.Basic.index_24"))},te=async()=>{if(!U.value)return void u.error(p("Security.SSH.Basic.index_25"));const{close:e}=u.loading(p("Security.SSH.Basic.index_26"));try{await Q(),window.open(`${o()}/ssh_security?action=download_key`)}finally{e()}},ae=x(""),se=x({}),pe=v(()=>void 0===Object.keys(se.value).find(e=>e===ae.value)),Se=v(()=>{const e=se.value[ae.value];return e?e.title:""}),_e=W(p("Security.SSH.Basic.index_13"),{onSetName:e=>{ae.value=e}}),xe=()=>{_e.data.config=se.value,_e.show=!0},ve=g(),ge=()=>{ve.push("/security/system-hardening")},me=async()=>{const{message:e}=await E();s(e)&&(S.value="yes"===e.password,U.value="yes"===e.pubkey,z.value=e.port,F.value=e.root_login_type,s(e.root_login_types)&&(O.value=Object.entries(e.root_login_types).map(([e,t])=>({label:t,value:e}))))},fe=async()=>{const{message:e}=await X();s(e)&&(ae.value=e.result)},he=async()=>{const{message:e}=await ce();s(e)&&(se.value=e)},{setLoading:ze}=q(!0);return(async()=>{try{ze(!0),await Promise.all([me(),fe(),he()])}finally{ze(!1)}})(),a({init:()=>{fe(),me()}}),(e,t)=>{const a=oe,s=ue,n=re,c=de,u=l,o=ye,p=ne,_=i,x=ie,v=le;return f(),m("div",we,[h(x,{"label-width":"140px"},{default:w(()=>[h(s,{label:e.$t("Security.SSH.Basic.index_1")},{default:w(()=>[h(a,{value:k(S),"onUpdate:value":[t[0]||(t[0]=e=>H(S)?S.value=e:null),C],size:"small"},null,8,["value"]),b("span",be,$(e.$t("Security.SSH.Basic.index_2")),1),h(a,{value:k(U),"onUpdate:value":[t[1]||(t[1]=e=>H(U)?U.value=e:null),T],size:"small"},null,8,["value"])]),_:1},8,["label"]),h(s,{label:e.$t("Security.SSH.Basic.index_3"),"show-feedback":!1},{default:w(()=>[b("div",He,[h(n,{value:k(z),"onUpdate:value":t[2]||(t[2]=e=>H(z)?z.value=e:null),min:1,max:65535,"show-button":!1},null,8,["value"])]),h(c,{type:"primary",onClick:A},{default:w(()=>[L($(e.$t("Public.Btn.Save")),1)]),_:1}),b("div",ke,$(e.$t("Security.SSH.Basic.index_4")),1)]),_:1},8,["label"]),b("div",$e,[h(u)]),h(s,{label:e.$t("Security.SSH.Basic.index_5")},{default:w(()=>[b("div",Le,[h(o,{value:k(F),"onUpdate:value":[t[3]||(t[3]=e=>H(F)?F.value=e:null),V],options:k(O)},null,8,["value","options"])])]),_:1},8,["label"]),h(s,{label:e.$t("Security.SSH.Basic.index_6")},{default:w(()=>[b("div",Be,[b("div",je,[h(p,{value:k(D),"onUpdate:value":t[4]||(t[4]=e=>H(D)?D.value=e:null),default:!1},null,8,["value"])]),h(c,{type:"primary",onClick:Y},{default:w(()=>[L($(e.$t("Public.Btn.Reset")),1)]),_:1})]),b("div",Ce,$(e.$t("Security.SSH.Basic.index_8")),1)]),_:1},8,["label"]),h(s,{label:e.$t("Security.SSH.Basic.index_9"),"show-feedback":!1},{default:w(()=>[h(c,{type:"primary",class:"btn-xs",onClick:ee},{default:w(()=>[L($(e.$t("Security.SSH.Basic.index_10")),1)]),_:1}),h(c,{class:"btn-xs ml-10px",onClick:te},{default:w(()=>[L($(e.$t("Public.Btn.Download")),1)]),_:1}),b("div",Ue,$(e.$t("Security.SSH.Basic.index_12")),1)]),_:1},8,["label"]),b("div",Pe,[h(u)]),h(s,{label:e.$t("Security.SSH.Basic.index_13"),"show-feedback":!1},{default:w(()=>[k(pe)?(f(),B(_,{key:0,type:"warning",onClick:xe},{default:w(()=>[L($(e.$t("Security.SSH.Basic.index_14")),1)]),_:1})):(f(),B(_,{key:1,onClick:xe},{default:w(()=>[L($(e.$t("Security.SSH.Basic.index_15",[k(Se)])),1)]),_:1})),h(c,{type:"primary",class:"btn-xs ml-10px",onClick:xe},{default:w(()=>[L($(e.$t("Public.Btn.Set")),1)]),_:1}),b("div",Re,$(e.$t("Security.SSH.Basic.index_12")),1)]),_:1},8,["label"]),b("div",Te,[L($(e.$t("Security.SSH.Basic.index_17"))+" ",1),h(_,{onClick:ge},{default:w(()=>[L(">>"+$(e.$t("Security.SSH.Basic.index_18")),1)]),_:1})])]),_:1}),h(v,{show:k(P).show,"onUpdate:show":t[5]||(t[5]=e=>k(P).show=e),title:k(P).title,data:k(P).data,width:400,"min-height":124,footer:!0,component:k(r),onPublicClose:R},null,8,["show","title","data","component"]),h(v,{show:k(Z).show,"onUpdate:show":t[6]||(t[6]=e=>k(Z).show=e),title:k(Z).title,width:400,"min-height":322,component:k(d)},null,8,["show","title","component"]),h(v,{show:k(_e).show,"onUpdate:show":t[7]||(t[7]=e=>k(_e).show=e),title:k(_e).title,data:k(_e).data,width:1e3,height:600,component:k(y)},null,8,["show","title","data","component"])])}}}),Ae={class:"pt-40px pb-40px"},Fe={class:"mb-24px text-center text-22px font-bold"},We={class:"mb-16px"},qe={class:"ul-style"},Ne={class:"ml-4px"},Oe={class:"text-center my-24px"},Ve={class:"flex justify-center"},De={class:"w-76%"},Ee=r(S({__name:"free",setup(e){const t=()=>{O({source:100})};return(e,a)=>{const s=de,l=pe;return f(),m("div",Ae,[b("div",Fe,$(e.$t("Security.SSH.Logs.free_1")),1),b("div",We,[b("ul",qe,[b("li",null,[b("span",Ne,$(e.$t("Security.SSH.Logs.free_2")),1)])])]),b("div",Oe,[h(s,{type:"primary",class:"h-36px text-14px",onClick:t},{default:w(()=>[L($(e.$t("WP.Transition.index_7")),1)]),_:1})]),b("div",Ve,[b("div",De,[h(l,{class:"flex justify-center w-full",src:k("/static/vite/images/ssh-logs.png")},null,8,["src"])])])])}}}),[["__scopeId","data-v-c0b88226"]]),Ie=S({__name:"index",setup(e,{expose:t}){const{t:a}=_(),l=d(),{isPro:i}=C(l),{table:n,columns:c,setLoading:o}=V([{key:"address",title:a("Security.SSH.Logs.index_5"),render:e=>h("a",{class:"bt-link",href:"javascript:;",onClick:()=>{r(e)}},[e.address,L(":"),h("span",{class:"text-#666 cursor-default"},[e.port])])},{key:"area",title:a("Security.SSH.Logs.index_6"),render:e=>e.area.info||"--"},{key:"user",title:a("Security.SSH.Logs.index_7")},{key:"status",title:a("Security.SSH.Logs.index_8"),render:e=>h("span",{class:e.status?"text-primary":"text-error"},[e.status?a("Security.SSH.Logs.index_14"):a("Security.SSH.Logs.index_15")])},{key:"time",title:a("Security.SSH.Logs.index_9")}]),r=e=>{N({title:a("Security.SSH.Logs.index_10"),content:e.deny_status?a("Security.SSH.Logs.index_13"):a("Security.SSH.Logs.index_11"),onConfirm:async()=>{if(e.deny_status){const{message:t}=await Z({address:e.address});y(t)&&t.length>0&&u.success(t[0].msg)}else{const{message:t}=await ee({address:e.address,types:"drop",brief:a("Security.SSH.Logs.index_12"),domain:"",choose:"address"});y(t)&&t.length>0&&u.success(t[0].msg)}x()}})},p=U({p:1,limit:20,select:"ALL",search:"",historyType:"ALL"}),S=()=>{i.value&&(p.p=1,x())},x=async()=>{try{o(!0);const{message:e}=await Y(R(p));s(e)&&(n.data=y(e.data)?e.data:[],n.total=e.total)}finally{o(!1)}};return P(()=>{S()}),t({init:e=>{p.select=e||"ALL",S()}}),(e,t)=>{const a=de,s=_e,l=Se,u=fe,o=D,r=me,d=ge;return k(i)?(f(),B(d,{key:0},{toolsLeft:w(()=>[h(a,{type:"primary",onClick:S},{default:w(()=>[L($(e.$t("Public.Btn.Refresh")),1)]),_:1})]),toolsRight:w(()=>[h(l,{value:k(p).select,"onUpdate:value":[t[0]||(t[0]=e=>k(p).select=e),S]},{default:w(()=>[h(s,{value:"ALL"},{default:w(()=>[L($(e.$t("Security.SSH.Logs.index_1")),1)]),_:1}),h(s,{value:"Accepted"},{default:w(()=>[L($(e.$t("Security.SSH.Logs.index_2")),1)]),_:1}),h(s,{value:"Failed"},{default:w(()=>[L($(e.$t("Security.SSH.Logs.index_3")),1)]),_:1})]),_:1},8,["value"]),h(u,{value:k(p).search,"onUpdate:value":t[1]||(t[1]=e=>k(p).search=e),width:"320",placeholder:e.$t("Security.SSH.Logs.index_4"),onSearch:S},null,8,["value","placeholder"])]),table:w(()=>[h(o,{loading:k(n).loading,data:k(n).data,columns:k(c)},null,8,["loading","data","columns"])]),pageRight:w(()=>[h(r,{page:k(p).p,"onUpdate:page":t[2]||(t[2]=e=>k(p).p=e),"page-size":k(p).limit,"onUpdate:pageSize":t[3]||(t[3]=e=>k(p).limit=e),"store-key":"security-ssh-logs","item-count":k(n).total,onRefresh:x},null,8,["page","page-size","item-count"])]),_:1})):(f(),B(Ee,{key:1}))}}}),Me={class:"mr-10px"},Ge={class:"mx-20px"};e("default",S({__name:"index",setup(e){const t=g(),{t:n}=_(),c=U({status:!1,success:0,successToday:0,error:0,errorToday:0}),u=x(),o=x("basic"),r=[{key:"basic",label:n("Security.SSH.index_5"),component:ze},{key:"logs",label:n("Security.SSH.index_6"),data:{type:"ALL"},component:Ie}],d=e=>{u.value.setValue("logs"),F(()=>{const t=u.value.getCompRef("logs");t&&t.init(e)})},y=async()=>{const{message:e}=await te();s(e)&&(c.status=e.status)},S=async()=>{const{message:e}=await ae();s(e)&&(c.success=e.success,c.successToday=e.today_success,c.error=e.error,c.errorToday=e.today_error)},v=e=>{N({title:n("Security.SSH.index_7"),content:n(e?"Security.SSH.index_8":"Security.SSH.index_9"),onConfirm:async()=>{await se({status:e?0:1}),y(),S()}})},B=t.currentRoute.value.query;B.menu&&(o.value=B.menu);const{loading:j,setLoading:C}=q();return C(!0),Promise.all([y(),S()]).finally(()=>{C(!1)}),(e,t)=>{const s=p,n=oe,y=l,S=i,_=xe,x=ve,g=a;return f(),m(A,null,[h(x,{class:"mb-16px p-16px"},{default:w(()=>[T(h(s,{width:600,height:20,sharp:!1,size:"medium"},null,512),[[z,k(j)]]),T(h(_,{class:"items-center",size:0},{default:w(()=>[b("div",Me,$(e.$t("Security.SSH.index_1")),1),h(n,{value:k(c).status,"onUpdate:value":v},null,8,["value"]),b("div",Ge,[h(y,{class:"mx-0! text-20px",vertical:""})]),b("div",null,[b("span",null,$(e.$t("Security.SSH.index_2")),1),h(S,{onClick:t[0]||(t[0]=e=>d("Accepted"))},{default:w(()=>[L($(e.$t("Security.SSH.index_3",[k(c).success,k(c).successToday])),1)]),_:1}),t[3]||(t[3]=b("span",{class:"mx-10px"},"/",-1)),h(S,{type:"error",onClick:t[1]||(t[1]=e=>d("Failed"))},{default:w(()=>[L($(e.$t("Security.SSH.index_4",[k(c).error,k(c).errorToday])),1)]),_:1})])]),_:1},512),[[z,!k(j)]])]),_:1}),h(x,{class:"p-16px"},{default:w(()=>[h(g,{ref_key:"tabsRef",ref:u,value:k(o),"onUpdate:value":t[2]||(t[2]=e=>H(o)?o.value=e:null),options:r},null,8,["value"])]),_:1})],64)}}}))}}});
