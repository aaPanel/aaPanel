const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/open.js?v=1764830988434","js/index.vue_vue_type_script_setup_true_lang.js?v=1764830988434","js/vue.js?v=1764830988434","js/__commonjsHelpers__.js?v=1764830988434","js/naive.js?v=1764830988434","js/common.js?v=1764830988434","js/index107.js?v=1764830988434","js/page_layout.js?v=1764830988434","js/public.js?v=1764830988434","css/public.css?v=1764830988434","css/page_layout.css?v=1764830988434","css/index22.css?v=1764830988434","js/index.js?v=1764830988434","css/index113.css?v=1764830988434","js/index.vue_vue_type_script_setup_true_lang2.js?v=1764830988434","js/index96.js?v=1764830988434","css/index14.css?v=1764830988434","js/config.js?v=1764830988434","js/index.vue_vue_type_script_setup_true_lang5.js?v=1764830988434","js/index.vue_vue_type_script_setup_true_lang6.js?v=1764830988434","css/index16.css?v=1764830988434","js/index.vue_vue_type_script_setup_true_lang7.js?v=1764830988434","js/index.vue_vue_type_script_setup_true_lang8.js?v=1764830988434","js/view.js?v=1764830988434","js/index97.js?v=1764830988434","css/index15.css?v=1764830988434","js/index212.js?v=1764830988434","js/index246.js?v=1764830988434","css/index61.css?v=1764830988434"])))=>i.map(i=>d[i]);
import{_ as e}from"./index107.js?v=1764830988434";import{aD as s,i as t,d as a,q as i,o as l,a as o,bf as n,m as c,M as r,p as u,u as d,x as p,l as _}from"./page_layout.js?v=1764830988434";import{k as S,P as y,r as x,c as g,am as m,R as v,V as f,W as h,a3 as b,S as H,ak as w,U as k,a4 as L,j as $,a2 as B,_ as j,a0 as A,e as O,o as C,N as P,l as U,v as q,F as R,n as T}from"./vue.js?v=1764830988434";import{e as M,d as z,a as E,b as V,c as D,h as I}from"./public.js?v=1764830988434";import{_ as N}from"./index.js?v=1764830988434";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang.js?v=1764830988434";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang2.js?v=1764830988434";import{g as W}from"./config.js?v=1764830988434";import{dR as G,dj as K,df as Q,aC as X,dV as Y,bJ as Z,dT as ee,e1 as se,da as te,dS as ae}from"./naive.js?v=1764830988434";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1764830988434";import{_ as le}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1764830988434";import{_ as oe}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1764830988434";const ne=(e,a=!0)=>s.post("/ssh_security?action=set_sshkey",e,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_3"),successMessage:a}}),ce=()=>s.post("/ssh_security?action=get_key"),re=e=>s.post("/ssh_security?action=get_logs",e),ue=()=>s.post("/ssh_security?action=get_login_send"),de=(e,a)=>s.post("/ssh_security?action=".concat(e?"set_login_send":"clear_login_send"),a,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_9"),successMessage:!0}}),pe=()=>s.post("/ssh_security?action=return_ip"),_e=e=>s.post("/ssh_security?action=add_return_ip",e,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_10"),successMessage:!0}}),Se=e=>s.post("/ssh_security?action=del_return_ip",e,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_11"),successMessage:!0}}),ye={class:"px-16px pt-4px pb-16px"},xe={class:"mx-20px"},ge={class:"w-200px mr-6px"},me={class:"ml-10px text-desc"},ve={class:"my-24px"},fe={class:"w-360px"},he={class:"flex w-260px"},be={class:"flex-1 mr-6px"},He={class:"ml-10px text-desc"},we={class:"ml-10px text-desc"},ke={class:"my-24px"},Le={class:"ml-10px text-desc"},$e={class:"mt-20px text-desc"},Be=S({__name:"index",setup(e,{expose:u}){const d=j(()=>o(()=>import("./open.js?v=1764830988434"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]))),p=j(()=>o(()=>import("./view.js?v=1764830988434"),__vite__mapDeps([23,24,2,3,4,5,7,8,9,10,25,6,11,12,13,1,14,15,16,17,18,19,20,21,22]))),_=j(()=>o(()=>import("./index212.js?v=1764830988434"),__vite__mapDeps([26,27,2,3,4,5,7,8,9,10,28,18,19,20,21,6,11,12,13,1,14,15,16,17,22]))),{t:S}=y(),A=x(!1),O=async e=>{var a;await(a={status:e},s.post("/ssh_security?action=".concat(a.status?"set_password":"stop_password"),a,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_2"),successMessage:!0}}))},C=x(!1),P=M(S("Security.SSH.Basic.index_19"),{onRefresh:()=>{Se()}}),U=()=>{C.value=!1},q=async e=>{e?P.show=!0:(await s.post("/ssh_security?action=stop_key",{},{requestOptions:{loading:t.global.t("Security.SSH.Api.index_4"),successMessage:!0}}),Se())},R=x(22),T=async()=>{var e;n(R.value)?await(e={port:R.value},s.post("/firewall?action=SetSshPort",e,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_5"),successMessage:!0}})):c.error(S("Security.SSH.Basic.index_20"),{close:!0})},V=x(null),D=x([]),I=async e=>{var a;await(a={p_type:e},s.post("/ssh_security?action=set_root",a,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_6"),successMessage:!0}}))},Z=x(""),ee=()=>{""!==Z.value.trim()?E({title:S("Security.SSH.Basic.index_22"),content:S("Security.SSH.Basic.index_23"),onConfirm:async()=>{var e;await(e={username:"root",password:Z.value},s.post("/ssh_security?action=set_root_password",e,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_7"),successMessage:!0}}))}}):c.error(S("Security.SSH.Basic.index_21"))},se=M(S("Security.SSH.Basic.index_2")),te=()=>{C.value?se.show=!0:c.error(S("Security.SSH.Basic.index_24"))},ae=async()=>{if(!C.value)return void c.error(S("Security.SSH.Basic.index_25"));const{close:e}=c.loading(S("Security.SSH.Basic.index_26"));try{await ce(),window.open("".concat(r(),"/ssh_security?action=download_key"))}finally{e()}},ie=x(""),le=x({}),oe=g(()=>void 0===Object.keys(le.value).find(e=>e===ie.value)),ne=g(()=>{const e=le.value[ie.value];return e?e.title:""}),re=M(S("Security.SSH.Basic.index_13"),{onSetName:e=>{ie.value=e}}),de=()=>{re.data.config=le.value,re.show=!0},pe=m(),_e=()=>{pe.push("/security/system-hardening")},Se=async()=>{const{message:e}=await s.post("/ssh_security?action=get_config");a(e)&&(A.value="yes"===e.password,C.value="yes"===e.pubkey,R.value=e.port,V.value=e.root_login_type,a(e.root_login_types)&&(D.value=Object.entries(e.root_login_types).map(([e,s])=>({label:s,value:e}))))},Be=async()=>{const{message:e}=await ue();a(e)&&(ie.value=e.result)},je=async()=>{const{message:e}=await W();a(e)&&(le.value=e)},{setLoading:Ae}=z(!0);return(async()=>{try{Ae(!0),await Promise.all([Se(),Be(),je()])}finally{Ae(!1)}})(),u({init:()=>{Be(),Se()}}),(e,s)=>{const t=K,a=G,o=Q,n=X,c=i,r=Y,u=F,S=l,y=J,x=N;return f(),v("div",ye,[h(y,{"label-width":"140px"},{default:b(()=>[h(a,{label:e.$t("Security.SSH.Basic.index_1")},{default:b(()=>[h(t,{value:k(A),"onUpdate:value":[s[0]||(s[0]=e=>w(A)?A.value=e:null),O],size:"small"},null,8,["value"]),H("span",xe,L(e.$t("Security.SSH.Basic.index_2")),1),h(t,{value:k(C),"onUpdate:value":[s[1]||(s[1]=e=>w(C)?C.value=e:null),q],size:"small"},null,8,["value"])]),_:1},8,["label"]),h(a,{label:e.$t("Security.SSH.Basic.index_3"),"show-feedback":!1},{default:b(()=>[H("div",ge,[h(o,{value:k(R),"onUpdate:value":s[2]||(s[2]=e=>w(R)?R.value=e:null),min:1,max:65535,"show-button":!1},null,8,["value"])]),h(n,{type:"primary",onClick:T},{default:b(()=>[$(L(e.$t("Public.Btn.Save")),1)]),_:1}),H("div",me,L(e.$t("Security.SSH.Basic.index_4")),1)]),_:1},8,["label"]),H("div",ve,[h(c)]),h(a,{label:e.$t("Security.SSH.Basic.index_5")},{default:b(()=>[H("div",fe,[h(r,{value:k(V),"onUpdate:value":[s[3]||(s[3]=e=>w(V)?V.value=e:null),I],options:k(D)},null,8,["value","options"])])]),_:1},8,["label"]),h(a,{label:e.$t("Security.SSH.Basic.index_6")},{default:b(()=>[H("div",he,[H("div",be,[h(u,{value:k(Z),"onUpdate:value":s[4]||(s[4]=e=>w(Z)?Z.value=e:null),default:!1},null,8,["value"])]),h(n,{type:"primary",onClick:ee},{default:b(()=>[$(L(e.$t("Public.Btn.Reset")),1)]),_:1})]),H("div",He,L(e.$t("Security.SSH.Basic.index_8")),1)]),_:1},8,["label"]),h(a,{label:e.$t("Security.SSH.Basic.index_9"),"show-feedback":!1},{default:b(()=>[h(n,{type:"primary",class:"btn-xs",onClick:te},{default:b(()=>[$(L(e.$t("Security.SSH.Basic.index_10")),1)]),_:1}),h(n,{class:"btn-xs ml-10px",onClick:ae},{default:b(()=>[$(L(e.$t("Public.Btn.Download")),1)]),_:1}),H("div",we,L(e.$t("Security.SSH.Basic.index_12")),1)]),_:1},8,["label"]),H("div",ke,[h(c)]),h(a,{label:e.$t("Security.SSH.Basic.index_13"),"show-feedback":!1},{default:b(()=>[k(oe)?(f(),B(S,{key:0,type:"warning",onClick:de},{default:b(()=>[$(L(e.$t("Security.SSH.Basic.index_14")),1)]),_:1})):(f(),B(S,{key:1,onClick:de},{default:b(()=>[$(L(e.$t("Security.SSH.Basic.index_15",[k(ne)])),1)]),_:1})),h(n,{type:"primary",class:"btn-xs ml-10px",onClick:de},{default:b(()=>[$(L(e.$t("Public.Btn.Set")),1)]),_:1}),H("div",Le,L(e.$t("Security.SSH.Basic.index_12")),1)]),_:1},8,["label"]),H("div",$e,[$(L(e.$t("Security.SSH.Basic.index_17"))+" ",1),h(S,{onClick:_e},{default:b(()=>[$(">>"+L(e.$t("Security.SSH.Basic.index_18")),1)]),_:1})])]),_:1}),h(x,{show:k(P).show,"onUpdate:show":s[5]||(s[5]=e=>k(P).show=e),title:k(P).title,data:k(P).data,width:400,"min-height":124,footer:!0,component:k(d),onPublicClose:U},null,8,["show","title","data","component"]),h(x,{show:k(se).show,"onUpdate:show":s[6]||(s[6]=e=>k(se).show=e),title:k(se).title,width:400,"min-height":322,component:k(p)},null,8,["show","title","component"]),h(x,{show:k(re).show,"onUpdate:show":s[7]||(s[7]=e=>k(re).show=e),title:k(re).title,data:k(re).data,width:1e3,height:600,component:k(_)},null,8,["show","title","data","component"])])}}}),je={class:"pt-40px pb-40px"},Ae={class:"mb-24px text-center text-22px font-bold"},Oe={class:"mb-16px"},Ce={class:"ul-style"},Pe={class:"ml-4px"},Ue={class:"text-center my-24px"},qe={class:"flex justify-center"},Re={class:"w-76%"},Te=u(S({__name:"free",setup(e){const s=()=>{V({source:100})};return(e,t)=>{const a=X,i=Z;return f(),v("div",je,[H("div",Ae,L(e.$t("Security.SSH.Logs.free_1")),1),H("div",Oe,[H("ul",Ce,[H("li",null,[H("span",Pe,L(e.$t("Security.SSH.Logs.free_2")),1)])])]),H("div",Ue,[h(a,{type:"primary",class:"h-36px text-14px",onClick:s},{default:b(()=>[$(L(e.$t("WP.Transition.index_7")),1)]),_:1})]),H("div",qe,[H("div",Re,[h(i,{class:"flex justify-center w-full",src:k("/static/vite/images/ssh-logs.png")},null,8,["src"])])])])}}}),[["__scopeId","data-v-c0b88226"]]),Me=S({__name:"index",setup(e,{expose:i}){const{t:l}=y(),o=d(),{isPro:n}=A(o),{table:r,columns:u,setLoading:_}=D([{key:"address",title:l("Security.SSH.Logs.index_5"),render:e=>h("a",{class:"bt-link",href:"javascript:;",onClick:()=>{S(e)}},[e.address,$(":"),h("span",{class:"text-#666 cursor-default"},[e.port])])},{key:"area",title:l("Security.SSH.Logs.index_6"),render:e=>e.area.info||"--"},{key:"user",title:l("Security.SSH.Logs.index_7")},{key:"status",title:l("Security.SSH.Logs.index_8"),render:e=>h("span",{class:e.status?"text-primary":"text-error"},[e.status?l("Security.SSH.Logs.index_14"):l("Security.SSH.Logs.index_15")])},{key:"time",title:l("Security.SSH.Logs.index_9")}]),S=e=>{E({title:l("Security.SSH.Logs.index_10"),content:e.deny_status?l("Security.SSH.Logs.index_13"):l("Security.SSH.Logs.index_11"),onConfirm:async()=>{if(e.deny_status){const{message:i}=await(a={address:e.address},s.post("/safe/syslog/remove_ip_rules",{data:JSON.stringify(a)},{requestOptions:{loading:t.global.t("Security.SSH.Api.index_8")}}));p(i)&&i.length>0&&c.success(i[0].msg)}else{const{message:a}=await(e=>s.post("/safe/syslog/create_ip_rules",{data:JSON.stringify(e)},{requestOptions:{loading:t.global.t("Security.SSH.Api.index_8")}}))({address:e.address,types:"drop",brief:l("Security.SSH.Logs.index_12"),domain:"",choose:"address"});p(a)&&a.length>0&&c.success(a[0].msg)}var a;m()}})},x=O({p:1,limit:20,select:"ALL",search:"",historyType:"ALL"}),g=()=>{n.value&&(x.p=1,m())},m=async()=>{try{_(!0);const{message:t}=await(e=P(x),s.post("/mod/ssh/com/get_ssh_list",{data:JSON.stringify(e)}));a(t)&&(r.data=p(t.data)?t.data:[],r.total=t.total)}finally{_(!1)}var e};return C(()=>{g()}),i({init:e=>{x.select=e||"ALL",g()}}),(e,s)=>{const t=X,a=se,i=ee,l=oe,o=I,c=le,d=ie;return k(n)?(f(),B(d,{key:0},{toolsLeft:b(()=>[h(t,{type:"primary",onClick:g},{default:b(()=>[$(L(e.$t("Public.Btn.Refresh")),1)]),_:1})]),toolsRight:b(()=>[h(i,{value:k(x).select,"onUpdate:value":[s[0]||(s[0]=e=>k(x).select=e),g]},{default:b(()=>[h(a,{value:"ALL"},{default:b(()=>[$(L(e.$t("Security.SSH.Logs.index_1")),1)]),_:1}),h(a,{value:"Accepted"},{default:b(()=>[$(L(e.$t("Security.SSH.Logs.index_2")),1)]),_:1}),h(a,{value:"Failed"},{default:b(()=>[$(L(e.$t("Security.SSH.Logs.index_3")),1)]),_:1})]),_:1},8,["value"]),h(l,{value:k(x).search,"onUpdate:value":s[1]||(s[1]=e=>k(x).search=e),width:"320",placeholder:e.$t("Security.SSH.Logs.index_4"),onSearch:g},null,8,["value","placeholder"])]),table:b(()=>[h(o,{loading:k(r).loading,data:k(r).data,columns:k(u)},null,8,["loading","data","columns"])]),pageRight:b(()=>[h(c,{page:k(x).p,"onUpdate:page":s[2]||(s[2]=e=>k(x).p=e),"page-size":k(x).limit,"onUpdate:pageSize":s[3]||(s[3]=e=>k(x).limit=e),"store-key":"security-ssh-logs","item-count":k(r).total,onRefresh:m},null,8,["page","page-size","item-count"])]),_:1})):(f(),B(Te,{key:1}))}}}),ze={class:"mr-10px"},Ee={class:"mx-20px"},Ve=S({__name:"index",setup(o){const{t:n}=y(),c=O({status:!1,success:0,successToday:0,error:0,errorToday:0}),r=x(),u=x("basic"),d=[{key:"basic",label:n("Security.SSH.index_5"),component:Be},{key:"logs",label:n("Security.SSH.index_6"),data:{type:"ALL"},component:Me}],p=e=>{r.value.setValue("logs"),T(()=>{const s=r.value.getCompRef("logs");s&&s.init(e)})},S=async()=>{const{message:e}=await s.post("/safe/ssh/GetSshInfo");a(e)&&(c.status=e.status)},g=async()=>{const{message:e}=await s.post("/mod/ssh/com/get_ssh_intrusion");a(e)&&(c.success=e.success,c.successToday=e.today_success,c.error=e.error,c.errorToday=e.today_error)},m=e=>{E({title:n("Security.SSH.index_7"),content:n(e?"Security.SSH.index_8":"Security.SSH.index_9"),onConfirm:async()=>{var a;await(a={status:e?0:1},s.post("/firewall?action=SetSshStatus",a,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_1"),successMessage:!0}})),S(),g()}})},{loading:B,setLoading:j}=z();return j(!0),Promise.all([S(),g()]).finally(()=>{j(!1)}),(s,t)=>{const a=_,o=K,n=i,S=l,y=te,x=ae,g=e;return f(),v(R,null,[h(x,{class:"mb-16px p-16px"},{default:b(()=>[U(h(a,{width:600,height:20,sharp:!1,size:"medium"},null,512),[[q,k(B)]]),U(h(y,{class:"items-center",size:0},{default:b(()=>[H("div",ze,L(s.$t("Security.SSH.index_1")),1),h(o,{value:k(c).status,"onUpdate:value":m},null,8,["value"]),H("div",Ee,[h(n,{class:"mx-0! text-20px",vertical:""})]),H("div",null,[H("span",null,L(s.$t("Security.SSH.index_2")),1),h(S,{onClick:t[0]||(t[0]=e=>p("Accepted"))},{default:b(()=>[$(L(s.$t("Security.SSH.index_3",[k(c).success,k(c).successToday])),1)]),_:1}),t[3]||(t[3]=H("span",{class:"mx-10px"},"/",-1)),h(S,{type:"error",onClick:t[1]||(t[1]=e=>p("Failed"))},{default:b(()=>[$(L(s.$t("Security.SSH.index_4",[k(c).error,k(c).errorToday])),1)]),_:1})])]),_:1},512),[[q,!k(B)]])]),_:1}),h(x,{class:"p-16px"},{default:b(()=>[h(g,{ref_key:"tabsRef",ref:r,value:k(u),"onUpdate:value":t[2]||(t[2]=e=>w(u)?u.value=e:null),options:d},null,8,["value"])]),_:1})],64)}}}),De=Object.freeze(Object.defineProperty({__proto__:null,default:Ve},Symbol.toStringTag,{value:"Module"}));export{re as a,ue as b,pe as c,Se as d,_e as e,ce as g,De as i,ne as o,de as s};
