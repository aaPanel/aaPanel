const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index221.js?v=1769066082311","js/public.js?v=1769066082311","js/page_layout.js?v=1769066082311","js/vue.js?v=1769066082311","js/__commonjsHelpers__.js?v=1769066082311","js/naive.js?v=1769066082311","js/common.js?v=1769066082311","css/page_layout.css?v=1769066082311","css/public.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang.js?v=1769066082311","js/index222.js?v=1769066082311","js/index.js?v=1769066082311","css/index123.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang5.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang6.js?v=1769066082311","css/index17.css?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang7.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang9.js?v=1769066082311","js/index.vue_vue_type_script_setup_true_lang8.js?v=1769066082311","js/index223.js?v=1769066082311","css/index45.css?v=1769066082311","js/xterm.js?v=1769066082311","js/xterm-addon-canvas.js?v=1769066082311","css/xterm-addon-canvas.css?v=1769066082311","js/batch3.js?v=1769066082311"])))=>i.map(i=>d[i]);
import{x as e,m as a,i as t,d as s,a as o,T as l,aA as n,p as r,y as i}from"./page_layout.js?v=1769066082311";import{_ as d}from"./index.js?v=1769066082311";import{_ as u}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1769066082311";import{_ as p}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1769066082311";import{_ as c}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1769066082311";import{e as _,c as y,f as h,a as m,d as w,u as v,K as f,C as k,_ as g,h as b}from"./public.js?v=1769066082311";import{_ as x}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1769066082311";import{_ as R}from"./index.vue_vue_type_script_setup_true_lang.js?v=1769066082311";import{d as S,g as A,a as C,r as j,b as P,c as T,v as $,t as U,e as E,f as O}from"./index222.js?v=1769066082311";import{db as L,au as z,aC as H,dh as D,dS as N,dW as M,dj as B,dZ as K,de as V,G as Z,bJ as q,dT as F,dg as I,dU as W,dV as G,e2 as J}from"./naive.js?v=1769066082311";import{k as Q,P as X,r as Y,e as ee,R as ae,V as te,W as se,S as oe,a3 as le,ak as ne,U as re,j as ie,a4 as de,N as ue,Z as pe,ae as ce,a0 as _e,s as ye,_ as he,a2 as me,O as we,an as ve,F as fe,w as ke,ap as ge,o as be,b as xe,n as Re,i as Se,c as Ae,af as Ce,p as je,ay as Pe,u as Te}from"./vue.js?v=1769066082311";import{_ as $e}from"./index223.js?v=1769066082311";import{x as Ue,a as Ee,b as Oe,c as Le}from"./xterm.js?v=1769066082311";import{x as ze}from"./xterm-addon-canvas.js?v=1769066082311";const He={class:"p-20px"},De={class:"flex-1"},Ne={class:"mt-12px"},Me={class:"px-20px pt-24px pb-8px"},Be={class:"w-150px"},Ke=Q({__name:"set",props:{data:{}},setup(t){const{t:s}=X(),o=t,{setOptions:l}=o.data,n=Y(""),r=async()=>{const e=n.value.trim();""!==e?(await C({name:e}),n.value="",await k(),l()):a.error(s("Site.PHP.index_46"))},i=_(),u=Y(null),p=ee({id:-1,name:""}),c={name:{required:!0,message:s("Site.PHP.index_46"),trigger:["blur","change"]}},w=async({hide:e})=>{var a;await(null==(a=u.value)?void 0:a.validate()),await C(ue(p)),await k(),l(),e()},{table:v,columns:f}=y([{key:"name",title:"Name"},h({width:120,options:e=>[{label:s("Public.Btn.Edit"),show:!1,onClick:()=>{(e=>{p.id=e.id,p.name=e.name,i.title="".concat(s("Site.PHP.index_48")," [").concat(e.name,"]"),i.show=!0})(e)}},{label:s("Public.Btn.Delete"),onClick:()=>{m({title:"".concat(s("Site.PHP.index_49")," [").concat(e.name,"]"),content:s("Site.PHP.index_50"),onConfirm:async({hide:a})=>{await S({id:e.id}),await k(),l(e.id),a()}})}}]})]),k=async()=>{const{message:a}=await A();v.data=e(a)?a:[]};return k(),(e,a)=>{const t=z,s=H,o=L,l=D,_=N,y=R,h=d;return te(),ae("div",He,[se(o,null,{default:le(()=>[oe("div",De,[se(t,{value:re(n),"onUpdate:value":a[0]||(a[0]=e=>ne(n)?n.value=e:null),placeholder:e.$t("Site.PHP.index_46")},null,8,["value","placeholder"])]),oe("div",null,[se(s,{type:"primary",onClick:r},{default:le(()=>[ie(de(e.$t("Site.Cert.index_62")),1)]),_:1})])]),_:1}),oe("div",Ne,[se(l,{"max-height":300,data:re(v).data,columns:re(f)},null,8,["data","columns"])]),se(h,{show:re(i).show,"onUpdate:show":a[2]||(a[2]=e=>re(i).show=e),title:re(i).title,width:350,footer:!0,onConfirm:w},{default:le(()=>[oe("div",Me,[se(y,{ref_key:"formRef",ref:u,model:re(p),rules:c},{default:le(()=>[se(_,{label:e.$t("Site.PHP.index_47"),path:"name"},{default:le(()=>[oe("div",Be,[se(t,{value:re(p).name,"onUpdate:value":a[1]||(a[1]=e=>re(p).name=e),placeholder:""},null,8,["value"])])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["show","title"])])}}}),Ve=pe("node-manage",()=>({categoryList:Y([]),nodeRow:Y({}),nodeType:Y("1")}),{persist:{pick:["nodeType"]}}),Ze={class:"w-160px"},qe=Q({__name:"index",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(a,{expose:t}){const s=ce(a,"value"),{t:o}=X(),{loading:l,setLoading:n}=w(),r=Ve(),{categoryList:i}=_e(r),u=_(o("Site.PHP.index_44"),{setOptions:e=>{c(),s.value===e&&(s.value="")}}),p=()=>{u.show=!0},c=async()=>{try{n(!0);const{message:a}=await A();e(a)&&(i.value=a.map(e=>({label:e.name,value:e.id})))}finally{i.value.unshift({label:o("Default category"),value:0}),i.value.unshift({label:o("Site.PHP.index_45"),value:""}),n(!1)}};return t({getList:c}),(e,a)=>{const t=H,o=M,n=d;return te(),ae("div",Ze,[se(o,ye(e.$attrs,{value:s.value,"onUpdate:value":a[0]||(a[0]=e=>s.value=e),loading:re(l),options:re(i)}),{action:le(()=>[se(t,{block:"",onClick:p},{default:le(()=>[ie(de(e.$t("Site.PHP.index_43")),1)]),_:1})]),_:1},16,["value","loading","options"]),se(n,{show:re(u).show,"onUpdate:show":a[1]||(a[1]=e=>re(u).show=e),width:350,title:re(u).title,data:re(u).data,component:Ke},null,8,["show","title","data"])])}}}),{t:Fe}=t.global,Ie=e=>[{key:"edit",label:Fe("Edit node"),icon:()=>se("i",{class:"i-material-symbols-light:edit-square-sharp text-18px"},null)},{key:"restart_panel",label:Fe("Restart panel"),show:!Qe(e),icon:()=>se("i",{class:"i-material-symbols-light:bottom-panel-close text-18px"},null)},{key:"restart_service",label:Fe("Restart service"),show:!Qe(e),icon:()=>se("i",{class:"i-material-symbols:service-toolbox-outline-rounded text-18px"},null)}],We=e=>{var a;const t=Ve(),{categoryList:s}=_e(t);return null==(a=s.value.find(a=>a.value===e))?void 0:a.label},Ge=e=>[Fe("Online"),Fe("Unknown"),Fe("Offline"),Fe("Abnormal"),Fe("Restarting")][e],Je=e=>{if(!e)return!0;return/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)||/^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/.test(e)},Qe=e=>""===e.api_key&&""===e.app_key&&e.ssh_conf&&Object.keys(e.ssh_conf).length,{t:Xe}=t.global;function Ye(e){return{handleAction:async(a,t)=>{switch(a){case"visit":{const{message:e}=await $({node_id:t.id});s(e)&&window.open(e.target_panel_url,"_blank");break}case"manage":e({option:"option",optionType:"other"},t);break;case"edit":e({option:"option",optionType:"edit"},t);break;case"delete":m({title:Xe("Delete node"),content:Xe("Are you sure you want to delete the node [{0}]?",[t.remarks]),onConfirm:async()=>{await T({ids:String(t.id)}),e({option:"refresh"})}});break;case"restart_panel":m({title:Xe("Restart panel"),content:Xe("Are you sure you want to restart the node [{0}] panel?",[t.remarks]),onConfirm:async()=>{await P({node_id:t.id}),e({option:"refresh"})}});break;case"restart_service":m({title:Xe("Restart service"),content:Xe("Are you sure you want to restart the node [{0}] service?",[t.remarks]),onConfirm:async()=>{await j({node_id:t.id}),e({option:"refresh"})}})}}}}const{t:ea}=t.global;function aa(e){const{handleAction:a}=Ye(e);return{key:"action",title:ea("Site.TableRow.index_30"),width:180,align:"right",render:e=>se(L,{size:2,class:"justify-end!"},{default:()=>[se(f,{options:[{label:ea("Visit"),show:!Qe(e)&&"local"!==e.api_key,onClick:()=>a("visit",e)},{label:ea("Manage"),show:"local"!==e.api_key,onClick:()=>a("manage",e)},{label:ea("Delete"),show:"local"!==e.api_key,onClick:()=>a("delete",e)}]},null),"local"!==e.api_key?se(B,{trigger:"click",options:Ie(e),onSelect:t=>((e,t)=>{a(e,t)})(t,e)},{default:()=>[se("i",{class:"i-famicons:ellipsis-vertical text-18px cursor-pointer"},null)]}):""]})}}const ta={class:"text-16px font-bold"},sa={class:"text-desc"},oa={class:"text-desc"},la={class:"h-100px flex items-center justify-center"},na={class:"text-desc"},ra={class:"text-desc"},ia={class:"flex justify-end h-18px"},da={class:"flex cursor-pointer color-primary"},ua=r(Q({__name:"index",props:{list:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["action"],setup(e,{emit:a}){const{t:t}=X(),s=a,{handleAction:o}=Ye((e,a)=>{s("action",e,a)}),r=e=>[{label:t("Visit"),key:"visit",show:!Qe(e)},{label:t("Manage"),key:"manage"},{label:t("Delete"),key:"delete"},{label:t("Edit"),key:"edit"},{label:t("Restart panel"),key:"restart_panel",show:!Qe(e)},{label:t("Restart service"),key:"restart_service",show:!Qe(e)}];return(a,t)=>{const s=V,i=L,d=Z,u=q,p=B,c=F,_=K,y=n,h=l;return te(),me(h,{show:e.loading},{default:le(()=>[e.list.length?(te(),me(y,{key:0,cols:"1 s:1 m:2 l:3 xl:4 2xl:5",responsive:"screen","x-gap":20,"y-gap":20},{default:le(()=>[(te(!0),ae(fe,null,we(e.list,e=>(te(),me(_,{key:e.id},{default:le(()=>[se(c,{class:"monitor-card p-16px"},{default:le(()=>[se(i,{class:"justify-between! items-center"},{default:le(()=>[oe("span",ta,de(e.remarks),1),se(s,{type:0===e.data.status?"success":"error",size:"small",round:"",bordered:!1},{default:le(()=>[ie(de(re(Ge)(e.data.status)),1)]),_:2},1032,["type"])]),_:2},1024),se(i,{class:"justify-between! items-center my-16px"},{default:le(()=>[oe("span",null,de(a.$t("Address")),1),oe("span",sa,de(e.address),1)]),_:2},1024),se(i,{class:"justify-between! items-center"},{default:le(()=>[oe("span",null,de(a.$t("Category")),1),oe("span",oa,de(re(We)(e.category_id)),1)]),_:2},1024),oe("div",la,[2===e.data.status?(te(),me(d,{key:0,description:a.$t("Node is offline, no metrics")},null,8,["description"])):(te(),me(i,{key:1,class:"flex-col! flex-1",size:16},{default:le(()=>[oe("div",null,[se(i,{class:"justify-between! items-center mb-8px"},{default:le(()=>[t[0]||(t[0]=oe("span",null,"CPU",-1)),oe("span",na,de(e.data.cpu)+"%",1)]),_:2,__:[0]},1024),se(u,{type:"line",status:"success",percentage:e.data.cpu,"show-indicator":!1,height:6},null,8,["percentage"])]),oe("div",null,[se(i,{class:"justify-between! items-center mb-8px"},{default:le(()=>[oe("span",null,de(a.$t("Memory")),1),oe("span",ra,de(e.data.memNewTotal)+" ("+de(e.data.memory)+"%)",1)]),_:2},1024),se(u,{type:"line",status:"success",percentage:e.data.memory,"show-indicator":!1,height:6},null,8,["percentage"])])]),_:2},1024))]),oe("div",ia,["local"!==e.api_key?(te(),me(p,{key:0,trigger:"hover",placement:"bottom",options:r(e),onSelect:a=>((e,a)=>{o(e,a)})(a,e)},{default:le(()=>[oe("div",da,[oe("span",null,de(a.$t("Site.TableRow.index_30")),1),t[1]||(t[1]=oe("i",{class:"i-material-symbols:keyboard-arrow-down text-18px"},null,-1))])]),_:2},1032,["options","onSelect"])):ve("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})):(te(),me(d,{key:1,class:"h-200px flex items-center justify-center"}))]),_:1},8,["show"])}}}),[["__scopeId","data-v-46d0d2ec"]]),pa={class:"p-20px"},ca=Q({__name:"ssh-form",props:{row:{type:Object,default:()=>({})},onRefresh:{type:Function,default:()=>{}}},setup(e,{expose:a}){const{t:t}=X(),s=e,o=Ve(),l=Y(null),n=ee({port:22,ssh_type:"password",password:"",private_key:"",passphrase:""}),r={port:{required:!0,message:t("Enter port"),trigger:"blur",type:"number"},password:{required:!0,message:t("Enter password"),trigger:"blur"},private_key:{required:!0,message:t("Enter key"),trigger:"blur"}},{loading:i,setLoading:d}=w(),u=e=>{var a;const t=(null==(a=s.row.ssh_conf)?void 0:a.host)||s.row.server_ip;return{node_id:s.row.id,host:t,port:n.port,test_case:e,pkey:"key"===n.ssh_type?n.private_key:null,pkey_passwd:"key"===n.ssh_type?n.passphrase:null,password:"password"===n.ssh_type?n.password:null}},p=async()=>{var e;try{d(!0),await(null==(e=l.value)?void 0:e.validate()),await U(u(1))}finally{d(!1)}};a({onConfirm:async()=>{var e;await(null==(e=l.value)?void 0:e.validate()),await U(u(0)),o.nodeRow&&(o.nodeRow.ssh_conf||(o.nodeRow.ssh_conf={}),o.nodeRow.ssh_conf.port=n.port,"password"===n.ssh_type?(o.nodeRow.ssh_conf.password=n.password,o.nodeRow.ssh_conf.pkey="",o.nodeRow.ssh_conf.pkey_passwd=""):(o.nodeRow.ssh_conf.password="",o.nodeRow.ssh_conf.pkey=n.private_key,o.nodeRow.ssh_conf.pkey_passwd=n.passphrase)),s.onRefresh()}});return s.row.ssh_conf&&(n.port=s.row.ssh_conf.port||22,n.ssh_type=s.row.ssh_conf.pkey?"key":"password",n.password=s.row.ssh_conf.password||"",n.private_key=s.row.ssh_conf.pkey||s.row.ssh_conf.private_key||"",n.passphrase=s.row.ssh_conf.pkey_passwd||s.row.ssh_conf.private_key_password||""),(e,a)=>{const t=I,s=N,o=G,d=L,u=W,c=z,_=H,y=R;return te(),ae("div",pa,[se(y,{ref_key:"formRef",ref:l,model:re(n),rules:r},{default:le(()=>[se(s,{label:e.$t("Port"),path:"port"},{default:le(()=>[se(t,{class:"w-120px!",value:re(n).port,"onUpdate:value":a[0]||(a[0]=e=>re(n).port=e),"show-button":!1,placeholder:"22"},null,8,["value"])]),_:1},8,["label"]),se(s,{label:e.$t("Authentication"),path:"ssh_type"},{default:le(()=>[se(u,{value:re(n).ssh_type,"onUpdate:value":a[1]||(a[1]=e=>re(n).ssh_type=e)},{default:le(()=>[se(d,null,{default:le(()=>[se(o,{value:"password"},{default:le(()=>[ie(de(e.$t("Site.Lable.index_27")),1)]),_:1}),se(o,{value:"key"},{default:le(()=>a[5]||(a[5]=[ie("Key",-1)])),_:1,__:[5]})]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),"password"===re(n).ssh_type?(te(),me(s,{key:0,label:e.$t("Site.Lable.index_27"),path:"password"},{default:le(()=>[se(d,{class:"items-center"},{default:le(()=>[se(c,{class:"w-250px!",value:re(n).password,"onUpdate:value":a[2]||(a[2]=e=>re(n).password=e),type:"password","show-password-on":"click",placeholder:e.$t("Enter SSH password")},null,8,["value","placeholder"]),se(_,{onClick:p,loading:re(i)},{default:le(()=>[ie(de(e.$t("Test connection")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["label"])):ve("",!0),"key"===re(n).ssh_type?(te(),ae(fe,{key:1},[se(s,{label:"Key",path:"private_key"},{default:le(()=>[se(d,{class:"items-end"},{default:le(()=>[se(c,{class:"w-250px!",value:re(n).private_key,"onUpdate:value":a[3]||(a[3]=e=>re(n).private_key=e),type:"textarea",placeholder:e.$t("Enter SSH key")},null,8,["value","placeholder"]),se(_,{onClick:p,loading:re(i)},{default:le(()=>[ie(de(e.$t("Test connection")),1)]),_:1},8,["loading"])]),_:1})]),_:1}),se(s,{label:e.$t("Key password"),path:"passphrase"},{default:le(()=>[se(c,{class:"w-250px!",value:re(n).passphrase,"onUpdate:value":a[4]||(a[4]=e=>re(n).passphrase=e),type:"password","show-password-on":"click",placeholder:e.$t("Enter SSH key password")},null,8,["value","placeholder"])]),_:1},8,["label"])],64)):ve("",!0)]),_:1},8,["model"])])}}}),_a=r(Q({__name:"index",props:{data:{}},setup(e,{expose:a}){const{t:t}=X(),s=e,{data:o}=s,{ws:l,status:n,send:r,open:i,close:d}=k("/webssh",{get verifyData(){return{host:o.host,port:o.port,username:o.username,password:o.password,pkey:o.pkey,pkey_passwd:o.pkey_passwd,id:o.id}},onMessage:(e,a)=>{const s=a.data;if(s.indexOf("Authentication timeout.")>-1)c.value=!0;else if("\\r\\nlogout\\r\\n"==s||"logout\\r\\n"==s||"\r\nlogout\r\n"==s||"logout\r\n"==s||s.search(/logout[\r\n]+$/)>-1)return u.write("\r"+t("Component.Terminal.index_1")+"\r"),v(),void d()}});let u,p;const c=Y(!1),_=Y(null);let y=null;const h=()=>{const e=l.value;e&&(u.loadAddon(p),u.loadAddon(new ze.CanvasAddon),u.loadAddon(new Le.WebLinksAddon),y=new Ue.AttachAddon(e),u.loadAddon(y),setTimeout(()=>{p.fit()},100))};ke([l,n],([e,a])=>{if("CLOSED"===a&&e)return u.write("\r\n"+t("Component.Terminal.index_2")+"\r\n"),void setTimeout(()=>{i()},500);"OPEN"===a&&e&&(y&&y.dispose(),y=new Ue.AttachAddon(e),u.loadAddon(y),setTimeout(()=>{p.fit();const{cols:e,rows:a}=u;r({cols:e,rows:a,resize:1})},100))},{immediate:!1});const m=()=>{_.value&&u.open(_.value)};let w=!1;const v=()=>{w=!1},f=()=>{u.focus(),u.onData(e=>{const a=l.value;"\r"===e&&c.value&&(c.value=!1,u.write("\r\n"),g()),void 0!==a||"\r"!==e||w||(w=!0,u.write("\r\n"+t("Component.Terminal.index_2")+"\r\n"),g())})},g=()=>{i(),f();const e=l.value;e&&u.loadAddon(new Ue.AttachAddon(e))},b=()=>{Re(()=>{if(p.fit(),"CLOSED"!==n.value){const{cols:e,rows:a}=u;r({cols:e,rows:a,resize:1})}})};let x=!0;const R=new ResizeObserver(()=>{ge(()=>{x?x=!1:b()},200)()});return a({send:r}),be(async()=>{u=new Ee.Terminal({cursorBlink:!0,fontSize:14,fontFamily:"Monaco, Menlo, Consolas, 'Courier New', monospace",theme:{background:"#333",foreground:"#ececec"}}),p=new Oe.FitAddon,h(),m(),f(),b(),(()=>{const e=_.value;e&&R.observe(e)})()}),xe(()=>{null==R||R.disconnect(),d(),null==u||u.dispose()}),(e,a)=>(te(),ae("div",{ref_key:"terminalRef",ref:_,class:"w-full box"},null,512))}}),[["__scopeId","data-v-688bd5ac"]]),ya=Q({__name:"index",setup(e){var a,t;const{t:s}=X(),o=Ve(),{nodeRow:n}=_e(o),r=Se("onRefresh"),i=Y(!1),u=Y(null),p=Y(!!(null==(t=null==(a=n.value)?void 0:a.ssh_conf)?void 0:t.host)),c=_(s("Edit connection"),{row:n.value,ssh_type:u.value,onRefresh:()=>{p.value=!0,i.value=!1}}),y=Ae(()=>[{label:s("Terminal"),key:"terminal",show:p.value,onClick:()=>{i.value=!0}},{label:s("Edit"),key:"edit",onClick:()=>{c.show=!0}},{label:s("Delete"),key:"delete",show:p.value,onClick:async()=>{var e;await E({node_id:null==(e=n.value)?void 0:e.id}),p.value=!1,null==r||r()}}]),h=Ae(()=>{var e,a,t,s,o,l,r,i,d,u,p;return{id:"nodeTerminal",host:(null==(a=null==(e=n.value)?void 0:e.ssh_conf)?void 0:a.host)||(null==(t=n.value)?void 0:t.server_ip),port:(null==(o=null==(s=n.value)?void 0:s.ssh_conf)?void 0:o.port)||22,username:"root",password:null==(r=null==(l=n.value)?void 0:l.ssh_conf)?void 0:r.password,pkey:null==(d=null==(i=n.value)?void 0:i.ssh_conf)?void 0:d.pkey,pkey_passwd:null==(p=null==(u=n.value)?void 0:u.ssh_conf)?void 0:p.pkey_passwd}});return(e,a)=>{const t=V,s=H,o=L,n=f,r=g,u=d,_=l;return te(),me(_,{show:!1},{default:le(()=>[se(o,{class:"justify-between!"},{default:le(()=>[se(o,{class:"items-center"},{default:le(()=>[oe("span",null,de(e.$t("Root password")),1),se(t,{type:re(p)?"success":"error"},{default:le(()=>[ie(de(re(p)?e.$t("Set"):e.$t("Not set")),1)]),_:1},8,["type"]),re(p)?ve("",!0):(te(),me(s,{key:0,onClick:a[0]||(a[0]=e=>re(c).show=!0)},{default:le(()=>[ie(de(e.$t("Set")),1)]),_:1}))]),_:1}),se(n,{options:re(y)},null,8,["options"])]),_:1}),se(r,{class:"my-16px"},{default:le(()=>[oe("li",null,de(e.$t("Save root password for terminal or node function calls")),1)]),_:1}),re(i)?(te(),me(_a,{key:0,class:"h-480px",url:"/webssh",data:re(h)},null,8,["data"])):ve("",!0),se(u,{show:re(c).show,"onUpdate:show":a[1]||(a[1]=e=>re(c).show=e),title:re(c).title,data:re(c).data,width:550,"min-height":200,footer:!0,component:ca},null,8,["show","title","data"])]),_:1})}}}),ha={class:"h-600px!"},ma=Q({__name:"index",props:{row:{},menuType:{default:"ssh"},onRefresh:{}},setup(e){const a=e,{menuType:t}=Ce(a);Ve().nodeRow=a.row,je("onRefresh",()=>{var e;return null==(e=a.onRefresh)?void 0:e.call(a)});const s=Y(t.value),o=[{key:"ssh",label:"SSH",component:ya}];return(e,a)=>{const t=$e;return te(),ae("div",ha,[se(t,{value:re(s),"onUpdate:value":a[0]||(a[0]=e=>ne(s)?s.value=e:null),data:o},null,8,["value"])])}}});const wa=Q({__name:"index",setup(e){const a=he(()=>o(()=>import("./index221.js?v=1769066082311"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),{t:t}=X(),l=_(t("Add node"),{onRefresh:()=>{C()}}),n=_(t("Node management"),{onRefresh:()=>{C()}}),r=()=>{l.title=t("Add node"),l.data.row=null,l.show=!0},h=({option:e,optionType:a},s)=>{"option"===e?"edit"===a?(l.title=t("Edit node"),l.data.row=s,l.show=!0):"other"===a&&((e,a)=>{n.data.row=e,n.title=t("Node management")+" [".concat(e.address,"]"),n.data.menuType=a,n.show=!0})(s):"refresh"===e&&C()},m=Y(),w=Ve(),f=ee({p:1,limit:20,search:"",category_id:"",node_type:w.nodeType});ke(()=>f.node_type,e=>{w.nodeType=e});const{keys:k,table:g,columns:R}=y([{type:"selection",width:40},{title:t("Node name"),key:"remarks"},{title:t("Address"),key:"address"},{title:t("Status"),key:"status",render:e=>{let a;return se(V,{type:0===e.data.status?"success":"error",size:"small",round:!0,bordered:!1},"function"==typeof(t=a=Ge(e.data.status))||"[object Object]"===Object.prototype.toString.call(t)&&!Te(t)?a:{default:()=>[a]});var t}},{title:t("CPU/Memory"),key:"cpu",render:e=>{const{data:a}=e;return a.status?se("span",null,[ie("--/--")]):se("span",null,[e.data.cpu_usage,ie(" "),t("Home.index_36"),ie(" ("),e.data.cpu,ie("%) / "),e.data.memNewTotal,ie(" ("),e.data.memory,ie("%)")])}},{title:t("Category"),key:"category_id",render:e=>se("span",null,[We(e.category_id)])},aa(h)]),S=((e,a)=>[{key:"category",label:ea("Crontab.Planned.index_19"),onBatch:e=>{v({title:ea("Site.Batch.index_22"),width:350,minHeight:72,footer:!0,data:{rows:e,onRefresh:a},component:he(()=>o(()=>import("./batch3.js?v=1769066082311"),__vite__mapDeps([24,9,3,4,5,6,2,1,8,7,10,11,12,13,14,15,16,17,18,19,20,21,22,23])))})}},{key:"restart_panel",type:"confirm",label:ea("Restart panel"),confirm:{title:ea("Restart panel"),desc:ea("Are you sure you want to restart the selected node?"),columns:[e.value[1]],api:e=>P({node_id:e.id},!1),done:()=>{a()}}},{key:"restart_service",type:"confirm",label:ea("Restart service"),confirm:{title:ea("Restart service"),desc:ea("Are you sure you want to restart the selected node?"),columns:[e.value[1]],api:e=>j({node_id:e.id},!1),done:()=>{a()}}},{key:"delete",type:"confirm",label:ea("Delete node"),confirm:{title:ea("Delete node"),desc:ea("Are you sure you want to delete the selected node?"),columns:[e.value[1]],api:e=>T({ids:String(e.id)},!1),done:()=>{a()}}}])(R,()=>{C()}),A=()=>{f.p=1,C()},C=async()=>{try{g.loading=!0;const{message:e}=await O({p:f.p,limit:f.limit,search:f.search,category_id:""===f.category_id?null:f.category_id});s(e)&&(g.data=e.data,g.total=i(e.page))}finally{g.loading=!1}};return be(async()=>{var e;null==(e=m.value)||e.getList(),C()}),(e,s)=>{const o=H,i=J,_=W,y=x,w=b,v=c,j=p,P=u,T=d,$=F;return te(),me($,{class:"p-16px"},{default:le(()=>[se(P,null,Pe({toolsLeft:le(()=>[se(o,{type:"primary",onClick:r},{default:le(()=>[ie(de(re(t)("Add node")),1)]),_:1})]),toolsRight:le(()=>[se(_,{value:re(f).node_type,"onUpdate:value":s[0]||(s[0]=e=>re(f).node_type=e)},{default:le(()=>[se(i,{value:"1"},{default:le(()=>[ie(de(re(t)("List mode")),1)]),_:1}),se(i,{value:"2"},{default:le(()=>[ie(de(re(t)("Probe mode")),1)]),_:1})]),_:1},8,["value"]),se(qe,{ref_key:"siteCategoryRef",ref:m,value:re(f).category_id,"onUpdate:value":[s[1]||(s[1]=e=>re(f).category_id=e),C]},null,8,["value"]),se(y,{value:re(f).search,"onUpdate:value":s[2]||(s[2]=e=>re(f).search=e),placeholder:"Enter node name",onSearch:A},null,8,["value"])]),table:le(()=>["1"===re(f).node_type?(te(),me(w,{key:0,"checked-row-keys":re(k),"onUpdate:checkedRowKeys":s[3]||(s[3]=e=>ne(k)?k.value=e:null),"row-key":"id",loading:re(g).loading,data:re(g).data,columns:re(R)},null,8,["checked-row-keys","loading","data","columns"])):"2"===re(f).node_type?(te(),me(ua,{key:1,list:re(g).data,loading:re(g).loading,onAction:h},null,8,["list","loading"])):ve("",!0)]),pageRight:le(()=>[se(j,{page:re(f).p,"onUpdate:page":s[5]||(s[5]=e=>re(f).p=e),"page-size":re(f).limit,"onUpdate:pageSize":s[6]||(s[6]=e=>re(f).limit=e),"item-count":re(g).total,"store-key":"node-manage",onRefresh:C},null,8,["page","page-size","item-count"])]),_:2},["1"===re(f).node_type?{name:"pageLeft",fn:le(()=>[se(v,{"checked-row-keys":re(k),"onUpdate:checkedRowKeys":s[4]||(s[4]=e=>ne(k)?k.value=e:null),data:re(g).data,options:re(S)},null,8,["checked-row-keys","data","options"])]),key:"0"}:void 0]),1024),se(T,{show:re(l).show,"onUpdate:show":s[7]||(s[7]=e=>re(l).show=e),title:re(l).title,data:re(l).data,width:600,"min-height":380,footer:!0,component:re(a)},null,8,["show","title","data","component"]),se(T,{show:re(n).show,"onUpdate:show":s[8]||(s[8]=e=>re(n).show=e),title:re(n).title,data:re(n).data,width:900,component:ma},null,8,["show","title","data"])]),_:1})}}}),va=Object.freeze(Object.defineProperty({__proto__:null,default:wa},Symbol.toStringTag,{value:"Module"}));export{va as i,Ve as u,Je as v};
