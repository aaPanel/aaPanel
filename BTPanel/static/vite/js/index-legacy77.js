System.register(["./setting-legacy.js?v=1769066082311","./vue-legacy.js?v=1769066082311","./page_layout-legacy.js?v=1769066082311","./naive-legacy.js?v=1769066082311","./public-legacy.js?v=1769066082311","./index.vue_vue_type_script_setup_true_lang-legacy14.js?v=1769066082311","./index-legacy208.js?v=1769066082311","./tools-legacy2.js?v=1769066082311"],function(e,t){"use strict";var a,l,r,i,n,o,s,c,u,d,p,v,f,x,_,m,y,w,h,g,b,k,O,W,$,S,q,T,j,z,C,L,B,I,M,A,E,P,U,D,F,G,N,H,Y,K,R,V,X,Z,J,Q,ee,te,ae,le,re,ie,ne,oe,se,ce,ue,de,pe,ve,fe,xe,_e,me,ye;return{setters:[e=>{a=e.s},e=>{l=e.Z,r=e.a0,i=e.r,n=e.c,o=e.a2,s=e.V,c=e.a3,u=e.q,d=e.k,p=e.P,v=e.ae,f=e.y,x=e.R,_=e.W,m=e.U,y=e.ak,w=e.F,h=e.O,g=e.j,b=e.a4,k=e.S,O=e.l,W=e.v,$=e.X,S=e.aG,q=e.Y,T=e.w,j=e.n,z=e._,C=e.an,L=e.a7,B=e.I},e=>{I=e.aE,M=e.i,A=e.dr,E=e.aa,P=e.d,U=e.n,D=e.p,F=e.a7,G=e.aI,N=e.x,H=e.k,Y=e.ca,K=e.q,R=e.o,V=e.a,X=e.aA},e=>{Z=e.dT,J=e.dU,Q=e.e2,ee=e.di,te=e.bJ,ae=e.aC,le=e.dk,re=e.dd,ie=e.G,ne=e.dZ,oe=e.dl},e=>{se=e.k,ce=e.c,ue=e.h,de=e.a,pe=e.u,ve=e.f},e=>{fe=e._},e=>{xe=e._},e=>{_e=e.a,me=e.b,ye=e.s}],execute:function(){var we=document.createElement("style");we.textContent='.wap-card[data-v-ff288151]{--n-border-radius: 6px;--n-title-font-size: 14px;--n-title-text-color: var(--color-text-4);box-shadow:0 1px 3px 1px rgba(0,0,0,.05)}.wap-card[data-v-ff288151] .n-card-header{height:50px;padding:0 16px}.wap-card[data-v-ff288151] .n-card-header .n-card-header__main{display:flex;align-items:center;font-weight:700}.bt-radio[data-v-e100fb9e] .n-radio-button:last-child{border-right:none;border-top-right-radius:0;border-bottom-right-radius:0}.bt-date-picker[data-v-e100fb9e]{width:120px}.bt-date-picker[data-v-e100fb9e] .n-input{border-top-left-radius:0;border-bottom-left-radius:0}.refresh-progress[data-v-cdf03241]{width:28px;cursor:pointer}.wap-card[data-v-d7e87a24]{--wap-card-icon: url(/static/vite/images/today-new.svg);--wap-card-color: var(--color-primary);height:100%;padding:20px}.wap-card.request[data-v-d7e87a24]{--wap-card-color: var(--color-primary)}.wap-card.malicious-request[data-v-d7e87a24]{--wap-card-color: var(--color-error)}.wap-card .card-bg[data-v-d7e87a24]{position:absolute;right:0;bottom:0;display:flex;justify-content:flex-end;align-items:flex-end;height:80px;font-size:80px;color:var(--color-text-3);opacity:.3;z-index:0}.wap-card .card-title[data-v-d7e87a24]{display:flex;align-items:center;font-size:14px;color:var(--color-text-4)}.wap-card .card-title[data-v-d7e87a24]:before{content:"";display:block;width:4px;height:14px;border-radius:2px;margin-right:8px;background-color:var(--wap-card-color)}.wap-card .card-value[data-v-d7e87a24]{position:relative;margin-top:14px;margin-bottom:6px;font-size:28px;font-weight:700;color:var(--color-text-5);font-family:Microsoft YaHei,sans-serif;z-index:1}.wap-card .card-trend[data-v-d7e87a24]{position:relative;display:flex;align-items:center;color:var(--wap-card-color);font-family:Microsoft YaHei,sans-serif;z-index:1}.wap-card .card-yesterday[data-v-d7e87a24]{position:relative;margin-top:8px;color:var(--color-text-4);z-index:1}.rank-list[data-v-ba455d5c]{display:flex;flex-direction:column;gap:8px}.rank-item[data-v-ba455d5c]{display:flex;align-items:center}.rank-item .rank-num[data-v-ba455d5c]{width:24px;height:24px;line-height:24px;margin-right:16px;border-radius:50%;color:#fff;text-align:center;font-size:12px;font-weight:700}.rank-item .rank-title[data-v-ba455d5c]{width:110px;margin-right:20px;font-size:13px;color:var(--color-text-5)}.rank-item .rank-value[data-v-ba455d5c]{text-align:right;font-size:13px;color:var(--color-text-5)}\n/*$vite$:1*/',document.head.appendChild(we);const he=e=>I.post("/btwaf/overview.json",e),ge=e=>I.post("/btwaf/new_overview.json",e),be=(e("g",()=>I.post("/btwaf/get_index_map.json")),()=>I.post("/plugin?action=a&name=btwaf&s=set_obj_open",{obj:"3D"},{requestOptions:{loading:M.global.t("Waf.Api.overview_2"),successMessage:!0}})),ke=l("waf-overview-store",()=>{const e=i("today"),t=n(()=>{const t=A(e.value);return E(t,"yyyy-MM-dd")}),a=i(1),l=i(2),r=i(!0),o=i(!1),s=i({today_request:0,malicious_request:0,unprotected_site:0,unprotected_site_list:[],maybe_err_cc:0,maybe_err_cc_list:[],webshell:0,yesterday_request_total:0,yesterday_malicious_request:0}),c=i([]),u=i({qps:0,proxy_time:0,traffic:0,time:0}),d=i(0),p=i(0),v=i(!1),f=i([]),x=i([]),_=i([]),m=i([]),y=i([]),w=i([]),h=i([]),g=e=>{s.value=e.count,c.value=e.traffic_filter||[],u.value={qps:e.qps,time:e.time,traffic:Number(U(e.traffic,!1,2,"KB")),proxy_time:e.proxy_time},r.value=e.open,v.value=e["3D"],f.value=e.map||[],x.value=e.attack_details||[],_.value=e.server_name_top||[],m.value=e.traffic_top||[],y.value=e.url_top||[],w.value=e.type||[],h.value=e.attack_report_log||[]},b=t=>{u.value={qps:t.qps,time:t.time,traffic:Number(U(t.traffic,!1,2,"KB")),proxy_time:t.proxy_time},"today"===e.value&&(s.value.today_request=t.count.today_request,s.value.malicious_request=t.count.malicious_request),t.traffic_filter.length>0&&(c.value=t.traffic_filter),t.map.length>0&&(f.value=t.map),t.attack_details.length>0&&(x.value=t.attack_details),t.server_name_top.length>0&&(_.value=t.server_name_top),t.traffic_top.length>0&&(m.value=t.traffic_top),t.url_top.length>0&&(y.value=t.url_top),t.type.length>0&&(w.value=t.type),t.attack_report_log.length>0&&(h.value=t.attack_report_log)};return{startTime:e,queryStartTime:t,request:a,mapType:l,open:r,count:s,trafficFilter:c,realTime:u,qps:d,proxyTime:p,is3D:v,map:f,attackDetails:x,serverNameTop:_,trafficTop:m,urlTop:y,blockTypes:w,attackReportLogs:h,getInfo:async()=>{try{o.value=!0;const{message:e}=await he({start_time:t.value,country:0,request:a.value});P(e)&&g(e)}finally{o.value=!1}},getLoopInfo:async()=>{const{message:e}=await ge({start_time:t.value});P(e)&&b(e)}}},{persist:{pick:["request","mapType"]}}),Oe=e("u",()=>{const e=ke();return{store:e,...r(e)}}),We=D({},[["render",function(e,t){const a=Z;return s(),o(a,{class:"wap-card"},{header:c(()=>[u(e.$slots,"header",{},void 0,!0)]),"header-extra":c(()=>[u(e.$slots,"header-extra",{},void 0,!0)]),default:c(()=>[u(e.$slots,"default",{},void 0,!0)]),_:3})}],["__scopeId","data-v-ff288151"]]),$e={class:"flex"},Se=D(d({__name:"query-date",props:{value:{default:"today"},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=p(),a=i("today"),l=i(null),r=v(e,"value"),n=[{label:t("Public.Search.Yesterday"),value:"yesterday"},{label:t("Public.Search.Today"),value:"today"}],o=e=>{r.value=e},u=e=>{a.value=e?"":"today",r.value=G(e)?E(e,"yyyy-MM-dd"):"today"};return f(()=>{n.map(e=>e.value).includes(r.value)?(a.value=r.value,l.value=null):(a.value="",l.value=new Date(r.value).getTime())}),(e,t)=>{const r=Q,i=J,d=F;return s(),x("div",$e,[_(i,{value:m(a),"onUpdate:value":[t[0]||(t[0]=e=>y(a)?a.value=e:null),o],size:"small",class:"bt-radio"},{default:c(()=>[(s(),x(w,null,h(n,e=>_(r,{key:e.value,value:e.value},{default:c(()=>[g(b(e.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"]),_(d,{value:m(l),"onUpdate:value":[t[1]||(t[1]=e=>y(l)?l.value=e:null),u],type:"date",size:"small",class:"bt-date-picker",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-e100fb9e"]]),qe={class:"text-desc text-12px leading-1"},Te=d({__name:"auto-refresh",props:{show:{type:Boolean,default:!0},open:{type:Boolean,default:!0},seconds:{default:3},refresh:{}},setup(e){const t=e,a=t.seconds,l=i(0),r=i(a),n=i(!1),{loop:u}=se(async()=>{if(0===r.value)try{n.value=!0,await(t.refresh?.())}finally{l.value=0,r.value=a,n.value=!1}else r.value-=1,l.value=(a-r.value)/a*100},1);return u(),(e,t)=>{const i=te,u=ee;return s(),o(u,{placement:"bottom"},{trigger:c(()=>[O(_(i,{class:"refresh-progress",type:"circle",status:"success",processing:m(n),"rail-color":"#e8e8e8","stroke-width":12,"offset-degree":180,percentage:m(l)},{default:c(()=>[k("span",qe,b(m(r)),1)]),_:1},8,["processing","percentage"]),[[W,e.show]])]),default:c(()=>[k("span",null,b(e.$t("Waf.Overview.index_8",[m(a)])),1)]),_:1})}}}),je=D(Te,[["__scopeId","data-v-cdf03241"]]),ze={class:"flex items-center justify-between h-50px px-16px"},Ce=d({__name:"index",setup(e){const{store:t,startTime:a}=Oe(),l=()=>{t.getInfo()},r=async()=>{await t.getLoopInfo()};return(e,t)=>(s(),o(We,null,{default:c(()=>[k("div",ze,[_(Se,{value:m(a),"onUpdate:value":[t[0]||(t[0]=e=>y(a)?a.value=e:null),l]},null,8,["value"]),_(je,{show:"today"===m(a),refresh:r},null,8,["show"])])]),_:1}))}}),Le={class:"flex gap-16px h-160px"},Be={class:"flex-1"},Ie={class:"card-title"},Me={class:"card-value"},Ae={class:"card-trend"},Ee={class:"card-yesterday"},Pe={class:"flex-1"},Ue={class:"card-title"},De={class:"card-value"},Fe={class:"card-trend"},Ge={class:"card-yesterday"},Ne=D(d({__name:"index",setup(e){const{count:t}=Oe(),a=e=>e.toLocaleString("en-US"),l=n(()=>{const e=100*(t.value.today_request/(t.value.yesterday_request_total||1)-1);return`${e>0?"↑":"↓"} ${e.toFixed(2)}%`}),r=n(()=>{const e=100*(t.value.malicious_request/(t.value.yesterday_malicious_request||1)-1);return`${e>0?"↑":"↓"} ${e.toFixed(2)}%`});return(e,i)=>(s(),x("div",Le,[k("div",Be,[_(We,{class:"request"},{default:c(()=>[k("div",Ie,b(e.$t("Waf.Overview.index_1")),1),k("div",Me,b(a(m(t).today_request)),1),k("div",Ae,b(m(l)),1),k("div",Ee,b(e.$t("Public.Search.Yesterday"))+b(e.$t("Public.Punctuation.Colon"))+b(m(t).yesterday_request_total),1),i[0]||(i[0]=k("div",{class:"card-bg"},[k("i",{class:"i-waf:today"})],-1))]),_:1,__:[0]})]),k("div",Pe,[_(We,{class:"malicious-request"},{default:c(()=>[k("div",Ue,b(e.$t("Waf.Overview.index_2")),1),k("div",De,b(a(m(t).malicious_request)),1),k("div",Fe,b(m(r)),1),k("div",Ge,b(e.$t("Public.Search.Yesterday"))+b(e.$t("Public.Punctuation.Colon"))+b(m(t).yesterday_malicious_request),1),i[1]||(i[1]=k("div",{class:"card-bg"},[k("i",{class:"i-waf:malicious"})],-1))]),_:1,__:[1]})])]))}}),[["__scopeId","data-v-d7e87a24"]]),He=(e,t,a,l)=>{const{t:r}=p(),i=$("--chart-tooltip-bg-color"),n=$("--color-text-2"),o=$("--color-border"),s=S({grid:{left:"4%",right:"10%",bottom:"0",top:"12%",containLabel:!0},tooltip:{trigger:"axis",backgroundColor:i.value,borderColor:"transparent",position:"right",textStyle:{color:n.value},formatter(e){if(!N(e)||0===e.length)return"";const t=e[0],a=H(t.axisValue),i=document.createElement("div"),n=_(w,null,[_("div",null,[r("Waf.Overview.index_22",[E(a)])]),_("div",null,[_("span",{class:"inline-block w-10px h-10px mr-10px rounded-full",style:{backgroundColor:`${t.color}`}},null),t.seriesName+": "+t.value+(l?" "+l:"")])]);return q(n,i),i}},xAxis:c(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:o.value}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:n.value},nameTextStyle:{color:n.value}},series:u()});function c(e=[]){return{type:"category",boundaryGap:!1,data:e,axisLabel:{color:n.value,formatter:e=>E(H(e),"HH:mm:ss")},nameTextStyle:{color:n.value},axisLine:{show:!0,lineStyle:{color:o.value}},axisTick:{show:!0,lineStyle:{color:o.value}}}}function u(e=[]){return[{name:a,type:"line",stack:"Total",data:e,itemStyle:{color:"#20a53a"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.4)"},{offset:.7,color:"rgba(32, 164, 58, 0)"}]}}}]}const d=[],v=[],f=async()=>{var e;await j(),d.length>0&&(e=d[0],(new Date).getTime()-e>6e4)&&(d.shift(),v.shift()),s.xAxis=c(d),s.series=u(v)};return T(()=>e.value,e=>{d.push(1e3*e.time),v.push(e[t]),f()},{deep:!0}),{chartOption:s}},Ye={class:"ml-6px"},Ke={class:"h-114px p-10px"},Re=d({__name:"index",setup(e){const{realTime:t}=Oe(),{chartOption:a}=He(t,"qps","QPS");return(e,l)=>(s(),o(We,null,{header:c(()=>[l[0]||(l[0]=k("i",{class:"i-waf:qps text-16px"},null,-1)),k("span",Ye,b(e.$t("Waf.Overview.index_21",[m(t).qps])),1)]),default:c(()=>[k("div",Ke,[_(fe,{type:"line",height:"100%",option:m(a)},null,8,["option"])])]),_:1}))}}),Ve={class:"ml-6px"},Xe={class:"h-114px p-10px"},Ze=d({__name:"index",setup(e){const{t:t}=p(),{realTime:a}=Oe(),{chartOption:l}=He(a,"proxy_time",t("Waf.Overview.index_40"));return(e,t)=>(s(),o(We,null,{header:c(()=>[t[0]||(t[0]=k("i",{class:"i-waf:response text-16px"},null,-1)),k("span",Ve,b(e.$t("Waf.Overview.index_39",[m(a).proxy_time])),1)]),default:c(()=>[k("div",Xe,[_(fe,{type:"line",height:"100%",option:m(l)},null,8,["option"])])]),_:1}))}}),Je={class:"ml-6px"},Qe={class:"h-114px p-10px"},et=d({__name:"index",setup(e){const{t:t}=p(),{realTime:a}=Oe(),{chartOption:l}=He(a,"traffic",t("Waf.Overview.index_41"),"KB/s");return(e,t)=>(s(),o(We,null,{header:c(()=>[t[0]||(t[0]=k("i",{class:"i-waf:site-traffic text-16px"},null,-1)),k("span",Je,b(e.$t("Waf.Overview.index_81",[m(a).traffic])),1)]),default:c(()=>[k("div",Qe,[_(fe,{type:"line",height:"100%",option:m(l)},null,8,["option"])])]),_:1}))}}),tt={class:"ml-6px"},at={class:"h-176px p-16px"},lt=d({__name:"index",setup(e){const{t:t}=p(),{store:a,trafficFilter:l}=Oe(),r=$("--chart-tooltip-bg-color"),n=$("--color-text-2"),u=$("--color-border"),d=()=>{a.getInfo()},v=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:n.value},nameTextStyle:{color:n.value},axisLine:{show:!0,lineStyle:{color:u.value}},axisTick:{show:!0,lineStyle:{color:u.value}}}),x=i([{name:t("Waf.Overview.index_5"),color:"#20a53a",value:[]},{name:t("Waf.Overview.index_4"),color:"#A0BFE0",value:[]},{name:t("Waf.Overview.index_41"),color:"#30aaf6ff",value:[]},{name:t("Waf.Overview.index_42"),color:"#78e1b9ff",value:[]}]),y=()=>x.value.map(e=>({name:e.name,type:"line",data:e.value,symbol:"none",sampling:"average",smooth:!0,showSymbol:!1,itemStyle:{color:e.color},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:Y(e.color,.6)},{offset:1,color:Y(e.color,0)}]}}})),h={BYTE:{factor:1,suffix:" Byte"},KB:{factor:1024,suffix:" KB"},MB:{factor:1048576,suffix:" MB"},GB:{factor:1024**3,suffix:" GB"}},O=(e,t)=>(e=>{const t=e.toFixed(2);return t.endsWith(".00")?parseInt(t).toString():t})(e/t.factor),W=e=>{const{flow:t,static_flow:a}=e,l=t-a,r=(i=t,Object.values(h).reverse().find(e=>i>=e.factor)||h.BYTE);var i;return{static_flow:O(a,r),dynamic_flow:O(l,r),tmp_size:r.suffix}},T=S({grid:{left:"2%",right:"2%",bottom:"2%",top:"20%",containLabel:!0},legend:{icon:"circle",data:x.value.map(e=>e.name),top:"-2%",itemWidth:10,itemHeight:10,itemGap:16,textStyle:{color:n.value,lineHeight:12,padding:[0,0,-2,0],rich:{a:{verticalAlign:"middle"}}}},tooltip:{trigger:"axis",backgroundColor:r.value,borderColor:"transparent",textStyle:{color:n.value},position:(e,t,a,l,r)=>{let i=0,n=0;const o=window.__LAST_VIEWPORT_MOUSE__?.x||0,s=(window.__LAST_VIEWPORT_MOUSE__?.y||0)-e[1],c=r.contentSize[0]||0,u=r.contentSize[1]||0;return i=e[0]-c-20,n=e[1]-u-30,s<u&&s<300&&(n=e[1]+20),o+c+20>window.innerWidth&&(i=e[0]-c-20),[i,n]},formatter(e){if(!N(e))return"";const a=e[0].data,l=W(a),r=document.createElement("div"),i=_(w,null,[_("div",null,[t("Waf.Overview.index_22",[E(a.timestamp,"yyyy-MM-dd HH:mm")])]),e.map(e=>_("div",null,[_("span",{class:"inline-block w-10px h-10px mr-10px rounded-full",style:{backgroundColor:`${e.color}`}},null),e.seriesName,g(": "),e.value,g(" "),e.seriesName===x.value[2].name?"MB":""])),_("div",null,[_("span",{class:"inline-block w-10px h-10px mr-10px"},null),t("Waf.Overview.index_7_1",[a.err_499||0])]),_("div",null,[_("span",{class:"inline-block w-10px h-10px mr-10px"},null),t("Waf.Overview.index_7_2",[a.err_502||0])]),_("div",null,[_("span",{class:"inline-block w-10px h-10px mr-10px"},null),t("Waf.Overview.index_43",[l.dynamic_flow,l.static_flow,l.tmp_size])])]);return q(i,r),r}},xAxis:v(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:u.value}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:n.value},nameTextStyle:{color:n.value}},series:y()});return f(()=>{(e=>{const t=[],a=[],l=[],r=[],i=[];e.forEach(e=>{a.push(e.proxy_count),i.push({...e,value:e.request}),r.push(e.ip_count||0);const n=e.flow?Number((e.flow/1024/1024).toFixed(2)):0;l.push(n);const o=e.hour<10?"0"+e.hour:e.hour,s=e.minute<10?"0"+e.minute:e.minute;t.push(`${o}:${s}`)}),T.xAxis=v(t),x.value[0].value=i,x.value[1].value=a,x.value[2].value=l,x.value[3].value=r,T.series=y()})(l.value)}),(e,t)=>{const a=ae;return s(),o(We,null,{header:c(()=>[t[0]||(t[0]=k("i",{class:"i-waf:traffic-filter text-16px"},null,-1)),k("span",tt,b(e.$t("Waf.Overview.index_3")),1)]),"header-extra":c(()=>[_(a,{onClick:d},{default:c(()=>t[1]||(t[1]=[k("i",{class:"i-common:refresh text-14px"},null,-1)])),_:1,__:[1]})]),default:c(()=>[k("div",at,[_(fe,{type:"line",height:"100%",option:m(T)},null,8,["option"])])]),_:1})}}}),rt=d({__name:"block",setup(e){const{attackDetails:t}=Oe(),{t:a}=p(),{columns:l}=ce([{key:"ip",width:120,title:a("Waf.Overview.index_27"),ellipsis:{tooltip:!0},render:e=>_("a",{class:"bt-link",href:"javascript:;",onClick:()=>{_e({ip:e.ip})}},[e.ip])},{key:"count",width:90,title:a("Waf.Overview.index_28")},{key:"address",title:a("Waf.Overview.index_29"),ellipsis:{tooltip:!0}}]);return(e,a)=>{const r=ue;return s(),o(r,{"max-height":380,data:m(t),columns:m(l)},null,8,["data","columns"])}}}),it=d({__name:"request",setup(e){const{attackDetails:t}=Oe(),{t:a}=p(),{columns:l}=ce([{key:"ip",width:110,title:a("Waf.Overview.index_76"),ellipsis:{tooltip:!0},render:e=>_("a",{class:"bt-link",href:"javascript:;",onClick:()=>{_e({ip:e.ip})}},[e.ip])},{key:"count",width:80,title:a("Waf.Overview.index_77")},{key:"traffic",width:60,title:a("Waf.Overview.index_41"),render:e=>U(e.traffic)},{key:"address",title:a("Waf.Overview.index_29"),ellipsis:{tooltip:!0}}]);return(e,a)=>{const r=ue;return s(),o(r,{"max-height":380,data:m(t),columns:m(l)},null,8,["data","columns"])}}}),nt={class:"mx-6px"},ot={class:"leading-20px"},st={class:"flex items-center"},ct={class:"mr-8px text-12px"},ut={class:"flex gap-12px h-475px p-16px"},dt={class:"flex-1 flex flex-col w-0"},pt={class:"flex items-center relative w-full"},vt={class:"flex items-center gap-8px"},ft={class:"text-desc"},xt={class:"relative flex-1"},_t={class:"w-360px"},mt=d({__name:"index",setup(e){const a=z(()=>V(()=>t.import("./map2d-legacy.js?v=1769066082311"),void 0)),l=z(()=>V(()=>t.import("./map3d-legacy.js?v=1769066082311"),void 0)),{store:r,is3D:i,mapType:u,request:d}=Oe(),{t:v}=p(),f=n(()=>3===u.value&&i.value?l:a),x=n(()=>1===d.value?rt:it),w=e=>{de({title:v(e?"Waf.Overview.index_35":"Waf.Overview.index_36"),content:v(e?"Waf.Overview.index_37":"Waf.Overview.index_38"),onConfirm:async()=>{await be(),i.value=e,u.value=e?3:2}})},h=()=>{r.getInfo()};return(e,t)=>{const a=xe,l=le,r=K,n=R,p=Q,v=J;return s(),o(We,null,{header:c(()=>[t[2]||(t[2]=k("i",{class:"i-waf:attack-map text-16px"},null,-1)),k("span",nt,b(e.$t("Waf.Overview.index_44")),1),_(a,null,{default:c(()=>[k("div",ot,b(e.$t("Waf.Overview.index_45")),1)]),_:1})]),"header-extra":c(()=>[k("div",st,[k("span",ct,b(e.$t("Waf.Overview.index_34")),1),_(l,{value:m(i),size:"small","onUpdate:value":w},null,8,["value"]),_(r,{vertical:""}),_(n,{href:"/btwaf/content_report.html",target:"_blank"},{default:c(()=>[g(b(e.$t("Waf.Overview.index_30")),1)]),_:1})])]),default:c(()=>[k("div",ut,[k("div",dt,[k("div",pt,[k("div",vt,[m(i)?(s(),o(v,{key:0,value:m(u),"onUpdate:value":t[0]||(t[0]=e=>y(u)?u.value=e:null),size:"small"},{default:c(()=>[_(p,{value:3},{default:c(()=>t[3]||(t[3]=[g("3D",-1)])),_:1,__:[3]}),_(p,{value:2},{default:c(()=>t[4]||(t[4]=[g("2D",-1)])),_:1,__:[4]})]),_:1},8,["value"])):C("",!0),k("span",ft,b(e.$t("Waf.Overview.index_46")),1)]),_(v,{value:m(d),"onUpdate:value":[t[1]||(t[1]=e=>y(d)?d.value=e:null),h],class:"ml-70px",size:"small"},{default:c(()=>[_(p,{value:0},{default:c(()=>[g(b(e.$t("Waf.Overview.index_47")),1)]),_:1}),_(p,{value:1},{default:c(()=>[g(b(e.$t("Waf.Overview.index_48")),1)]),_:1})]),_:1},8,["value"])]),k("div",xt,[(s(),o(L(m(f))))])]),k("div",_t,[(s(),o(L(m(x))))])])]),_:1})}}}),yt={key:0,class:"rank-list"},wt={class:"rank-title"},ht={class:"flex-1 mr-16px"},gt={class:"rank-value"},bt={key:1,class:"flex items-center justify-center h-full"},kt=d({__name:"rank",props:{data:{type:Array,default:()=>[]},colors:{type:Array,default:()=>["#418f6b","#bcdeca"]}},setup(e){const t=n(()=>a(e.colors[0],e.colors[1])),a=(e,t)=>{function a(e){return e=function(e){if(3===(e=(e||"").replace(/^#/,"").toLowerCase()).length&&(e=e.split("").map(function(e){return e+e}).join("")),6!==e.length)throw new Error("无效的hex颜色："+e);return e}(e),[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function l(e){function t(e){var t=e.toString(16);return 1===t.length?"0"+t:t}return"#"+t(e[0])+t(e[1])+t(e[2])}function r(e,t,a){return Math.round(e+(t-e)*a)}const i=a(e),n=a(t),o=[];for(let s=0;s<=9;s++){const e=s/9,t=r(i[0],n[0],e),a=r(i[1],n[1],e),c=r(i[2],n[2],e);o.push(l([t,a,c]))}return o};return(a,l)=>{const r=re,i=te,n=ie;return e.data.length>0?(s(),x("div",yt,[(s(!0),x(w,null,h(e.data,(a,l)=>{return s(),x("div",{key:l,class:"rank-item"},[k("span",{class:"rank-num",style:B({backgroundColor:m(t)[l]})},b(l+1),5),k("div",wt,[_(r,null,{default:c(()=>[g(b(a[0]),1)]),_:2},1024)]),k("div",ht,[_(i,{type:"line",percentage:(n=a[1],n/Math.max(...e.data.map(e=>e[1]))*100),color:m(t)[l],height:6,"show-indicator":!1},null,8,["percentage","color"])]),k("div",gt,b(a[1]),1)]);var n}),128))])):(s(),x("div",bt,[_(n,{size:"large"})]))}}}),Ot=D(kt,[["__scopeId","data-v-ba455d5c"]]),Wt={class:"ml-6px"},$t={class:"h-350px px-16px py-12px"},St=d({__name:"index",setup(e){const{serverNameTop:t}=Oe(),a=n(()=>t.value.slice(0,10));return(e,t)=>(s(),o(We,null,{header:c(()=>[t[0]||(t[0]=k("i",{class:"i-waf:attacked-domain text-16px"},null,-1)),k("span",Wt,b(e.$t("Waf.Overview.index_49")),1)]),default:c(()=>[k("div",$t,[_(Ot,{data:m(a),colors:["#418f6b","#bcdeca"]},null,8,["data"])])]),_:1}))}}),qt={class:"w-920px p-20px"},Tt=d({__name:"more",setup(e){const{t:t}=p(),{queryStartTime:a}=Oe(),l=i(!1),r=i([]),n=i([{key:"server_name",title:t("Waf.Overview.index_64")},{key:"ip",title:t("Waf.Overview.index_65")},{key:"count",title:t("Waf.Overview.index_66"),sorter:(e,t)=>e.count-t.count},{key:"traffic",title:t("Waf.Overview.index_41"),sorter:(e,t)=>e.traffic-t.traffic,render:e=>U(e.traffic)},{key:"static_count",title:t("Waf.Overview.index_67"),sorter:(e,t)=>e.static_count-t.static_count},{key:"static_traffic",title:t("Waf.Overview.index_68"),sorter:(e,t)=>e.static_traffic-t.static_traffic,render:e=>U(e.static_traffic)},{key:"session_count",title:t("Waf.Overview.index_83"),sorter:(e,t)=>e.session_count-t.session_count}]),o=e=>{n.value.forEach(t=>{const a=t;if(a.key===e.columnKey){const t="ascend"===a.sortOrder?"descend":"ascend";a.sortOrder="boolean"==typeof e.order?t:e.order}else a.sortOrder=!1})};return(async()=>{try{l.value=!0;const{message:t}=await(e={start_time:a.value},I.post("/btwaf/get_traffic_top.json",e));P(t)&&(r.value=t.traffic_top||[])}finally{l.value=!1}var e})(),(e,t)=>{const a=ue;return s(),x("div",qt,[_(a,{"max-height":460,loading:m(l),data:m(r),columns:m(n),"onUpdate:sorter":o},null,8,["loading","data","columns"])])}}}),jt={class:"mx-6px"},zt={class:"leading-20px"},Ct={class:"h-350px p-16px"},Lt=d({__name:"index",setup(e){const{t:t}=p(),{trafficTop:a}=Oe(),l=n(()=>a.value.map(e=>[e.ip,e.count]).slice(0,10)),r=()=>{pe({title:t("Waf.Overview.index_51"),component:Tt})};return(e,t)=>{const a=xe,i=ae;return s(),o(We,null,{header:c(()=>[t[6]||(t[6]=k("i",{class:"i-waf:traffic-ranking text-16px"},null,-1)),k("span",jt,b(e.$t("Waf.Overview.index_50")),1),_(a,null,{default:c(()=>[k("div",zt,[g(b(e.$t("Waf.Overview.index_52")),1),t[0]||(t[0]=k("br",null,null,-1)),g(" 1."+b(e.$t("Waf.Overview.index_53")),1),t[1]||(t[1]=k("br",null,null,-1)),g(" 2."+b(e.$t("Waf.Overview.index_54")),1),t[2]||(t[2]=k("br",null,null,-1)),g(" 3."+b(e.$t("Waf.Overview.index_55")),1),t[3]||(t[3]=k("br",null,null,-1)),g(" 4."+b(e.$t("Waf.Overview.index_56")),1),t[4]||(t[4]=k("br",null,null,-1)),g(" 5."+b(e.$t("Waf.Overview.index_57")),1),t[5]||(t[5]=k("br",null,null,-1)),g(" "+b(e.$t("Waf.Overview.index_58")),1)])]),_:1})]),"header-extra":c(()=>[_(i,{type:"primary",text:"",onClick:r},{default:c(()=>[g(b(e.$t("Public.Btn.More"))+">> ",1)]),_:1})]),default:c(()=>[k("div",Ct,[_(Ot,{data:m(l),colors:["#06a6c7","#a5f1fc"]},null,8,["data"])])]),_:1})}}}),Bt={class:"w-1020px p-20px"},It=d({__name:"more",setup(e){const{t:t}=p(),{queryStartTime:a}=Oe(),l=i(!1),r=i([]),n=i([{key:"server_name",title:t("Waf.Overview.index_64")},{key:"url",title:t("Waf.Overview.index_69"),ellipsis:{tooltip:!0}},{key:"count",title:t("Waf.Overview.index_66"),sorter:(e,t)=>e.count-t.count},{key:"traffic",title:t("Waf.Overview.index_41"),sorter:(e,t)=>e.traffic-t.traffic,render:e=>U(e.traffic)},{key:"static_count",title:t("Waf.Overview.index_67"),sorter:(e,t)=>e.static_count-t.static_count},{key:"static_traffic",title:t("Waf.Overview.index_68"),sorter:(e,t)=>e.static_traffic-t.static_traffic,render:e=>U(e.static_traffic)},{key:"content_type",title:t("Waf.Overview.index_82"),ellipsis:{tooltip:!0}},{key:"session_count",title:t("Waf.Overview.index_83"),sorter:(e,t)=>e.session_count-t.session_count}]),o=e=>{n.value.forEach(t=>{const a=t;if(a.key===e.columnKey){const t="ascend"===a.sortOrder?"descend":"ascend";a.sortOrder="boolean"==typeof e.order?t:e.order}else a.sortOrder=!1})};return(async()=>{try{l.value=!0;const{message:t}=await(e={start_time:a.value},I.post("/btwaf/get_url_top.json",e));P(t)&&(r.value=t.traffic_top||[])}finally{l.value=!1}var e})(),(e,t)=>{const a=ue;return s(),x("div",Bt,[_(a,{"max-height":460,loading:m(l),data:m(r),columns:m(n),"onUpdate:sorter":o},null,8,["loading","data","columns"])])}}}),Mt={class:"mx-6px"},At={class:"leading-20px"},Et={class:"h-350px p-16px"},Pt=d({__name:"index",setup(e){const{t:t}=p(),{urlTop:a}=Oe(),l=n(()=>a.value.map(e=>[e.url,e.count]).slice(0,10)),r=()=>{pe({title:t("Waf.Overview.index_63"),component:It})};return(e,t)=>{const a=xe,i=ae;return s(),o(We,null,{header:c(()=>[t[3]||(t[3]=k("i",{class:"i-waf:visit-page text-16px"},null,-1)),k("span",Mt,b(e.$t("Waf.Overview.index_62")),1),_(a,null,{default:c(()=>[k("div",At,[g(b(e.$t("Waf.Overview.index_59")),1),t[0]||(t[0]=k("br",null,null,-1)),g(" 1."+b(e.$t("Waf.Overview.index_60")),1),t[1]||(t[1]=k("br",null,null,-1)),g(" 2."+b(e.$t("Waf.Overview.index_61")),1),t[2]||(t[2]=k("br",null,null,-1)),g(" "+b(e.$t("Waf.Overview.index_58")),1)])]),_:1})]),"header-extra":c(()=>[_(i,{type:"primary",text:"",onClick:r},{default:c(()=>[g(b(e.$t("Public.Btn.More"))+">> ",1)]),_:1})]),default:c(()=>[k("div",Et,[_(Ot,{data:m(l),colors:["#0d5450","#4ff9e0"]},null,8,["data"])])]),_:1})}}}),Ut={class:"ml-6px"},Dt={class:"p-16px h-360px"},Ft={key:1,class:"flex items-center justify-center h-full"},Gt=d({__name:"index",setup(e){const{t:t}=p(),{count:a,blockTypes:l}=Oe(),r=$("--color-bg-2"),i=$("--chart-tooltip-bg-color"),n=$("--color-text-1"),u=$("--color-text-2"),d=$("--color-text-5"),v=(e,t)=>{let a=0;for(var r=0;r<l.value.length;r++)if(l.value[r][0]===e){a=l.value[r][1];break}return{value:a,percent:a>0&&t>0?(a/t*100).toFixed(0)+"%":"0%"}},y=S({color:["#6ec71e","#4885FF","#fc8b40","#818af8","#31c9d7","#f35e7a","#ab7aee","#14d68b","#cde5ff"],backgroundColor:r.value,title:w(),tooltip:{trigger:"item",confine:!0,backgroundColor:i.value,borderColor:"transparent",textStyle:{color:d.value},formatter(e){const t=e;return`${t.marker} ${t.name}: ${t.value} (${t.percent}%)`}},legend:{show:!0,orient:"vertical",type:"scroll",right:"0%",top:"center",itemGap:15,icon:"circle",textStyle:{color:d.value,fontSize:13},formatter(e){const t=e.length>12?e.substring(0,12)+"...":e,{value:l,percent:r}=v(e,a.value.malicious_request);return`${t} ${l} (${r})`},tooltip:{show:!0,textStyle:{color:d.value},formatter(e){const{value:t,percent:l}=v(e.name,a.value.malicious_request);return`${e.name} ${t} (${l})`}}},series:h()});function w(e=0){return{text:t("Waf.Overview.index_75"),textStyle:{color:n.value,fontSize:16},subtext:`${e}`,subtextStyle:{color:u.value,fontSize:20,fontWeight:"bold"},itemGap:16,left:"27%",top:"46%",textAlign:"center",textVerticalAlign:"middle"}}function h(e=[]){return[{type:"pie",data:e,radius:["45%","55%"],center:["28%","50%"],clockwise:!0,avoidLabelOverlap:!0,hoverOffset:10,label:{show:!1},labelLine:{show:!1},itemStyle:{labelLine:{lineStyle:{width:2,color:"#fff"},emphasis:{borderWidth:0,shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},emphasis:{scaleSize:15}}]}return f(()=>{(e=>{const t=e.map(e=>({name:e[0],value:e[1]}));y.title=w(a.value.malicious_request),y.series=h(t)})(l.value)}),(e,t)=>{const a=ie;return s(),o(We,null,{header:c(()=>[t[0]||(t[0]=k("i",{class:"i-waf:interception-type text-16px"},null,-1)),k("span",Ut,b(e.$t("Waf.Overview.index_74")),1)]),default:c(()=>[k("div",Dt,[m(l).length>0?(s(),o(fe,{key:0,type:"pie",height:"100%",option:m(y)},null,8,["option"])):(s(),x("div",Ft,[_(a,{size:"large"})]))])]),_:1})}}}),Nt={class:"ml-6px"},Ht={class:"p-16px h-360px"},Yt=d({__name:"index",setup(e){const{t:t}=p(),{attackReportLogs:a}=Oe(),l=n(()=>a.value.slice(0,20)),r=i([{key:"time_localtime",width:150,title:t("Waf.Overview.index_70"),render:e=>E(e.time_localtime)},{key:"ip",width:120,title:t("Waf.Overview.index_71")},{key:"server_name",width:140,title:t("Waf.Overview.index_64")},{key:"filter_rule",width:160,title:t("Waf.Overview.index_72")},{key:"uri",title:t("Waf.Overview.index_69"),render:e=>_("span",{class:"break-all"},[e.uri])},ve({width:200,options:e=>[{label:t("Waf.Block.index_22"),onClick:()=>{_e(e)}},{label:t("Waf.Block.index_23"),onClick:()=>{me(e,-1!==e.uri.indexOf("?")&&-1!==e.uri.indexOf("="))}},{label:t("Waf.Block.index_24"),onClick:()=>{ye(e)}}]})]);return(e,t)=>{const a=ue;return s(),o(We,null,{header:c(()=>[t[0]||(t[0]=k("i",{class:"i-waf:interception-event text-16px"},null,-1)),k("span",Nt,b(e.$t("Waf.Overview.index_73")),1)]),default:c(()=>[k("div",Ht,[_(a,{"max-height":270,data:m(l),columns:m(r)},null,8,["data","columns"])])]),_:1})}}}),Kt={class:"waf-overview"},Rt={class:"flex flex-wrap items-center gap-20px px-8px"},Vt={class:"text-base font-bold"},Xt={class:"text-default"},Zt={class:"flex flex-col gap-16px"},Jt={class:"flex flex-col gap-16px"},Qt=d({__name:"index",setup(e){const{store:t,open:l}=Oe(),r=async()=>{await a(),t.getInfo()};return t.getInfo(),(e,t)=>{const a=ae,i=oe,n=ne,u=X;return s(),x("div",Kt,[_(u,{"x-gap":"16","y-gap":"16",cols:"24"},{default:c(()=>[m(l)?C("",!0):(s(),o(n,{key:0,span:"24"},{default:c(()=>[_(i,{type:"error","show-icon":!1,bordered:!1},{default:c(()=>[k("div",Rt,[k("span",Vt,b(e.$t("Waf.Overview.index_78")),1),k("span",Xt,b(e.$t("Waf.Overview.index_79")),1),_(a,{type:"primary",onClick:r},{default:c(()=>[g(b(e.$t("Waf.Overview.index_80")),1)]),_:1})])]),_:1})]),_:1})),_(n,{span:"6"},{default:c(()=>[k("div",Zt,[_(Ce),_(Ne),_(Re),_(et),_(Ze),_(St),_(Gt)])]),_:1}),_(n,{span:"18"},{default:c(()=>[k("div",Jt,[_(lt),_(mt),_(u,{"x-gap":"16","y-gap":"16",cols:"2"},{default:c(()=>[_(n,null,{default:c(()=>[_(Lt)]),_:1}),_(n,null,{default:c(()=>[_(Pt)]),_:1})]),_:1}),_(Yt)])]),_:1})]),_:1})])}}}),ea=Object.freeze(Object.defineProperty({__proto__:null,default:Qt},Symbol.toStringTag,{value:"Module"}));e("i",ea)}}});
