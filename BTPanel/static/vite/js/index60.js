import{c as e,d as t,h as a,e as s,I as i,f as n,_ as l,a as o,b as u,q as r}from"./public.js?v=1764830988434";import{_ as c}from"./index107.js?v=1764830988434";import{_ as d}from"./index.js?v=1764830988434";import{k as p,P as _,r as y,n as m,e as g,R as x,V as v,W as h,a3 as w,S as k,a4 as b,U as f,ak as S,a0 as I,w as A,F as j,j as C,a2 as O,l as P,O as U,H as q,v as R,c as $}from"./vue.js?v=1764830988434";import{aD as M,i as T,a9 as z,x as L,ch as F,m as K,d as W,y as H,_ as D,p as V,u as B,q as E}from"./page_layout.js?v=1764830988434";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1764830988434";import{da as G,dV as N,dR as Q,au as X,aC as Y,dS as Z,bJ as ee,dj as te}from"./naive.js?v=1764830988434";import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang.js?v=1764830988434";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1764830988434";import"./common.js?v=1764830988434";import"./__commonjsHelpers__.js?v=1764830988434";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1764830988434";const{t:ie}=T.global,ne={class:"p-20px"},le=p({__name:"log",props:{data:{}},setup(s,{expose:i}){const{t:n}=_(),l=s,{date:o,name:u}=l.data,r=y([]),{keys:c,table:d,columns:p}=e([{key:"log",title:n("Ftp.Analysis.Index_27"),render:()=>u},{key:"cwd",title:n("Security.Anti.Index_46")},{key:"cmd",title:n("Security.Anti.Index_47")},{key:"filename",title:n("Security.Anti.Index_48")},{key:"cwd",title:n("Config.Safe.index_152"),render:e=>z(e.timestamp)}]);m(()=>{r.value=o.map(e=>({label:e,value:e}))});const I=g({p:1,num:999,day:o[0]}),{loading:A,setLoading:j}=t(),C=async()=>{try{j(!0);const{message:t}=await(e={...I,user:u},M.post("/plugin?action=a&name=bt_security&s=get_user_log",e));L(t)&&(d.data=t,d.total=t.length)}finally{c.value=[],j(!1)}var e};return C(),i({init:C}),(e,t)=>{const s=N,i=G,n=a,l=J;return v(),x("div",ne,[h(i,{class:"flex-nowrap! items-center mb-10px"},{default:w(()=>[k("span",null,b(e.$t("Security.Anti.Index_45")),1),h(s,{class:"w-150px",value:f(I).day,"onUpdate:value":[t[0]||(t[0]=e=>f(I).day=e),C],options:f(r)},null,8,["value","options"])]),_:1}),h(l,null,{table:w(()=>[h(n,{"checked-row-keys":f(c),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>S(c)?c.value=e:null),loading:f(A),data:f(d).data,"max-height":350,columns:f(p)},null,8,["checked-row-keys","loading","data","columns"])]),_:1})])}}}),oe=p({__name:"index",setup(o,{expose:u}){const{t:r}=_(),c=F(),{antiForm:p}=I(c),y=s(),{keys:m,table:g,columns:C}=e([{key:"user",title:r("Ftp.Analysis.Index_27")},{key:"total",title:r("Security.Anti.Index_7")},{key:"today",title:r("Public.Search.Today")},i({key:"protection",title:r("Security.Tabs.Index_8"),minWidth:60,onClick:async(e,t)=>{var a;e?await(a={user:t.user},M.post("/plugin?action=a&name=bt_security&s=start_user_security",a,{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}})):await(e=>M.post("/plugin?action=a&name=bt_security&s=stop_user_security",e,{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}))({user:t.user})}}),i({key:"log",title:r("Security.Anti.Index_8"),minWidth:60,onClick:async(e,t)=>{var a;e?await(a={uid:t.uid},M.post("/plugin?action=a&name=bt_security&s=start_user_log",a,{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}})):await(e=>M.post("/plugin?action=a&name=bt_security&s=stop_user_log",e,{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}))({uid:t.uid})}}),{key:"remark",title:r("Site.Proxy.index_3")},n({width:130,title:r("Public.Table.Operation"),options:e=>[{label:r("Site.Proxy.index_51"),onClick:async()=>{const{message:t}=await(a={user:e.user},M.post("/plugin?action=a&name=bt_security&s=get_logs_list",a,{requestOptions:{loading:ie("Site.Api.Index_10"),successMessage:!1}}));var a;!L(t)||t.length?(y.title="[".concat(e.user,"] - ").concat(r("Site.Proxy.index_51")),y.data.date=t,y.data.name=e.user,y.show=!0):K.error(r("Security.Anti.Index_44"))}}]})]);A(()=>c.isRefresh,e=>{e&&(c.setRefresh(!1),U())});const{loading:O,setLoading:P}=t(),U=async()=>{try{P(!0);const{message:e}=await M.post("/plugin?action=a&name=bt_security&s=get_total_all");W(e)&&(p.value.switch=e.open,p.value.times=e.totla_times,p.value.days=e.totla_days,g.data=e.system_user.map(e=>({user:e[0],total:e[4].totla,today:e[4].day_totla,protection:e[3],log:e[5],remark:e[6],uid:e[1]})))}finally{m.value=[],P(!1)}};return U(),u({init:U}),(e,t)=>{const s=a,i=l,n=d;return v(),x(j,null,[h(s,{"checked-row-keys":f(m),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(m)?m.value=e:null),"row-key":"user","max-height":750,loading:f(O),data:f(g).data,columns:f(C)},null,8,["checked-row-keys","loading","data","columns"]),h(i,{class:"mt-16px"},{default:w(()=>[k("li",null,b(e.$t("Security.Anti.Index_4")),1),k("li",null,b(e.$t("Security.Anti.Index_5")),1),k("li",null,b(e.$t("Security.Anti.Index_6")),1)]),_:1}),h(n,{show:f(y).show,"onUpdate:show":t[1]||(t[1]=e=>f(y).show=e),title:f(y).title,data:f(y).data,width:750,"min-height":268,footer:!1,component:le},null,8,["show","title","data"])],64)}}}),ue={class:"p-20px"},re={class:"w-280px"},ce={class:"color-#ff3333"},de=p({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=_(),s=e,{getList:i}=s.data,n=y(null),o=g({name:""}),u={name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=n.value)?void 0:t.validate()),await(a={cmd:o.name},M.post("/plugin?action=a&name=bt_security&s=add_porcess_log",a,{requestOptions:{loading:ie("Security.Api.Index_4"),successMessage:!0}})),null==i||i(),e()}}),(e,t)=>{const a=X,s=Q,i=ae,r=l;return v(),x("div",ue,[h(i,{ref_key:"formRef",ref:n,model:f(o),rules:u},{default:w(()=>[h(s,{label:e.$t("Home.index_24"),path:"name"},{default:w(()=>[k("div",re,[h(a,{type:"text",value:f(o).name,"onUpdate:value":t[0]||(t[0]=e=>f(o).name=e),placeholder:"e.g:/bin/bash"},null,8,["value"])])]),_:1},8,["label"])]),_:1},8,["model"]),h(r,{class:"mt-4px"},{default:w(()=>[k("li",ce,b(e.$t("Security.Anti.Index_9")),1)]),_:1})])}}}),pe=p({__name:"index",setup(i,{expose:l}){const{t:u}=_(),{loading:r,setLoading:c}=t(),{keys:p,table:y,columns:m}=e([{key:"whitelist",title:u("Security.Anti.Index_11")},n({width:130,options:e=>[{label:u("Public.Btn.Del"),onClick:()=>{o({title:"".concat(u("Security.Anti.Index_12")," [").concat(e.whitelist,"]"),content:u("Security.Anti.Index_13"),onConfirm:async({hide:t})=>{var a;await(a={cmd:e.whitelist},M.post("/plugin?action=a&name=bt_security&s=del_porcess_log",a,{requestOptions:{loading:ie("Security.Api.Index_3"),successMessage:!0}})),g(),t()}})}}]})]),g=async()=>{try{c(!0);const{message:e}=await M.post("/plugin?action=a&name=bt_security&s=porcess_set_up_log");L(e)&&(y.data=e.map(e=>({whitelist:e})))}finally{p.value=[],c(!1)}};g(),l({init:g});const k=()=>{I.show=!0},I=s(u("Security.Anti.Index_10"),{getList:g});return(e,t)=>{const s=Y,i=a,n=J,l=d;return v(),x("div",null,[h(n,null,{toolsLeft:w(()=>[h(s,{type:"primary",onClick:k},{default:w(()=>[C(b(e.$t("Security.Anti.Index_10")),1)]),_:1})]),table:w(()=>[h(i,{"checked-row-keys":f(p),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(p)?p.value=e:null),"row-key":"whitelist",loading:f(r),"max-height":440,data:f(y).data,columns:f(m)},null,8,["checked-row-keys","loading","data","columns"])]),_:1}),h(l,{show:f(I).show,"onUpdate:show":t[1]||(t[1]=e=>f(I).show=e),title:f(I).title,data:f(I).data,width:480,footer:!0,component:de},null,8,["show","title","data"])])}}}),_e=p({__name:"index",setup(s,{expose:i}){const{t:n}=_(),{keys:l,table:o,columns:u}=e([{key:"log",title:n("Public.Table.Operation")},{key:"addtime",align:"right",title:n("Site.Cert.index_68")}]),r=g({p:1,limit:10}),{loading:c,setLoading:d}=t(),p=async()=>{try{d(!0);const{message:t}=await(e=r,M.post("/plugin?action=a&name=bt_security&s=get_log",e));W(t)&&(o.data=t.data,o.total=H(t.page))}finally{l.value=[],d(!1)}var e};return p(),i({init:p}),(e,t)=>{const s=a,i=se,n=J;return v(),O(n,{feedback:!0},{table:w(()=>[h(s,{"checked-row-keys":f(l),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(l)?l.value=e:null),"row-key":"log",loading:f(c),data:f(o).data,columns:f(u)},null,8,["checked-row-keys","loading","data","columns"])]),pageRight:w(()=>[h(i,{page:f(r).p,"onUpdate:page":t[1]||(t[1]=e=>f(r).p=e),"page-size":f(r).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>f(r).limit=e),"item-count":f(o).total,"store-key":"security-anti",onRefresh:p},null,8,["page","page-size","item-count"])]),_:1})}}}),ye=p({__name:"index",setup(e){const{t:t}=_(),a=y("overview"),s=[{key:"overview",label:t("Security.Tabs.Index_5"),component:oe},{key:"whitelist",label:t("Security.Tabs.Index_6"),component:pe},{key:"operation",label:t("Security.Tabs.Index_7"),component:_e}];return(e,t)=>{const i=c;return v(),O(i,{value:f(a),"onUpdate:value":t[0]||(t[0]=e=>S(a)?a.value=e:null),options:s},null,8,["value"])}}}),me={class:"pt-40px pb-40px"},ge={class:"mb-16px"},xe={class:"ul-style"},ve={class:"text-center my-24px"},he={class:"flex justify-center"},we={class:"item"},ke=["onClick"],be=V(p({__name:"conversion",setup(e){const t=y(0),a=["Overview","Process whitelist","Operation logs"],s=()=>{u({source:105})};return(e,i)=>{const n=D,l=Y,o=ee,u=Z;return v(),O(u,null,{default:w(()=>[k("div",me,[i[3]||(i[3]=k("div",{class:"mb-24px text-center text-22px font-bold"},"Anti Intrusion prevention features",-1)),k("div",ge,[k("ul",xe,[k("li",null,[h(n,{name:"security-lixian",size:"22"}),i[0]||(i[0]=k("span",{class:"ml-4px"},"Prevents the program from hanging",-1))]),k("li",null,[h(n,{name:"security-sanfang",size:"20"}),i[1]||(i[1]=k("span",{class:"ml-4px"},"Stop the mining virus",-1))]),k("li",null,[h(n,{name:"security-webshell",size:"26"}),i[2]||(i[2]=k("span",null,"Prevent Privilege Escalation Attacks",-1))])])]),k("div",ve,[h(l,{type:"primary",class:"h-36px text-14px",onClick:s},{default:w(()=>[C(b(e.$t("WP.Transition.index_7")),1)]),_:1})]),k("div",he,[k("div",we,[k("ul",null,[(v(),x(j,null,U(a,(e,a)=>k("li",{class:q({active:f(t)==a}),key:a,onClick:e=>t.value=a},b(e),11,ke)),64))])]),P(h(o,{width:"100%",src:f("/static/vite/images/overview.png")},null,8,["src"]),[[R,0==f(t)]]),P(h(o,{width:"100%",src:f("/static/vite/images/whitelist.png")},null,8,["src"]),[[R,1==f(t)]]),P(h(o,{width:"100%",src:f("/static/vite/images/logs.png")},null,8,["src"]),[[R,2==f(t)]])])])]),_:1})}}}),[["__scopeId","data-v-f9cef105"]]),fe={key:0},Se=p({__name:"index",setup(e){const t=B(),{isPro:a}=I(t),s=F(),{antiForm:i}=I(s),n=y(i.value.switch),l=$(()=>i.value.switch);A(l,e=>{n.value=e});const o=$(()=>i.value.times),u=$(()=>i.value.days),c=async e=>{e?await M.post("/plugin?action=a&name=bt_security&s=start_bt_security",{},{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}}):await M.post("/plugin?action=a&name=bt_security&s=stop_bt_security",{},{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await r("bt_security")})(),(e,t)=>{const s=te,i=E,l=G,r=Z;return f(a)?(v(),x("div",fe,[h(r,{class:"my-15px"},{default:w(()=>[h(l,{class:"p-15px items-center"},{default:w(()=>[k("span",null,b(e.$t("Security.Anti.Index_1")),1),h(s,{value:f(n),"onUpdate:value":[t[0]||(t[0]=e=>S(n)?n.value=e:null),c],"rubber-band":!1,size:"small"},null,8,["value"]),h(i,{vertical:""}),k("span",null,b(e.$t("Security.Anti.Index_2"))+": "+b(f(o)),1),h(i,{vertical:""}),k("span",null,b(e.$t("Security.Anti.Index_3"))+": "+b(f(u)),1)]),_:1})]),_:1}),h(r,{class:"p-15px"},{default:w(()=>[h(ye)]),_:1})])):(v(),O(be,{key:1}))}}});export{Se as default};
